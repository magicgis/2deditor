!function(u,y,N){"use strict";var E="ht",c=u[E],o=c.Default,m=c.graph,i=o.getInternal(),h=i.ui(),D=h.NodeUI.prototype,n=h.ShapeUI.prototype,O=m.GraphView,a=O.prototype,x=h.EdgeUI.prototype,t=c.Node,$=c.Shape,k=c.Edge,R=c.Group,p=o.isTouchable,Y=o.preventDefault,q=u.setTimeout,T=o.grow,M=o.isDragging,P=o.getDistance,r=null,U=c.List,H="undefined"!=typeof Float32Array?Float32Array:Array,e=Math,A=e.PI,C="Crossing",l="No Crossing",S=A/2,X=2*A,J=e.atan2,V=e.sqrt,d=e.pow,K=e.sin,g=e.cos,v=e.min,G=e.max,B=e.abs,Q=e.ceil,W=e.round,w=o.unionPoint,L=o.unionRect,_=o.containsPoint,s=o.clone,j="rgb(52, 152, 219)",F="red",f={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},I={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var Y=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],A=0;A<Y.length;A++){var F=Y[A];F=0===A%2?F/400*I.width:F/100*I.height,Y[A]=F}return I.width>120&&(Y[4]=I.width-26,Y[6]=I.width-40,Y[10]=I.width-40,Y[12]=I.width-26,Y[18]=33),Y}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},b={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:j,rotation:.61},{type:"circle",rect:[200,120,70,70],background:j,rotation:.61},{type:"circle",rect:[200,220,70,70],background:j,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:j},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:j}]},Z={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:F,rotation:.61}]},z={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:j},{type:"circle",rect:[0,210,90,90],background:j},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:j}]},od={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:F},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:F}]},rm={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:j}]},ib={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:F}]},gb={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},pi={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Ab=function(i){var C=i.touches[0];return C?C:i.changedTouches[0]},ol=function(Z,s,K,A){return J(A-s,K-Z)},sc=function(L,x){return{x:L.x*x,y:L.y*x}},pn=function(J,C){J.each(function(M){return J.isSelected(M)?C(M):void 0})},Uh=function(Z,E){Z.reverseEach(function(X){return Z.isSelected(X)?E(X):void 0})},bk=function(I,P,l){var r,T,J,q,S,Z=this,t=P,_=Z.gv;if(I instanceof $){J=I.getSegments();var Q=_.getDataUI(I);S=Q._55O.$15l,J&&J.size()||(J=Wd(S)),I.isClosePath()&&J.indexOf(5)<0&&(J=new U(J._as),J.add(5)),r=Oh(I,Q,t),T=S[r]}else{var H=_.getDataUI(I);S=Fr(H,I.s("edge.points")),J=I.s("edge.segments"),J&&J.size()||(J=Wd(S)),S=S._as,r=Oh(I,H,t),T=S[r]}if(J&&(q=J.get(t)),2===q||1===q||5===q){var w=S[r+1];5===q&&(w=S[0]);var u=Tc(T,l,w);return u}return l},Vi=function(d,b,r,T){var I=b/2,G=r/2,K=Rd(d,-I,-G,T),z=Rd(d,I,-G,T),j=Rd(d,-I,G,T),p=Rd(d,I,G,T),m=Rd(d,0,-G,T),O=Rd(d,I,0,T),o=Rd(d,0,G,T),D=Rd(d,-I,0,T);return[K,z,j,p,m,O,o,D]},Tc=function(i,A,Q){var L={x:A.x-i.x,y:A.y-i.y},Y={x:Q.x-i.x,y:Q.y-i.y},G=V(d(Q.x-i.x,2)+d(Q.y-i.y,2)),a={x:Y.x/G,y:Y.y/G},g=L.x*a.x+L.y*a.y,l={x:a.x*g,y:a.y*g};return{x:i.x+l.x,y:i.y+l.y}},Rd=function(i,G,H,X){var q=g(X)*G-K(X)*H,Y=K(X)*G+g(X)*H;return i?{x:i.x+q,y:i.y+Y}:{x:q,y:Y}},Ed=function(f,B){return B>2*f?f:B/2},Ce=function(W,e,O,s){var R=P(W,e);return O=s?v(O,R):Ed(O,R),R?O/=R:O=0,{x:W.x+(e.x-W.x)*O,y:W.y+(e.y-W.y)*O}},yn=function(x,L){var X,D,S=x.gv,J=x._data,M=J._40I,y=J._41I,o=J.s("edge.offset"),z=J.s("edge.source.position"),r=J.s("edge.target.position"),T=J.s("edge.source.offset.x"),c=J.s("edge.source.offset.y"),m=J.s("edge.target.offset.x"),C=J.s("edge.target.offset.y"),F=J.s("edge.source.anchor.x"),d=J.s("edge.source.anchor.y"),W=J.s("edge.target.anchor.x"),I=J.s("edge.target.anchor.y");if(L?(X=i.getEdgeAgentPosition(S,M,z,T,c,F,d),D=i.getEdgeAgentPosition(S,y,r,m,C,W,I)):(X=i.getEdgeAgentPosition(S,M,z,0,0,F,d),D=i.getEdgeAgentPosition(S,y,r,0,0,W,I)),"points"===J.s("edge.type")&&o&&!J.s("edge.center")&&X){var w=J.s("edge.points")||new U,Y=w.size(),p=Ce(X,Y?w.get(0):D,o,Y),G=Ce(D,Y?w.get(Y-1):X,o,Y);X=p,D=G}return[X,D]},Fr=function(v,L,W){var F=v._78o,M=v._data,X=M.s("edge.type"),k=[F.sourcePoint,F.targetPoint];return"points"===X?W&&(k=yn(v)):k=F.center?X?W?yn(v):yn(v,!0):W?yn(v):[F.c1,F.c2]:W?yn(v):yn(v,!0),L=new U(L?L._as:r),L.add(k[0],0),L.add(k[1]),L},nj=function(X){return X=new U(X._as),X.removeAt(0),X.removeAt(X.size()-1),X},Wd=function(e){e._as||(e=new U(e));var X=new U;X.add(1);for(var T=1;T<e.size();T++)X.add(2);return X},tc=function(c,y){return{x:(c.x+y.x)/2,y:(c.y+y.y)/2}},Ol=function(b,S){return{x:b.x+1*(S.x-b.x)/4,y:b.y+1*(S.y-b.y)/4}},ne=function(f,U){return{x:f.x+3*(U.x-f.x)/4,y:f.y+3*(U.y-f.y)/4}},$d=function(t,L,z,R){var E=L.x+L.width/2,A=L.y+L.height/2,$=V(E*E+A*A),m=J(A,E)+z;return{x:R.x+$*g(m),y:R.y+$*K(m)}},xj=a.validateImpl,no=a.isRectEditable,Yd=a.isPointEditable,Oj=a._42,Wr=n._79o,kc=x._79o,Jm=n._48O,vo=n._47O,si=D._48O,Dl=D._80o,Ud=n._80o,li=D.getSelectWidth,qc=D._47O,cq=x._47O,of=a.isEditable,Lg=["northwest","north","northeast","east","southeast","south","southwest","west"],xh=function(y,E,P,l,e,j,U,R,k,z){var _=y.x,W=y.y,b=y.width,M=y.height,h={x:_+b/2,y:W+M/2};l=l||0,E=Rd(h,E.x-h.x,E.y-h.y,-l),U&&!R&&(E.x+=k,E.y+=z);var T=.01;if("northwest"===P?(E.x+e>_+b-T&&(E.x=_+b-e-T),E.y+e>W+M-T&&(E.y=W+M-e-T),y=w(E,{x:_+b,y:W+M})):"north"===P?(E.y+e>W+M-T&&(E.y=W+M-e-T),y=w({x:_,y:E.y},{x:_+b,y:W+M})):"northeast"===P?(E.x<_+e+T&&(E.x=_+e+T),E.y+e>W+M-T&&(E.y=W+M-e-T),y=w({x:_,y:E.y},{x:E.x,y:W+M})):"west"===P?(E.x+e>_+b-T&&(E.x=_+b-e-T),y=w({x:E.x,y:W},{x:_+b,y:W+M})):"east"===P?(E.x<_+e+T&&(E.x=_+e+T),y=w({x:_,y:W},{x:E.x,y:W+M})):"southwest"===P?(E.x+e>_+b-T&&(E.x=_+b-e-T),E.y<W+e+T&&(E.y=W+e+T),y=w({x:E.x,y:W},{x:_+b,y:E.y})):"south"===P?(E.y<W+e+T&&(E.y=W+e+T),y=w({x:_,y:W},{x:_+b,y:E.y})):"southeast"===P&&(E.x<_+e+T&&(E.x=_+e+T),E.y<W+e+T&&(E.y=W+e+T),y=w({x:_,y:W},E)),"keepRatio"===j&&(!U&&R||U&&!R)&&("northeast"===P||"southeast"===P||"northwest"===P||"southwest"===P)){var X=y.width,a=y.height,G=X/b,m=a/M,u=v(G,m);y.width=b*u,y.height=M*u,"northeast"===P?y.y=W+(M-y.height):"northwest"===P?(y.y=W+(M-y.height),y.x=_+(b-y.width)):"southwest"===P&&(y.x=_+(b-y.width))}y.x-=h.x,y.y-=h.y;var f=$d(r,y,l,h);return y.x=f.x-y.width/2,y.y=f.y-y.height/2,y},Em=function(h,r,O,F){var P=h.getRotation(),e=r,V=e.x,T=e.y,v=e.width,L=e.height,S={x:V+e.width/2,y:T+e.height/2};F=Rd(S,F.x-S.x,F.y-S.y,-P),"northwest"===O?e=w(F,{x:V+v,y:T+L}):"north"===O?e=w({x:V,y:F.y},{x:V+v,y:T+L}):"northeast"===O?e=w({x:V,y:F.y},{x:F.x,y:T+L}):"west"===O?e=w({x:F.x,y:T},{x:V+v,y:T+L}):"east"===O?e=w({x:V,y:T},{x:F.x,y:T+L}):"southwest"===O?e=w({x:F.x,y:T},{x:V+v,y:F.y}):"south"===O?e=w({x:V,y:T},{x:V+v,y:F.y}):"southeast"===O&&(e=w({x:V,y:T},F)),h.setRect(e),e.x-=S.x,e.y-=S.y;var g=$d(h,e,P,S);h.p(g.x,g.y)},hk=function(l,e,i,D,M,V,F,g){var _=r;V?(_=Rd(r,M.x-e.x,M.y-e.y,-i),_.x-=F.x,_.y-=F.y):_=Rd(r,M.x-e.x,M.y-e.y,0);var j={x:e.x+_.x,y:e.y+_.y};g&&(j=g(j.x,j.y)),j.e=l.getPoints().get(D).e,l.setPoint(D,j);var x=l.getWidth(),f=l.getHeight(),C=l.p().x-x/2,G=l.p().y-f/2;C-=e.x,G-=e.y;var p=$d(l,{x:C,y:G,width:x,height:f},i,e);l.p(p.x,p.y)},Oh=function(y,_,K){var Y,s;if(y instanceof $?(Y=y.getPoints(),s=y.getSegments()):y instanceof k&&"points"===y.s("edge.type")&&(Y=y.s("edge.points"),s=y.s("edge.segments"),Y=Fr(_,Y)),s&&s.size()||(s=Wd(Y)),y instanceof $&&y.isClosePath()&&s.indexOf(5)<0&&(s=new U(s._as),s.add(5)),s)for(var G=-1,o=0;o<s.size();o++){if(o===K)return G;var A=s.get(o);1===A?G+=1:2===A?G+=1:3===A?G+=2:4===A&&(G+=3)}},Qj=function(K,P,i){var B,D;if(K instanceof $?(B=K.getPoints(),D=K.getSegments()):K instanceof k&&"points"===K.s("edge.type")&&(B=K.s("edge.points"),D=K.s("edge.segments"),B=Fr(P,B)),D&&D.size()||(D=Wd(B)),D)for(var O=-1,A=0;A<D.size();A++){var G=D.get(A);if(1===G?O+=1:2===G?O+=1:3===G?O+=2:4===G&&(O+=3),O===i)return A}},Fp=function(i,j){var k=[i[0]-j[0],i[1]-j[1],i[2]-j[2]];return k},Yp=function(){var m=new H(16);return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m},uo=function(F,D){var U=F[0],P=F[1],E=F[2];return F[0]=D[0]*U+D[4]*P+D[8]*E+D[12],F[1]=D[1]*U+D[5]*P+D[9]*E+D[13],F[2]=D[2]*U+D[6]*P+D[10]*E+D[14],F},Ap=function(l,f){if(f){var O=K(f),Q=g(f),$=l[0],y=l[1],F=l[2],x=l[3],R=l[8],s=l[9],Z=l[10],U=l[11];l[0]=$*Q-R*O,l[1]=y*Q-s*O,l[2]=F*Q-Z*O,l[3]=x*Q-U*O,l[8]=$*O+R*Q,l[9]=y*O+s*Q,l[10]=F*O+Z*Q,l[11]=x*O+U*Q}},Le=function(c,C){for(var K=c.s("grid.row.count"),i=c.s("grid.column.count"),y=0;K>y;y++)for(var o=0;i>o;o++){var $=c.getCellRect(y,o);if(_($,C))return{rowIndex:y,columnIndex:o,rect:$,grid:c}}return null},zj=function(F,T,Q,x,E,s){var A={},t=Q-F,C=x-T,g=e.sqrt(t*t+C*C),w=t/g,p=C/g,c=(-F+E)*w+(-T+s)*p;return 0>=c?(A.x=F,A.y=T):c>=g?(A.x=Q,A.y=x):(A.x=F+c*w,A.y=T+c*p),t=E-A.x,C=s-A.y,A.z=e.sqrt(t*t+C*C),A},ac=function(f,E){var h,Z,A,F,n,W,T,J,R=f.getPoints(),m=f.getSegments(),x=f.p(),K=f.getRotation();if(!m||!(m.indexOf(3)>0||m.indexOf(4)>0)){for(J=0;J<=R.size()-1;J++)if(J===R.size()-1?(n=R.get(0),F=R.get(J)):(F=R.get(J),n=R.get(J+1)),F=Rd(x,F.x-x.x,F.y-x.y,K),n=Rd(x,n.x-x.x,n.y-x.y,K),W=zj(F.x,F.y,n.x,n.y,E.x,E.y),T=W.z,T<(f.s("shape.border.width")||10)){Z=F,A=n,h=J;break}if(h!=r){var b=zj(Z.x,Z.y,A.x,A.y,E.x,E.y),l=P(Z,b);return{attachIndex:h,attachOffset:l}}}},jf=function(f){for(var x=f._data,w=x.p(),c=x.getRotation(),C=x.getPoints(),W=r,F=[],l=0;l<C.size();l++)W=C.get(l),F.push(Rd(w,W.x-w.x,W.y-w.y,c));f._55O.$15l=F};o.setImage("xeditinteractor_parentIcon",b),o.setImage("xeditinteractor_hostIcon",Z),o.setImage("xeditinteractor_edgeIcon",z),o.setImage("xeditinteractor_removeIcon",od),o.setImage("xeditinteractor_sourceIcon",rm),o.setImage("xeditinteractor_targetIcon",ib),o.setImage("xeditinteractor_elevationIcon",gb),o.setImage("xeditinteractor_tallIcon",pi),a._editPointSize=p?24:9,a._edgeHelpers=["parent","remove","source","target"],a._leftTopHelpers=["parent"],a._rightTopHelpers=["host"],a._leftBottomHelpers=["edge"],a._rightBottomHelpers=["remove"],Lg=Lg.concat(Lg).concat(Lg),x._79o=function(){var Q=this,M=Q.gv,e=M.getZoom(),j=M._editInteractor,u=kc.call(Q);if(!u)return null;var r=yn(Q,!0),l=r[0],b=r[1],B={x:u.x,y:u.y,width:u.width,height:u.height},y=w(l,b);if(j instanceof m.XEditInteractor){B=L(B,y);var k=Q._55O,E=M.getEditPointSize()/e+2,f=0;k&&k._43O&&(f+=E/2,T(B,f))}return B},x._47O=function(b){var n=this,T=n.gv,g=T._editInteractor;g instanceof m.XEditInteractor||cq.call(n,b)},x.rectIntersects=function(j){var Q=this,Y=Q._data,E=Q.gv,R=E.getZoom(),q=Q._55O,t=E._editInteractor;if(t instanceof m.XEditInteractor&&E.isEditable(Y)&&q&&q._43O&&"points"===Y.s("edge.type")){var V=Y.s("edge.points"),N=Y.s("edge.segments");V=Fr(Q,V),N&&N.size()||(N=Wd(V)),V=V._as;var a=!1,I=p?5:1,O=j.x+I,s=j.y+I,k={x:O,y:s};if(t._edge===Y&&t._hoverSegmentIndex>=0){var o=E._editInteractor._hoverSegmentIndex,y=N.get(o),x=Oh(Y,Q,o),$=r;if(x!=r&&x>=0){var v=V[x],J=E.getSegmentHoverWidth()/R;if(2===y||1===y){var _=V[x+1];$=Up(new Yq(v.x,v.y),new Yq(_.x,_.y),new Yq(k.x-J,k.y-J),new Yq(k.x+2*J,k.y+2*J)),$.$62l===C&&(a=!0)}else if(3===y){var L=V[x+1],_=V[x+2];$=dr(new Yq(v.x,v.y),new Yq(L.x,L.y),new Yq(_.x,_.y),new Yq(k.x-J,k.y-J),new Yq(k.x+2*J,k.y+2*J)),$.$62l===C&&(a=!0)}else if(4===y){var i=V[x+1],g=V[x+2];_=V[x+3],$=hc(new Yq(v.x,v.y),new Yq(i.x,i.y),new Yq(g.x,g.y),new Yq(_.x,_.y),new Yq(k.x-J,k.y-J),new Yq(k.x+2*J,k.y+2*J)),$.$62l===C&&(a=!0)}}}if(a)return!0}return r},n._47O=function(l){var W=this,J=W.gv,c=J._editInteractor;c instanceof m.XEditInteractor||vo.call(W,l)},n.rectIntersects=function(R){var M=this,l=M._data,b=M.gv,I=b.getZoom(),X=M._55O,O=b._editInteractor;if(O instanceof m.XEditInteractor&&b.isEditable(l)&&X&&X._43O){var P=X.$15l,v=!1,G=p?5:1,q=R.x+G,e=R.y+G,L={x:q,y:e};if(P&&P.length===l.getPoints().size()||(jf(M),P=X.$15l),O._shape===l&&O._hoverSegmentIndex>=0){var i=l.getSegments();i&&i.size()||(i=Wd(P));var K=b._editInteractor._hoverSegmentIndex,x=i.get(K),u=Oh(l,M,K),c=r;if(u!=r&&u>=0){var t=P[u],E=b.getSegmentHoverWidth()/I;if(2===x||1===x){var g=P[u+1];c=Up(new Yq(t.x,t.y),new Yq(g.x,g.y),new Yq(L.x-E,L.y-E),new Yq(L.x+2*E,L.y+2*E)),c.$62l===C&&(v=!0)}else if(3===x){var $=P[u+1],g=P[u+2];c=dr(new Yq(t.x,t.y),new Yq($.x,$.y),new Yq(g.x,g.y),new Yq(L.x-E,L.y-E),new Yq(L.x+2*E,L.y+2*E)),c.$62l===C&&(v=!0)}else if(4===x){var A=P[u+1],T=P[u+2];g=P[u+3],c=hc(new Yq(t.x,t.y),new Yq(A.x,A.y),new Yq(T.x,T.y),new Yq(g.x,g.y),new Yq(L.x-E,L.y-E),new Yq(L.x+2*E,L.y+2*E)),c.$62l===C&&(v=!0)}}}if(v)return!0}return r},n._48O=function(){var l=this,h=l.gv,H=h._editInteractor;H instanceof m.XEditInteractor?(D._48O.call(l),l._55O._43O&&jf(l)):Jm.call(l)},n._79o=function(){var S=this,i=S.gv,H=i.getZoom(),t=i._editInteractor,D=Wr.call(S);if(D){var $={x:D.x,y:D.y,width:D.width,height:D.height};if(t instanceof m.XEditInteractor){var N=S._55O,J=i.getEditPointSize()/H+2,n=0;N&&N._43O&&(n+=J/2,T($,n))}return $}},D._47O=function(Y){var Q=this,i=Q.gv,_=i._editInteractor;if(_ instanceof m.XEditInteractor);else{var V=Q._55O;V&&V._98o&&qc.call(Q,Y)}},D.getSelectWidth=function(){var d=this,j=d.gv,P=j._editInteractor,N=d._data;return j.isEditable(N)&&P instanceof m.XEditInteractor?0:li.call(d)},D._80o=function(r){var H=this,O=H.gv._editInteractor;if(Dl.call(H,r),O&&O._debug){r.save(),r.beginPath(),r.lineWidth=1,r.strokeStyle="green";var E=H._79o();E&&(r.rect(E.x,E.y,E.width,E.height),r.stroke()),r.restore()}},n._80o=function(X){var f=this,o=f.gv._editInteractor;if(Ud.call(f,X),o&&o._debug){X.save(),X.beginPath(),X.lineWidth=1,X.strokeStyle="green";var r=f._79o();X.rect(r.x,r.y,r.width,r.height),X.stroke(),X.restore()}},D._48O=function(){var X=this,x=X.gv,$=X._data,C=x._editInteractor,h=X._55O,P=$.p(),d=$.getRotation();if(C instanceof m.XEditInteractor){if(h._42O){var H=Vi(P,$.getWidth(),$.getHeight(),d),N=H[0],E=H[1],t=H[2],F=H[3],T=H[4],z=H[5],_=H[6],M=H[7];h.$45l=[N,T,E,z,F,_,t,M]}}else si.call(X)},a.getResizeMode=function(){return this.$25l||"normal"},a.setResizeMode=function(i){var J=this.$25l;this.$25l=i,this.fp("resizeMode",J,i)},a.getSnapAngle=function(){return this.$26l||Math.PI/36},a.setSnapAngle=function(r){var g=this.$26l;this.$26l=r,this.fp("snapAngle",g,r)},a.getSnapSpacing=function(){return this.$27l},a.setSnapSpacing=function(D){var e=this.$27l;this.$27l=D,this.fp("snapSpacing",e,D)},a.getPointSnapSpacing=function(){return this._pointSnapSpacing},a.setPointSnapSpacing=function(G){var C=this._pointSnapSpacing;this._pointSnapSpacing=G,this.fp("pointSnapSpacing",C,G)},a.setHelperEditableFunc=function(m){var q=this._helperEditableFunc;this._helperEditableFunc=m,this.fp("helperEditableFunc",q,m)},a.getHelperEditableFunc=function(){return this._helperEditableFunc},a.setLeftTopHelpers=function(T){var L=this._leftTopHelpers;this._leftTopHelpers=T,this.fp("leftTopHelpers",L,T)},a.getLeftTopHelpers=function(){return this._leftTopHelpers},a.setLeftTopHelpersAlign=function(u){var A=this._leftTopHelpersAlign;this._leftTopHelpersAlign=u,this.fp("leftTopHelpersAlign",A,u)},a.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},a.setRightTopHelpers=function(g){var e=this._rightTopHelpers;this._rightTopHelpers=g,this.fp("rightTopHelpers",e,g)},a.getRightTopHelpers=function(){return this._rightTopHelpers},a.setRightTopHelpersAlign=function(k){var l=this._rightTopHelpersAlign;this._rightTopHelpersAlign=k,this.fp("rightTopHelpersAlign",l,k)},a.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},a.setLeftBottomHelpers=function(A){var i=this._leftBottomHelpers;this._leftBottomHelpers=A,this.fp("leftBottomHelpers",i,A)},a.getLeftBottomHelpers=function(){return this._leftBottomHelpers},a.setLeftBottomHelpersAlign=function(J){var U=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=J,this.fp("leftBottomHelpersAlign",U,J)},a.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},a.setRightBottomHelpers=function(u){var n=this._rightBottomHelpers;this._rightBottomHelpers=u,this.fp("rightBottomHelpers",n,u)},a.getRightBottomHelpers=function(){return this._rightBottomHelpers},a.setRightBottomHelpersAlign=function(Y){var Q=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=Y,this.fp("rightBottomHelpersAlign",Q,Y)},a.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},a.setEdgeHelpers=function(D){var P=this._edgeHelpers;this._edgeHelpers=D,this.fp("edgeHelpers",P,D)},a.getEdgeHelpers=function(){return this._edgeHelpers},a.isHelperEditable=function(f,e){return f instanceof k&&("host"===e||"edge"===e||"elevation"===e||"tall"===e)?!1:f instanceof t&&("source"===e||"target"===e)?!1:"pointElevation"===e?this._helperEditableFunc?this._helperEditableFunc(f,e):!1:this._helperEditableFunc?this._helperEditableFunc(f,e):!0},a.getEditHelperSize=function(){return this._editHelperSize||(p?28:16)},a.setEditHelperSize=function(l){var H=this._editHelperSize;this._editHelperSize=l,this.fp("editHelperSize",H,l)},a.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},a.setEditRectBorderColor=function(F){var X=this.$28l;this.$28l=F,this.fp("editRectBorderColor",X,F)},a.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},a.setNodeBorderColor=function(P){var A=this.$29l;this.$29l=P,this.fp("nodeBorderColor",A,P)},a.getEditRectBorderStyle=function(){return this.$30l||"dashed"},a.setEditRectBorderStyle=function(q){var k=this.$30l;this.$30l=q,this.fp("editRectBorderStyle",k,q)},a.getControlPointBackground=function(){return this.$31l||"#ff0"},a.setControlPointBackground=function(e){var o=this.$31l;this.$31l=e,this.fp("controlPointBackground",o,e)},a.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},a.setControlPointBorderColor=function(A){var U=this.$32l;this.$32l=A,this.fp("controlPointBorderColor",U,A)},a.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},a.setJoinPointBackground=function(_){var E=this.$33l;this.$33l=_,this.fp("joinPointBackground",E,_)},a.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},a.setJoinPointBorderColor=function(J){var B=this.$34l;this.$34l=J,this.fp("joinPointBorderColor",B,J)},a.getDirectionLineColor=function(){return this.$35l||"#888"},a.setDirectionLineColor=function(n){var K=this.$35l;this.$35l=n,this.fp("directionLineColor",K,n)},a.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},a.setSegmentHoverColor=function(s){var x=this.$36l;this.$36l=s,this.fp("segmentHoverColor",x,s)},a.getSegmentHoverWidth=function(){return this.$22l||(p?16:8)},a.setSegmentHoverWidth=function(X){var K=this.$22l;this.$22l=X,this.fp("segmentHoverWidth",K,X)},a.getSnapPointBorderColor=function(){return this.$38l||"#f00"},a.setSnapPointBorderColor=function(n){var r=this.$38l;this.$38l=n,this.fp("snapPointBorderColor",r,n)},a.getEditRectPadding=function(){return this.$39l!=r?this.$39l:6},a.setEditRectPadding=function(h){var s=this.$39l;this.$39l=h,this.fp("editRectPading",s,h)},a.isRectEditable=function(g){var V=this,Y=V._editInteractor;return Y instanceof m.XEditInteractor?V._rectEditableFunc?V._rectEditableFunc(g):!0:no.call(V,g)},a.isPointEditable=function(E){var R=this,b=R._editInteractor;return b instanceof m.XEditInteractor?R._pointEditableFunc?R._pointEditableFunc(E):!0:Yd.call(R,E)},a.validateImpl=function(){var H=this,e=H.$14l,q=H._editInteractor;if(e){var c=H.getWidth(),s=H.getHeight();(c!==e.clientWidth||s!==e.clientHeight)&&(q&&(q._68I=1),i.setCanvas(e,c,s),H._32I=1)}xj.call(this)},a.isEditable=function(b){var I=of.call(this,b),X=this._editInteractor;if(X instanceof m.XEditInteractor&&b instanceof k){if(!b.s("2d.editable"))return!1;var R=this.getEditableFunc();I=R?R(b):!0}return I},a._42=function(U,Z){var G=this,b=G._editInteractor;Oj.call(G,U,Z),b instanceof m.XEditInteractor&&b._68I&&b._42()},a.isSnapPoint=function(){return!0};var Gh=function(V){arguments.length>0&&this.$58l(V)},Qr=Gh.prototype;Qr.$58l=function(J){this.$62l=J,this.points=new Array},Qr.$56l=function(S){this.points.push(S)},Qr.$57l=function(s){this.points=this.points.concat(s)};var Yq=function(A,N){arguments.length>0&&this.$58l(A,N)},Lp=Yq.prototype;Lp.$58l=function(t,q){this.x=t,this.y=q},Lp.add=function(I){return new Yq(this.x+I.x,this.y+I.y)},Lp.addEquals=function(E){return this.x+=E.x,this.y+=E.y,this},Lp.$55l=function(H){return new Yq(this.x*H,this.y*H)},Lp.eq=function(m){return this.x==m.x&&this.y==m.y},Lp.lt=function(a){return this.x<a.x&&this.y<a.y},Lp.lte=function(a){return this.x<=a.x&&this.y<=a.y},Lp.gt=function(g){return this.x>g.x&&this.y>g.y},Lp.gte=function(w){return this.x>=w.x&&this.y>=w.y},Lp.lerp=function(B,k){return new Yq(this.x+(B.x-this.x)*k,this.y+(B.y-this.y)*k)},Lp.distanceFrom=function(J){var z=this.x-J.x,X=this.y-J.y;return V(z*z+X*X)},Lp.min=function(C){return new Yq(v(this.x,C.x),v(this.y,C.y))},Lp.max=function(T){return new Yq(G(this.x,T.x),G(this.y,T.y))},Lp.toString=function(){return this.x+","+this.y};var id=function(){this.$58l(arguments)},Yb=id.prototype;id.TO=1e-6,id.AC=6,Yb.$58l=function(i){this.co=new Array;for(var M=i.length-1;M>=0;M--)this.co.push(i[M])},Yb.$55l=function(M){for(var p=new id,n=0;n<=this.$50l()+M.$50l();n++)p.co.push(0);for(var n=0;n<=this.$50l();n++)for(var d=0;d<=M.$50l();d++)p.co[n+d]+=this.co[n]*M.co[d];return p},Yb.$59l=function(){for(var E=this.$50l();E>=0&&B(this.co[E])<=id.TO;E--)this.co.pop()},Yb.$50l=function(){return this.co.length-1},Yb.$51l=function(){var $;switch(this.$59l(),this.$50l()){case 0:$=new Array;break;case 1:$=this.$52l();break;case 2:$=this.$53l();break;case 3:$=this.$54l();break;case 4:$=this.$63l();break;default:$=new Array}return $},Yb.$52l=function(){var g=new Array,r=this.co[1];return 0!=r&&g.push(-this.co[0]/r),g},Yb.$53l=function(){var k=new Array;if(2==this.$50l()){var c=this.co[2],I=this.co[1]/c,X=this.co[0]/c,Y=I*I-4*X;if(Y>0){var Q=V(Y);k.push(.5*(-I+Q)),k.push(.5*(-I-Q))}else 0==Y&&k.push(.5*-I)}return k},Yb.$63l=function(){var E=new Array;if(4==this.$50l()){var i=this.co[4],N=this.co[3]/i,r=this.co[2]/i,A=this.co[1]/i,k=this.co[0]/i,g=new id(1,-r,N*A-4*k,-N*N*k+4*r*k-A*A).$54l(),U=g[0],h=N*N/4-r+U;if(B(h)<=id.TO&&(h=0),h>0){var j=V(h),c=3*N*N/4-j*j-2*r,u=(4*N*r-8*A-N*N*N)/(4*j),d=c+u,Z=c-u;if(B(d)<=id.TO&&(d=0),B(Z)<=id.TO&&(Z=0),d>=0){var q=V(d);E.push(-N/4+(j+q)/2),E.push(-N/4+(j-q)/2)}if(Z>=0){var q=V(Z);E.push(-N/4+(q-j)/2),E.push(-N/4-(q+j)/2)}}else if(0>h);else{var u=U*U-4*k;if(u>=-id.TO){if(0>u&&(u=0),u=2*V(u),c=3*N*N/4-2*r,c+u>=id.TO){var $=V(c+u);E.push(-N/4+$/2),E.push(-N/4-$/2)}if(c-u>=id.TO){var $=V(c-u);E.push(-N/4+$/2),E.push(-N/4-$/2)}}}}return E},Yb.$54l=function(){var U=new Array;if(3==this.$50l()){var D=this.co[3],A=this.co[2]/D,_=this.co[1]/D,P=this.co[0]/D,R=(3*_-A*A)/3,Z=(2*A*A*A-9*_*A+27*P)/27,N=A/3,Q=Z*Z/4+R*R*R/27,z=Z/2;if(B(Q)<=id.TO&&(Q=0),Q>0){var v,$,O=V(Q);v=-z+O,$=v>=0?d(v,1/3):-d(-v,1/3),v=-z-O,v>=0?$+=d(v,1/3):$-=d(-v,1/3),U.push($-N)}else if(0>Q){var u=V(-R/3),W=J(V(-Q),-z)/3,x=g(W),f=K(W),l=V(3);U.push(2*u*x-N),U.push(-u*(x+l*f)-N),U.push(-u*(x-l*f)-N)}else{var v;v=z>=0?-d(z,1/3):d(-z,1/3),U.push(2*v-N),U.push(-v-N)}}return U};var Ph=function(p,o){arguments.length>0&&this.$58l(p,o)},Hl=Ph.prototype;Hl.$58l=function(E,K){this.x=E,this.y=K},Hl.length=function(){return V(this.x*this.x+this.y*this.y)},Hl.$60l=function(u){return this.x*u.x+this.y*u.y};var wd=function($,v,T,e){var x,h=(e.x-T.x)*($.y-T.y)-(e.y-T.y)*($.x-T.x),m=(v.x-$.x)*($.y-T.y)-(v.y-$.y)*($.x-T.x),S=(e.y-T.y)*(v.x-$.x)-(e.x-T.x)*(v.y-$.y);if(0!=S){var q=h/S,X=m/S;q>=0&&1>=q&&X>=0&&1>=X?(x=new Gh(C),x.points.push(new Yq($.x+q*(v.x-$.x),$.y+q*(v.y-$.y)))):x=new Gh(l)}else x=0==h||0==m?new Gh("C"):new Gh("P");return x},Qn=function(S,t,w,P,z){var y,H,x,n,K,U,f,g=P.min(z),r=P.max(z),V=new Gh(l);y=t.$55l(-2),x=S.add(y.add(w)),y=S.$55l(-2),H=t.$55l(2),n=y.add(H),K=new Yq(S.x,S.y),f=new Ph(P.y-z.y,z.x-P.x),U=P.x*z.y-z.x*P.y;for(var c=new id(f.$60l(x),f.$60l(n),f.$60l(K)+U).$51l(),a=0;a<c.length;a++){var A=c[a];if(A>=0&&1>=A){var $=S.lerp(t,A),o=t.lerp(w,A),G=$.lerp(o,A);P.x==z.x?g.y<=G.y&&G.y<=r.y&&(V.$62l=C,V.$56l(G)):P.y==z.y?g.x<=G.x&&G.x<=r.x&&(V.$62l=C,V.$56l(G)):G.gte(g)&&G.lte(r)&&(V.$62l=C,V.$56l(G))}}return V},dr=function(J,w,p,A,z){var Z=A.min(z),E=A.max(z),G=new Yq(E.x,Z.y),b=new Yq(Z.x,E.y),h=Qn(J,w,p,Z,G),e=Qn(J,w,p,G,E),q=Qn(J,w,p,E,b),n=Qn(J,w,p,b,Z),M=new Gh(l);return M.$57l(h.points),M.$57l(e.points),M.$57l(q.points),M.$57l(n.points),M.points.length>0&&(M.$62l=C),M},Ur=function(J,q,W,u,n,Y){var L,w,Q,h,K,z,Z,V,H,v,r=n.min(Y),_=n.max(Y),j=new Gh(l);L=J.$55l(-1),w=q.$55l(3),Q=W.$55l(-3),h=L.add(w.add(Q.add(u))),K=new Ph(h.x,h.y),L=J.$55l(3),w=q.$55l(-6),Q=W.$55l(3),h=L.add(w.add(Q)),z=new Ph(h.x,h.y),L=J.$55l(-3),w=q.$55l(3),Q=L.add(w),Z=new Ph(Q.x,Q.y),V=new Ph(J.x,J.y),v=new Ph(n.y-Y.y,Y.x-n.x),H=n.x*Y.y-Y.x*n.y;for(var X=new id(v.$60l(K),v.$60l(z),v.$60l(Z),v.$60l(V)+H).$51l(),E=0;E<X.length;E++){var d=X[E];if(d>=0&&1>=d){var b=J.lerp(q,d),O=q.lerp(W,d),g=W.lerp(u,d),a=b.lerp(O,d),B=O.lerp(g,d),F=a.lerp(B,d);n.x==Y.x?r.y<=F.y&&F.y<=_.y&&(j.$62l=C,j.$56l(F)):n.y==Y.y?r.x<=F.x&&F.x<=_.x&&(j.$62l=C,j.$56l(F)):F.gte(r)&&F.lte(_)&&(j.$62l=C,j.$56l(F))}}return j},hc=function(O,I,U,t,j,R){var X=j.min(R),N=j.max(R),J=new Yq(N.x,X.y),$=new Yq(X.x,N.y),b=Ur(O,I,U,t,X,J),H=Ur(O,I,U,t,J,N),L=Ur(O,I,U,t,N,$),K=Ur(O,I,U,t,$,X),B=new Gh(l);return B.$57l(b.points),B.$57l(H.points),B.$57l(L.points),B.$57l(K.points),B.points.length>0&&(B.$62l=C),B},Up=function(x,v,u,J){var z=u.min(J),s=u.max(J),h=new Yq(s.x,z.y),B=new Yq(z.x,s.y),_=wd(z,h,x,v),f=wd(h,s,x,v),w=wd(s,B,x,v),j=wd(B,z,x,v),c=new Gh(l);return c.$57l(_.points),c.$57l(f.points),c.$57l(w.points),c.$57l(j.points),c.points.length>0&&(c.$62l=C),c},Un=m.XEditInteractor=function(c){var N=this,Y=N._view=document.createElement("canvas");Y.className="editCanvas",Y.style.position="absolute",Un.superClass.constructor.call(N,c)};o.def(Un,m.Interactor,{ms_edit:1,setUp:function(){var P=this,L=P.gv,z=L.getView(),u=P._view;Un.superClass.setUp.call(P),L.setEditInteractor(P),L.$14l=u,L._79O?z.insertBefore(u,L._79O):z.appendChild(u);var f=P.$49l=P.$11l.bind(P);L.dm().md(f),L.sm().ms(f),L.mp(f)},tearDown:function(){var D=this,y=D.gv,M=y.getView(),k=D.$49l;Un.superClass.tearDown.call(D),y.setEditInteractor(r),y.$14l=r,M.removeChild(D._view),y.dm().umd(k),y.sm().ums(k),y.ump(k)},clear:function(){var _=this,l=_.gv;delete _._hoverSegmentIndex,delete _._edge,delete _._shape,delete l._editing,delete _.$10l,delete _.$13l,delete _.$9l,delete _._removePointIndex,delete _._lp,_.$12l="",delete _.$40l,delete _.$67l,delete _.$72l,delete _.$73l,delete _.$75l,delete _.$1l,delete _.$3l,delete _.$2l,delete _.$92l,delete _.$93l,delete _.$94l,_.clearDragging()},handle_keydown:function(Q){this.$48l!==Q.shiftKey&&(this.$48l=Q.shiftKey,this.handle_mousemove(Q,N,!0))},handle_keyup:function(h){this.$48l!==h.shiftKey&&(this.$48l=h.shiftKey,this.handle_mousemove(h,N,!0))},handle_touchstart:function(r){this.handle_mousemove(r),this.handle_mousedown(r)},handle_mousedown:function(v){Y(v);var d=this,F=d.$13l,O=d.gv,D=O.dm(),N=O.sm(),m=O.getZoom(),X=O.lp(v),k=o.isDoubleClick(v),h=o.isLeftButton(v),U=d.$7l,n=d._shape,u=d._hoverSegmentIndex,w=d._edge,j=d.$87l,$=d.$88l,M=function(){d._68I||j===d.$87l&&$===d.$88l||d.$43l()};if(7!==d.$67l&&(delete d.$87l,delete d.$88l),h&&(n||w)&&u>=0&&k&&(n&&N.contains(n)||w&&N.contains(w))){var I=bk.call(d,n||w,u,X);return d.addShapePoint(n||w,u,I),q(function(){d.handle_mousemove(v)},40),void 0}if(h&&(n||w)&&d._removePointIndex>=0&&k)return d.removeShapePoint(),d.$5l=1,q(function(){d.handle_mousemove(v)},40),void 0;if(!h||!O._editing)return M(),void 0;if(n&&F>=0){var G=n.getPoints().get(F),p=n.p(),g=Rd(p,G.x-p.x,G.y-p.y,-U+n.getRotation());y=Rd(p,X.x-p.x,X.y-p.y,-U),d.$24l={x:y.x-g.x,y:y.y-g.y},d.startDragging(v),D.beginTransaction(),d.fi({kind:"beginEditPoint",event:v,data:n,index:F}),d.$88l=F,d.$87l=n}else if(d.$10l){var E=O.sm().getSelection(),P=d.$6l,V=d.$1l={},b=d.$3l={},K=d.$16l[f[d.$10l]],r={x:P.x,y:P.y},C={x:P.x+P.width/2,y:P.y+P.height/2};d.$24l={x:X.x-K.x/m,y:X.y-K.y/m},d.$2l=s(d.$8l),d.$4l=s(P),E.each(function(z){if(z instanceof t){var a=z.p(),M=z.getWidth(),f=z.getHeight(),I=Rd(C,a.x-C.x,a.y-C.y,-U);V[z.getId()]={x:a.x-M/2,y:a.y-f/2,width:M,height:f},b[z.getId()]={x:(I.x-r.x)/P.width,y:(I.y-r.y)/P.height}}}),d.startDragging(v),D.beginTransaction(),d.fi({kind:"beginEditRect",event:v,direction:d.$10l})}else if(w&&F>=0){var z=Fr(O.getDataUI(w),w.s("edge.points")),G=z.get(F);d.$24l={x:X.x-G.x,y:X.y-G.y},d.startDragging(v),D.beginTransaction(),d.fi({kind:"beginEditPoint",event:v,data:w,index:F}),d.$88l=F,d.$87l=w}else if(d.$40l){var P=d.$6l,C={x:P.x+P.width/2,y:P.y+P.height/2},L=s(d.$23l);L.x/=m,L.y/=m;var e=Rd(C,L.x-C.x,L.y-C.y,-U),y=Rd(C,X.x-C.x,X.y-C.y,-U);d.$24l={x:y.x-e.x,y:y.y-e.y},d.startDragging(v),D.beginTransaction(),d.fi({kind:"beginEditRotation",event:v,data:d._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(d.$67l)>=0){var Z=d.$67l;(7===Z||8===Z||9===Z)&&D.beginTransaction(),d.startDragging(v)}else if(d.$71l&&k&&d.$79l(d.$71l,X)){var Q=N.toSelection();D.beginTransaction(),Q.each(function(z){D.remove(z)}),D.endTransaction()}M()},$11l:function(){var A=this,w=A.gv;w._editing&&(A.$13l==r||A._shape==r&&A._edge==r)&&(A.$73l==r||1!==A.$67l&&5!==A.$67l&&6!==A.$67l)||(A.$5l=1),A._68I=1},$46l:function(Q){var W=this,$=W.gv,s=$.lp(Q),n=[];return Uh($,function(k){var p=$.getDataUI(k);if(p){var Z=p._79o();_(Z,s)&&n.push(k)}}),n},$47l:function(d){var g=this,Y=g.$13l,j=g.gv.dm();g.$10l?(g.fi({kind:"endEditRect",event:d,direction:g.$10l}),j.endTransaction()):g._shape&&Y>=0?(g.fi({kind:"endEditPoint",event:d,data:g._shape,index:Y}),j.endTransaction()):g._edge&&Y>=0?(g.fi({kind:"endEditPoint",event:d,data:g._edge,index:Y}),j.endTransaction()):g.$23l&&g.$40l&&(g.fi({kind:"endEditRotation",event:d}),j.endTransaction())},handleWindowTouchEnd:function(G){this.handleWindowMouseUp(G)},handleWindowMouseUp:function(e){var S=this,u=S.gv,j=u.dm(),y=S._shape,s=S._edge,v=S.$13l,w=S.$40l,P=S.$9l,G=S.$10l,d=S.$67l;if((y||s)&&v>=0&&P>=0){var J,f;if(y){var D=y.p(),E=y.getRotation();J=y.getPoints(),f=J.get(P),hk(y,D,E,v,f,!1)}else if(J=Fr(u.getDataUI(s),s.s("edge.points"),!0),f=J.get(P),0===v){var m=J.get(0);s.s("edge.source.offset.x",f.x-m.x),s.s("edge.source.offset.y",f.y-m.y)}else if(v===J.size()-1){var W=J.get(J.size()-1);s.s("edge.target.offset.x",f.x-W.x),s.s("edge.target.offset.y",f.y-W.y)}else"points"===s.s("edge.type")&&(J.set(v,f),s.s("edge.points",nj(J)))}S.$47l(e);var $=S.$73l;1===d?(j.beginTransaction(),$?u.sm().each(function(U){if(U.setHost&&u.isHelperEditable(U,"host")){U.setHost($);
var z=S.$75l,x=S.$74l;z&&(U.s("attach.row.index",z.rowIndex),U.s("attach.column.index",z.columnIndex)),x&&(U.s("attach.index",x.attachIndex),U.s("attach.offset",x.attachOffset),U.s("attach.offset.relative",!1),U.s("attach.offset.opposite",!1))}}):u.sm().each(function(Y){Y.setHost&&u.isHelperEditable(Y,"host")&&(Y.setHost(r),Y.s("attach.row.index",N),Y.s("attach.column.index",N),Y.s("attach.index",N),Y.s("attach.offset",N),Y.s("attach.offset.relative",!1),Y.s("attach.offset.opposite",!1))}),j.endTransaction()):2===d?(j.beginTransaction(),$?u.sm().each(function(k){k.setParent&&u.isHelperEditable(k,"parent")&&k.setParent($)}):u.sm().each(function(S){S.setParent&&u.isHelperEditable(S,"parent")&&S.setParent(r)}),j.endTransaction()):3===d?$&&(j.beginTransaction(),u.sm().each(function(w){if(u.isHelperEditable(w,"edge")&&w instanceof t&&$ instanceof t){var E=new c.Edge;j.add(E),E.setSource(w),E.setTarget($),S.onEdgeCreated&&S.onEdgeCreated(e,E)}}),j.endTransaction()):5===d||6===d?$&&(j.beginTransaction(),u.sm().each(function(g){g instanceof k&&$ instanceof t&&(5===d&&u.isHelperEditable(g,"source")?g.setSource($):6===d&&u.isHelperEditable(g,"source")&&g.setTarget($))}),j.endTransaction()):(7===d||8===d||9===d)&&j.endTransaction(),(G||w)&&S.$43l(!0),p?(S.clear(),delete S.$64l,S._68I||S.$43l()):(S.handle_mousemove(e,!0),d&&!S._68I&&S.$43l())},handleWindowTouchMove:function(p){this.handleWindowMouseMove(p)},handleWindowMouseMove:function(a){this._78I(a)},handle_mousemove:function(x,s,L){if(!this._pause){if(!L){var k=p?Ab(x):x;this.$61l={clientX:k.clientX,clientY:k.clientY}}if(s===!0||!M()){var v=this,I=v.gv,n=!1,u=r;v.clear(),I.sm().size()>0&&(u=I.lp(L?v.$61l:x),n=v._79I(x,u)),n&&(I._editing=1),v.$12l!==v.$65l&&(v.$65l=v.$12l,v.setCursor(v.$12l)),v.$40l!==v.$64l&&(v.$64l=v.$40l,v._68I||v.$43l()),v._hoverSegmentIndex!==v.$66l&&(v.$66l=v._hoverSegmentIndex,v._68I||v.$43l())}}},_78I:function(m){this.autoScroll(m);var K=this,g=K.gv,T=g.lp(m),s=g.getZoom(),l=K.$13l;if((K._shape||K._edge)&&l>=0){var E,a,y,x=K._shape,c=K._edge,u=K.$24l,Y=g.getPointSnapSpacing(),N=function(C,y){return Y==r||isNaN(Y)?{x:C,y:y}:{x:W(C/Y)*Y,y:W(y/Y)*Y}};if(x){E=x.getPoints();var O=x.p(),L=x.getRotation(),H=0;a=Rd(O,T.x-O.x,T.y-O.y,-L),hk(x,O,L,l,T,!0,u,N),K.fi({kind:"betweenEditPoint",event:m,data:x,index:l})}else if(c){E=Fr(g.getDataUI(c),c.s("edge.points"),!0),T.x-=u.x,T.y-=u.y,a=T;var v,j,F=c.s("edge.offset"),R=E.size(),i=R>2;if(0===l){var Z=E.get(0);F&&(Z=Ce(Z,E.get(1),-F,i),T=Ce(T,E.get(1),-F,i)),v=T.x-Z.x,j=T.y-Z.y,y=N(v,j),c.s("edge.source.offset.x",y.x),c.s("edge.source.offset.y",y.y)}else if(l===R-1){var _=E.get(R-1);F&&(_=Ce(_,E.get(R-2),-F,i),T=Ce(T,E.get(R-2),-F,i)),v=T.x-_.x,j=T.y-_.y,y=N(v,j),c.s("edge.target.offset.x",y.x),c.s("edge.target.offset.y",y.y)}else"points"===c.s("edge.type")&&(y=N(T.x,T.y),y.e=E.get(l).e,E.set(l,y),c.s("edge.points",nj(E)));K.fi({kind:"betweenEditPoint",event:m,data:c,index:l})}if(delete K.$9l,g.isSnapPoint(x)||g.isSnapPoint(c))for(H=0;H<E.size();H++)if(H!==l){var n=E.get(H);if(P(n,a)<g.getEditPointSize()/s){K.$9l=H;break}}}else if(K.$10l){var u=K.$24l;T.x-=u.x,T.y-=u.y;var D=g.sm().getSelection(),z=K.$1l,M=K.$7l,G=K.$10l,C=K.$4l,U=K.$2l,Q=g.getEditRectPadding()/s,w=2*Q,d=g.getSnapSpacing(),I=d!=r&&!isNaN(d),e=xh(U,T,G,M,2*Q,g.getResizeMode(),I,!0),f=K.$6l;if(I){var b=e.width-w,p=e.height-w,h=W(b/d)*d,ip=W(p/d)*d,hr=h-b,yo=ip-p;("west"===G||"northwest"===G||"southwest"===G)&&(hr=-hr),("north"===G||"northwest"===G||"northeast"===G)&&(yo=-yo),e=xh(U,T,G,M,2*Q,g.getResizeMode(),I,!1,hr,yo)}K.$8l=e,f.x=e.x+Q,f.y=e.y+Q,f.width=e.width-w,f.height=e.height-w;var Vg=e.x+e.width/2,Nb=e.y+e.height/2,Dh=f.x,Je=f.y,hl=f.width/C.width,_l=f.height/C.height;D.each(function(U){if(U instanceof t&&g.isEditable(U)&&g.isRectEditable(U)){var Y=z[U.getId()],L=K.$3l[U.getId()],I={x:Y.x+Y.width/2,y:Y.y+Y.height/2},Z=0,r=0,C=G,X=180*B(M-U.getRotation())/A;"northeast"===G?X>=315||45>X?(Z=Y.width*hl+Y.x,r=Y.height*(1-_l)+Y.y,C="northeast"):X>=45&&135>X?(Z=Y.width*(1-_l)+Y.x,r=Y.height*(1-hl)+Y.y,C="northwest"):X>=135&&225>X?(Z=Y.width*(1-hl)+Y.x,r=Y.height*_l+Y.y,C="southwest"):(Z=Y.width*_l+Y.x,r=Y.height*hl+Y.y,C="southeast"):"north"===G?X>=315||45>X?(r=Y.height*(1-_l)+Y.y,C="north"):X>=45&&135>X?(Z=Y.width*(1-_l)+Y.x,C="west"):X>=135&&225>X?(r=Y.height*_l+Y.y,C="south"):(Z=Y.width*_l+Y.x,C="east"):"northwest"===G?X>=315||45>X?(Z=Y.width*(1-hl)+Y.x,r=Y.height*(1-_l)+Y.y,C="northwest"):X>=45&&135>X?(Z=Y.width*(1-_l)+Y.x,r=Y.height*hl+Y.y,C="southwest"):X>=135&&225>X?(Z=Y.width*hl+Y.x,r=Y.height*_l+Y.y,C="southeast"):(Z=Y.width*_l+Y.x,r=Y.height*(1-hl)+Y.y,C="northeast"):"west"===G?X>=315||45>X?(Z=Y.width*(1-hl)+Y.x,C="west"):X>=45&&135>X?(r=Y.height*hl+Y.y,C="south"):X>=135&&225>X?(Z=Y.width*hl+Y.x,C="east"):(r=Y.height*(1-hl)+Y.y,C="north"):"southwest"===G?X>=315||45>X?(Z=Y.width*(1-hl)+Y.x,r=Y.height*_l+Y.y,C="southwest"):X>=45&&135>X?(Z=Y.width*_l+Y.x,r=Y.height*hl+Y.y,C="southeast"):X>=135&&225>X?(Z=Y.width*hl+Y.x,r=Y.height*(1-_l)+Y.y,C="northeast"):(Z=Y.width*(1-_l)+Y.x,r=Y.height*(1-hl)+Y.y,C="northwest"):"east"===G?X>=315||45>X?(Z=Y.width*hl+Y.x,C="east"):X>=45&&135>X?(r=Y.height*(1-hl)+Y.y,C="north"):X>=135&&225>X?(Z=Y.width*(1-hl)+Y.x,C="west"):(r=Y.height*hl+Y.y,C="south"):"south"===G?X>=315||45>X?(r=Y.height*_l+Y.y,C="south"):X>=45&&135>X?(Z=Y.width*_l+Y.x,C="east"):X>=135&&225>X?(r=Y.height*(1-_l)+Y.y,C="north"):(Z=Y.width*(1-_l)+Y.x,C="west"):"southeast"===G&&(X>=315||45>X?(Z=Y.width*hl+Y.x,r=Y.height*_l+Y.y,C="southeast"):X>=45&&135>X?(Z=Y.width*_l+Y.x,r=Y.height*(1-hl)+Y.y,C="northeast"):X>=135&&225>X?(Z=Y.width*(1-hl)+Y.x,r=Y.height*(1-_l)+Y.y,C="northwest"):(Z=Y.width*(1-_l)+Y.x,r=Y.height*hl+Y.y,C="southwest"));var H=Rd(I,Z-I.x,r-I.y,U.getRotation());Em(U,Y,C,{x:H.x,y:H.y});var o=Dh+f.width*L.x,D=Je+f.height*L.y,Q={x:o,y:D};Q=Rd({x:Vg,y:Nb},Q.x-Vg,Q.y-Nb,M),U.p(Q.x,Q.y)}}),K.fi({kind:"betweenEditRect",event:m,direction:G})}else if(K.$23l&&K.$40l){var Fi=K.$8l,Fj=Fi.width,ti=Fi.height,O={x:Fi.x+Fj/2,y:Fi.y+ti/2},u=K.$24l,aq=K.$23l,Kp=aq.x/s-O.x,xc=aq.y/s-O.y,of=V(Kp*Kp+xc*xc),Gd=Math.asin(u.x/of),lc=g.sm().getSelection(),Tj=S+J(T.y-O.y,T.x-O.x)-Gd,uf=g.getSnapAngle(),Tj=W(Tj/uf)*uf;0>Tj&&(Tj+=X);var Eb=Tj-K.$7l,$m=[O.x,0,O.y];lc.each(function(J){if(g.isEditable(J)&&g.isRotationEditable(J)&&g.isVisible(J)){var j=Fp(J.p3(),$m),s=Yp();Ap(s,-Eb),J.setRotation(J.getRotation()+Eb),uo(j,s),J.p3($m[0]+j[0],$m[1]+j[1],$m[2]+j[2])}}),K.$7l=Tj,K.fi({kind:"betweenEditRotation",event:m})}else if([1,2,3,5,6].indexOf(K.$67l)>=0)K.$72l=m,K.$78l||(K.$78l=1,q(function(){o.isDragging()&&K.$43l(),delete K.$78l},12));else if(7===K.$67l){if(K.$87l instanceof $){var x=K.$87l,Jf=K.$88l,yb=o.clone(x.getPoints().get(Jf)),ul=T.y-yb.y;yb.e||(yb.e=0),K.$92l||(K.$92l=yb.e),yb.e=K.$92l-ul,x.setPoint(Jf,yb)}else if(K.$87l instanceof k){var c=K.$87l,Jf=K.$88l,E=Fr(g.getDataUI(c),c.s("edge.points")),yb=E.get(Jf),ul=T.y-yb.y;yb.e||(yb.e=0),K.$92l||(K.$92l=yb.e),yb.e=K.$92l-ul,E.set(Jf,yb),c.s("edge.points",nj(E))}}else if(8===K.$67l){var lc=g.sm().getSelection(),wh=K.$93l;wh||(wh=K.$93l={}),lc.each(function(j){if(j.p3){var Q=j.p3(),d=wh[j.getId()];d==r&&(d=wh[j.getId()]=Q[1]),j.p3([Q[0],d-(T.y-K.$90l.y/s),Q[2]])}})}else if(9===K.$67l){var lc=g.sm().getSelection(),Kn=K.$94l;Kn||(Kn=K.$94l={}),lc.each(function(D){if(D.s3){var e=D.s3(),b=Kn[D.getId()];b==r&&(b=Kn[D.getId()]=e[1]);var H=b-(T.y-K.$91l.y/s);0>H&&(H=.01),D.s3([e[0],H,e[2]])}})}},$79l:function(I,v){var J=this,W=J.gv,g=W.getZoom(),Q=W.getEditHelperSize(),$=I.x/g,z=I.y/g,U=Q/g,P=U/2;return _({x:$-P,y:z-P,width:U,height:U},v)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(x,i){for(var w=this,n=w.gv,A=n.getZoom(),I=n.getEditPointSize(),L=I/A,B=L/2,W=w.$46l(x),D=0;D<W.length;D++){var e,O,T=W[D],p=n.getDataUI(T);if(p&&p._55O){var m=p._55O;if(m._43O&&T instanceof k){if(e=T.s("edge.points"),e=Fr(p,e),O=T.s("edge.segments"),O&&O.size()||(O=Wd(e)),w.$42l(T,i,e._as,O,"edge"))return!0;if("points"===T.s("edge.type")&&w.$41l(T,i,e._as,O,"edge"))return}if(m._43O&&T instanceof $&&m.$15l&&m.$15l.length===T.getPoints().size()){if(e=m.$15l,O=T.getSegments(),O&&O.size()||(O=Wd(e)),w.$42l(T,i,e,O,"shape"))return!0;if(w.$41l(T,i,e,O,"shape"))return}}}if(w.$16l){var e,Q=w.$16l,C=Q[3].x-Q[7].x,G=Q[3].y-Q[7].y,d=V(C*C+G*G),S=Q[1].x-Q[5].x,E=Q[1].y-Q[5].y,J=V(S*S+E*E),f={x:i.x*A,y:i.y*A};if(w._80I(f,0,Q[0],"northwest",d,J)||w._80I(f,1,Q[1],"north",d,J)||w._80I(f,2,Q[2],"northeast",d,J)||w._80I(f,7,Q[7],"west",d,J)||w._80I(f,3,Q[3],"east",d,J)||w._80I(f,6,Q[6],"southwest",d,J)||w._80I(f,5,Q[5],"south",d,J)||w._80I(f,4,Q[4],"southeast",d,J))return!0}if(w.$23l){var a=w.$23l,U=a.x/A,o=a.y/A;if(_({x:U-B,y:o-B,width:L,height:L},i))return w.$40l=1,w.$12l=w.getHelperCursor("rotation")||"crosshair",!0}return w.$68l&&w.$79l(w.$68l,i)?(w.$67l=1,w.$12l=w.getHelperCursor("host")||"crosshair",!0):w.$69l&&w.$79l(w.$69l,i)?(w.$67l=2,w.$12l=w.getHelperCursor("parent")||"crosshair",!0):w.$70l&&w.$79l(w.$70l,i)?(w.$67l=3,w.$12l=w.getHelperCursor("edge")||"crosshair",!0):w.$71l&&w.$79l(w.$71l,i)?(w.$67l=4,w.$12l=w.getHelperCursor("remove")||"crosshair",!0):w.$82l&&w.$79l(w.$82l,i)?(w.$67l=5,w.$12l=w.getHelperCursor("source")||"crosshair",!0):w.$83l&&w.$79l(w.$83l,i)?(w.$67l=6,w.$12l=w.getHelperCursor("target")||"crosshair",!0):w._pointElevationHelperPoint&&w.$79l(w._pointElevationHelperPoint,i)?(w.$67l=7,w.$12l=w.getHelperCursor("pointElevation")||"crosshair",!0):w.$90l&&w.$79l(w.$90l,i)?(w.$67l=8,w.$12l=w.getHelperCursor("elevation")||"crosshair",!0):w.$91l&&w.$79l(w.$91l,i)?(w.$67l=9,w.$12l=w.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(f,p,c,R,N,h){var B=this,X=B.gv,o=X.getEditPointSize(),Q=o/2,G=X.sm(),K=X.isDirectionEditable;if(K&&1===G.size()){var u=G.ld();if(K=K.bind(X),u instanceof t){if(!K(u,R))return!1;if("east"===R){if(K(u,"northeast")&&K(u,"southeast")&&2*o>=h)return!1}else if("west"===R){if(K(u,"northwest")&&K(u,"southwest")&&2*o>=h)return!1}else if("north"===R){if(K(u,"northwest")&&K(u,"northeast")&&2*o>=N)return!1}else if("south"===R&&K(u,"southwest")&&K(u,"southeast")&&2*o>=N)return!1}}else{if(2*o>=N&&("north"===R||"south"===R))return!1;if(2*o>=h&&("east"===R||"west"===R))return!1}if(_({x:c.x-Q,y:c.y-Q,width:o,height:o},f)){if(B.$10l!==R){var F=180*B.$7l/A,Y="";F>=337.5||22.5>F?Y="north":F>=22.5&&67.5>F?Y="northeast":F>=67.5&&112.5>F?Y="east":F>=112.5&&157.5>F?Y="southeast":F>=157.5&&202.5>F?Y="south":F>=202.5&&247.5>F?Y="southwest":F>=247.5&&292.5>F?Y="west":F>=292.5&&337.5>F&&(Y="northwest");var D=Lg.indexOf(Y),Y=Lg[p-(1-D)+8];switch(Y){case"northwest":B.$12l="nwse-resize";break;case"northeast":B.$12l="nesw-resize";break;case"southwest":B.$12l="nesw-resize";break;case"southeast":B.$12l="nwse-resize";break;case"north":B.$12l="ns-resize";break;case"east":B.$12l="ew-resize";break;case"south":B.$12l="ns-resize";break;case"west":B.$12l="ew-resize"}B.$10l=R}return!0}return!1},$42l:function(v,H,u,F,$){var Z,e=this,W=e.gv,I=W.getEditPointSize(),L=I/W.getZoom(),j=-1,c={x:H.x,y:H.y,width:0,height:0},E=function(K){"shape"===$?e._shape=v:e._edge=v,e._removePointIndex=K},m=function(A){"shape"===$?e._shape=v:e._edge=v,e.$13l=A,e.$12l="crosshair"};for(T(c,L/2),j=u.length-1,Z=F.size()-1;Z>=0;Z--){var a=F.get(Z);if(1===a||2===a)j-=1;else if(3===a){var h=u[j-1];if(_(c,h))return m(j-1),!0;j-=2}else if(4===a){var z=u[j-1],f=u[j-2];if(_(c,z))return m(j-1),!0;if(_(c,f))return m(j-2),!0;j-=3}}for(j=u.length-1,Z=F.size()-1;Z>=0;Z--){var a=F.get(Z),o=u[j];if(_(c,o))return E(j),m(j),!0;1===a||2===a?j-=1:3===a?j-=2:4===a&&(j-=3)}return!1},$41l:function(L,e,S,k,r){var Z=this,j=Z.gv,g=-1,v=0,Y={x:e.x,y:e.y,width:0,height:0},J=function(W,c){Z._hoverSegmentIndex=c,Z._lp=e,"shape"===r?Z._shape=L:Z._edge=L};for(T(Y,j.getSegmentHoverWidth()/2/j.getZoom()),L instanceof $&&L.isClosePath()&&k.indexOf(5)<0&&(k=new U(k._as),k.add(5));v<k.size();v++){var I=k.get(v);if(1===I){var D=S[g],G=S[g+1];if(D){var c=Up(new Yq(D.x,D.y),new Yq(G.x,G.y),new Yq(Y.x,Y.y),new Yq(Y.x+Y.width,Y.y+Y.height));if(c.$62l===C&&c.points.length>0)return J(c,v),!0}g+=1}else if(2===I){var D=S[g],G=S[g+1],c=Up(new Yq(D.x,D.y),new Yq(G.x,G.y),new Yq(Y.x,Y.y),new Yq(Y.x+Y.width,Y.y+Y.height));if(c.$62l===C&&c.points.length>0)return J(c,v),!0;g+=1}else if(3===I){var D=S[g],a=S[g+1],R=S[g+2],c=dr(new Yq(D.x,D.y),new Yq(a.x,a.y),new Yq(R.x,R.y),new Yq(Y.x,Y.y),new Yq(Y.x+Y.width,Y.y+Y.height));if(c.$62l===C)return J(c,v),!0;g+=2}else if(4===I){var D=S[g],n=S[g+1],o=S[g+2],R=S[g+3],c=hc(new Yq(D.x,D.y),new Yq(n.x,n.y),new Yq(o.x,o.y),new Yq(R.x,R.y),new Yq(Y.x,Y.y),new Yq(Y.x+Y.width,Y.y+Y.height));if(c.$62l===C)return J(c,v),!0;g+=3}else if(5===I){var D=S[g],G=S[0];if(D){var c=Up(new Yq(D.x,D.y),new Yq(G.x,G.y),new Yq(Y.x,Y.y),new Yq(Y.x+Y.width,Y.y+Y.height));if(c.$62l===C&&c.points.length>0)return J(c,v),!0}}}return!1},addShapePoint:function(_,z,E){var q=this,n=q.gv,b=n.dm();if(b.beginTransaction(),0===arguments.length&&(_=q._shape||q._edge,z=q._hoverSegmentIndex,E=q._lp),_ instanceof $||_ instanceof k){var O=Oh(_,n.getDataUI(_),z);if(!isNaN(z)&&E&&!isNaN(O)){var L=E;if(_ instanceof $){var H=_.p(),T=_.getRotation(),Q=_.toSegments();Q&&Q.size()||(Q=Wd(_.getPoints())),_.isClosePath()&&Q.indexOf(5)<0&&(Q=new U(Q._as),Q.add(5));var s=Q.get(z),y="addPoint",x="removePointAt";if(2===s||1===s){var g={x:L.x,y:L.y};Q.add(s,z),g=Rd(H,g.x-H.x,g.y-H.y,-T),_[y](g,O+1)}else if(3===s){var l=_.getPoints(),G=l.get(O),c=l.get(O+2),g={x:L.x,y:L.y};g=Rd(H,g.x-H.x,g.y-H.y,-T);var V=tc(G,g),h=tc(g,c);Q.removeAt(z),Q.add(3,z),Q.add(3,z),_.setPoint(O+1,g),_[y](h,O+2),_[y](V,O+1)}else if(4===s){var l=_.getPoints(),G=l.get(O),c=l.get(O+3),g={x:L.x,y:L.y};g=Rd(H,g.x-H.x,g.y-H.y,-T);var V=Ol(G,g),h=ne(G,g),j=Ol(g,c),u=ne(g,c);Q.removeAt(z),Q.add(4,z),Q.add(4,z),_[x](O+1),_[x](O+1),_[y](g,O+1),_[y](u,O+2),_[y](j,O+2),_[y](h,O+1),_[y](V,O+1)}else if(5===s){var g={x:L.x,y:L.y};Q.add(2,z),g=Rd(H,g.x-H.x,g.y-H.y,-T),_[y](g,O+1)}_.isClosePath()&&Q.remove(5),_.setSegments(Q);var r=_.getWidth(),W=_.getHeight(),p=_.p().x-r/2,m=_.p().y-W/2;p-=H.x,m-=H.y;var P=$d(_,{x:p,y:m,width:r,height:W},T,H);_.p(P.x,P.y)}else if(_ instanceof k){if("points"!==_.s("edge.type"))return b.endTransaction(),void 0;var l=_.s("edge.points");Q=_.s("edge.segments"),l=Fr(n.getDataUI(_),l),Q&&Q.size()||(Q=Wd(l)),Q=new U(Q._as.slice(0)),l=new U(l._as.slice(0));var s=Q.get(z);if(2===s||1===s){var g={x:L.x,y:L.y};Q.add(s,z),l.add(g,O+1)}else if(3===s){var G=l.get(O),c=l.get(O+2),g={x:L.x,y:L.y},V=tc(G,g),h=tc(g,c);Q.removeAt(z),Q.add(3,z),Q.add(3,z),l.set(O+1,g),l.add(h,O+2),l.add(V,O+1)}else if(4===s){var G=l.get(O),c=l.get(O+3),g={x:L.x,y:L.y},V=Ol(G,g),h=ne(G,g),j=Ol(g,c),u=ne(g,c);Q.removeAt(z),Q.add(4,z),Q.add(4,z),l.removeAt(O+1),l.removeAt(O+1),l.add(g,O+1),l.add(u,O+2),l.add(j,O+2),l.add(h,O+1),l.add(V,O+1)}_.s("edge.points",nj(l)),_.s("edge.segments",Q)}}}b.endTransaction()},removeShapePoint:function(t,i){var T=this,D="removeAt",V=T.gv,y=V.dm();if(y.beginTransaction(),0===arguments.length&&(t=T._shape||T._edge,i=T._removePointIndex),i>=0&&(t instanceof $||t instanceof k)){var G=Qj(t,T.gv.getDataUI(t),i),X=i;if(t instanceof $){var h=t.p(),p=t.toSegments();p&&p.size()||(p=Wd(t.getPoints()));var N=p.get(G),J="removePointAt";if(1===N&&0===X)if(t.getPoints().size()>1){var M=p.get(G+1);p[D](G+1),3===M?t[J](X+1):4===M&&(t[J](X+2),t[J](X+1)),t[J](X)}else t.dm().remove(t);else 2===N||1===N?(p[D](G),t[J](X)):3===N?(p[D](G),t[J](X),t[J](X-1)):4===N&&(p[D](G),t[J](X),t[J](X-1),t[J](X-2));t.setSegments(p);var f=t.getWidth(),o=t.getHeight(),e=t.p().x-f/2,a=t.p().y-o/2;e-=h.x,a-=h.y;var S=$d(t,{x:e,y:a,width:f,height:o},t.getRotation(),h);t.p(S.x,S.y)}else if(t instanceof k){if("points"!==t.s("edge.type"))return y.endTransaction(),void 0;var l=t.s("edge.points");if(p=t.s("edge.segments"),l&&(l=Fr(T.gv.getDataUI(t),l),p&&p.size()||(p=Wd(l))),0===i||i===l.size()-1)return y.endTransaction(),void 0;p=new U(p._as.slice(0)),l=new U(l._as.slice(0));var N=p.get(G);2===N||1===N?(p[D](G),l[D](X)):3===N?(p[D](G),l[D](X),l[D](X-1)):4===N&&(p[D](G),l[D](X),l[D](X-1),l[D](X-2)),t.s("edge.segments",p),t.s("edge.points",nj(l))}}y.endTransaction()},changeShapeSegment:function(I,s,G){var O=this,p=O.gv,e=p.dm();if(e.beginTransaction(),1!==arguments.length||isNaN(I)||(G=I,I=O._shape||O._edge,s=O._hoverSegmentIndex),I instanceof $||I instanceof k){var z=Oh(I,O.gv.getDataUI(I),s);if(!isNaN(s)&&!isNaN(z))if(I instanceof $){var W=I.p(),Z=I.toSegments();Z&&Z.size()||(Z=Wd(I.getPoints()));var b=Z.get(s),P=I.toPoints();if(1===G||2===G)1===b||2===b?Z.set(s,G):3===b?(Z.set(s,G),P.removeAt(z+1)):4===b&&(Z.set(s,G),P.removeAt(z+1),P.removeAt(z+1));else if(3===G){var x=function(){var v=P.get(z),n=P.get(z+1),U=tc(v,n);Z.set(s,3),P.add(U,z+1)};2===b||1===b?x():4===b&&(P.removeAt(z+1),P.removeAt(z+1),x())}else if(4===G){var h=function(){var $=P.get(z),D=P.get(z+1),o=Ol($,D),N=ne($,D);Z.set(s,4),P.add(o,z+1),P.add(N,z+2)};2===b||1===b?h():3===b&&(P.removeAt(z+1),h())}I.setSegments(Z),I.setPoints(P);var f=I.getWidth(),B=I.getHeight(),v=I.p().x-f/2,l=I.p().y-B/2;v-=W.x,l-=W.y;var i=new $d(I,{x:v,y:l,width:f,height:B},I.getRotation(),W);I.p(i.x,i.y)}else if(I instanceof k){if("points"!==I.s("edge.type"))return e.endTransaction(),void 0;var P=I.s("edge.points");Z=I.s("edge.segments"),P&&(P=Fr(O.gv.getDataUI(I),P),Z&&Z.size()||(Z=Wd(P))),Z=new U(Z._as.slice(0)),P=new U(P._as.slice(0));var b=Z.get(s);if(1===G||2===G)1===b||2===b?Z.set(s,G):3===b?(Z.set(s,G),P.removeAt(z+1)):4===b&&(Z.set(s,G),P.removeAt(z+1),P.removeAt(z+1));else if(3===G){var x=function(){var i=P.get(z),c=P.get(z+1),W=tc(i,c);Z.set(s,3),P.add(W,z+1)};2===b||1===b?x():4===b&&(P.removeAt(z+1),P.removeAt(z+1),x())}else if(4===G){var h=function(){var H=P.get(z),k=P.get(z+1),j=Ol(H,k),h=ne(H,k);Z.set(s,4),P.add(j,z+1),P.add(h,z+2)};2===b||1===b?h():3===b&&(P.removeAt(z+1),h())}I.s("edge.points",nj(P)),I.s("edge.segments",Z)}}e.endTransaction()},getDefaultSegments:function(M){var d=this.gv,D=d.getDataUI(M);if(M instanceof k){var A=M.s("edge.points");return A=Fr(D,A),Wd(A)}if(M instanceof $){var A=M.getPoints(),C=M.getSegments();return C&&C.size()>0?C:Wd(A)}},$43l:function($){var A=this;$&&(A.$5l=1),A._68I=1,A._42()},_42:function(){var d=this;if(d._68I){delete d._68I;var q=d.gv,D=d.$5l,x=q.getZoom(),g=q.getEditPointSize(),e=g/2,C=new U,v=d._view,u=d._edge,A=d._shape,Y=v.getContext("2d"),K=q.tx(),l=q.ty(),f=r,h=q.getEditPointBackground(),H=q.getControlPointBackground(),M=q.getControlPointBorderColor(),N=q.getEditPointBorderColor(),O=q.getEditRectBorderColor(),Z=q.getDirectionLineColor(),E=q.getSegmentHoverColor(),P=q.getSnapPointBorderColor(),S=q.getJoinPointBackground(),y=q.getJoinPointBorderColor(),B=q.getSegmentHoverWidth(),_=[5,5],p=q.getEditRectBorderStyle();pn(q,function(U){q.isSelected(U)&&q.isVisible(U)&&C.add(U)}),Y.clearRect(0,0,Q(v.width),Q(v.height)),Y.save(),i.translateAndScale(Y,K,l,1);var G=r,n={x:0,y:0,width:0,height:0},z=0,a=0,m=0,b=0,J=0,W=0,Hf=0,_j=0,go=0,ve=0,Qf=[];if(D?(delete d.$6l,delete d.$8l,delete d.$7l,delete d.$16l,delete d.$23l):(G=d.$6l,f=d.$7l),delete d.$68l,delete d.$69l,delete d.$71l,delete d.$70l,delete d.$82l,delete d.$83l,delete d._pointElevationHelperPoint,delete d.$90l,delete d.$91l,delete d.$75l,delete d.$74l,C.each(function(K){var d=q.getDataUI(K);if(d){var Y=d._55O;if(q.isEditable(K))Y._56O&&K instanceof t&&a++,Qf.push(K),Y._42O&&K instanceof t&&z++,q.isHelperEditable(K,"host")&&b++,q.isHelperEditable(K,"parent")&&m++,q.isHelperEditable(K,"remove")&&J++,q.isHelperEditable(K,"edge")&&W++,q.isHelperEditable(K,"source")&&Hf++,q.isHelperEditable(K,"target")&&_j++,q.isHelperEditable(K,"elevation")&&go++,q.isHelperEditable(K,"tall")&&ve++;else if(K instanceof R&&K.isExpanded()){var j=!0,n=q.getEditableFunc();n&&(j=n(K)),j&&(q.isHelperEditable(K,"host")&&b++,q.isHelperEditable(K,"parent")&&m++,q.isHelperEditable(K,"remove")&&J++,q.isHelperEditable(K,"edge")&&W++,q.isHelperEditable(K,"source")&&Hf++,q.isHelperEditable(K,"target")&&_j++,q.isHelperEditable(K,"elevation")&&go++,q.isHelperEditable(K,"tall")&&ve++,Qf.push(K))}}}),Y.beginPath(),Y.lineWidth=1,Y.strokeStyle=q.getNodeBorderColor(),Qf.forEach(function(K){var S=q.getDataUI(K),F=S._55O;if(D)if(f==r&&(f=K instanceof k?0:K instanceof R&&K.isExpanded()?0:K.getRotation(),d.$7l=f),G==r){var C,V,J;if(K instanceof R&&K.isExpanded()||K instanceof k){var E=q.getDataUIBounds(K);V=E.width,J=E.height,C={x:E.x+V/2,y:E.y+J/2}}else C=K.p(),V=K.getWidth(),J=K.getHeight();G={x:C.x,y:C.y,width:0,height:0},n.x=C.x-V/2,n.y=C.y-J/2,n.width=V,n.height=J,G=L(G,n)}else{var C,V,J,p,M=G.x+G.width/2,m=G.y+G.height/2,B={x:M,y:m};if(K instanceof R&&K.isExpanded()||K instanceof k){p=0;var E=q.getDataUIBounds(K);V=E.width,J=E.height,C={x:E.x+V/2,y:E.y+J/2}}else C=K.p(),V=K.getWidth(),J=K.getHeight(),p=K.getRotation();var u={x:C.x-V/2,y:C.y-J/2,width:V,height:J},H={x:u.x,y:u.y},c={x:u.x+u.width,y:u.y},j={x:u.x,y:u.y+u.height},N={x:u.x+u.width,y:u.y+u.height},H=Rd(C,H.x-C.x,H.y-C.y,p),j=Rd(C,j.x-C.x,j.y-C.y,p),N=Rd(C,N.x-C.x,N.y-C.y,p),c=Rd(C,c.x-C.x,c.y-C.y,p),g=-f,U=Rd(B,H.x-B.x,H.y-B.y,g),b=Rd(B,c.x-B.x,c.y-B.y,g),h=Rd(B,j.x-B.x,j.y-B.y,g),s=Rd(B,N.x-B.x,N.y-B.y,g),e=w([U,b,h,s]);G=L(G,e),G.x-=M,G.y-=m;var P=$d(r,G,f,B);G.x=P.x-G.width/2,G.y=P.y-G.height/2}if(z>1&&q.isEditable(K)&&q.isRectEditable(K)&&K instanceof t){var a=K.getRect(),i=F.$45l,I=sc(i[0],x),Q=sc(i[2],x),W=sc(i[4],x),y=sc(i[6],x);K.getRotation()?(Y.moveTo(I.x,I.y),Y.lineTo(Q.x,Q.y),Y.lineTo(W.x,W.y),Y.lineTo(y.x,y.y),Y.lineTo(I.x,I.y)):Y.rect(a.x*x,a.y*x,a.width*x,a.height*x)}}),Y.stroke(),G){d.$6l=s(G),T(G,q.getEditRectPadding()/x);var Rr={x:G.x+G.width/2,y:G.y+G.height/2},he=Vi(Rr,G.width,G.height,f),Vg=he[0],ej=he[1],Nn=he[2],Sc=he[3],pj=he[4],qb=he[5],Xk=he[6],Nq=he[7];if(Vg=sc(he[0],x),ej=sc(he[1],x),Nn=sc(he[2],x),Sc=sc(he[3],x),pj=sc(he[4],x),qb=sc(he[5],x),Xk=sc(he[6],x),Nq=sc(he[7],x),d.$8l=G,z>0&&(d.$16l=[Vg,pj,ej,qb,Sc,Xk,Nn,Nq],Y.beginPath(),Y.lineWidth=1,Y.strokeStyle=O,"dashed"===p&&Y.setLineDash&&Y.setLineDash(_),Y.moveTo(Vg.x,Vg.y),Y.lineTo(ej.x,ej.y),Y.lineTo(Sc.x,Sc.y),Y.lineTo(Nn.x,Nn.y),Y.lineTo(Vg.x,Vg.y),Y.stroke(),"dashed"===p&&Y.setLineDash&&Y.setLineDash([])),Y.beginPath(),Y.lineWidth=1,Y.fillStyle=h,Y.strokeStyle=N,z>0){var tn=qb.x-Nq.x,Wo=qb.y-Nq.y,Kf=V(tn*tn+Wo*Wo),Ch=pj.x-Xk.x,Th=pj.y-Xk.y,Wb=V(Ch*Ch+Th*Th),Bc=2*g;if(q.isDirectionEditable&&1===Qf.length){var Dl=Qf[0],gd=q.getDataUI(Dl),Yq=gd._55O,ah=q.isDirectionEditable.bind(q);if(Yq._42O){var Io,ye,fn,pg;ah(Dl,"northwest")&&(Io=!0,Y.rect(Vg.x-e,Vg.y-e,g,g)),ah(Dl,"northeast")&&(ye=!0,Y.rect(ej.x-e,ej.y-e,g,g)),ah(Dl,"southwest")&&(fn=!0,Y.rect(Nn.x-e,Nn.y-e,g,g)),ah(Dl,"southeast")&&(pg=!0,Y.rect(Sc.x-e,Sc.y-e,g,g)),ah(Dl,"north")&&(Io&&ye?Kf>Bc&&Y.rect(pj.x-e,pj.y-e,g,g):Y.rect(pj.x-e,pj.y-e,g,g)),ah(Dl,"south")&&(pg&&fn?Kf>Bc&&Y.rect(Xk.x-e,Xk.y-e,g,g):Y.rect(Xk.x-e,Xk.y-e,g,g)),ah(Dl,"west")&&(fn&&Io?Wb>Bc&&Y.rect(Nq.x-e,Nq.y-e,g,g):Y.rect(Nq.x-e,Nq.y-e,g,g)),ah(Dl,"east")&&(pg&&ye?Wb>Bc&&Y.rect(qb.x-e,qb.y-e,g,g):Y.rect(qb.x-e,qb.y-e,g,g))}}else Kf>Bc&&(Y.rect(pj.x-e,pj.y-e,g,g),Y.rect(Xk.x-e,Xk.y-e,g,g)),Wb>Bc&&(Y.rect(qb.x-e,qb.y-e,g,g),Y.rect(Nq.x-e,Nq.y-e,g,g)),Y.rect(Vg.x-e,Vg.y-e,g,g),Y.rect(ej.x-e,ej.y-e,g,g),Y.rect(Nn.x-e,Nn.y-e,g,g),Y.rect(Sc.x-e,Sc.y-e,g,g)}if(a>0){var $p=d.$23l=Rd(pj,0,2*-g,f);Y.moveTo($p.x+e,$p.y),Y.arc($p.x,$p.y,e,0,X,!1)}Y.fill(),Y.stroke(),d.$40l&&d.$44l(Y,G,f);var wn,ge,yi=q.getLeftTopHelpers(),ug=q.getRightTopHelpers(),Xg=q.getLeftBottomHelpers(),ap=q.getRightBottomHelpers(),sg=q.getEdgeHelpers(),si=q.getEditHelperSize(),Xp=si/2,Oc=function(o,c,v,P){"leftTop"===c?(wn=G.x*x-si-e-("h"===P?v*(si+e):0)-1,ge=G.y*x-si-e-("v"===P?v*(si+e):0)-1):"rightTop"===c?(wn=(G.x+G.width)*x+e+("h"===P?v*(si+e):0)+1,ge=G.y*x-si-e-("v"===P?v*(si+e):0)-1):"leftBottom"===c?(wn=G.x*x-si-e-("h"===P?v*(si+e):0)-1,ge=(G.y+G.height)*x+e+("v"===P?v*(si+e):0)+1):"rightBottom"===c&&(wn=(G.x+G.width)*x+e+("h"===P?v*(si+e):0)+1,ge=(G.y+G.height)*x+e+("v"===P?v*(si+e):0)+1);var Q=wn+Xp,w=ge+Xp,V=(G.x+G.width/2)*x,H=(G.y+G.height/2)*x,g=Rd({x:V,y:H},Q-V,w-H,f);if("host"===o){if(b>0)return d.$77l(Y,f,g),!0}else if("edge"===o){if(W>0)return d.$80l(Y,f,g),!0}else if("remove"===o){if(J>0)return Qf&&1===Qf.length&&Qf[0]instanceof k?d.$81l(Y,f,{x:V+si/2+5,y:H}):d.$81l(Y,f,g),!0}else if("parent"===o){if(m>0)return Qf&&1===Qf.length&&Qf[0]instanceof k?d.$76l(Y,f,{x:V-si/2-5,y:H}):d.$76l(Y,f,g),!0}else if("elevation"===o){if(go>0)return d.$85l(Y,f,g),!0}else if("tall"===o){if(ve>0)return d.$86l(Y,f,g),!0}else if("source"===o||"target"===o){var r=Qf[0],i=q.getDataUI(r),t=yn(i,!0),B=t[0],y=t[1];if(Hf&&"source"===o)return d.$84l(Y,G,B,!0,r.isLooped(),c,v,P),!0;if(_j&&"target"===o)return d.$84l(Y,G,y,!1,r.isLooped(),c,v,P),!0}};if(yi&&yi.length>0){var bd=0;yi.forEach(function(K){Oc(K,"leftTop",bd,q.getLeftTopHelpersAlign()||"h")&&bd++})}if(ug&&ug.length>0){var bd=0;ug.forEach(function(z){Oc(z,"rightTop",bd,q.getRightTopHelpersAlign()||"h")&&bd++})}if(Xg&&Xg.length>0){var bd=0;Xg.forEach(function(B){Oc(B,"leftBottom",bd,q.getLeftBottomHelpersAlign()||"h")&&bd++})}if(ap&&ap.length>0){var bd=0;ap.forEach(function(t){Oc(t,"rightBottom",bd,q.getRightBottomHelpersAlign()||"h")&&bd++})}if(sg&&sg.length>0&&((Hf||_j)&&Qf&&1===Qf.length&&Qf[0]instanceof k?!0:!1)){var bd=0;sg.forEach(function(e){Oc(e,"edge",bd,"h")&&bd++})}if(d.$72l){var Wp,xf=d.$67l,jb=d.$68l,_r=d.$69l,hj=(d.$71l,d.$70l),an=d.$82l,co=d.$83l;if(1===xf?Wp=jb:2===xf?Wp=_r:3===xf?Wp=hj:5===xf?Wp=an:6===xf&&(Wp=co),Wp){var kr=q.lp(d.$72l),fj=q.getDataAt(d.$72l);if(fj&&fj instanceof t){var tr,Jq,kh;if(d.$73l=fj,1===xf)if(fj instanceof c.Grid)tr=d.$75l=Le(fj,kr);else if(fj instanceof c.Shape){kh=d.$74l=ac(fj,kr);var Gm=fj.getPoints();if(kh){var nc=kh.attachIndex,pc=Oh(fj,q.getDataUI(fj),nc)+1,kg=pc+1>=Gm.size()?0:pc+1,We=Gm.get(pc),ub=Gm.get(kg),Hj=fj.p(),ai=fj.getRotation();We=Rd(Hj,We.x-Hj.x,We.y-Hj.y,ai),ub=Rd(Hj,ub.x-Hj.x,ub.y-Hj.y,ai),Y.beginPath(),Y.strokeStyle=E,Y.lineWidth=B,Y.moveTo(We.x*x,We.y*x),Y.lineTo(ub.x*x,ub.y*x),Y.stroke()}}tr?Jq=tr.rect:(Jq=o.clone(q.getDataUIBounds(fj)),o.grow(Jq,2)),Y.beginPath(),Y.rect(Jq.x*x,Jq.y*x,Jq.width*x,Jq.height*x),Y.strokeStyle=1===xf||4===xf||6===xf?F:j,Y.lineWidth=2,Y.setLineDash&&Y.setLineDash([8,8]),Y.stroke()}else delete d.$73l;kr.x=kr.x*x,kr.y=kr.y*x;var _e=ol(Wp.x,Wp.y,kr.x,kr.y),$q=Rd(Wp,kr.x-Wp.x,kr.y-Wp.y,-_e),Ih=$q.x-Wp.x;Y.save(),Y.translate(Wp.x,Wp.y),Y.rotate(_e),I.width=Ih,I.height=40;var hf=j;(1===xf||4===xf||6===xf)&&(hf=F),I.comps[0].gradientColor=hf,o.drawImage(Y,I,0,-20,Ih,40),Y.restore()}}}if(C.each(function(K){var O=q.getDataUI(K);if(O){var f,p,v=O._55O,Q=O._78o;if(v&&v._43O&&K instanceof $?(f=v.$15l,p=K.getSegments(),p&&p.size()||(p=Wd(f)),K.isClosePath()&&p.indexOf(5)<0&&(p=new U(p._as),p.add(5))):v&&Q&&v._43O&&(f=K.s("edge.points"),p=K.s("edge.segments"),f=Fr(O,f),p&&p.size()||(p=Wd(f)),f&&(f=f._as)),f&&p){var W=0,b=p.size(),k=d._hoverSegmentIndex;f=f.slice(0);for(var G=0;G<f.length;G++)f[G]=sc(f[G],x);Y.beginPath(),Y.strokeStyle=Z,Y.lineWidth=1,W=0;for(var G=0;b>G;G++){var j=p.get(G);if(1===j||2===j)W++;else if(3===j){var N=f[W-1],D=f[W],V=f[W+1];Y.moveTo(N.x,N.y),Y.lineTo(D.x,D.y),Y.lineTo(V.x,V.y),W+=2}else if(4===j){var N=f[W-1],h=f[W],T=f[W+1],V=f[W+2];Y.moveTo(N.x,N.y),Y.lineTo(h.x,h.y),Y.moveTo(T.x,T.y),Y.lineTo(V.x,V.y),W+=3}}if(Y.stroke(),A===K||u===K&&"points"===u.s("edge.type")){Y.beginPath(),W=0,Y.strokeStyle=E,Y.lineWidth=B;for(var G=0;b>G;G++){var j=p.get(G);if(1===j||2===j){if(k===G){var N=f[W-1],V=f[W];Y.moveTo(N.x,N.y),Y.lineTo(V.x,V.y);break}W++}else if(3===j){if(k===G){var N=f[W-1],D=f[W],V=f[W+1];Y.moveTo(N.x,N.y),Y.quadraticCurveTo(D.x,D.y,V.x,V.y);break}W+=2}else if(4===j){if(k===G){var N=f[W-1],h=f[W],T=f[W+1],V=f[W+2];Y.moveTo(N.x,N.y),Y.bezierCurveTo(h.x,h.y,T.x,T.y,V.x,V.y);break}W+=3}else if(5===j&&k===G){var N=f[W-1],V=f[0];Y.moveTo(N.x,N.y),Y.lineTo(V.x,V.y);break}}Y.stroke()}Y.beginPath(),W=0,Y.strokeStyle=y,Y.lineWidth=1,Y.fillStyle=S;for(var G=0;b>G;G++){var j=p.get(G);if(1===j||2===j){var V=f[W];Y.moveTo(V.x+e,V.y),Y.arc(V.x,V.y,e,0,X,!0),W++}else if(3===j){var V=f[W+1];Y.moveTo(V.x+e,V.y),Y.arc(V.x,V.y,e,0,X,!0),W+=2}else if(4===j){var V=f[W+2];Y.moveTo(V.x+e,V.y),Y.arc(V.x,V.y,e,0,X,!0),W+=3}}Y.fill(),Y.stroke(),Y.beginPath(),W=0,Y.strokeStyle=M,Y.lineWidth=1,Y.fillStyle=H;for(var G=0;b>G;G++){var j=p.get(G);if(1===j||2===j)W++;else if(3===j){var D=f[W];Y.moveTo(D.x+e,D.y),Y.arc(D.x,D.y,e,0,X,!0),W+=2}else if(4===j){var h=f[W],T=f[W+1];Y.moveTo(h.x+e,h.y),Y.arc(h.x,h.y,e,0,X,!0),Y.moveTo(T.x+e,T.y),Y.arc(T.x,T.y,e,0,X,!0),W+=3}}if(Y.fill(),Y.stroke(),Y.beginPath(),W=0,Y.strokeStyle=P,Y.lineWidth=2,(A===K||u===K)&&d.$9l!=r){var V=f[d.$9l];Y.moveTo(V.x+e,V.y),Y.arc(V.x,V.y,e,0,X,!0),Y.stroke()}}}}),d.$87l&&q.sm().contains(d.$87l)){var hq,yd=d.$87l,tq=d.$88l,si=q.getEditHelperSize(),Xp=si/2;if(q.isHelperEditable(yd,"pointElevation"))if(yd instanceof $){var Tl=yd.getPosition();hq=o.clone(yd.getPoints().get(tq)),hq=Rd({x:Tl.x,y:Tl.y},hq.x-Tl.x,hq.y-Tl.y,yd.getRotation()),hq.x*=x,hq.y*=x,Y.translate(hq.x,hq.y),o.drawImage(Y,o.getImage("xeditinteractor_elevationIcon"),Xp,-Xp,si,si),Y.translate(-hq.x,-hq.y),d._pointElevationHelperPoint={x:hq.x+si,y:hq.y}}else if(yd instanceof k){var _l=Fr(q.getDataUI(yd),yd.s("edge.points")),hq=o.clone(_l.get(tq));hq.x*=x,hq.y*=x,Y.translate(hq.x,hq.y),o.drawImage(Y,o.getImage("xeditinteractor_elevationIcon"),Xp,-Xp,si,si),Y.translate(-hq.x,-hq.y),d._pointElevationHelperPoint={x:hq.x+si,y:hq.y}}}Y.restore(),d.$5l=0}},$89l:function(Z,c,x,D){Z.save();var k=this,T=k.gv,m=T.getEditHelperSize(),h=m/2;Z.beginPath(),Z.translate(x.x,x.y),Z.rotate(c),o.drawImage(Z,D,-h,-h,m,m),Z.restore()},$85l:function(D,E,K){var w=this;w.$90l=K,w.$89l(D,E,K,o.getImage("xeditinteractor_elevationIcon"))},$86l:function(F,$,Q){var i=this;i.$91l=Q,i.$89l(F,$,Q,o.getImage("xeditinteractor_tallIcon"))},$77l:function(R,V,k){var D=this;D.$68l=k,D.$89l(R,V,k,o.getImage("xeditinteractor_hostIcon"))},$80l:function(J,i,l){var m=this;m.$70l=l,m.$89l(J,i,l,o.getImage("xeditinteractor_edgeIcon"))},$81l:function(I,b,r){var a=this;a.$71l=r,a.$89l(I,b,r,o.getImage("xeditinteractor_removeIcon"))},$76l:function(q,j,M){var p=this;p.$69l=M,p.$89l(q,j,M,o.getImage("xeditinteractor_parentIcon"))},$84l:function(a,u,p,O,v){var d,r=this,J=r.gv,f=J.getZoom(),e=J.getEditHelperSize(),L=e/2;p.x*=f,p.y*=f,v&&(O?p.x-=L+5:p.x+=L+5),p.y-=e-2,O?(r.$82l=p,d=o.getImage("xeditinteractor_sourceIcon")):(r.$83l=p,d=o.getImage("xeditinteractor_targetIcon")),a.beginPath(),a.translate(p.x,p.y),o.drawImage(a,d,-L,-L,e,e),a.translate(-p.x,-p.y)},$44l:function(C,O,i){C.save();var b=this.gv.getZoom(),F=V(d(O.width,2)+d(O.height,2))/2*b+10,k=F,s=k+8,B=k+18,U=i,n=O.x+O.width/2,R=O.y+O.height/2;C.translate(n*b,R*b),C.beginPath(),C.strokeStyle="rgb(150, 150, 150)";for(var I=0,Q=0,Z=0,o=0,m=0,l=0;360>l;l++)I=l*A/180,0===l%5&&(Q=g(I)*k,Z=K(I)*k,o=g(I)*s,m=K(I)*s,C.moveTo(Q,Z),C.lineTo(o,m)),0===l%45&&(Q=g(I)*k,Z=K(I)*k,o=g(I)*B,m=K(I)*B,C.moveTo(Q,Z),C.lineTo(o,m));C.stroke(),C.beginPath(),C.rotate(-S),C.beginPath(),C.fillStyle="rgba(255, 0, 0, 0.1)",C.strokeStyle="rgb(157, 157, 157)",C.moveTo(0,0),C.arc(0,0,B,0,i,!1),C.fill(),C.beginPath(),C.moveTo(0+B,0),C.arc(0,0,B,0,i,!1),C.stroke(),C.rotate(S),C.font="bold 12px Verdana, Arial";var v=20*K(U),q=20*g(U),M=W(180*U/A)+"°";C.textAlign="center",C.textBaseline="middle",C.beginPath();var P=C.measureText("365.°").width;C.fillStyle="white",C.rect(v-P/2,-q-10,P,20),C.fill(),C.beginPath(),C.fillStyle="rgb(79,79,79)",C.fillText(M,v,-q),C.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);