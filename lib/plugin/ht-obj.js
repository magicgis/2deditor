!function($,f,M){"use strict";var c="ht",r=$[c],W=null,e=Math,t=e.abs,N=e.max,g=Number.MAX_VALUE,E=r.Default,A=E.getInternal(),s=E.clone,J=A.vec3TransformMat4,p=A.appendArray,V=function(){var S=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,B=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,e=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,y=function(j,s){return s=parseInt(s),s>=0?j[s-1]:j[s+j.length]},a=function(e,B,D,Y,r,H){if(e.vs){var a=y(B,Y),w=y(B,r),Z=y(B,H),x=D.matrix,E=e.vs;if(D.flipFace){var d=w;w=Z,Z=d}x?(p(E,J(s(a),x)),p(E,J(s(w),x)),p(E,J(s(Z),x))):(p(E,a),p(E,w),p(E,Z))}},i=function(j,U,Z,X,I,g){if(j.vs){var G=y(U,X),r=y(U,I),Q=y(U,g),x=Z.flipY;if(Z.flipFace){var e=r;r=Q,Q=e}j.uv.push(G[0],x?1-G[1]:G[1],r[0],x?1-r[1]:r[1],Q[0],x?1-Q[1]:Q[1])}},D=function(M,j,X,D,v,Y){if(M.vs){var r=y(j,D),O=y(j,v),W=y(j,Y),a=X.normalMatrix,x=M.ns;if(X.flipFace){var T=O;O=W,W=T}a?(p(x,J(s(r),a)),p(x,J(s(O),a)),p(x,J(s(W),a))):(p(x,r),p(x,O),p(x,W))}},T=function(G,p,Y,v,w,V,O,T){var W=v&&v.length&&T;V[3]===M?(a(G,p,w,V[0],V[1],V[2]),O&&i(G,Y,w,O[0],O[1],O[2]),W&&D(G,v,w,T[0],T[1],T[2])):(a(G,p,w,V[0],V[1],V[3]),a(G,p,w,V[1],V[2],V[3]),O&&(i(G,Y,w,O[0],O[1],O[3]),i(G,Y,w,O[1],O[2],O[3])),W&&(D(G,v,w,T[0],T[1],T[3]),D(G,v,w,T[1],T[2],T[3])))},R=function(w,y,R,W){var f,u,v,e,F,U,P,l=g,z=g,K=g,M=-g,c=-g,H=-g;for(f in w)for(U=w[f].vs,P=U.length,u=0;P>u;u+=3)v=U[u+0],e=U[u+1],F=U[u+2],l>v&&(l=v),z>e&&(z=e),K>F&&(K=F),v>M&&(M=v),e>c&&(c=e),F>H&&(H=F);if(R){var p=l+(M-l)/2,T=z+(c-z)/2,i=K+(H-K)/2;for(f in w)for(U=w[f].vs,P=U.length,u=0;P>u;u+=3)U[u+0]-=p,U[u+1]-=T,U[u+2]-=i}var $,j,s;R?($=M-l,j=c-z,s=H-K):($=2*N(t(l),t(M)),j=2*N(t(z),t(c)),s=2*N(t(K),t(H))),W.rawS3=[$,j,s];for(f in w){if(U=w[f].vs,y)for(P=U.length,u=0;P>u;u+=3)$&&(U[u+0]/=$),j&&(U[u+1]/=j),s&&(U[u+2]/=s);w[f].rawS3=W.rawS3}};return function(n,C,M){if(!n)return W;(A.isString(C)||C instanceof ArrayBuffer)&&(C=q(C)),M||(M={}),M.flipY==W&&(M.flipY=!0),(M.s3||M.r3||M.t3||M.mat)&&(M.matrix=A.createWorldMatrix(M.mat,M.s3,M.r3,M.rotationMode,M.t3));var d,H,g,G,D,L,i=[],Q=[],K=M.ignoreNormal?W:[],p=M.reverseFlipMtls,l={vs:[],uv:[],ns:K?[]:W},f={htdefault:l},k=new b(n);for(K&&M.matrix&&(M.normalMatrix=A.createNormalMatrix(M.matrix));null!=(H=k.stepNext());)if(H=H.trim(),0!==H.length&&"#"!==H.charAt(0))if(H.indexOf("#QNAN0")>=0&&(H=H.replace(/#QNAN0/gi,"0")),g=S.exec(H))i.push([parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3])]);else if(g=B.exec(H))Q.push([parseFloat(g[1]),parseFloat(g[2])]);else if(K&&(g=e.exec(H)))M.flipFace?K.push([parseFloat(-g[1]),parseFloat(-g[2]),parseFloat(-g[3])]):K.push([parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3])]);else if("f"===H[0]){var Y=H.split(/\s+/);if(Y.length<4)continue;var o,d,U,j=[],z=[],N=[];for(d=1,U=Y.length;U>d;d++)o=Y[d].split("/"),j.push(parseInt(o[0],10)),o.length>1&&o[1].length>0&&N.push(parseInt(o[1],10)),o.length>2&&o[2].length>0&&z.push(parseInt(o[2],10));for(d=0,U=j.length-2;U>d;d++)T(l,i,Q,K,M,[j[0],j[d+1],j[d+2]],N.length?[N[0],N[d+1],N[d+2]]:W,z.length?[z[0],z[d+1],z[d+2]]:W)}else if(/^usemtl /.test(H)&&(G=H.substring(7).trim(),!(l=f[G]))){if(l={name:G,vs:[],uv:[],ns:K?[]:W},M.ignoreMtls&&M.ignoreMtls.indexOf(G)>=0&&delete l.vs,(M.reverseFlip||"*"===p||p&&p.indexOf(G)>=0)&&(l.reverseFlip=!0),C&&(D=C[G],D&&(M.ignoreColor||(l.color=D.kd),!M.ignoreTransparent&&D.d>0&&D.d<1&&(l.transparent=!0,l.opacity=D.d),!M.ignoreImage&&(L=D.map_kd)))){L=L.split(" ");var v=-1;for(d=0;d<L.length;d++)"-o"===L[d]?(l.uvOffset=[parseFloat(L[d+1]),parseFloat(L[d+2])],d+=3,v=d):"-s"===L[d]&&(l.uvScale=[parseFloat(L[d+1]),parseFloat(L[d+2])],d+=3,v=d);l.image=(M.prefix||"")+L.splice(v+1).join(" ")}f[G]=l}var x=[];for(var m in f){var c=f[m].vs;c&&0!==c.length||x.push(m)}x.forEach(function(E){delete f[E]}),R(f,M.cube,M.center,M);var I=M.shape3d;if(I){var J=[];for(var G in f){var l=f[G];J.rawS3=l.rawS3,J.push(l)}E.setShape3dModel(I,J)}return f}}(),q=function(V){var T={};if(V)for(var G,Y,P,O,K,j,I=new b(V),H=/\s+/;null!=(Y=I.stepNext());)Y=Y.trim(),0!==Y.length&&"#"!==Y.charAt(0)&&(P=Y.indexOf(" "),O=(P?Y.substring(0,P):Y).toLowerCase(),K=(P?Y.substring(P+1):"").trim(),"newmtl"===O?T[K]=G={name:K}:G&&("ka"===O||"kd"===O||"ks"===O?(j=K.split(H,3),G[O]=[parseFloat(j[0]),parseFloat(j[1]),parseFloat(j[2]),1]):G[O]="ns"===O||"d"===O?parseFloat(K):K));return T},b=function(A){var l=this;if(A instanceof ArrayBuffer){l.isBuffer=!0;var I=0,F=new Uint8Array(A),a=F.length,G=F.length;l.stepNext=function(){for(var Y,c,y=I;a>I;)if(Y=F[I],c=Y>>4,12===c||13==c)I+=2;else if(14===c)I+=3;else if(I++,10===Y)return String.fromCharCode.apply(null,F.subarray(y,I));return I>y?String.fromCharCode.apply(null,F.subarray(y,I)):null}}else{l.isBuffer=!1;var x=A.split("\n"),Z=0,G=x.length;l.stepNext=function(){return G>Z?x[Z++]:null}}};b.prototype={},b.prototype.constructor=b,A.addMethod(E,{loadObj:function(v,n,m){m=m||{};var r=!1;/(MSIE |Trident\/|Edge\/)/.test($.navigator.userAgent)&&(r=!0);var Q=function(I){var H,j=m.finishFunc,W=m.shape3d,L=I?V(I[0],I[1],m):null;if(L){if(W)H=E.getShape3dModel(W);else{H=[];for(var g in L){var t=L[g];H.rawS3=t.rawS3,H.push(t)}}j&&j(L,H,H.rawS3)}else j&&j(null)};if(r){var N=function(n){m.responseType="arraybuffer",E.xhrLoad(v,function(L){Q([L,n])},m)};n?E.xhrLoad(n,function(o){N(o)},m):N()}else E.xhrLoad(n?[v,n]:[v],Q,m)},parseObj:function(N,r,Z){return V(N,r,Z)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);