!function(D){"use strict";var O="ht",L=D[O],k=function(){return document},w=function(){return k().body},v=function(y,r,z){y.style.setProperty(r,z,null)},t=function(u){return k().createElement(u)},q=function(){return t("div")},E=function(){var m=t("canvas");return m},F=function(K,m){v(K,"-webkit-transform",m),v(K,"-ms-transform",m),v(K,"transform",m)},f=function(d,j){v(d,"-webkit-transform-origin",j),v(d,"-ms-transform-origin",j),v(d,"transform-origin",j)},R=function(U,f){U.appendChild(f)},N=function(g,G){g.removeChild(G)},M=D.parseInt,z=L.Default,m=z.eventListenerOptionsFalse,y=(z.eventListenerOptionsTrue,function(C,r,P,v){C.addEventListener(r,P,v?m:m)}),$=z.getInternal(),n=Math.PI,i="white-space",s="visibility",e="left",K="top",Y="width",J="height",j="position",V="display",h="z-index",_="px",x="0 0",Q="absolute",T="visible",c="hidden",g="none",u="block",r="nowrap",P="rgba(0, 0, 0, 0.005)";z.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var B=L.graph.GraphView.prototype,U=B._42;B.adjustHtmlNodeIndex=!0,B._42=function(I,A){if(U.call(this,I,A),this.adjustHtmlNodeIndex)for(var X=this.getDataModel()._datas._as,K=X.length,w=1,Y=0;K>Y;Y++){var t=X[Y];if(t instanceof W){var O=this.getDataUI(t);v(O.$2f,h,w+""),v(O.$3f,h,w+1+""),w+=2}}};var X=L.HtmlNodeUI=function(M,G){var I=this;X.superClass.constructor.call(I,M,G);var a=I.$2f=q(),W=I.$3f=E();v(a,j,Q),v(a,s,c),v(a,i,r),W.draggable=!1,v(W,j,Q),v(W,V,g),f(W,x),y(a,"change",function(Y){var v=Y.target,f=v.bind||v.getAttribute("bind"),e=v.type&&"checkbox"===v.type?v.checked:v.value,m=G.getContext();f&&m&&(m[f]=e,I.$4f=JSON.stringify(m))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(A){y(a,A,this.$9f.bind(this))},I)};z.def(X,$.ui().NodeUI,{_visible:!0,$11f:function(){var i=this,f=i.$3f,P=i._data,G=P.getDraggerImageWidth(),Y=P.getDraggerImageHeight(),R=P.getDraggerImage(),T=$.initContext(f);T.beginPath(),$.setCanvas(f,G,Y),$.translateAndScale(T,0,0,1),T.clearRect(0,0,G,Y),z.drawImage(T,z.getImage(R),0,0,G,Y),T.restore()},_80o:function(A){X.superClass._80o.call(this,A);var O=this,t=O._data,B=t._padding,a=2*B,w=O.$2f,E=O.$3f,Z=O.gv,l=Z.getZoom(),p=Z.getTranslateX(),d=Z.getTranslateY(),N=Z.getView(),m=O._83o,f=t._width,G=t._height,o=m.position,y=m.rotation,U=(f-a)/t.$5f*l,C=(G-a)/t.$6f*l,W=O._html,k=t._html,r=t.getHtmlType();if("html"===r){var $=t.getContext()||{},H=O.$4f,L=t.$10f,D=JSON.stringify($);W&&H&&W===k&&H===D||(O.$4f=D,O._html=k,w.innerHTML=L?L($):k)}else if(null!=r){var I=t.getHtml();"ht"===r&&(I=I.getView()),W&&W===I&&w.contains(W)||(O._html=I,w.innerHTML="",R(w,I))}if(!w.parentNode){var i=Z.$1f;if(!i){var z=q();v(z,j,Q),v(z,h,"0"),i=Z.$1f=z;var x=Z._canvas.nextSibling;x?N.insertBefore(z,x):R(N,z)}R(i,w),R(i,E),t.onContentInitialized&&t.onContentInitialized(w)}if(t._scalable){var b=t.$5f,S=t.$6f;F(w,"rotate("+180*(y/n)+"deg) scale("+U+","+C+")"),v(w,Y,""),v(w,J,""),v(w,e,(o.x-b/l/2)*l+p+_),v(w,K,(o.y-S/l/2)*l+d+_)}else{var Gc=M(w.style.width),bq=M(w.style.height),Vc=M((f-a)*l),se=M((G-a)*l),Hp="100%",dm=w.children[0];v(dm,Y,Hp),v(dm,J,Hp),(Gc!==Vc||bq!==se)&&(v(w,Y,Vc+_),v(w,J,se+_),"ht"===r&&k.invalidate()),F(w,"rotate("+180*(y/n)+"deg)"),v(w,e,(o.x-Vc/l/2)*l+p+_),v(w,K,(o.y-se/l/2)*l+d+_)}var Ej=O.dragRect;Z.isMovable(t)&&Z.isSelected(t)&&Ej?(A.save(),A.fillStyle=P,A.fillRect(Ej.x,Ej.y,Ej.width,Ej.height),A.restore(),v(E,e,Ej.x*l+p+_),v(E,K,Ej.y*l+d+_),F(E,"scale("+l+","+l+")"),v(E,V,u),O.$11f()):v(E,V,g),v(w,s,this._visible?T:c)},dispose:function(){var D=this.gv.$1f;this.$2f.parentNode===D&&D.removeChild(this.$2f),this.$3f.parentNode===D&&D.removeChild(this.$3f)},_84o:function(p){this._visible=p,v(this.$2f,s,p?T:c),v(this.$3f,V,p?u:g)},_3O:function(){var z=this,S=z.gv,V=z._data;X.superClass._3O.call(z);var D=V.getRect();S.isEditable(V)&&(z.dragRect={x:D.x+D.width+V._padding,y:D.y+10,width:V.getDraggerImageWidth(),height:V.getDraggerImageHeight()},z._68o(z.dragRect))},rectIntersects:function(S){var X=this._79o();return L.Default.intersection(X,S)?!0:void 0},$9f:function(h){var L=this.gv,t=this._data;L.sm().contains(t)&&h.stopPropagation()}});var W=L.HtmlNode=function(){W.superClass.constructor.call(this)};L.Default.def(W,L.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:L.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(L){var X=this,b=X._html;X._html=L,"html"===X.getHtmlType()&&"Handlebars"in D&&(X.$10f=Handlebars.compile(L)),X.$13f(),X.fp("html",b,L)},setContext:function(Y){var y=this,G=y._context;y._context=Y,y.fp("context",G,Y),y.$13f()},setScalable:function(T){var i=this,X=i._scalable;i._scalable=T,i.fp("scalable",X,T),i.$13f()},getHtmlType:function(){var U=this._html;return U?"string"==typeof U?"html":U.getView?"ht":"dom":null},$13f:function(){var A=this,T=A._html,E=A.$10f;if(T){var U=q(),y=!1,$=A.getHtmlType();if(v(U,j,Q),v(U,i,r),v(U,s,c),"html"===$?(U.innerHTML=E?E(A.getContext()||{}):T,y=!0):"ht"===$?(R(U,T.getView()),y=!0):"dom"===$&&(R(U,T),y=!0),y){var Z=2*A._padding;R(w(),U),A.$5f=U.scrollWidth,A.$6f=U.scrollHeight,A._width=A.$5f+Z,A._height=A.$6f+Z,A._originWidth=A._width,A._originHeight=A._height,N(w(),U)}}},getUIClass:function(){return L.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);