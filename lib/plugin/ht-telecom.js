!function(v,Q){"use strict";var t=ht.AlarmSeverity=function(B,Q,c,f,k){this.value=B,this.name=Q,this.nickName=c,this.color=f,this.displayName=k};ht.Default.def("ht.AlarmSeverity",Q,{toString:function(){return this.displayName||this.name}}),function(){t.severities=new ht.List,t._vm={},t._nm={},t._cp=function(f,c){if(f&&c){var b=f.value-c.value;return b>0?1:0>b?-1:0}return f&&!c?1:!f&&c?-1:0},t.each=function(F,D){t.severities.each(F,D)},t.getSortFunction=function(){return t._cp},t.setSortFunction=function(J){t._cp=J,t.severities.sort(J)},t.add=function(p,w,m,P,e){var Y=new t(p,w,m,P,e);return t._vm[p]=Y,t._nm[w]=Y,t.severities.add(Y),t.severities.sort(t._cp),Y},t.remove=function(W){var r=t._nm[W];return r&&(delete t._nm[W],delete t._vm[r.value],t.severities.remove(r)),r},t.CRITICAL=t.add(500,"Critical","C","#FF0000"),t.MAJOR=t.add(400,"Major","M","#FFA000"),t.MINOR=t.add(300,"Minor","m","#FFFF00"),t.WARNING=t.add(200,"Warning","W","#00FFFF"),t.INDETERMINATE=t.add(100,"Indeterminate","N","#C800FF"),t.CLEARED=t.add(0,"Cleared","R","#00FF00"),t.isClearedAlarmSeverity=function(m){return m?0===m.value:!1},t.getByName=function(b){return t._nm[b]},t.getByValue=function(b){return t._vm[b]},t.clear=function(){t.severities.clear(),t._vm={},t._nm={}},t.compare=function(m,k){return t._cp(m,k)}}();var l=ht.AlarmState=function(V){this._d=V,this._nm={},this._am={},this._ps=null,this._haa=null,this._hna=null,this._hoa=null,this._hta=null,this._hls=!1,this._aac=0,this._nac=0};ht.Default.def("ht.AlarmState",Q,{_ep:!0,_f:function(){this._c1(),this._c2(),this._c3(),this._c4(),this._c5(),this._c6(),this._c7(),this._d.fp("alarmState",null,this)},getHighestAcknowledgedAlarmSeverity:function(){return this._haa},getHighestNewAlarmSeverity:function(){return this._hna},getHighestOverallAlarmSeverity:function(){return this._hoa},getHighestNativeAlarmSeverity:function(){return this._hta},hasLessSevereNewAlarms:function(){return this._hls},_c1:function(){var Y=null;for(var E in this._am)E=t.getByName(E),t.isClearedAlarmSeverity(E)||0!==this.getAcknowledgedAlarmCount(E)&&(Y=Y?t.compare(Y,E)>0?Y:E:E);this._haa=Y},_c2:function(){var c=null;for(var n in this._nm)n=t.getByName(n),t.isClearedAlarmSeverity(n)||0!==this.getNewAlarmCount(n)&&(c=c?t.compare(c,n)>0?c:n:n);this._hna=c},_c3:function(){if(!this._hna)return this._hls=!1,void 0;for(var B in this._nm)if(B=t.getByName(B),!t.isClearedAlarmSeverity(B)&&0!==this.getNewAlarmCount(B)&&t.compare(this._hna,B)>0)return this._hls=!0,void 0;this._hls=!1},_c4:function(){var X=this._haa,W=this._hna,m=this._ps;this._hoa=X,t.compare(W,this._hoa)>0&&(this._hoa=W),t.compare(m,this._hoa)>0&&(this._hoa=m)},_c5:function(){var H=this._haa,w=this._hna;this._hta=H,t.compare(w,this._hta)>0&&(this._hta=w)},increaseAcknowledgedAlarm:function(k,t){if(0!==t){t=t||1;var w=this._am[k.name]||0;w+=t,this._am[k.name]=w,this._f()}},increaseNewAlarm:function(L,g){if(0!==g){g=g||1;var h=this._nm[L.name]||0;h+=g,this._nm[L.name]=h,this._f()}},decreaseAcknowledgedAlarm:function(R,N){if(0!==N){N||(N=1);var G=this._am[R.name]||0;if(G-=N,0>G)throw"Alarm count can not be negative";this._am[R.name]=G,this._f()}},decreaseNewAlarm:function(D,d){if(0!==d){d||(d=1);var l=this._nm[D.name]||0;if(l-=d,0>l)throw"Alarm count can not be negative";this._nm[D.name]=l,this._f()}},acknowledgeAlarm:function(W){this.decreaseNewAlarm(W,1),this.increaseAcknowledgedAlarm(W,1)},acknowledgeAllAlarms:function(H){if(H){var c=this.getNewAlarmCount(H);this.decreaseNewAlarm(H,c),this.increaseAcknowledgedAlarm(H,c)}else for(var T in this._nm)this.acknowledgeAllAlarms(t.getByName(T))},_c6:function(){this._aac=0;for(var j in this._am)j=t.getByName(j),this._aac+=this.getAcknowledgedAlarmCount(j)},getAcknowledgedAlarmCount:function(Z){return Z?this._am[Z.name]||0:this._aac},getAlarmCount:function(Y){return this.getAcknowledgedAlarmCount(Y)+this.getNewAlarmCount(Y)},_c7:function(){this._nac=0;for(var e in this._nm)this._nac+=this.getNewAlarmCount(t.getByName(e))},getNewAlarmCount:function(M){return M?this._nm[M.name]||0:this._nac},setNewAlarmCount:function(C,O){this._nm[C.name]=O,this._f()},removeAllNewAlarms:function(V){V?delete this._nm[V]:this._nm={},this._f()},setAcknowledgedAlarmCount:function(q,o){this._am[q.name]=o,this._f()},removeAllAcknowledgedAlarms:function(E){E?delete this._am[E.name]:this._am={},this._f()},isEmpty:function(){return!this._hoa},clear:function(){this._am={},this._nm={},this._f()},getPropagateSeverity:function(){return this._ps},setPropagateSeverity:function(d){if(this._ep||(d=null),this._ps!==d){var i=this._ps;this._ps=d,this._f(),this._d.fp("propagateSeverity",i,d)}},isEnablePropagation:function(){return this._ep},setEnablePropagation:function(e){var P=this._ep;this._ep=e,this._d.fp("enablePropagation",P,e)&&(e||this.setPropagateSeverity(null))}});var b=ht.AlarmStatePropagator=function(H){this._dataModel=H,this._enable=!1,this._isPropagating=!1};ht.Default.def("ht.AlarmStatePropagator",Q,{getDataModel:function(){return this._dataModel},isEnable:function(){return this._enable},setEnable:function(T){this._enable!==T&&(this._enable=T,this._enable?(this._dataModel.mm(this.handleDataModelChange,this),this._dataModel.md(this.handleDataPropertyChange,this),this._dataModel.each(function(L){this.propagate(L)},this)):(this._dataModel.umm(this.handleDataModelChange,this),this._dataModel.umd(this.handleDataPropertyChange,this)))},handleDataModelChange:function(d){d.data&&this.propagate(d.data)},handleDataPropertyChange:function(a){if("alarmState"===a.property||"enablePropagation"===a.property)this.propagate(a.data);else if("parent"===a.property){var e=a.oldValue;e&&this.propagate(e),this.propagate(a.data)}},propagate:function(d){d&&!this._isPropagating&&(this._isPropagating=!0,this.propagateToTop(d),this._isPropagating=!1)},propagateToTop:function(U){for(this.propagateToParent(null,U);U&&U.getParent();)this.propagateToParent(U,U.getParent()),U=U.getParent()},propagateToParent:function(l,y){var Z=null;y.getChildren().each(function(J){var j=J.getAlarmState().getHighestOverallAlarmSeverity();t.compare(j,Z)>0&&(Z=j)}),y.getAlarmState().setPropagateSeverity(Z)}}),ht.AlarmStateStatistics=function(Z){this.sumNew=0,this.sumAcked=0,this.sumTotal=0,this.severtiyMap={},this.dataMap={},this.setDataModel(Z)},ht.Default.def("ht.AlarmStateStatistics",Q,{ms_fire:1,getDataModel:function(){return this._dataModel},setDataModel:function(c){var s=this._dataModel;s!==c&&(s&&(s.umd(this.handleDataPropertyChange,this),s.umm(this.handleDataModelChange,this),this.severtiyMap={},this.dataMap={}),this._dataModel=c,this.reset(),c.md(this.handleDataPropertyChange,this),c.mm(this.handleDataModelChange,this),this.fp("dataModel",s,c))},dispose:function(){this._dataModel.umd(this.handleDataPropertyChange,this),this._dataModel.umm(this.handleDataModelChange,this),delete this._dataModel},handleDataPropertyChange:function(H){"alarmState"===H.property&&(this.increase(H.data),this.fireAlarmStateChange())},handleDataModelChange:function(Q){"add"===Q.kind?(this.increase(Q.data),this.fireAlarmStateChange()):"remove"===Q.kind?(this.decrease(Q.data),this.fireAlarmStateChange()):"clear"===Q.kind&&(this.severtiyMap={},this.dataMap={},this.fireAlarmStateChange())},fireAlarmStateChange:function(){this.sumAcked=0,this.sumNew=0,this.sumTotal=0,t.each(function(l){var g=this.getSumInfo(l);this.sumAcked+=g.ackedCount,this.sumNew+=g.newCount,this.sumTotal+=g.totalCount},this),this.fp("alarmState",!1,!0)},getNewAlarmCount:function(P){if(!P)return this.sumNew;var l=this.getSumInfo(P);return l.newCount},getAcknowledgedAlarmCount:function(o){if(!o)return this.sumAcked;var y=this.getSumInfo(o);return y.ackedCount},getTotalAlarmCount:function(L){if(!L)return this.sumTotal;var u=this.getSumInfo(L);return u.totalCount},getSumInfo:function(X){var z=this.severtiyMap[X.name];return z||(z={},z.newCount=0,z.ackedCount=0,z.totalCount=0,this.severtiyMap[X.name]=z),z},decrease:function($){var O=this.dataMap[$.getId()];O&&(delete this.dataMap[$.getId()],t.each(function(r){var S=O[r.name],z=this.getSumInfo(r);z.newCount=z.newCount-S.newCount,z.ackedCount=z.ackedCount-S.ackedCount,z.totalCount=z.totalCount-S.totalCount},this))},increase:function(M){if(this.decrease(M),!this._filterFunc||this._filterFunc(M)){var h={},G=M.getAlarmState();this.dataMap[M.getId()]=h,t.each(function(w){var m={};m.newCount=G.getNewAlarmCount(w),m.ackedCount=G.getAcknowledgedAlarmCount(w),m.totalCount=G.getAlarmCount(w),h[w.name]=m;var Z=this.getSumInfo(w);Z.newCount=Z.newCount+m.newCount,Z.ackedCount=Z.ackedCount+m.ackedCount,Z.totalCount=Z.totalCount+m.totalCount},this)}},reset:function(){this.severtiyMap={},this.dataMap={},this._dataModel.each(this.increase,this),this.fireAlarmStateChange()},setFilterFunc:function(t){var $=this._filterFunc;this._filterFunc=t,this.reset(),this.fp("filterFunc",$,t)},getFilterFunc:function(){return this._filterFunc}});var s=ht.Data.prototype;s.getAlarmState=function(){return this._alarmState||(this._alarmState=new l(this))},s=ht.DataModel.prototype,s.isEnableAlarmStatePropagator=function(){return!!this._alarmStatePropagator&&this._alarmStatePropagator.isEnable()},s.setEnableAlarmStatePropagator=function(C){C!=this.isEnableAlarmStatePropagator()&&(C?(this._alarmStatePropagator=new b(this)).setEnable(!0):this._alarmStatePropagator.setEnable(!1))},s=ht.graph.GraphView.prototype,s.getNote2=function(L){var T=L.getAlarmState().getHighestNewAlarmSeverity();if(T){var q=L.getAlarmState().getNewAlarmCount(T)+T.nickName;return L.getAlarmState().hasLessSevereNewAlarms()&&(q+="+"),q}return L.s("note2")},s.getNote2Background=function(Y){var T=Y.getAlarmState().getHighestNewAlarmSeverity();return T?T.color:Y.s("note2.background")},s.getBodyColor=function(M){var n=M.getAlarmState().getHighestNativeAlarmSeverity();return n?n.color:M.s("body.color")},s.getBorderColor=function(u){var c=u.getAlarmState().getPropagateSeverity();return c?c.color:u.s("border.color")},s=ht.widget.TreeView.prototype,s.getBorderColor=function(N){var K=N.getAlarmState().getPropagateSeverity();return K?K.color:N.s("border.color")},s.getIcon=function(V){return V.getIcon()?"__alarmIcon__":null},s=ht.widget.TreeTableView.prototype,s.getBorderColor=function(Z){var e=Z.getAlarmState().getPropagateSeverity();return e?e.color:Z.s("border.color")},s.getIcon=function(R){return R.getIcon()?"__alarmIcon__":null},ht.Default.setImage("__alarmIcon__",{width:16,height:16,comps:[{type:"image",name:{func:function(q){return q.getIcon()}},color:{func:function(y){var L=y.getAlarmState().getHighestNativeAlarmSeverity();return L?L.color:y.s("body.color")}},rect:[0,0,16,16]}]});var f=ht.Style;f["note2.expanded"]=!0,f["note2.color"]="#000"}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);