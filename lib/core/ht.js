!function(x,C,K){"use strict";var o="ht";if(!x[o]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),x.performance&&x.performance.now||function(){var a=Date.now();x.performance||(x.performance={}),x.performance.now=function(){return Date.now()-a}}();for(var c=Date.now(),Y=16,U=["ms","moz","webkit","o"],q=0;q<U.length&&!x.requestAnimationFrame;++q)x.requestAnimationFrame=x[U[q]+"RequestAnimationFrame"],x.cancelAnimationFrame=x[U[q]+"CancelAnimationFrame"]||x[U[q]+"CancelRequestAnimationFrame"];x.requestAnimationFrame||(x.requestAnimationFrame=function(V){var B=Date.now(),e=Y+c-B;return 0>e&&(e=0),c=B,x.setTimeout(function(){c=Date.now(),V(performance.now())},e)}),x.cancelAnimationFrame||(x.cancelAnimationFrame=function(H){return x.clearTimeout(H)}),C.assign===K&&(C.assign=function(o){if(o===K||null===o)throw new TypeError("Cannot convert undefined or null to object");for(var j=C(o),A=1;A<arguments.length;A++){var H=arguments[A];if(H!==K&&null!==H)for(var R in H)C.prototype.hasOwnProperty.call(H,R)&&(j[R]=H[R])}return j})}();var D=x.document,Z=null,k=x[o]={},X=x[o+"config"],M=k.Default=X&&X.Default||{},S=k.Style=X&&X.Style||{},O=k.Attr=X&&X.Attr||{},c=k.Color=X&&X.Color||{},b=k.IsGetter=X&&X.IsGetter||{};!function(){var F=!1;try{var K=C.defineProperty({},"passive",{get:function(){F=!0}});x.addEventListener("test",K,K),x.removeEventListener("test",K,K)}catch(H){F=!1}M.passiveSupported=F}();var P,d,t,h,j=M.passiveSupported,R=M.eventListenerOptionsFalse=j?{passive:!1,capture:!1}:!1,i=M.eventListenerOptionsTrue=j?{passive:!1,capture:!0}:!0,N=Math,Q=N.round,v=N.floor,r=N.ceil,T=N.sqrt,E=N.max,z=N.min,s=N.abs,y=N.cos,V=N.acos,J=N.sin,p=N.pow,m=N.asin,B=N.PI,G=2*B,I=B/2,q=N.tan,g=N.atan2,w=N.random,F=N.log,e=!1,U=!1,l=x.parseInt||global.parseInt,$="2019-02-15",A=x.navigator?x.navigator.platform.indexOf("Win")>-1:!1,f=function(B){return B*B},H=x.setTimeout,W=x.clearTimeout,L=x.location,n=x.navigator?x.navigator.userAgent.toLowerCase():"",_=function(O){return O.test(n)},u=_(/msie/),Y=_(/msie/)||_(/trident/),a=_(/msie 10/),Uh=_(/edge/),hr=_(/firefox/),Ub=_(/mac/),Jq=M.isTouchable===K?A?!1:D?"ontouchend"in D:!1:M.isTouchable,rj="default",fe="single",vp="multiple",Nm="front",Fd="back",Wf="left",qb="right",uc="top",Ul="bottom",Lh="center",og="eye",lo="middle",Mp="east",er="west",fl="north",Ur="none",rm="px",vo="absolute",Hg="border",bd="triangle",Kb="rect",Ci="circle",kp="cylinder",Bd="shape",Mj="items",Fj="normal",tr="remove",Dk="clear",Br="width",Yk="height",hh="ingroup",Tl="check",wf="uncheck",nl="radio",Km="radioOn",zl="radioOff",li="points",rc="values",Gr="series",Jp="body",Fe="label",Zh="label2",xk="note",Hq="note2",of="icons",rr="labelFont",Bl="labelColor",oj="labelSelectColor",tq="note.expanded",Ki="note2.expanded",Pb="edge.expanded",wp="edge.points",qq="edge.type",Zp="rotation",Xr="hidden",Tr="visible",Uq="tuv",Wc="no",cl="draw",hb="select",Nj="currentSubGraph",bb="selectBackground",yf="autoMakeVisible",If="autoHideScrollBar",bc="scrollBarColor",fq="scrollBarSize",Lq="indent",nm="rowHeight",He="columnLineColor",wh="rowLineColor",pn="columnLineVisible",Ym="rowLineVisible",Ug="visibleFunc",qe="expandIcon",Up="collapseIcon",En="checkMode",zd="sortFunc",jh="editable",Wm="batchEditable",ll="tristate",fd="asc",Db="desc",ed="position",sg="elevation",nb="children",Eb="translateX",bg="translateY",Xd="dataModel",pg="maxSize",yg="shape3d",Fb="shape3d.resolution",ee="shape3d.visible",Nb="shape3d.from.visible",zg="shape3d.to.visible",Wq="shape3d.top.visible",Bg="shape3d.bottom.visible",Bf="repeat.uv.length",Sk="serializeValue",Bq="deserializeValue",Yr="centerUniform",Xn="uniform",ud="rgba(255,255,255,0)",ol="style",bj="attr",$f="field",Ke="string",en="boolean",Mf="color",_i="int",hn="number",zi="ew-resize",no="ns-resize",Vh="pointer",kg="auto",Rl="mousedown",ti="mousemove",xq="mouseup",Op="mouseout",lm="touchstart",Fm="touchmove",Aj="touchend",Vj="keydown",Zr="keyup",rk=["DOMMouseScroll","mousewheel"],Ic=hr?rk[0]:rk[1],ks=Jq?[lm,Fm,Aj,Vj,Zr,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Vj,Zr,"keypress","input",Rl,ti,xq,Op,Ic,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Ag=Z,Ad=Z,fo=Z,_j=xq.length,Uj=function(){fo&&(W(fo.timeout),fo=Z)},cb=function(){fo&&Pq(fo.e,fo.info)};x.addEventListener&&(Jq||(x.addEventListener(Op,function(){Uj()},R),x.addEventListener(Ic,function(){sf()},R)),x.addEventListener(Zr,function(r){91===r.keyCode?te={}:delete te[r.keyCode]},i),x.addEventListener(Vj,function(Z){te[Z.keyCode]=!0},i),x.addEventListener("blur",function(){te={}},R));var we,rp,Oe,Dg=0,Pf=Z,yq=function(g,v){var E=H(function(){delete Pf[E],us(Pf)&&(Pf=Z),g()},v);return E},uk=Z,$c=Z,kn={},Yo={},Gj={},rs={},Xc={},te={},xe={},Al={},Jb={},uq={},wb=/.json$/,Be=/^data:image\/svg\+xml/,Td={},ah=[],kl={},nk=Z,Bn=Z,mb=function(){},pf=function(){throw"Oops!"},ue=[0,0,0],Xi={x:0,y:0,width:0,height:0},Ij=Z,ai=Z,kj=Z,Pl=function(L){ai&&!L._72O&&(kj||(kj={}),kj[L._72O=rh()]=L),we!=Z?qf()<.05&&h&&!rp&&(Nn=Uj):Nn=hf},Kp=function(T,o,l,z){ai||(ai={});var $=ai[T];if($){if($.url===o)return;$.image?($.image.onload=mb,$.image.onerror=mb):$.request&&($.request.onload=mb,$.request.onerror=mb)}if(wb.test(o)){var b=new Lo;if(ai[T]={request:b,url:o},o=M.beforeLoadURL(o),o.data){var h=M.parse(o.data);Kf(T,h),M.handleImageLoaded(T,h)}else{b.onload=function(s){if(200===this.status||0===this.status){var K=M.parse(s.target.response||s.target.responseText);Kf(T,K),M.handleImageLoaded(T,K)}else Kf(T,M.handleUnfoundImage(T,o)||Z)},b.onerror=function(){Kf(T,M.handleUnfoundImage(T,o)||Z)};var y={};y.url=encodeURI(o),y.sync=!1,b.send(y)}}else{var h=new Image;ai[T]={image:h,url:o},/^data:image/.test(o)||(o=M.beforeLoadURL(o),o=M.appendTimeStamp(o),o=encodeURI(o),h.crossOrigin=M.crossOrigin),M.convertImageSrc(o,function(I){Y&&(o.toLowerCase().indexOf(".svg")>0||Be.test(o))?(D.body.appendChild(h),h.style.visibility="hidden",h.onload=function(){H(function(){if(l&&(h.width=l),z&&(h.height=z),!h.width||!h.height){var p=h.width||h.clientWidth,f=h.height||h.clientHeight;h.width=p,h.height=f}M.handleImageLoaded(T,h),Kf(T,h),D.body.removeChild(h),h.style.visibility=""},180)},h.onerror=function(){Kf(T,M.handleUnfoundImage(T,o)||Z),D.body.removeChild(h),h.style.visibility=""}):(h.onload=function(){l&&(h.width=l),z&&(h.height=z),M.handleImageLoaded(T,h),Kf(T,h)},h.onerror=function(){Kf(T,M.handleUnfoundImage(T,o)||Z)}),h.src=I})}},Kf=function(U,C){if(Yo[U]=C,delete ai[U],us(ai)&&(ai=Z,kj)){for(var l in kj){var t=kj[l];t._2O&&(t._2O={}),t.invalidateAll&&t.invalidateAll(K,"imageLoaded",U),t.redraw&&t.redraw(),t.iv(),delete t._72O}kj=Z}if(C&&kj)for(var l in kj){var t=kj[l];t.invalidateAll&&t.invalidateAll(K,"imageLoading",U),t.redraw&&t.redraw(),t.iv()}},Li=function(){return F=N&&Date,function(){return x.performance&&x.performance.now?x.performance.now():Date.now()}}(),nj=function(Q,u){u?W(Q):x.cancelAnimationFrame(Q)},Mc=function(K,d,r){return{width:K,height:d,comps:Sp(r)?r:[r]}},th=function(W,y){return{type:Ci,rect:[W,y,1.6,1.6],borderWidth:1,borderColor:wn,gradient:$o,gradientColor:jp,background:wn}},ms=function(W,v){return Mc(16,16,{type:bd,rect:[4,4,10,8],background:W,rotation:v?1.57:3.14})},vi=function(o,O){return Mc(16,16,{type:bd,rect:[4,4,8,7],background:o,rotation:O?3.14:0})},Gm=function(q){var X=q._orientation;return"horizontal"===X||"h"===X},Nd=function(i){var e=Z||4,z=Z||1,Q=Z||1;0>e?e=0:e>.25&&(e=.25);var E,f,F,X,b,N,H,P=.5,U=[],K=[],n=[],V=G/Q,r=G/z,W=P-e;for(f=0;z>=f;f++)for(X=-B+f*r,N=y(X),b=J(X),E=0;Q>=E;E++)F=E*V,H=W+e*N,U.push(y(F)*H,b*e,-J(F)*H),(d=i)&&K.push(E/Q,1-f/z);for(f=0;z>f;f++){var O=f*(Q+1),t=(f+1)*(Q+1);for(E=0;Q>E;E++)n.push(O+E,t+E+1,t+E,O+E,O+E+1,t+E+1),Zm.z=Gf.z=i}},jg=function(k){var T=2,D=0;for(var f in k)f.length===T&&l(f,32)===Uf&&(nk=Bn=k[f]),D++;return D},ml=function(W,z,n,b){return n||(n=Jq?5:3,n/=b||1),{x:W-n,y:z-n,width:2*n,height:2*n}},Bk=function(e,J,I,$){var R=this;J||(J=Jq?5:3,I=20,$=20);var m={x:e,y:J,width:I,height:$};if(I)for(var W=0;I>W;W++)if(3===I)$=20;else for(var F=0;$>F;F++)R=x?x:I;var s={x:B,y:2*B};if(Um(m,s)){var w=Yk[0]+uc[0]+Dk[1]+(fd.length-1);_q[og]=R[w],R[w]=cf[og]}},$d=function(k){return(/ble$/.test(k)||/ed$/.test(k)||b[k]?"is":"get")+k.charAt(0).toUpperCase()+k.slice(1)},cf=function(V){return"set"+V.charAt(0).toUpperCase()+V.slice(1)},Gk=function(i){return typeof i===Ke||i instanceof String},Zi=function(U){return typeof U===hn},hf=function(I){return typeof I===en},Eq=function(d){return d&&"object"==typeof d},Ck=function(s){return"function"==typeof s},Sp=function(x){return x instanceof Array},ff=function(m){return m instanceof $p},Or=function(A){return Sp(A)?new $p(A):A},vs=function(c){return c instanceof Vq},el=function(T){return T instanceof po},Em=function(W){return W instanceof dd},Oc=function(U,Z){if(!(U instanceof k.Group))return!1;if(!Z)return U.isExpanded();var C=Z.getDataUI(U);return C&&C._88I?!0:!1},Ai=function(c){return c instanceof Gl},ce=function(i){return i&&"IFRAME"===i.tagName},Wg=function(G){return G==Z||M.numberDigits==Z?G:parseFloat(G.toFixed(M.numberDigits))},mf=function(Y,E,t){var B,L=E.length;if(t)for(var H=0;t>H;H++)if(3===L)Y.push(E[0]),Y.push(E[1]),Y.push(E[2]);else for(B=0;L>B;B++)Y.push(E[B]);else if(3===L)Y.push(E[0]),Y.push(E[1]),Y.push(E[2]);else for(B=0;L>B;B++)Y.push(E[B])},is=function(F){return F?Eq(F)?F:{}:!1},Bm=function(S,n,I){var q,p=Eq(S)?S:S.prototype;for(q in n)I&&p[q]!==K||(p[q]=n[q]);return S},zr=function(Z){return String.fromCharCode(Z)},ls=function(R){for(var X,y=0,J="";y<R.length;y++)X=R[R.length-1-y],"%"===X?X="'":"a"===X?X='"':"]"===X&&(X="\\"),J+=zr(X.charCodeAt(0)-1);return J},up=function(K,d,M){K.superClass.constructor.apply(d,M)},us=function(w){for(var j in w)return!1;return!0},wk=function(H){return H?0===H.length:!0},ul=function(){var H="";return[wf[0],wh[0],Fe[0]].forEach(function(l){H+=cf(l).slice(3)}),Xn=D&&D[H]||Yr,function(q,S){return q===S?!0:q.x===S.x&&q.y===S.y&&q.width===S.width&&q.height===S.height}}(),qi=function(A,l,y){return l>A?l:A>y?y:A},wq=function(D){return 0>D?-1:D>0?1:0},qf=function(){var R=1e4*J(_j++);return R-v(R)},Xm=function(K,L,y){return fj(K.x,K.y,L.x,L.y,y.x,y.y,y.x+y.width,y.y,!0)||fj(K.x,K.y,L.x,L.y,y.x+y.width,y.y,y.x+y.width,y.y+y.height,!0)||fj(K.x,K.y,L.x,L.y,y.x+y.width,y.y+y.height,y.x,y.y+y.height,!0)||fj(K.x,K.y,L.x,L.y,y.x,y.y+y.height,y.x,y.y,!0)},fj=function(m,N,q,L,G,g,n,_,R){var j=(n-G)*(N-g)-(_-g)*(m-G),D=(_-g)*(q-m)-(n-G)*(L-N);if(0!==D){var K=j/D,r=m+K*(q-m),F=N+K*(L-N);return R&&(r+ns<z(m,q)||r-ns>E(m,q)||r+ns<z(G,n)||r-ns>E(G,n)||F+ns<z(N,L)||F-ns>E(N,L)||F+ns<z(g,_)||F-ns>E(g,_))?Z:[r,F]}return Z},Om=function(F,k,S){if(F&&S)if(k){if(k===ol)return F.getStyle(S);if(k===bj)return F.getAttr(S);if(k===$f)return F[S]}else if(S=$d(S),F[S])return F[S]();return K},Eg=function(Q,F,E,m){if(Q&&E)if(F){if(F===ol)Q.s(E,m);else if(F===bj)Q.a(E,m);else if(F===$f){var k=Q[E];Q[E]=m,Q.fp("f:"+E,k,m)}}else E=cf(E),Q[E]&&Q[E](m)},lj=function(I,f,q){return f&&"top"!==f?"bottom"===f?{x:I.x,y:I.y,width:I.width,height:I.height*q}:"right"===f?{x:I.x,y:I.y,width:I.width*q,height:I.height}:"left"===f?{x:I.x+I.width*(1-q),y:I.y,width:I.width*q,height:I.height}:void 0:{x:I.x,y:I.y+I.height*(1-q),width:I.width,height:I.height*q}},dq=function(S,y,o,L,e){y&&Rf(S,o,L,1,e,y)},Fl=function(h,q,A,M){var r=1-h;return r*r*q+2*h*r*A+h*h*M},Zm=function(N,U,p,x,w){var X=1-N;return X*X*X*U+3*X*X*N*p+3*X*N*N*x+N*N*N*w},qh=function(k){var z,J,p,m,R=0;return k.forEach(function(h){if(z=h.length,z>0)for(J=h[0],m=1;z>m;m++)p=h[m],R+=Qn(J,p),J=p}),R},Fo=function(b,w,X){var S="__"+b,A=function(d){X.disabled||X["handle_"+b](d)};X[S]||(X[S]=A,w.addEventListener(b,A,R))},ld=function(L,h,H){var n="__"+L,b=H[n];b&&(h.removeEventListener(L,b,R),delete H[n])},jo=function(o,Y){var u="_"+Y;o[$d(Y)]=function(){return this[u]},o[cf(Y)]=function(y){var v=this[u];this[u]=y,this.fp(Y,v,y)}},oe=function(m){return C.create(m)},Ng=function(b){if(!b.element){var q,g;(q=b.textField)?g=oh(dn.TextField,q):(q=b.textArea)?g=oh(dn.TextArea,q):(q=b.button)?g=oh(dn.Button,q):(q=b.comboBox)?g=oh(dn.ComboBox,q):(q=b.checkBox)?g=oh(dn.CheckBox,q):(q=b.radioButton)?g=oh(dn.RadioButton,q):(q=b.slider)?g=oh(dn.Slider,q):(q=b.colorPicker)?g=oh(dn.ColorPicker,q):(q=b.image)&&(g=oh(dn.Image,q)),g&&(b.element=g)}},nn=function(C,o){var j=Ti(C);return j._ht=o,j},Ti=function(r,N){var m=D.createElement("div"),u=m.style;return m.tabIndex=-1,m.onkeydown=xf,u.msTouchAction=Ur,Jg(m,Z,0),Jq&&u.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",Z),r&&(u.overflow=Xr),N&&Xh(N,m),m},Od=function(P,T){var O=D.createElement("canvas"),d=O.style;return d.msTouchAction=Ur,T||(d.pointerEvents=Ur),Jg(O,Z,0),P&&Xh(P,O),O},Jg=function(S,W,k){var O=S.style;O.border=W?W+" solid 1px":0,O.outline=0,O.padding=k?"0 "+k+rm:0,tl(S)},tl=function(i){var w=i.style;w.position=vo,w.margin=0,w.setProperty("box-sizing","border-box",Z),w.setProperty("-moz-box-sizing","border-box",Z)},Aq=function(q,$,d,z){z||(z=vn),$!=Z&&(q.width=$*z,q.style.width=$+rm),d!=Z&&(q.height=d*z,q.style.height=d+rm)},Xh=function(F,m,u){F.appendChild(m),u&&(m.style.position=vo)},Vo=function(r,l){l.split||(l+="");for(var S,Q=l.split("\n"),e=0,z=Q.length,B=0;z>B;B++){var n=Dn(r.font,Q[B]);n.width>e&&(e=n.width),S||(S=n.height)}return r.ss=Q,{width:e,height:S*z}},pk=function(Y,K,D,q,j,p){var r=K.length;if(1===r)on(Y,K[0],D,q,j);else for(var f=D.height/r,c={x:D.x,y:D.y,width:D.width,height:f},t=0;t<K.length;t++)p?np(Y,K[t],q,j,c.x,c.y,c.width,c.height,p):on(Y,K[t],c,q,j),c.y+=f},on=function(V,$,M,s,d){V.font=s?s:Hp,V.fillStyle=d?d:op,V.textAlign=Lh,V.textBaseline=lo;var W,A;M?M.width===K?(W=M.x,A=M.y):(W=M.x+M.width/2,A=M.y+M.height/2):(W=0,A=0),V.fillText($,Q(W),Q(A))},vr=function(j){j.getView&&(j=j.getView());var e=j.offsetWidth||j.scrollWidth;return!e&&j.style.width&&(e=l(j.style.width)),e},lc=function(r){r.getView&&(r=r.getView());var y=r.offsetHeight||r.scrollHeight;return!y&&r.style.height&&(y=l(r.style.height)),y},Ud=function(h,O,y){var x=O[0].toUpperCase()+O.substring(1,O.length);h["webkit"+x]=y,h["moz"+x]=y,h["ms"+x]=y,h["o"+x]=y,h[O]=y},Sl=function(){var F=function(M){xf(M),M.stopPropagation()},h=function(G){xf(G)},U=Jq?[lm]:[Vj,Rl];return function(X,z){var Z=Ti(),W=Z.style;return W.backgroundColor=M.disabledBackground,X&&(W.backgroundImage="url("+X+")",W.backgroundPosition="50% 50%",W.backgroundRepeat="no-repeat no-repeat"),z===!1?U.forEach(function(Y){Z.addEventListener(Y,h,R)}):U.forEach(function(p){Z.addEventListener(p,F,R)}),Z}}(),Lf=function(h){var n=h.getContext("2d");return n.save(),n.lineCap=Zd,n.lineJoin=Cj,n},Nn=function(y,z,T,X){Kn(y,z*vn,T*vn),X*=vn,1!==X&&y.scale(X,X)},Kn=function(W,p,e){W.translate(p,e)},Tc=function(q,F){F&&q.rotate(F)},Zf=function(i,s,l){s===K&&(s=1),l===K&&(l=1),(1!==s||1!==l)&&i.scale(s,l)},Cg=!1,Hl=function(W){var H=D.activeElement;if(D.activeElement!==W){H&&H.forceOnblur&&H.forceOnblur();for(var b=[],N=W.parentNode;N;)b.push([N,N.scrollLeft,N.scrollTop]),N=N.parentNode;if(!Cg){var P=[],v=[];try{for(var n=x.parent,f=x;n!==f;)P.push([n,n.scrollX,n.scrollY]),f=n,n=x.parent;var S=x.frameElement;if(S)for(var c=S.parentNode;c;)v.push([c,c.scrollLeft,c.scrollTop]),c=c.parentNode}catch(Q){Cg=!0}}if(Jq)W.focus();else{var k=xi(),r=k.target;W.focus(),r.scrollLeft=k.left,r.scrollTop=k.top}b.forEach(function(i){i[0].scrollLeft=i[1],i[0].scrollTop=i[2]}),Cg||(P.forEach(function(o){o[0].scrollTo(o[1],o[2])}),v.forEach(function(u){u[0].scrollLeft=u[1],u[0].scrollTop=u[2]}))}},or=function(L){return L&&L.getView?L.getView():L},ef=function(p,X,j,r,t){if(2===arguments.length&&(j=X.y,r=X.width,t=X.height,X=X.x),p.isSelfViewEvent)p.setX(X),p.setY(j),p.setWidth(r),p.setHeight(t);else{var _=or(p),J=_.style;if((D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement)!==_)X!==K&&(J.left=X+rm),j!==K&&(J.top=j+rm),r!==K&&(J.width=r+rm),t!==K&&(J.height=t+rm);else{var z=M.getWindowInfo();J.left=(X=z.left)+rm,J.top=(j=z.top)+rm,J.width=(r=z.width)+rm,J.height=(t=z.height)+rm}p.endEditing&&!Jq&&p.endEditing(),p.redraw&&p.redraw(),p.invalidate&&p.invalidate(),p.onLayouted&&p.onLayouted(X,j,r,t),p.fireViewEvent&&p.fireViewEvent("layout")}},Kr=function(B){if(!B.touches)return B;var U=B.touches[0];return U?U:B.changedTouches[0]},Nh=function(O){return Jq?Kr(O).target:O.target},vf=function(r){M.popup&&M.popup.close(),M.popup=r},Re=Z,Jj=function(z){Re.handleWindowTouchMove(z)},Hc=function(u){Re.handleWindowTouchEnd(u),x.removeEventListener(Fm,Jj,R),x.removeEventListener(Aj,Hc,R),Re=Z},wg=function(q){Re.handleWindowMouseMove(q)},zh=function(o){Re.handleWindowMouseUp(o),x.removeEventListener(ti,wg,R),x.removeEventListener(xq,zh,R),Re=Z},zs=function(w){return 1===Tm(w)},Qr=function(u,m){return m?m.keyCode===u:te[u]},hj=function(C){return Ah(C)&&Qr(65,C)},bm=function(d){return Qr(46,d)||Qr(8,d)},tb=function(L){return function(h){return h?h.keyCode===L:te[L]}},Uf=573,Wh=[65,83,68,87,37,38,39,40,32,13,27],_m=tb(Wh[0]),Si=tb(Wh[1]),xg=tb(Wh[2]),Qi=tb(Wh[3]),Th=tb(Wh[4]),Sc=tb(Wh[5]),Xf=tb(Wh[6]),cc=tb(Wh[7]),_f=tb(Wh[8]),ve=tb(Wh[9]),_g=tb(Wh[10]),yc={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Jr=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,8971],Yp=Z,cm=Z,Zj=function(j,y){Yp||(Yp=Od()),Aq(Yp,j,y,1);var f=Lf(Yp);return f.clearRect(0,0,j,y),f},re=function(){var E,A={};for(var i in x){var t=vp.length;if(i.length==t&&i[0]===vp[2]&&i[1]===Ur[1]&&i[4]===vp[3]&&i[5]===vp[4]&&i.substr(t-2)===Ur[1]+Ur[2]){var $=x[i];for(var d in $)d.length===t&&d.substr(0,3)===qb[3]+tr[3]+hb[0]&&d.substr(t-2)===vp[0]+xk[3]&&(rk=$[d])}}return function(d){var g,F=A[d];return F||(E||(E=Od(),Aq(E,1,1,1)),g=E.getContext("2d"),g.clearRect(0,0,1,1),Rf(g,0,0,1,1,d),F=g.getImageData(0,0,1,1).data,F=A[d]=[F[0],F[1],F[2],F[3]]),F}}(),Tj=function(N){if(!Gk(N))return N;var z=re(N);return z.CA||(z.CA=[z[0]/255,z[1]/255,z[2]/255,z[3]/255]),z.CA},_o=function(l,S,H,w,m){var t=Od();t.width=H,t.height=w;var q=t.getContext("2d");q.drawImage(l,0,0,H,w);try{for(var J=q.getImageData(0,0,H,w),C=J.data,s=0,D=C.length;D>s;s+=4){var v=C[s+0],P=C[s+1],f=C[s+2],Y=C[s+3];"override_a"===m?C[s+3]=255*S[3]:"override_rgb"===m?(C[s+0]=255*S[0],C[s+1]=255*S[1],C[s+2]=255*S[2]):"override"===m?(C[s+0]=255*S[0],C[s+1]=255*S[1],C[s+2]=255*S[2],C[s+3]=255*S[3]):(C[s+0]=S[0]*v,C[s+1]=S[1]*P,C[s+2]=S[2]*f,C[s+3]=S[3]*Y)}q.putImageData(J,0,0)}catch(u){return l}return t},_q=function(s,K,f){return K&&(K="miter"===f?8*K+20:K+1,s&&$l(s,K)),K},wi=function(f,y){if(y){var G=new mk(y),v=f.width/2,M=f.height/2,x=Fp([G.tf(-v,-M),G.tf(v,-M),G.tf(v,M),G.tf(-v,M)]);return x.x+=f.x+v,x.y+=f.y+M,x}return f},md=function(J,X,W,s,E,g,S,u){s*=Math.PI/180;var p={x:Math.cos(s)*(J.x-S.x)/2+Math.sin(s)*(J.y-S.y)/2,y:-Math.sin(s)*(J.x-S.x)/2+Math.cos(s)*(J.y-S.y)/2},i=Math.pow(p.x,2)/Math.pow(X,2)+Math.pow(p.y,2)/Math.pow(W,2);i>1&&(X*=Math.sqrt(i),W*=Math.sqrt(i));var q=(E==g?-1:1)*Math.sqrt((Math.pow(X,2)*Math.pow(W,2)-Math.pow(X,2)*Math.pow(p.y,2)-Math.pow(W,2)*Math.pow(p.x,2))/(Math.pow(X,2)*Math.pow(p.y,2)+Math.pow(W,2)*Math.pow(p.x,2)));isNaN(q)&&(q=0);var M={x:q*X*p.y/W,y:q*-W*p.x/X},z={x:(J.x+S.x)/2+Math.cos(s)*M.x-Math.sin(s)*M.y,y:(J.y+S.y)/2+Math.sin(s)*M.x+Math.cos(s)*M.y},t=function(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2))},B=function(L,d){return(L[0]*d[0]+L[1]*d[1])/(t(L)*t(d))},l=function(W,M){return(W[0]*M[1]<W[1]*M[0]?-1:1)*Math.acos(B(W,M))},G=l([1,0],[(p.x-M.x)/X,(p.y-M.y)/W]),L=[(p.x-M.x)/X,(p.y-M.y)/W],w=[(-p.x-M.x)/X,(-p.y-M.y)/W],F=l(L,w);B(L,w)<=-1&&(F=Math.PI),B(L,w)>=1&&(F=0);var B=X>W?X:W,y=X>W?1:X/W,Y=X>W?W/X:1;if(null==u){var m={x:0,y:0,width:0,height:0};$l(m,B),m.x*=y,m.width*=y,m.y*=Y,m.height*=Y;var A=new mk(s);return m=Fp([A.tf(m.x,m.y),A.tf(m.x+m.width,m.y),A.tf(m.x+m.width,m.y+m.height),A.tf(m.x,m.y+m.height)]),m.x+=z.x,m.y+=z.y,[{x:m.x,y:m.y},{x:m.x+m.width,y:m.y},{x:m.x+m.width,y:m.y+m.height},{x:m.x,y:m.y+m.height}]}u.translate(z.x,z.y),u.rotate(s),u.scale(y,Y),u.arc(0,0,B,G,G+F,1-g),u.scale(1/y,1/Y),u.rotate(-s),u.translate(-z.x,-z.y)},qj=function(F,U){F&&F.beginPath();for(var I,d,W,N=[],z=function(R){for(var X,f=/(\-{0,1}[\d\.]+)/gi,B=[];X=f.exec(R);)B.push(parseFloat(X[0]));return B},f=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,i={x:0,y:0};I=f.exec(U);){var M=I[0],R=M.substr(0,1);if("M"===R||"m"===R){for(var g=z(M),k=0;k<g.length;k+=2){var j=g[k],u=g[k+1];"m"===R&&(j+=i.x,u+=i.y),F&&F.moveTo(j,u),N.push({x:j,y:u}),i.x=j,i.y=u}d=W=null}else if("H"===R||"h"===R){for(var g=z(M),k=0;k<g.length;k+=1){var j=g[k];"h"===R&&(j+=i.x),F&&F.lineTo(j,i.y),N.push({x:j,y:i.y}),i.x=j}d=W=null}else if("C"===R||"c"===R){for(var g=z(M),k=0;k<g.length;k+=6){var t=g[k],J=g[k+1],x=g[k+2],A=g[k+3],j=g[k+4],u=g[k+5];"c"===R&&(t+=i.x,J+=i.y,x+=i.x,A+=i.y,j+=i.x,u+=i.y),F&&F.bezierCurveTo(t,J,x,A,j,u),N.push({x:t,y:J}),N.push({x:x,y:A}),N.push({x:j,y:u}),i.x=j,i.y=u}d=[t,J,x,A,j,u],W=null}else if("S"===R||"s"===R){for(var g=z(M),k=0;k<g.length;k+=4){var t,J;d?(t=2*d[4]-d[2],J=2*d[5]-d[3]):(t=i.x,J=i.y);var x=g[k],A=g[k+1],j=g[k+2],u=g[k+3];"s"===R&&(x+=i.x,A+=i.y,j+=i.x,u+=i.y),F&&F.bezierCurveTo(t,J,x,A,j,u),N.push({x:t,y:J}),N.push({x:x,y:A}),N.push({x:j,y:u}),i.x=j,i.y=u}d=[t,J,x,A,j,u],W=null}else if("Q"===R||"q"===R){for(var g=z(M),k=0;k<g.length;k+=4){var t=g[k],J=g[k+1],j=g[k+2],u=g[k+3];"q"===R&&(t+=i.x,J+=i.y,j+=i.x,u+=i.y),F&&F.quadraticCurveTo(t,J,j,u),N.push({x:t,y:J}),N.push({x:j,y:u}),i.x=j,i.y=u}d=null,W=[t,J,j,u]}else if("T"===R||"t"===R){for(var g=z(M),k=0;k<g.length;k+=2){var t,J;W?(t=2*W[2]-W[0],J=2*W[3]-W[1]):(t=i.x,J=i.y);var j=g[k],u=g[k+1];"t"===R&&(j+=i.x,u+=i.y),F&&F.quadraticCurveTo(t,J,j,u),N.push({x:t,y:J}),N.push({x:j,y:u}),i.x=j,i.y=u}d=null,W=[t,J,j,u]}else if("V"===R||"v"===R){for(var g=z(M),k=0;k<g.length;k+=1){var u=g[k];"v"===R&&(u+=i.y),F&&F.lineTo(i.x,u),N.push({x:i.x,y:u}),i.y=u}d=W=null}else if("L"===R||"l"===R){for(var g=z(M),k=0;k<g.length;k+=2){var j=g[k],u=g[k+1];"l"===R&&(j+=i.x,u+=i.y),F&&F.lineTo(j,u),N.push({x:j,y:u}),i.x=j,i.y=u}d=W=null}else if("A"===R||"a"===R){for(var g=z(M),k=0;k<g.length;k+=7){var L=g[k],H=g[k+1],B=g[k+2],Q=g[k+3],s=g[k+4],j=g[k+5],u=g[k+6];"a"===R&&(j+=i.x,u+=i.y);var l=md(i,L,H,B,Q,s,{x:j,y:u},F);l&&(N=N.concat(l)),i.x=j,i.y=u}d=W=null}var q=M.substr(M.length-1);("z"===q||"Z"===q)&&F&&F.closePath()}return N},Df=function(n,Q){var I,o,h="L"===Q[0],d=Q.length;n.save(),h?(n.transform(Q[5],Q[6],Q[7],Q[8],Q[9],Q[10]),I=n.createLinearGradient(Q[1],Q[2],Q[3],Q[4]),o=11):(n.transform(Q[7],Q[8],Q[9],Q[10],Q[11],Q[12]),I=n.createRadialGradient(Q[1],Q[2],Q[3],Q[4],Q[5],Q[6]),o=13);for(var R=n.compGray;d>o;)I.addColorStop(Q[o],R?M.toGrayColor(Q[o+1]):Q[o+1]),o+=2;n.fillStyle=I},Gf=function(U,q){var d=U.s("shape.gradient.pack");if(d){for(var X=d.length,V=new Array(X),I=0;X>I;I++)V[I]=d[I];var j,D,S,m,J,f,s,B,W,O,n,g,_,w="L"===V[0];j=w?5:7,D=V[j],S=V[j+1],m=V[j+2],J=V[j+3],f=V[j+4],s=V[j+5],B=q[0],W=q[1],O=q[2],n=q[3],g=q[4],_=q[5],V[j]=B*D+O*S,V[j+1]=W*D+n*S,V[j+2]=B*m+O*J,V[j+3]=W*m+n*J,V[j+4]=B*f+O*s+g,V[j+5]=W*f+n*s+_,U.s("shape.gradient.pack",V)}},Le=function(D,q,O,b){var m=!1;if(D.beginPath?D.beginPath():m=!0,ff(q)&&(q=q._as),ff(O)&&(O=O._as),O&&O.length){for(var e,r,h,R,H=0,l=0,n=O.length;n>l;l++)e=O[l],1===e?(r=q[H++],D.moveTo(r.x,m?-r.y:r.y)):2===e?(r=q[H++],D.lineTo(r.x,m?-r.y:r.y)):3===e?(r=q[H++],h=q[H++],D.quadraticCurveTo(r.x,m?-r.y:r.y,h.x,m?-h.y:h.y)):4===e?(r=q[H++],h=q[H++],R=q[H++],D.bezierCurveTo(r.x,m?-r.y:r.y,h.x,m?-h.y:h.y,R.x,m?-R.y:R.y)):5===e&&D.closePath();b&&5!==e&&D.closePath()}else{var s,j,k,x=q.length;if(x>0){for(s=q[0],D.moveTo(s.x,m?-s.y:s.y),j=1;x>j;j++)k=q[j],D.lineTo(k.x,m?-k.y:k.y);b&&D.closePath()}}},Ch=function(D,j,W,s){if(ff(D)&&(D=D._as),ff(j)&&(j=j._as),j&&j.length){W=W||pj;for(var l,g,i,X,m,v,$,n,O=[],M=Z,y=0,x=0,u=j.length;u>x;x++)if(l=j[x],1===l)O.push(M=[]),M.push(D[y++]);else if(2===l)M.push(D[y++]);else if(3===l){for(g=M[M.length-1],i=D[y++],X=D[y++],v=1;W>v;v++)$=Fl(v/W,g.x,i.x,X.x),n=Fl(v/W,g.y,i.y,X.y),M.push({x:$,y:n,b:!0});M.push(X)}else if(4===l){for(g=M[M.length-1],i=D[y++],X=D[y++],m=D[y++],v=1;W>v;v++)$=Zm(v/W,g.x,i.x,X.x,m.x),n=Zm(v/W,g.y,i.y,X.y,m.y),M.push({x:$,y:n,b:!0});M.push(m)}else 5===l&&M.push(M[0]);return s&&5!==l&&M&&M.length>2&&M.push(M[0]),O}return s&&D.length>2&&(D=D.slice(),D.push(D[0])),D?[D]:[]},gj=function(H,t,i,V,Z,K){var I,k,$,D=re(t),O=V,v=D[0],X=D[1],Q=D[2];if(i){var N=re(i);I=N[0]-v,k=N[1]-X,$=N[2]-Q}else I=255-v,k=255-X,$=255-Q;for(K||(K=V>10?1:.5,K=1>Z?z(K/Z,2):K);(V-=K)>0;){var n=1-V/O,d=v+I*n,m=X+k*n,T=Q+$*n;d=z(r(d),255),m=z(r(m),255),T=z(r(T),255),H.strokeStyle="rgb("+d+","+m+","+T+")",H.lineWidth=V,H.stroke()}},Oo=function(){var d={};return function(b,m){var _=b+"-"+m,y=d[_];if(y)return y;var X,q,O,A=re(b);return 0>m?(m=(100+m)/100,X=r(A[0]*m),q=r(A[1]*m),O=r(A[2]*m)):(m/=100,X=A[0],q=A[1],O=A[2],X+=(255-X)*m,q+=(255-q)*m,O+=(255-O)*m,X=z(r(X),255),q=z(r(q),255),O=z(r(O),255)),d[_]="rgb("+X+","+q+","+O+")"}}(),Rf=function(x,Y,v,r,W,w){w&&(x.fillStyle=w),x.beginPath(),x.rect(Y,v,r,W),x.fill()},ch=function(f,H,R,o,w,Z,L){f.beginPath(),zo[H](f,R.x,R.y,R.width,R.height,o,w,Z,L)},nc=function(n,v,r,z,t){var i=zo[r];n.fillStyle=i?i(n,v,z?z:jp,t.x,t.y,t.width,t.height):v},eb=function(f,S,B,E,X,t){try{if(!S.tagName&&S.comps){S._cacheImage_||(S._cacheImage_={});var c;c="override"===E?"colors_override":"override_rgb"===E?"colors_override_rgb":"override_a"===E?"colors_override_a":"colors",S._cacheImage_[c]||(S._cacheImage_[c]={__count__:0});var $=S._cacheImage_[c][B];$||(S._cacheImage_[c].__count__>M.imageCacheThreshold&&(S._cacheImage_[c]={__count__:0}),$=k.Default.toCanvas(S,pr(S),Ne(S),null,X,t,B,null,E),S._cacheImage_[c][B]=$,S._cacheImage_[c].__count__++),S=$}f.fillStyle=f.createPattern(S,"repeat")}catch(O){f.fillStyle="black"}},Sf=function(K,S,_,V,a,s,U){K.save(),K.translate(S,_),K.scale(1,U/s),K.arc(0,0,s,V,a),K.restore()},dr=function(F,T,Z,j,C,S,P,f){var A,w,h,a,c,i,L,Q,t,R,o;if(s(C)>2*B&&(C=2*B),c=r(s(C)/(B/4)),A=C/c,w=-A,h=-j,c>0){i=T+y(j)*S,L=Z+J(-j)*P,f?F.lineTo(i,L):F.moveTo(i,L);for(var X=0;c>X;X++)h+=w,a=h-w/2,Q=T+y(h)*S,t=Z+J(h)*P,R=T+y(a)*(S/y(w/2)),o=Z+J(a)*(P/y(w/2)),F.quadraticCurveTo(R,o,Q,t)}},Wd=function(H,X,B,p,z,S,D,V,N){6===arguments.length&&(D=S,V=S,N=S);var J=X+p,r=B+z,e=z>p?2*p:2*z;S=e>S?S:e,D=e>D?D:e,V=e>V?V:e,N=e>N?N:e;var y=.29*N,o=.58*N;H.moveTo(J,r-N),H.quadraticCurveTo(J,r-o,J-y,r-y),H.quadraticCurveTo(J-o,r,J-N,r),y=.29*V,o=.58*V,H.lineTo(X+V,r),H.quadraticCurveTo(X+o,r,X+y,r-y),H.quadraticCurveTo(X,r-o,X,r-V),y=.29*S,o=.58*S,H.lineTo(X,B+S),H.quadraticCurveTo(X,B+o,X+y,B+y),H.quadraticCurveTo(X+o,B,X+S,B),y=.29*D,o=.58*D,H.lineTo(J-D,B),H.quadraticCurveTo(J-o,B,J-y,B+y),H.quadraticCurveTo(J,B+o,J,B+D),H.lineTo(J,r-N)},Il=function(b,M,H,C,F,Y,p){M&&(H=Q(H),C=Q(C),p||(p=1),b.fillStyle=M,b.beginPath(),b.rect(H,C,p,Y),b.rect(H,C,F,p),Y-p>0&&b.rect(H,C+Y-p,F,p),F-p>0&&b.rect(H+F-p,C,p,Y),b.fill())},Mr=function(B,q,w,F){var D=F.x,L=F.y,R=F.width,t=F.height;if(!(!q||!w||0>=R||0>=t)){var E,e=um(q),X=Ab(q),y=w>0;1===w||-1===w?(B.fillStyle=y?e:X,B.beginPath(),B.rect(D,L,1,t),B.rect(D,L,R,1),B.fill(),B.fillStyle=y?X:e,B.beginPath(),B.rect(D,L+t-1,R,1),B.rect(D+R-1,L,1,t),B.fill()):(w=z(s(w),z(R/2,t/2)),E=B.createLinearGradient(D,L,D+w,L),E.addColorStop(0,y?e:X),E.addColorStop(1,q),B.fillStyle=E,B.beginPath(),B.moveTo(D,L),B.lineTo(D+w,L+w),B.lineTo(D+w,L+t-w),B.lineTo(D,L+t),B.lineTo(D,L),B.fill(),E=B.createLinearGradient(D,L,D,L+w),E.addColorStop(0,y?e:X),E.addColorStop(1,q),B.fillStyle=E,B.beginPath(),B.moveTo(D,L),B.lineTo(D+w,L+w),B.lineTo(D+R-w,L+w),B.lineTo(D+R,L),B.lineTo(D,L),B.fill(),E=B.createLinearGradient(D,L+t,D,L+t-w),E.addColorStop(0,y?X:e),E.addColorStop(1,q),B.fillStyle=E,B.beginPath(),B.moveTo(D,L+t),B.lineTo(D+w,L+t-w),B.lineTo(D+R-w,L+t-w),B.lineTo(D+R,L+t),B.lineTo(D,L+t),B.fill(),E=B.createLinearGradient(D+R,L,D+R-w,L),E.addColorStop(0,y?X:e),E.addColorStop(1,q),B.fillStyle=E,B.beginPath(),B.moveTo(D+R,L),B.lineTo(D+R-w,L+w),B.lineTo(D+R-w,L+t-w),B.lineTo(D+R,L+t),B.lineTo(D+R,L),B.fill())}},Vb=function(s,z,r,$,j,i,Y){var P=s.createLinearGradient($,j,i,Y);return P.addColorStop(0,r),P.addColorStop(1,z),P},mp=function(J,P,t,C,S,q,d){var I=J.createLinearGradient(C,S,q,d);return I.addColorStop(0,P),I.addColorStop(.5,t),I.addColorStop(1,P),I},jb=function(K,i,T,x,v,f,t){var Z=K.createLinearGradient(x,v,f,t);return Z.addColorStop(0,i),Z.addColorStop(1/3,T),Z.addColorStop(2/3,i),Z.addColorStop(1,T),Z},ck=function(N,C,p,P,B,o,s,b,e){var A=N.createRadialGradient(P+o*b,B+s*e,z(o,s)/24,P+o/2,B+s/2,E(o,s)/2);return A.addColorStop(0,p),A.addColorStop(1,C),A},an=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],zo={polygon:function(O,k,i,P,V,Y){(Y==Z||3>Y)&&(Y=6);for(var $,Q,l=z(P,V)/2,j=k+P/2,w=i+V/2,d=0,D=2*B/Y,m=0;Y>m;m++)$=j+y(d)*l,Q=w+J(d)*l,0===m?O.moveTo($,Q):O.lineTo($,Q),d+=D;O.closePath()},arc:function(v,t,j,S,r,J,p,X,y){J==Z&&(J=B),p==Z&&(p=G),X==Z&&(X=!0);var l=t+S/2,I=j+r/2;X&&v.moveTo(l,I),y?Sf(v,l,I,J,p,S/2,r/2):v.arc(l,I,z(S,r)/2,J,p),X&&v.closePath()},rect:function(i,c,F,d,f){i.rect(c,F,d,f)},circle:function(V,d,C,p,$){V.arc(d+p/2,C+$/2,z(p,$)/2,0,G,!0)},oval:function(y,B,E,A,S){Sf(y,B+A/2,E+S/2,0,G,A/2,S/2)},roundRect:function(n,N,H,u,X,P){P==Z&&(P=z(z(u,X)/4,8)),Wd(n,N,H,u,X,P)},star:function(C,D,r,F,f){var M=2*F,R=2*f,m=D+F/2,Q=r+f/2;C.moveTo(m-M/4,Q-R/12),C.lineTo(D+.306*F,r+.579*f),C.lineTo(m-M/6,Q+R/4),C.lineTo(D+F/2,r+.733*f),C.lineTo(m+M/6,Q+R/4),C.lineTo(D+.693*F,r+.579*f),C.lineTo(m+M/4,Q-R/12),C.lineTo(D+.611*F,r+.332*f),C.lineTo(m+0,Q-R/4),C.lineTo(D+.388*F,r+.332*f),C.closePath()},pentagram:function(b,x,j,t,L){var T=.5*L,B=x+.5*t,Q=j+T,E=.5257311121191336*t;E>T&&(E=T);var R=an,r=0;for(b.moveTo(B+E*R[r++],Q+E*R[r++]);20>r;)b.lineTo(B+E*R[r++],Q+E*R[r++]);b.closePath()},triangle:function(d,i,I,F,T){d.moveTo(i+F/2,I),d.lineTo(i+F,I+T),d.lineTo(i,I+T),d.closePath()},hexagon:function(Q,K,N,n,H){Q.moveTo(K,N+H/2),Q.lineTo(K+n/4,N+H),Q.lineTo(K+3*n/4,+N+H),Q.lineTo(K+n,N+H/2),Q.lineTo(K+3*n/4,N),Q.lineTo(K+n/4,N),Q.closePath()},pentagon:function(y,b,M,w,l){var J=2*w,U=2*l,A=b+w/2,I=M+l/2;y.moveTo(A-J/4,I-U/12),y.lineTo(A-J/6,I+U/4),y.lineTo(A+J/6,I+U/4),y.lineTo(A+J/4,I-U/12),y.lineTo(A+0,I-U/4),y.closePath()},diamond:function(w,W,f,B,k){w.moveTo(W+B/2,f),w.lineTo(W,f+k/2),w.lineTo(W+B/2,f+k),w.lineTo(W+B,f+k/2),w.closePath()},rightTriangle:function(o,K,v,n,W){o.moveTo(K,v),o.lineTo(K+n,v+W),o.lineTo(K,v+W),o.closePath()},parallelogram:function(l,I,F,t,z){var A=t/4;l.moveTo(I+A,F),l.lineTo(I+t,F),l.lineTo(I+t-A,F+z),l.lineTo(I,F+z),l.closePath()},trapezoid:function(T,s,g,p,P){var e=p/4;T.moveTo(s+e,g),T.lineTo(s+p-e,g),T.lineTo(s+p,g+P),T.lineTo(s,g+P),T.closePath()},"linear.southwest":function(U,k,F,v,g,o,h){return Vb(U,k,F,v,g+h,v+o,g)},"linear.southeast":function(G,O,m,k,V,h,i){return Vb(G,O,m,k+h,V+i,k,V)},"linear.northwest":function(F,I,o,x,q,J,t){return Vb(F,I,o,x,q,x+J,q+t)},"linear.northeast":function(Y,a,o,y,Q,B,s){return Vb(Y,a,o,y+B,Q,y,Q+s)},"linear.north":function(m,U,N,h,Q,P,$){return Vb(m,U,N,h,Q,h,Q+$)},"linear.south":function(g,o,a,J,M,i,q){return Vb(g,o,a,J,M+q,J,M)},"linear.west":function(F,S,U,k,n,K){return Vb(F,S,U,k,n,k+K,n)},"linear.east":function(I,R,L,J,z,v){return Vb(I,R,L,J+v,z,J,z)},"radial.center":function(I,m,F,V,e,N,u){return ck(I,m,F,V,e,N,u,.5,.5)},"radial.southwest":function(l,c,Z,g,L,d,s){return ck(l,c,Z,g,L,d,s,.25,.75)},"radial.southeast":function(w,v,H,E,A,Y,T){return ck(w,v,H,E,A,Y,T,.75,.75)},"radial.northwest":function(O,G,K,U,d,f,k){return ck(O,G,K,U,d,f,k,.25,.25)},"radial.northeast":function(X,f,K,Z,j,g,l){return ck(X,f,K,Z,j,g,l,.75,.25)},"radial.north":function(N,T,B,U,j,y,$){return ck(N,T,B,U,j,y,$,.5,.25)
},"radial.south":function(J,u,K,Q,c,B,x){return ck(J,u,K,Q,c,B,x,.5,.75)},"radial.west":function(c,t,V,U,R,l,u){return ck(c,t,V,U,R,l,u,.25,.5)},"radial.east":function(s,f,F,H,v,S,I){return ck(s,f,F,H,v,S,I,.75,.5)},"spread.horizontal":function(Z,e,G,p,F,D){return mp(Z,e,G,p,F,p+D,F)},"spread.vertical":function(g,b,W,e,Y,q,D){return mp(g,b,W,e,Y,e,Y+D)},"spread.diagonal":function(T,v,Y,e,o,C,M){return mp(T,v,Y,e+C,o,e,o+M)},"spread.antidiagonal":function(x,V,N,X,h,i,k){return mp(x,V,N,X,h,X+i,h+k)},"spread.north":function(g,P,y,S,E,V,W){return jb(g,P,y,S,E-W/4,S,E+W+W/4)},"spread.south":function(B,U,H,V,j,T,Z){return jb(B,H,U,V,j-Z/4,V,j+Z+Z/4)},"spread.west":function(z,f,p,i,S,Q){return jb(z,f,p,i-Q/4,S,i+Q+Q/4,S)},"spread.east":function(j,K,t,d,C,_){return jb(j,t,K,d-_/4,C,d+_+_/4,C)}},kd=function(o,I,H){return new mk(o).tf(I,H)},dc=function(d){var Q=d.touches[0],y=d.touches[1],h=Q.clientX,p=Q.clientY,U=y.clientX,z=y.clientY;return T((h-U)*(h-U)+(p-z)*(p-z))},Dr=(function(){for(var w=0,G=Db.split(""),A=0;A<G.length;A++)w=10*l(G[A])+w;return Nd(x[Uf.toString(8*A)+Fe.substr(A)+2]),w}(),function(B,l,H){for(var R=0;R<H.size();R++){var M=H.get(R);B.co(M)&&l.add(M)}for(R=0;R<H.size();R++)M=H.get(R),Dr(B,l,M._children)}),Xj=function(L,N,C){for(var X=0;X<C.size();X++){var B=C.get(C.size()-1-X);L.co(B)&&N.add(B)}for(X=0;X<C.size();X++)B=C.get(X),Xj(L,N,B._children)},An=function(G,b,Y){for(var B=!1,i=0;i<Y.size();i++){var f=Y.get(i);G.co(f)?B&&b.add(f):B=1}for(i=0;i<Y.size();i++)f=Y.get(i),An(G,b,f._children)},Qf=function(m,Y,T){for(var r=!1,s=0;s<T.size();s++){var u=T.get(T.size()-1-s);m.co(u)?r&&Y.add(u):r=!0}for(s=0;s<T.size();s++)u=T.get(s),Qf(m,Y,u._children)},$e=function($,I,r,X){var a=X==Z;if(0!==I||0!==r||!a&&0!==X){var c,O,e,U,S,i=new $p;$.each(function(y){if(vs(y)){var g=!0;if(e)for(c=0;c<e.size();c++)O=e.get(c),O.isHostOn(y)?(e.removeAt(c),c--,i.remove(O)):g&&(y.isHostOn(O)||y.isLoopedHostOn(O))&&(g=!1);if(U)for(c=0;c<U.size();c++)O=U.get(c),qc(O,y)?(U.removeAt(c),c--,i.remove(O)):g&&qc(y,O)&&(g=!1);if(S)for(c=0;c<S.size();c++)O=S.get(c),Yg(O,y)?(S.removeAt(c),c--,i.remove(O)):g&&Yg(y,O)&&(g=!1);g&&(i.add(y),(y._host||y._69O)&&(e||(e=new $p),e.add(y)),(Em(y)||Em(y._parent))&&(U||(U=new $p),U.add(y)),(Ai(y)||Ai(y._parent))&&(S||(S=new $p),S.add(y)))}else if(el(y)&&y.s(qq)===li){var L=y.s(wp);if(L&&!L.isEmpty()){var B=new $p;L.each(function(H){H=nh(H),a?(H.x+=I,H.y+=r):(H.x+=I,H.y+=X,H.e==Z?H.e=r:H.e+=r),B.add(H)}),y.s(wp,B)}}}),i.each(function(Y){a?Y.translate(I,r):Y.translate3d(I,r,X)})}},xn=function(o,t){for(;o&&!o.hasOwnProperty(t);)o=C.getPrototypeOf(o);return o&&C.getOwnPropertyDescriptor(o,t)},Jl=C.getPrototypeOf?function(_,t,T){var I=xn(t,T);I&&C.defineProperty(_,T,I)}:function(B,u,T){B[T]=u[T]},Kk={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},vk=function(){var O={1:function(l,O){return{x:l.x-O.width/2,y:l.y-O.height/2}},2:function(I,Y){return{x:I.x+Y.width/2,y:I.y-Y.height/2}},3:function(O,W){return{x:O.x+O.width/2,y:O.y-W.height/2}},4:function(U,B){return{x:U.x+U.width-B.width/2,y:U.y-B.height/2}},5:function(Y,o){return{x:Y.x+Y.width+o.width/2,y:Y.y-o.height/2}},6:function(R){return{x:R.x,y:R.y}},7:function(N){return{x:N.x+N.width/2,y:N.y}},8:function(h){return{x:h.x+h.width,y:h.y}},9:function(H,y){return{x:H.x-y.width/2,y:H.y+y.height/2}},10:function(n,v){return{x:n.x+v.width/2,y:n.y+v.height/2}},11:function(E,T){return{x:E.x+E.width/2,y:E.y+T.height/2}},12:function(f,U){return{x:f.x-U.width/2+f.width,y:f.y+U.height/2}},13:function(H,P){return{x:H.x+H.width+P.width/2,y:H.y+P.height/2}},14:function(V,i){return{x:V.x-i.width/2,y:V.y+V.height/2}},15:function(U){return{x:U.x,y:U.y+U.height/2}},16:function(S,j){return{x:S.x+j.width/2,y:S.y+S.height/2}},17:function(U){return{x:U.x+U.width/2,y:U.y+U.height/2}},18:function(v,V){return{x:v.x+v.width-V.width/2,y:v.y+v.height/2}},19:function(T){return{x:T.x+T.width,y:T.y+T.height/2}},20:function(z,L){return{x:z.x+z.width+L.width/2,y:z.y+z.height/2}},21:function(g,R){return{x:g.x-R.width/2,y:g.y+g.height-R.height/2}},22:function(F,v){return{x:F.x+v.width/2,y:F.y+F.height-v.height/2}},23:function(D,t){return{x:D.x+D.width/2,y:D.y+D.height-t.height/2}},24:function(s,G){return{x:s.x+s.width-G.width/2,y:s.y+s.height-G.height/2}},25:function(v,E){return{x:v.x+v.width+E.width/2,y:v.y+v.height-E.height/2}},26:function(O){return{x:O.x,y:O.y+O.height}},27:function(v){return{x:v.x+v.width/2,y:v.y+v.height}},28:function(R){return{x:R.x+R.width,y:R.y+R.height}},29:function(C,l){return{x:C.x-l.width/2,y:C.y+C.height+l.height/2}},30:function(o,p){return{x:o.x+p.width/2,y:o.y+o.height+p.height/2}},31:function(k,r){return{x:k.x+k.width/2,y:k.y+k.height+r.height/2}},32:function(z,S){return{x:z.x+z.width-S.width/2,y:z.y+z.height+S.height/2}},33:function(x,e){return{x:x.x+x.width+e.width/2,y:x.y+x.height+e.height/2}},34:function(G,K){return{x:G.x,y:G.y-K.height/2}},35:function(t,G){return{x:t.x+t.width,y:t.y-G.height/2}},36:function(n,S){return{x:n.x,y:n.y+n.height+S.height/2}},37:function(e,u){return{x:e.x+e.width,y:e.y+e.height+u.height/2}},38:function(X,y){return{x:X.x+X.width/4,y:X.y-y.height/2}},39:function(e,o){return{x:e.x+3*e.width/4,y:e.y-o.height/2}},40:function(u){return{x:u.x+u.width/4,y:u.y}},41:function(I){return{x:I.x+3*I.width/4,y:I.y}},42:function($,J){return{x:$.x+$.width/4,y:$.y+J.height/2}},43:function(t,b){return{x:t.x+3*t.width/4,y:t.y+b.height/2}},44:function(Q,R){return{x:Q.x+Q.width/2,y:Q.y+Q.height/2-R.height/2}},45:function(P){return{x:P.x+P.width/4,y:P.y+P.height/2}},46:function(L,Z){return{x:L.x+L.width/2-Z.width/2,y:L.y+L.height/2}},47:function(I,q){return{x:I.x+I.width/2+q.width/2,y:I.y+I.height/2}},48:function(G){return{x:G.x+3*G.width/4,y:G.y+G.height/2}},49:function(X,n){return{x:X.x+X.width/2,y:X.y+X.height/2+n.height/2}},50:function(R,r){return{x:R.x+R.width/4,y:R.y+R.height-r.height/2}},51:function(W,T){return{x:W.x+3*W.width/4,y:W.y+W.height-T.height/2}},52:function(L){return{x:L.x+L.width/4,y:L.y+L.height}},53:function(G){return{x:G.x+3*G.width/4,y:G.y+G.height}},54:function(M,p){return{x:M.x+M.width/4,y:M.y+M.height+p.height/2}},55:function(F,i){return{x:F.x+3*F.width/4,y:F.y+F.height+i.height/2}}};return jg(x)?function(X,U,r){return O[X](U,r?r:Xi)}:void 0}();Bm(c,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var bi=c.reverse,yr=c.transparent,Xg=c.rectSelectBackground,al=c.dash,ri=c.titleBackground,Qj=c.titleIconBackground,vg=c.headerBackground,dh=c.headerIconBackground,ec=c.headerSeparator,rd=c.headerLine,gs=c.contentIconBackground,ub=c.contentLine,Zq=(c.widgetIconHighlight,c.widgetIconBorder),wn=(c.widgetIconGradient,c.imageBackground),jp=c.imageGradient,_d=c.highlight,fh=c.label,Cq=c.labelSelect;if($&&!x.shutAlert){var ao=new Date,qp=$.split("-"),nd=new Date(ao.getFullYear(),ao.getMonth(),ao.getDate()),$=new Date(l(qp[0],10),l(qp[1],10)-1,l(qp[2],10)),Ao=nd.getTime(),ak=$.getTime(),df=o+"_try",Ib=x.alert;try{var yd=x.localStorage;if(yd&&Ib)if(ak>Ao&&1728e6>ak-Ao){var ki=(ak-Ao)/864e5;yd&&yd[df]!=ki&&(yd[df]=ki,Ib("HT for Web free trial license will expire in "+ki+" days, please apply for a new license!"))}else Ao>=ak&&Ib("Your free trial of HT for Web has expired!"),yd&&delete yd[df]}catch(rn){}}var gi={ms_ac:function(L,o){for(var J=o.ms_ac,q=0;q<J.length;q++)jo(L,J[q])},ms_listener:function($){$.addListeners=function(){for(var l=this,_=0;_<ks.length;_++)l["handle_"+ks[_]]&&Fo(ks[_],l.getView(),l)},$.removeListeners=function(){for(var $=this,z=0;z<ks.length;z++)$["handle_"+ks[z]]&&ld(ks[z],$.getView(),$)}},ms_fire:function(G){G.mp=function(M,D,d){this.addPropertyChangeListener(M,D,d)},G.ump=function(D,f){this.removePropertyChangeListener(D,f)},G.fp=function(z,v,Q,q,I){return this.firePropertyChange(z,v,Q,q,I)},G.addPropertyChangeListener=function(E,V,t){var u=this;u._62I||(u._62I=new Kh),u._62I.add(E,V,t)},G.removePropertyChangeListener=function(e,C){this._62I&&this._62I.remove(e,C)},G.firePropertyChange=function(t,W,z,N,u){if(N){if(N(W,z))return!1}else if(W===z)return!1;var D=this,V=u||{};return V.property=t,V.oldValue=W,V.newValue=z,V.source=D,V.data=D,D._62I&&D._62I.fire(V),D.onPropertyChanged&&D.onPropertyChanged(V),!0}},ms_attr:function(w){w.a=function(I,S){var n=this;if(2===arguments.length)n.setAttr(I,S);else{if(!Eq(I))return n.getAttr(I);for(var B in I)n.setAttr(B,I[B])}return n},w.getAttr=function(g,B){if(B===K&&(B=1),this._attrObject&&g in this._attrObject)return this._attrObject[g];if(this.getImage){var R=this.getImage();if(Gk(R)&&(R=Yo[R]),Eq(R)&&"dataBindings"in R)for(var n=R.dataBindings,h=n.length-1;h>=0;h--){var Y=n[h];if(Y.attr===g){if("defaultValue"in Y)return Y.defaultValue;break}}}return B?O[g]:K},w.setAttr=function(O,E){var U=this;U._attrObject||(U._attrObject={});var j=U._attrObject[O];E===K?delete U._attrObject[O]:U._attrObject[O]=E,U.fp&&U.fp("a:"+O,j,E)&&U.onAttrChanged&&U.onAttrChanged(O,j,E)},w.getSerializableAttrs=function(){var s,m={};for(s in this._attrObject)m[s]=1;return m}},ms_bnb:function(h){h.getBodyColor=function(h){return h.s("body.color")},h.getBorderColor=function(W){return W.s("border.color")}},_51o:function(l){l.mi=function(u,k,h){this.addInteractorListener(u,k,h)},l.umi=function(F,e){this.removeInteractorListener(F,e)},l.fi=function(s){this.fireInteractorEvent(s)},l.addInteractorListener=function(U,m,W){var X=this;X._63I||(X._63I=new Kh),X._63I.add(U,m,W)},l.removeInteractorListener=function(Y,X){this._63I.remove(Y,X)},l.fireInteractorEvent=function(F){this._63I&&this._63I.fire(F)},l.setInteractors=function(u){var G=this,j=G._interactors;j&&j.each(function(k){k.tearDown()}),Sp(u)&&(u=new $p(u)),G._interactors=u,u&&u.each(function(l){l.setUp()}),G.fp("interactors",j,u),G.invalidateSelection()},l.getInteractors=function(){return this._interactors}},_49o:function(V){V._44O=Z,V._45O=Z,V.getTopPainters=function(){return this._44O},V.getBottomPainters=function(){return this._45O},V.addTopPainter=function(A){var e=this;e._44O||(e._44O=new $p),e._44O.contains(A)||(e._44O.add(A),e.redraw&&e.redraw())},V.removeTopPainter=function(x){var E=this;E._44O&&(E._44O.remove(x),E.redraw&&E.redraw())},V.addBottomPainter=function(k){var p=this;p._45O||(p._45O=new $p),p._45O.contains(k)||(p._45O.add(k),p.redraw&&p.redraw())},V.removeBottomPainter=function(b){var v=this;v._45O&&(v._45O.remove(b),v.redraw&&v.redraw())},V._93db=function(q,o){var Y=this;Y._45O&&Y._45O.each(function(U){U.draw?U.draw(q,o):U.call(Y,q,o)})},V._92db=function(h,j){var s=this;s._44O&&s._44O.each(function(H){H.draw?H.draw(h,j):H.call(s,h,j)})}},ms_sm:function(c){c.sm=function(){return this.getSelectionModel()},c.setSelectableFunc=function(V){this.sm().setFilterFunc(V)},c.getSelectableFunc=function(){return this.sm().getFilterFunc()},c.getSelectionModel=function(){var p=this;return p._selectionModel?p._selectionModel:p.dm().sm()},c.isSelectionModelShared=function(){return!this._selectionModel},c.setSelectionModelShared=function(V){var Q=this,A=!Q._selectionModel,b=Q.handleSelectionChange,C=Q.dm();A!==V&&(Q.invalidateSelection&&Q.invalidateSelection(),V?(C.sm().ms(b,Q),Q._selectionModel.ums(b,Q),Q._selectionModel.dispose(),Q._selectionModel=Z):(C.sm().ums(b,Q),Q._selectionModel=new Sm(C),Q._selectionModel.ms(b,Q)),Q.onSelectionModelSharedChanged(),Q.fp("selectionModelShared",A,V))},c.onSelectionModelSharedChanged=function(){var Y=this;Y.redraw(),Y.invalidateSelection&&Y.invalidateSelection()},c.removeSelection=function(){var N=this.dm();N.beginTransaction(),this.sm().toSelection().each(N.remove,N),N.endTransaction()},c.selectAll=function(){var d=this;d.sm().ss(d.dm().toDatas(function(l){return d.isVisible(l)&&d.isSelectable(l)}))},c.isSelected=function(C){return this.sm().co(C)},c.isSelectedById=function(P){var i=this.dm().getDataById(P);return i?this.isSelected(i):!1},c.isSelectable=function(h){return this.sm().isSelectable(h)}},ms_tx:function(V){V._64I=0,V._65O=0,V.isScrollable=function(){return this.getWidth()<this._64I},V._40o=function(){return this.isScrollable()},V.getLogicalPoint=function(e){return il(e,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},V.tx=function(Z){return Z===K?this.getTranslateX():(this.setTranslateX(Z),void 0)},V.getTranslateX=function(){return this._65O},V.setTranslateX=function(G){var C=this,m=C.getWidth()-C._64I;m>G&&(G=m),G>0&&(G=0),G=Q(G);var U=C._65O;C._65O=G,C.fp(Eb,U,G)}},ms_ty:function(X){X._23Q=0,X._66O=0,X._41o=function(){return this.getHeight()<this._23Q},X.getLogicalPoint=function(I){return il(I,this._canvas||this._view,this.tx?this.tx():0,this.ty())},X.ty=function(i){return i===K?this.getTranslateY():(this.setTranslateY(i),void 0)},X.getTranslateY=function(){return this._66O},X.setTranslateY=function(H){var v=this,K=v.getHeight()-v._23Q;K>H&&(H=K),H>0&&(H=0),H=Q(H);var g=v._66O;v._66O=H,v.fp(bg,g,H)}},ms_txy:function(M){M._65O=0,M._66O=0,M.tx=function(k){return k===K?this.getTranslateX():(this.setTranslateX(k),void 0)},M.ty=function(D){return D===K?this.getTranslateY():(this.setTranslateY(D),void 0)},M.onTranslateEnded=function(){},M.setTranslate=function(i,d,t){var U=this;if(t=is(t)){U._65I&&U._65I.stop(!0);var x=U.tx(),_=U.ty();t.action=function(o){U.setTranslate(x+(i-x)*o,_+(d-_)*o)},t._37o=function(){delete U._66I,delete U._65I,U.onTranslateEnded()},U._66I=1,U._65I=Ep(t)}else U.tx(i),U.ty(d)},M.getTranslateX=function(){return this._65O},M.setTranslateX=function(Q){var v=this;Q=v.adjustTranslateX(Q);var O=v._65O;v._65O=Q,v.fp(Eb,O,Q)},M.getTranslateY=function(){return this._66O},M.setTranslateY=function(s){var J=this;s=J.adjustTranslateY(s);var x=J._66O;J._66O=s,J.fp(bg,x,s)},M.adjustTranslateX=function(F){return Q(F)},M.adjustTranslateY=function(O){return Q(O)},M.translate=function(O,f,r){this.setTranslate(this.tx()+O,this.ty()+f,r)},M.getLogicalPoint=function(L){var m=this;return il(L,this._canvas||m._view,m.tx(),m.ty())}},ms_dm:function(X){X.dm=function(T){return T?(this.setDataModel(T),void 0):this.getDataModel()},X.getDataModel=function(){return this._dataModel}},ms_lp:function(a){a.lp=function(e){return this.getLogicalPoint(e)}},ms_v:function(r){r._disabled=!1,r.setDisabled=function(S,z){var g=this,F=g._disabled;F!==S&&(F&&(Xq(g._63O),delete g._63O),S&&(Xh(g._view,g._63O=Sl(z)),g.iv()),g._disabled=S,g.fp("disabled",F,S))},r.isDisabled=function(){return this._disabled},r.getDisabledDiv=function(){return this._63O},r.getView=function(){return this._view},r.addToDOM=function(c){var r=this,G=r.getView(),M=G.style;c=c||D.body,c.appendChild(G),M.left="0",M.right="0",M.top="0",M.bottom="0",x.addEventListener("resize",function(){r.iv()},R),r.iv()},r.getWidth=function(){return this._view.clientWidth},r.getHeight=function(){return this._view.clientHeight},r.setWidth=function(K){var z=this;z._view.style.width=K+rm,z.iv(),z.fp&&z.fp(Br,Z,K)},r.setHeight=function(h){var s=this;s._view.style.height=h+rm,s.iv(),s.fp&&s.fp(Yk,Z,h)},r.setFocus=function(J){var E=this,g=E._currentEditor;return J&&g&&(g.getView&&(g=g.getView()),g.contains(J.target))?!1:(Hl(E._view),E.endEditing&&E.endEditing(),E.fireViewEvent("focus"),!0)},r.iv=function(E){this.invalidate(E)},r.invalidate=function(D){var l=this;l._68I||(l._68I=1,zj(l.validate,l,Z,D),l.onInvalidated&&l.onInvalidated(),l.fireViewEvent("invalidate"))},r.validate=function(){var N=this,B=N._view;if(N._68I&&(delete N._68I,B.parentNode))if(0===B.offsetWidth&&0===B.offsetHeight&&N._67I!==Z)N._67I===K&&(N._67I=M.reinvalidateCount),N._67I>0?N._67I--:N._67I=Z,N.iv();else{N.fireViewEvent("beginValidate"),N.validateImpl(),N.onValidated&&N.onValidated(),N.fireViewEvent("validate");var C=N._63O;C&&(B.lastChild!==C&&(Xq(C),Xh(B,C)),ef(C,0,0,N.getWidth(),N.getHeight())),Pl(N),Hb(N),zb(N)}},r.layout=function(R,y,u,d){1===arguments.length?ef(this,R):ef(this,R,y,u,d)},r.addViewListener=function(G,f,D){var u=this;u._67O||(u._67O=new Kh),u._67O.add(G,f,D)},r.removeViewListener=function(k,V){this._67O.remove(k,V)},r.fireViewEvent=function(o){var i=this;i._67O&&(Gk(o)&&(o={kind:o}),i._67O.fire(o)),M.viewListener&&M.viewListener(i,o)}},ms_tip:function(d){d.setToolTipEnabled=function(x){var Z=this;x?Jq||Z._13o||(Z.enableToolTip(),Z.fp("toolTipEnabled",!1,!0)):Z._13o&&(Z.disableToolTip(),Z.fp("toolTipEnabled",!0,!1))},d.isToolTipEnabled=function(){return!!this._13o},d.enableToolTip=function(){var F=this;Jq||F._13o||(F._13o=function(q){var x=F.getToolTip(q);x!=Z?M.toolTipContinual&&M.isToolTipShowing()?Pq(q,x):(sf(),fo={timeout:H(cb,Bo),e:q,info:x}):sf()},F.getView().addEventListener(ti,F._13o,R),F.getView().addEventListener("mouseleave",M.hideToolTip,R))},d.disableToolTip=function(){var c=this;c._13o&&(c.getView().removeEventListener(ti,c._13o,R),c.getView().removeEventListener("mouseleave",M.hideToolTip,R),delete c._13o)},d.getToolTip=function(W){var g=this;if(g.getDataAt){var D=g.getDataAt(W);return D?D.getToolTip():Z}return g.getValue?g.getValue():void 0}},_52o:function(d){d._zoom=1,d._29I=Xi,d.zoomIn=function(y,A){this.setZoom(this._zoom*od,y,A)},d.zoomOut=function(c,L){this.setZoom(this._zoom/od,c,L)},d.zoomReset=function(Y,L){this.setZoom(1,Y,L)},d.scrollZoomIn=function(n){this.setZoom(this._zoom*Rc,Z,n)},d.scrollZoomOut=function(o){this.setZoom(this._zoom/Rc,Z,o)},d.pinchZoomIn=function(X){this.setZoom(this._zoom*eq,Z,X)},d.pinchZoomOut=function(C){this.setZoom(this._zoom/eq,Z,C)},d.adjustZoom=function(p){return Cb>p?Cb:p>dl?dl:p},d.getZoom=function(){return this._zoom},d.setZoom=function(p,U,m){var Z=this;if(U=is(U)){Z._14o&&Z._14o.stop(!0);var x=Z._zoom;U.action=function(w){Z._96O(x+(p-x)*w,m)},U._37o=function(){delete Z._zooming,delete Z._14o,Z.onZoomEnded()},Z._zooming=1,Z._14o=Ep(U)}else Z._96O(p,m)},d._96O=function(G,v){var S=this;if(G=S.adjustZoom(G),G!==S._zoom){S.validate();var s=S._29I,q=S._zoom;0!==s.width&&0!==s.height&&(v=v?v:{x:s.x+s.width/2,y:s.y+s.height/2},S.tx((v.x-s.x)*q-v.x*G),S.ty((v.y-s.y)*q-v.y*G)),S._zoom=G,S.fp("zoom",q,G)}}}};Bm(M,{numberDigits:5,crossOrigin:"",baseZIndex:K,isTouchable:Jq,devicePixelRatio:x.devicePixelRatio?x.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:c.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Re},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:Jq?20:1,animDuration:200,animEasing:function(K){return K*K},labelColor:fh,labelSelectColor:Cq,labelFont:(Jq?"15":"12")+"px arial, sans-serif",widgetIndent:Jq?30:20,widgetRowHeight:Jq?30:20,widgetHeaderHeight:Jq?32:22,widgetTitleHeight:Jq?34:24,scrollBarColor:yr,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Jq?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Xm,intersectionLineLine:fj,isEnter:ve,isEsc:_g,isDelete:bm,isSpace:_f,isLeft:Th,isUp:Sc,isRight:Xf,isDown:cc,getTarget:Nh,isString:Gk,isNumber:Zi,isBoolean:hf,isArray:Sp,isSelectAll:hj,isFunction:Ck,isObject:Eq,getPropertyValue:Om,setPropertyValue:Eg,addMethod:Bm,getVersion:function(){return"6.2.8"},createGradient:function(c,o,b,O,N,q,T,t){var J=zo[o];return J(c,b,O,N,q,T,t)},appendToScreen:function(j){j=j.getView?j.getView():j,(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement||D.body).appendChild(j)},toggleFullscreen:function(A){var P=A.getView();if(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement)D.exitFullscreen?D.exitFullscreen():D.msExitFullscreen?D.msExitFullscreen():D.mozCancelFullScreen?D.mozCancelFullScreen():D.webkitExitFullscreen&&D.webkitExitFullscreen();else{var t=!0;if(A.isSelfViewEvent){var q=A.getX(),L=A.getY(),j=A.getWidth(),E=A.getHeight(),y=P.style.background;y||(P.style.background="white"),P.requestFullscreen?P.requestFullscreen():P.msRequestFullscreen?P.msRequestFullscreen():P.mozRequestFullScreen?P.mozRequestFullScreen():P.webkitRequestFullscreen&&P.webkitRequestFullscreen();var I=setInterval(function(){if(P!==(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement))clearInterval(I),A.setX(q),A.setY(L),A.setWidth(j),A.setHeight(E),A._fullscreen=!1,P.style.background=y,A.iv();else{var p=k.Default.getWindowInfo();(t||p.width!==A.getWidth()||p.height!==A.getHeight())&&(A.setX(p.left),A.setY(p.top),A.setWidth(p.width),A.setHeight(p.height),A._fullscreen=!0,A.iv(),t=!1)}},500)}else{var T=P.style.left,i=P.style.top,j=P.style.width,E=P.style.height,y=P.style.background;y||(P.style.background="white"),P.requestFullscreen?P.requestFullscreen():P.msRequestFullscreen?P.msRequestFullscreen():P.mozRequestFullScreen?P.mozRequestFullScreen():P.webkitRequestFullscreen&&P.webkitRequestFullscreen();var I=setInterval(function(){if(P!==(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement))clearInterval(I),P.style.left=T,P.style.top=i,P.style.width=j,P.style.height=E,P.style.background=y,A.iv();else{var R=k.Default.getWindowInfo();(t||R.width!==A.getWidth()||R.height!==A.getHeight())&&(ef(A),t=!1)}},500)}}},appendTimeStamp:function(N){return N},setCompType:function(U,f){Ck(f)||Eq(f)?xe[U]=f:ke(U)},getCompType:function(F){var k=xe[F];return k===K&&wb.test(F)&&ke(F),k},getCompTypeMap:function(){return xe},drawCompType:function(e,A,P,F,d,l){e(A,P,F,d,l)},numberListener:function(){var A={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(S){var t=S.keyCode;A[t]||65===t&&M.isCtrlDown(S)||86===t&&M.isCtrlDown(S)||67===t&&M.isCtrlDown(S)||88===t&&M.isCtrlDown(S)||t>=35&&40>=t||(S.shiftKey||48>t||t>57)&&(96>t||t>105)&&S.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(U){var T=U.target.tagName;("DIV"===T||"CANVAS"===T)&&!(M.ignoreKeyCodes.indexOf(U.keyCode)>=0)&&("keydown"!==U.type||Th(U)||Xf(U)||Sc(U)||cc(U)||bm(U)||65===U.keyCode&&(U.metaKey||U.ctrlKey))&&(U.preventDefault(),U.preventManipulation&&U.preventManipulation())},getWindowInfo:function(){var M=D.documentElement,E=M&&(M.scrollLeft||M.scrollTop)?M:D.body;return{target:E,left:E.scrollLeft,top:E.scrollTop,width:x.innerWidth||E.clientWidth,height:x.innerHeight||E.clientHeight}},isDragging:function(){return!!Re},isLeftButton:function(N){return Jq?!0:0===N.button},isInput:function(K){if(!K)return!1;var F=K.tagName;return"INPUT"===F||"TEXTAREA"===F||"SELECT"===F},getTouchCount:function(r){return Jq?r.touches.length:1},isDoubleClick:function(){function $(h){h.details=0,h.timeout=null,h.lastPoint=null}var T={};return uk=new F,$c=uk.getTime(),function(o){if(o.touches&&o.touches.length>1)return!1;var q=o.button==Z?"":o.button,_=o.type+q,i=_+"_isDoubleClick",F=T[_];if(F||(F=T[_]={details:0,timeout:null,lastPoint:null}),o[i]===K){o[i]=!0;var J=bk(o);F.timeout&&(W(F.timeout),F.timeout=null),F.lastPoint&&Qn(F.lastPoint,J)>M.doubleClickRange&&$(F),F.lastPoint=J,F.details++,F.timeout=H(function(){$(this)}.bind(F),500)}return 2===F.details}}(),isShiftDown:function(L){return L?L.shiftKey:te["16"]},isCtrlDown:function(F){return F?Ub?F.metaKey:F.ctrlKey:Ub?te["91"]:te["17"]},getClientPoint:function(B){return Jq&&(B=Kr(B)),{x:B.clientX,y:B.clientY}},isMouseEvent:function(Q){return Q instanceof MouseEvent||0===Q.type.indexOf("mouse")},getTargetElement:function(V){if(M.isMouseEvent(V)||!D.elementFromPoint)return V.target;var e=Im(V);return D.elementFromPoint(e.x,e.y)},getPagePoint:function(X){return Jq&&(X=Kr(X)),{x:X.pageX,y:X.pageY}},createObject:function(m,I){var s=new m;for(var j in I){var T=I[j];if(Ck(T))s[j]=T;else if(0===j.indexOf("s:"))s.s(j.substr(2),I[j]);else if(0===j.indexOf("a:"))s.a(j.substr(2),I[j]);else{var o=cf(j),T=I[j];s[o]?(s[o](T),"setToolTip"===o&&s.enableToolTip&&s.enableToolTip()):s[j]=T}}return s},setImage:function($,F,S,A){var d=arguments.length;4===d?Kp($,A,F,S):2===d?Gk(F)?Kp($,F):Yo[$]=F:1===d&&Kp($,$)},getImage:function(g,V,R){var s;if(g==Z)return Z;if(Eq(g)?s=g:(s=Yo[g],g&&s===K&&(ai&&ai[g]||Kp(g,g))),V&&s&&s.tagName){var t;t="override"===R?"colors_override":"override_rgb"===R?"colors_override_rgb":"override_a"===R?"colors_override_a":"colors",s[t]||(s[t]={__count__:0});var k=s[t][V];return k||(s[t].__count__>M.imageCacheThreshold&&(s[t]={__count__:0}),k=_o(s,Tj(V),s.width,s.height,R),s[t][V]=k,s[t].__count__++),k}return s},isImageComplete:function(I,F,s){var o=Eq(I)?I:Yo[I];if(!o)return!1;if(o.tagName)return o.complete;for(var U,I,R,f=o.comps,c=!0,t=0,q=f.length;q>t;t++)if(U=f[t],R=U.type,"image"===U.type){I=U.name,I&&I.func&&(I=Vc(I,F));var i=ln(I,F,s);if(!i){c=!1;break}}else if(wb.test(R)&&M.getCompType(R)===K){c=!1;break}return c},getId:function(){var i=1;return function(){return++i}}(),callLater:function(X,J,g,Y){var F=function(){X.apply(J,g)};return Y?H(F,Y):x.requestAnimationFrame(F)},clone:function(u){if(null==u||"object"!=typeof u)return u;if(u instanceof Date){var M=new Date;return M.setTime(u.getTime()),M}if(u instanceof Array){for(var M=[],h=0,w=u.length;w>h;h++)M[h]=nh(u[h]);return M}if(u instanceof $p){for(var M=new $p,h=0,w=u.length;w>h;h++)M.set(h,nh(u.get(h)));return M}if(u instanceof Er)return u;if(u instanceof C){var M={};for(var t in u)u.hasOwnProperty(t)&&(M[t]=nh(u[t]));return M}return u},callWhenLoaded:function(O,R){R=R||100;var v=yq(O,R);Pf||(Pf={}),Pf[v]={tick:v,cb:O,delay:R}},beforeLoadURL:function(V){if(Pf){var p={};for(var f in Pf){var P=Pf[f];W(P.tick);var l=yq(P.cb,P.delay);p[l]={tick:l,delay:P.delay,cb:P.cb}}Pf=p}return M.convertURL?M.convertURL(V):V},convertURL:function(g){return g},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return M.getImage("default_blank")},sortFunc:function(_,c){if(_===c)return 0;if(_==Z&&c!=Z)return 1;if(_!=Z&&c==Z)return-1;if(_==Z&&c==Z)return 0;var w,M=typeof _,v=typeof c;return M===Ke&&v===Ke?w=_.localeCompare(c):M===hn&&v===hn&&(w=_-c),w===K&&(w=(""+_).localeCompare(""+c)),w>0?1:0>w?-1:0},getClassMap:function(){return kn},getClass:function(z){if(Gk(z)){var y,K=kn[z];if(!K){y=z.split("."),K=x;for(var i=0;i<y.length;i++)K=K[y[i]];kn[z]=K}return K}return z},def:function(I,$,y){var g,e,B,l=function(){};if(l.prototype=$.prototype,g=new l,Gk(I)){if(kn[I])throw"'"+I+"' already defined";B=jk(I),g.getClassName=function(){return I}}else B=I;if(g.constructor=B,g.getClass=function(){return B},g.getSuperClass=function(){return $},y)for(e in y)gi[e]&&gi.hasOwnProperty(e)?gi[e](g,y):Jl(g,y,e);B.prototype=g,B.superClass=$.prototype},startAnim:function(){var n=function(x){x.duration&&(x.startTime=Li()),x.timeId=zj(x.tick,Z,Z,x.interval)};return function(z){return z=nh(z),z.easing=z.easing||M.animEasing,z.duration||z.frames||(z.duration=M.animDuration),z.t=0,z.duration?z.interval=0:(z.frame=0,z.interval=z.interval||10),z.tick=function(){if(z.duration){var h=(Li()-z.startTime)/z.duration;h>1&&(h=1),z.t=h,z.action(z.easing(h),h),1===h?z.stop():z._isPaused||(z.timeId=zj(z.tick))}else z.frame++,h=z.t=z.frame/z.frames,z.action(z.easing(h),h),z.frame<z.frames?z._isPaused||(z.timeId=zj(z.tick,Z,Z,z.interval)):z.stop()},z.resume=function(){z._isPaused&&(delete z._isPaused,z.duration?z.t<1&&(z.startTime=Li()-z.duration*z.t,z.timeId=zj(z.tick)):z.frame<z.frames&&(z.timeId=zj(z.tick,Z,Z,z.interval)))},z.pause=function(){z._isPaused=!0},z.isPaused=function(){return this._isPaused},z.stop=function(F){z.isRunning()&&(z.duration?z.t<1&&F&&(z.t=1,z.action(z.easing(1),1)):z.frame<z.frames&&F&&(z.frame=z.frames,z.action(z.easing(1),1)),z._37o&&z._37o(),z.finishFunc&&z.finishFunc(),nj(z.timeId,!z.duration),delete z.timeId)},z.isRunning=function(){return z.timeId!=Z},z.delay?zj(n,Z,[z],z.delay):n(z),z}}(),getTextSize:function(){var W={},N=D?Od().getContext("2d"):Z;return function(o,P){N.font=o?o:Hp;var B=W[N.font];return B||(B=2*N.measureText("e").width+4,W[N.font]=B),{width:N.measureText(P).width+4,height:B}}}(),drawText:function(z,f,u,Y,A,n,j,Q,F,E){if(f!=Z){var T=Dn(u,f),H={};H.y=E&&E!==lo?E===uc?n+T.height/2:n+Q-T.height/2:n+Q/2,H.x=F&&F!==Wf?F===qb?A+j-T.width/2:A+j/2:A+T.width/2,on(z,f,H,u,Y)}},getDistance:function(X,e){var S=X.length;return e?3===S?T(f(X[0]-e[0])+f(X[1]-e[1])+f(X[2]-e[2])):2===S?T(f(X[0]-e[0])+f(X[1]-e[1])):X.z===K?T(f(e.x-X.x)+f(e.y-X.y)):T(f(e.x-X.x)+f(e.y-X.y)+f(e.z-X.z)):3===S?T(f(X[0])+f(X[1])+f(X[2])):2===S?T(f(X[0])+f(X[1])):void 0},brighter:function($,U){return 0>U&&(U=-U),Oo($,U?U:40)},darker:function(h,i){return i>0&&(i=-i),Oo(h,i?i:-40)},unionPoint:function(D,r){if(!D)return Z;if(2===arguments.length)return D&&r?{x:z(D.x,r.x),y:z(D.y,r.y),width:s(D.x-r.x),height:s(D.y-r.y)}:Z;var n=D;if(n._as&&(n=n._as),n.length===K)return Z;var H=n.length;if(0>=H)return Z;for(var V=1,b=n[0],l={x:b.x,y:b.y,width:0,height:0};H>V;V++){b=n[V];var k=z(l.x,b.x),g=E(l.x+l.width,b.x),X=z(l.y,b.y),v=E(l.y+l.height,b.y);l.x=k,l.y=X,l.width=g-k,l.height=v-X}return l},unionRect:function(O,L){if(O&&!L)return nh(O);if(!O&&L)return nh(L);if(O&&L){var H={x:z(O.x,L.x),y:z(O.y,L.y)};return H.width=E(O.x+O.width,L.x+L.width)-H.x,H.height=E(O.y+O.height,L.y+L.height)-H.y,H}return Z},containsPoint:function(c,u,d,D){if(D!=Z&&1!==D){var G=c.x+c.width/2,A=c.y+c.height/2;c={x:G-c.width/2*D,y:A-c.height/2*D,width:c.width*D,height:c.height*D}}if(d){var S=c.width/2,C=c.height/2,o=J(-d),Q=y(-d),j=u.x-c.x-S,h=u.y-c.y-C;return u={x:Q*j-o*h,y:o*j+Q*h},Um({x:-S,y:-C,width:c.width,height:c.height},u)}return!(!c||u.x<c.x||u.y<c.y||u.x>c.x+c.width||u.y>c.y+c.height)},containsRect:function(l,Y){if(!l||!Y)return!1;var e=Y.x,s=Y.y,T=Y.width,K=Y.height,Z=l.width,p=l.height;if(0>(Z|p|T|K))return!1;var L=l.x,u=l.y;if(L>e||u>s)return!1;if(Z+=L,T+=e,e>=T){if(Z>=L||T>Z)return!1}else if(Z>=L&&T>Z)return!1;if(p+=u,K+=s,s>=K){if(p>=u||K>p)return!1}else if(p>=u&&K>p)return!1;return!0},intersectsRect:function(I,w){if(!I||!w)return!1;var B=w.width,W=w.height,Z=I.width,q=I.height;if(0>=Z||0>=q||0>=B||0>=W)return!1;var z=w.x,F=w.y,G=I.x,o=I.y;return Z+=G,q+=o,B+=z,W+=F,Z>z&&q>F&&B>G&&W>o},intersection:function(F,d){if(!F||!d)return Z;var f=d.x,r=d.y,B=F.x,P=F.y,i=f,$=r,X=B,V=P;return i+=d.width,$+=d.height,X+=F.width,V+=F.height,B>f&&(f=B),P>r&&(r=P),i>X&&(i=X),$>V&&($=V),i-=f,$-=r,0>=i||0>=$?Z:{x:f,y:r,width:i,height:$}},grow:function(S,F,X){X===K&&(X=F),S.x-=F,S.y-=X,S.width=S.width+2*F,S.height=S.height+2*X},getScreenPoint:function(S,_,i,m,u,Y,y){var T,I,K=i.getBoundingClientRect(),W=S*(Y||1)+K.left-i.scrollLeft+(m||0),H=_*(y||1)+K.top-i.scrollTop+(u||0),f={x:W,y:H};return(T=i.parentElement)&&(I=T.maxtrixAppend)?I.applyInverse(f,{}):f},getLogicalPoint:function(J,T,o,G,Y,R){var M,p,m=T.getBoundingClientRect();J.target?(Ah(J)?Ub?te["91"]=!0:te["17"]=!0:Ub?te["91"]=!1:te["17"]=!1,te["16"]=Cd(J)?!0:!1,J=Jq?Kr(J):J,M=J.clientX,p=J.clientY):(M=J.x,p=J.y);var L,E;if((L=T.parentElement)&&(E=L.maxtrixAppend)){var Q=E.apply({x:M,y:p},{});
return Q.x=(Q.x+T.scrollLeft-(o||0))/(Y||1),Q.y=(Q.y+T.scrollTop-(G||0))/(R||1),Q}return{x:(M-m.left+T.scrollLeft-(o||0))/(Y||1),y:(p-m.top+T.scrollTop-(G||0))/(R||1)}},removeHTML:function(){var O;return function(P){return P&&P.getView&&(P=P.getView()),P&&P.parentNode?O===P?!0:(O=P,P.parentNode.removeChild(P),O=Z,!0):!1}}(),getToolTipDiv:function(){if(!Ag){Ag=Ti(),Ad=Ti();var H=Ag.style;M.baseZIndex!=Z&&(H.zIndex=l(M.baseZIndex)+3+""),H.whiteSpace="nowrap",H.color=M.toolTipLabelColor,H.background=M.toolTipBackground,H.font=M.toolTipLabelFont,H.padding="5px",H.boxShadow="0px 0px 3px "+M.toolTipShadowColor}return Ag},isToolTipShowing:function(){return Ag&&Ag.parentNode?!0:Ad&&Ad.parentNode?!0:!1},hideToolTip:function(){Xq(Ag),Xq(Ad),Uj()},showToolTip:function(Y,R){if(!Y||R==Z)return sf(),void 0;M.getToolTipDiv();var L,y;if(R.html?(R=R.html,L=Ad,Xq(Ag)):(L=Ag,Xq(Ad)),y=L.style,L.innerHTML=R,L.parentNode||k.Default.appendToScreen(L),Y.target){Y=Im(Y);var H=xi(),S=Y.x,c=Y.y,U=Jq?60:12;if(Jq){var G=L.getBoundingClientRect();y.left=S-G.width/2+rm,y.top=c-G.height-U<H.top?c+U+rm:c-G.height-U+rm}else{y.left=S+U+rm,y.top=c+U+rm;var G=L.getBoundingClientRect();G.left+G.width>H.width&&(y.left=S-U-G.width+rm),G.top+G.height>H.height&&(y.top=c-U-G.height+rm),G.left<0&&(y.left=S+U+rm),G.top<0&&(y.top=c+U+rm)}}else y.left=Y.x+rm,y.top=Y.y+rm;Uj()},startDragging:function(p,V,$){$==K&&($=!0),p!==Re&&(Re?$&&(Jq?Re.handleWindowTouchEnd(V):Re.handleWindowMouseUp(V)):Jq?(x.addEventListener(Fm,Jj,R),x.addEventListener(Aj,Hc,R)):(x.addEventListener(ti,wg,R),x.addEventListener(xq,zh,R)),Re=p)},getImageMap:function(){return Yo},toBoundaries:function(F,n,Q,B){var p=[];return Ch(F,n,Q,B).forEach(function(F){var h=[];F.forEach(function(l){h.push(l.x,l.y)}),p.push(h)}),p},getCurrentKeyCodeMap:function(){return te},drawCenterImage:function(w,J,B,M,m,h,D,r){var O=pr(J,m,h),C=Ne(J,m,h);mc(w,J,Q(B-O/2),Q(M-C/2),O,C,m,h,D,r)},drawStretchImage:function(x,t,_,k,U,g,E,h,R,D,s,q){var $,e=pr(t,h,R,g),M=Ne(t,h,R,E);"uniform"===_?($=z(g/e,E/M),e*=$,M*=$,k+=Q((g-e)/2),U+=Q((E-M)/2),g=e,E=M):"centerUniform"===_&&((e>g||M>E)&&($=z(g/e,E/M),e*=$,M*=$),k+=Q((g-e)/2),U+=Q((E-M)/2),g=e,E=M);var K=x.interactiveInfo;if(K){var o;if(o="center"===_?{x:k+g/2-e/2,y:U+E/2-M/2,width:e,height:M}:{x:k,y:U,width:g,height:E},K.rect){var n=K.compInfos,S=n.length;S&&(n[S-1].rect.image=t)}else K.rect=o}if("center"===_){var F=s!==!1&&(e>g||M>E);F&&(x.save(),x.beginPath(),x.rect(k,U,g,E),x.clip()),mc(x,t,k+g/2-e/2,U+E/2-M/2,e,M,h,R,D,q),F&&x.restore()}else mc(x,t,k,U,g,E,h,R,D,q)},toCanvas:function(z,A,y,L,f,R,d,e,k){z=Mk(z,d),A=A||pr(z,f),y=y||Ne(z,f);var t=Od(),_=Lf(t);return e?(Aq(t,A,y,e),_.scale(e,e)):Aq(t,A,y,1),Ri(_,z,L,0,0,A,y,f,R,d,k),z&&z.clampToEdge&&(t.clampToEdge=z.clampToEdge),_.restore(),t},toGrayColor:function(z){if(!z)return z;var m=re(z),p=.299*m[0]+.587*m[1]+.114*m[2];return"rgba("+p+","+p+","+p+","+m[3]/255+")"},createGradientImage:function(K,e,I,B){for(var V=["L",0,0,K,0,1,0,0,1,0,0],$=0,f=Math.min(e.length,I.length);f>$;$++)V.push(I[$],e[$]);var T=k.Default.toCanvas({width:K,height:K,clampToEdge:!0,comps:[{type:"shape",rotation:B||0,points:[0,0,K,0,K,K,0,K],background:"#ffffff",gradientPack:V}]});return T},createElement:function(q,i,x,B){var v=D.createElement(q);return Jg(v,i||c.widgetBorder,2),v.style.font=x?x:Hp,B!=Z&&(v.value=B),M.onElementCreated&&M.onElementCreated(v),v},containedInView:function(V,R){var P=or(R).getBoundingClientRect();return Um({x:P.left,y:P.top,width:P.width,height:P.height},bk(V))},isIsolating:function(){return Dg>0},setIsolating:function(J){J?Dg++:Dg--},getMSMap:function(){return gi},stringify:function(a,v){var h=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var p=JSON.stringify(a,function(t,b){return"function"==typeof b?"__ht__"+(b.__ht__||b.toString()):Zi(b)?Wg(b):b instanceof k.List?"__ht__list"+(b.__ht__list||M.stringify(b._as)):b},v==Z?2:v);return Date.prototype.toJSON=h,p},parse:function(H){return Gk(H)?JSON.parse(H,function(K,t){if(Gk(t))if("__ht__function"==t.substr(0,14)){var v=t.indexOf("{")+1,Q=t.lastIndexOf("}"),$=t.indexOf("(")+1,B=t.indexOf(")");if(v&&Q&&$&&B){var H=new Function(t.substring($,B),t.substring(v,Q));return H.__ht__=t.substr(6),H}}else{if("__ht__date"==t.substr(0,10))return new Date(l(t.substr(10)));if("__ht__list"===t.substr(0,10))return new $p(M.parse(t.substr(10)))}return t}):H},loadJS:function(x,o){o&&x.push(o);var S=x.shift();if(Sp(S))x=S.contact(x),M.loadJS(x);else if(Ck(S))S(),M.loadJS(x);else if(Gk(S)){var z=D.createElement("script");z.onload=function(){M.loadJS(x)},z.setAttribute("src",S),D.getElementsByTagName("head")[0].appendChild(z)}else x.length&&M.loadJS(x)},toRoundedCorner:function(c,Y){var S=c.size();if(0>=Y)return{points:c};var Z,l=new $p,b=new $p,p=c.get(0);l.add(p),b.add(1);for(var $=1;S>$;$++)if(S>$+1){var O=c.get($),t=c.get($+1),R=p.x,e=p.y,f=O.x,j=O.y,F=j-e,U=f-R,E=g(F,U);Z=z(.99*Qn(p,O),Y),l.add({x:f-Z*y(E),y:j-Z*J(E)}),l.add(O),R=O.x,e=O.y,f=t.x,j=t.y,F=j-e,U=f-R,E=g(F,U),Z=z(.99*Qn(O,t),Y),p={x:R+Z*y(E),y:e+Z*J(E)},l.add(p),b.addAll([2,3])}else l.add(c.get($)),b.add(2);return{points:l,segments:b}},toColorData:re,setCanvas:Aq,createDiv:Ti,createDisabledDiv:Sl,createView:nn,createCanvas:Od,appendChild:Xh,initContext:Lf,checkLoadingImage:Pl,translateAndScale:Nn,layout:ef,getPosition:vk,drawPoints:Le,drawRoundRect:Wd,drawBorder:Il,setFocus:Hl,getter:$d,setter:cf,isEmptyObject:us},!0),Bm(b,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Gn=M.disabledOpacity,Bo=M.toolTipDelay,vn=M.devicePixelRatio,mo=M.autoMakeVisible,Ae=M.autoHideScrollBar,$o=M.imageGradient,Pq=M.showToolTip,sf=M.hideToolTip,xs=M.dashPattern,Zd=M.lineCap,Cj=M.lineJoin,op=M.labelColor,xh=M.labelSelectColor,Hp=M.labelFont,ui=M.widgetIndent,Xl=M.widgetRowHeight,gn=M.widgetHeaderHeight,$r=M.widgetTitleHeight,Zb=M.scrollBarColor,fp=M.scrollBarSize,ds=M.scrollBarTimeout,Nk=M.scrollBarMinLength,Zn=M.scrollBarInteractiveSize,od=M.zoomIncrement,Rc=M.scrollZoomIncrement,eq=M.pinchZoomIncrement,dl=M.zoomMax,Cb=M.zoomMin,oh=M.createObject,xf=M.preventDefault,ii=M.setImage,Mk=M.getImage,ln=M.isImageComplete,gl=M.drawCenterImage,Ri=M.drawStretchImage,rh=M.getId,zj=M.callLater,Uo=M.sortFunc,nh=M.clone,jk=M.getClass,Ep=M.startAnim,um=M.brighter,Ab=M.darker,np=M.drawText,Dn=M.getTextSize,em=M.isLeftButton,Tm=M.getTouchCount,yn=M.isDoubleClick,Cd=M.isShiftDown,Ah=M.isCtrlDown,bk=M.getClientPoint,Im=M.getPagePoint,Qn=M.getDistance,Fp=M.unionPoint,Gi=M.unionRect,Um=M.containsPoint,ne=M.containsRect,xr=M.intersectsRect,Hr=M.intersection,xi=M.getWindowInfo,$l=M.grow,il=M.getLogicalPoint,zk=M.getScreenPoint,nf=M.startDragging,Xq=M.removeHTML,jj=M.createElement,pj=M.segmentResolution,Ye=M.shapeResolution,Ho=M.shapeSide,_p=M.def,to=function(k,K,r){_p(o+"."+k,K,r)},Qo=function(T,V){T.childNodes.forEach(function(p){V(p),Qo(p,V)})};Bm(M,{toolTipLabelColor:op,toolTipLabelFont:Hp,toolTipBackground:c.toolTipBackground,toolTipShadowColor:yr,drawBreakableText:pk,setDevicePixelRatio:function(N){vn=M.devicePixelRatio="number"==typeof N?N:x.devicePixelRatio,Qo(D.body,function(K){var z=K._ht;z&&z._canvas&&(Aq(z._canvas,z.getWidth(),z.getHeight()),z.redraw?z.redraw():z.iv())})}},!0);var ns=1e-6,pb="undefined"!=typeof Uint16Array?Uint16Array:Array,Wp="undefined"!=typeof Float32Array?Float32Array:Array,xo=function(C,A,p){var J=[C[0]-A[0],C[1]-A[1],C[2]-A[2]];if(p){var M=Qn(J);M>0&&(J[0]/=M,J[1]/=M,J[2]/=M)}return J},As=function(){var D="charCodeAt",p=2*(2*vo.length+1);for(var R in x)if(R===o+Wf[0]+rm.length){var V=x[R];if(!V)break;for(var G=V.length,i=0;G>i;i++)if(V[i][D](0)===p&&V[i+1]!=Z&&V[i+1]===rm[0]&&V[i+2]!=Z&&V[i+2][D](0)===p){for(var N=i+3;G>N;N++)if(V[N][D](0)===p){if(0==V[N+1])for(var v,z=N+2;G>z;z++){if(V[z][D](0)===p){0==V[z-1]&&v&&(u=v.substr(0,v.length-1));break}v==Z?v=V[z]:v+=V[z]}break}break}break}return function(U){return[-U[0],-U[1],-U[2]]}}(),Zo=function(R,M){return 3===R.length?R[0]*M[0]+R[1]*M[1]+R[2]*M[2]:R[0]*M[0]+R[1]*M[1]},Zg=function(){var a=new Wp(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},_e=Zg(),uo=function(i){var U=new Wp(16);return U[0]=i[0],U[1]=i[1],U[2]=i[2],U[3]=i[3],U[4]=i[4],U[5]=i[5],U[6]=i[6],U[7]=i[7],U[8]=i[8],U[9]=i[9],U[10]=i[10],U[11]=i[11],U[12]=i[12],U[13]=i[13],U[14]=i[14],U[15]=i[15],U},jd=function(F,Z){return F[0]=Z[0],F[1]=Z[1],F[2]=Z[2],F[3]=Z[3],F[4]=Z[4],F[5]=Z[5],F[6]=Z[6],F[7]=Z[7],F[8]=Z[8],F[9]=Z[9],F[10]=Z[10],F[11]=Z[11],F[12]=Z[12],F[13]=Z[13],F[14]=Z[14],F[15]=Z[15],F},$q=function(W){return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=1,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=1,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},jq=function(u,r){var o=u[0],i=u[1],A=u[2];return u[0]=r[0]*o+r[4]*i+r[8]*A+r[12],u[1]=r[1]*o+r[5]*i+r[9]*A+r[13],u[2]=r[2]*o+r[6]*i+r[10]*A+r[14],u},Xb=function(o,p){var w=o[0],N=o[1],_=o[2],I=o[3];return o[0]=p[0]*w+p[4]*N+p[8]*_+p[12]*I,o[1]=p[1]*w+p[5]*N+p[9]*_+p[13]*I,o[2]=p[2]*w+p[6]*N+p[10]*_+p[14]*I,o[3]=p[3]*w+p[7]*N+p[11]*_+p[15]*I,o},ep=function(){var q,p,K,U,O=zr(Wh[1]+Wh[7]),E=zr(Wh[0]+Wh[3]-Wh[10]),j=zr(Wh[8]+2),g=function(){return p=K.charAt(q),q+=1,p},f=function(){var h="";if(p===j)for(;g();){if(p===j)return g(),h;h+=p}else g()},B=function(){for(;p&&" ">=p;)g()},d=function(){var A,F={};if(p===O){if(g(),B(),p===E)return g(),F;for(;p;){if(A=f(),B(),g(),F[A]=U(),B(),p===E)return g(),F;g(),B()}}};return U=function(){switch(B(),p){case O:return d();default:return f()}},function(g){if(h={},g){var Q;if(K=g,q=0,p=" ",Q=U(),B(),!p)return Q}}}(),Ih=function(P,$){if($){var f=J($),U=y($),O=P[4],N=P[5],_=P[6],W=P[7],T=P[8],m=P[9],Y=P[10],k=P[11];P[4]=O*U+T*f,P[5]=N*U+m*f,P[6]=_*U+Y*f,P[7]=W*U+k*f,P[8]=T*U-O*f,P[9]=m*U-N*f,P[10]=Y*U-_*f,P[11]=k*U-W*f}},Rk=function(A,M){if(M){var c=J(M),g=y(M),w=A[0],K=A[1],$=A[2],L=A[3],T=A[8],W=A[9],r=A[10],t=A[11];A[0]=w*g-T*c,A[1]=K*g-W*c,A[2]=$*g-r*c,A[3]=L*g-t*c,A[8]=w*c+T*g,A[9]=K*c+W*g,A[10]=$*c+r*g,A[11]=L*c+t*g}},sp=function(c,z){if(z){var Y=J(z),n=y(z),t=c[0],H=c[1],v=c[2],N=c[3],o=c[4],d=c[5],L=c[6],q=c[7];c[0]=t*n+o*Y,c[1]=H*n+d*Y,c[2]=v*n+L*Y,c[3]=N*n+q*Y,c[4]=o*n-t*Y,c[5]=d*n-H*Y,c[6]=L*n-v*Y,c[7]=q*n-N*Y}},go=function(D,Q,n){return Jh(Z,n===!1?Z:D.getFinalScale3d(),D.getFinalRotation3d(),D.getRotationMode(),D.p3(),Z,Q)},Jh=function(A,W,k,u,r,w,P){return w||(w=Zg()),r&&Ql(w,r),Dh(w,k,u),P&&bn(w,w,P),W&&vb(w,W),A&&bn(w,w,A),w},xd=function(j,B,d){B=l(B),d=l(d);var P=this;P.g=j,P._84O=B,P._85O=d,P._70I=!0,P.F=0,P._83O=B+d,P.pen={x:0,y:0}},fm="lineDashOffset",Yh="setLineDash",rl=function(f){for(var p in f)1===p.length&&(fm=f[p]);return p?1:0},Wi=function(B,w,k){return wk(w)?B:B[Yh]?(B[Yh](w),k&&(B.lineDashOffset=k),B):new xd(B,w[0],w.length>1?w[1]:w[0])},eh=function(z,J){!wk(J)&&z[Yh]&&(z[Yh](ah),z.lineDashOffset=0)};if(_p(xd,C,{_69I:6,moveTo:function(E,p){var W=this,M=W.pen;M.x=E,M.y=p,W.g.moveTo(E,p),W.start||(W.start={x:E,y:p})},lineTo:function(n,W){var A=this,Q=A.pen,T=n-Q.x,b=W-Q.y,V=g(b,T),E=y(V),_=J(V),q=A._23O(Q.x,Q.y,n,W),z=A._85O,s=A._84O,C=A._83O;if(A.F){if(A.F>q)return A._70I?A._72I(n,W):A.moveTo(n,W),A.F-=q,void 0;if(A._70I?A._72I(Q.x+E*A.F,Q.y+_*A.F):A.moveTo(Q.x+E*A.F,Q.y+_*A.F),q-=A.F,A.F=0,A._70I=!A._70I,!q)return}var e=v(q/C);if(e){for(var D=E*s,r=_*s,w=E*z,H=_*z,l=0;e>l;l++)A._70I?(A._72I(Q.x+D,Q.y+r),A.moveTo(Q.x+w,Q.y+H)):(A.moveTo(Q.x+w,Q.y+H),A._72I(Q.x+D,Q.y+r));q-=C*e}A._70I?q>s?(A._72I(Q.x+E*s,Q.y+_*s),A.moveTo(n,W),A.F=z-(q-s),A._70I=!1):(A._72I(n,W),q===s?(A.F=0,A._70I=!A._70I):(A.F=s-q,A.moveTo(n,W))):q>z?(A.moveTo(Q.x+E*z,Q.y+_*z),A._72I(n,W),A.F=s-(q-z),A._70I=!0):(A.moveTo(n,W),q===z?(A.F=0,A._70I=!A._70I):A.F=z-q)},quadraticCurveTo:function(M,y,Y,E){var C,q=this,u=q.pen,N=u.x,T=u.y,K=q._22O(N,T,M,y,Y,E),R=0,W=0,P=q._85O,S=q._84O;if(q.F){if(q.F>K)return q._70I?q._71I(M,y,Y,E):q.moveTo(Y,E),q.F-=K,void 0;if(R=q.F/K,C=q._20O(N,T,M,y,Y,E,R),q._70I?q._71I(C[2],C[3],C[4],C[5]):q.moveTo(C[4],C[5]),q.F=0,q._70I=!q._70I,!K)return}var r=K-K*R,G=v(r/q._83O),c=S/K,B=P/K;if(G)for(var z=0;G>z;z++)q._70I?(W=R+c,C=q._21O(N,T,M,y,Y,E,R,W),q._71I(C[2],C[3],C[4],C[5]),R=W,W=R+B,C=q._21O(N,T,M,y,Y,E,R,W),q.moveTo(C[4],C[5])):(W=R+B,C=q._21O(N,T,M,y,Y,E,R,W),q.moveTo(C[4],C[5]),R=W,W=R+c,C=q._21O(N,T,M,y,Y,E,R,W),q._71I(C[2],C[3],C[4],C[5])),R=W;r=K-K*R,q._70I?r>S?(W=R+c,C=q._21O(N,T,M,y,Y,E,R,W),q._71I(C[2],C[3],C[4],C[5]),q.moveTo(Y,E),q.F=P-(r-S),q._70I=!1):(C=q._19O(N,T,M,y,Y,E,R),q._71I(C[2],C[3],C[4],C[5]),K===S?(q.F=0,q._70I=!q._70I):(q.F=S-r,q.moveTo(Y,E))):r>P?(W=R+B,C=q._21O(N,T,M,y,Y,E,R,W),q.moveTo(C[4],C[5]),C=q._19O(N,T,M,y,Y,E,W),q._71I(C[2],C[3],C[4],C[5]),q.F=S-(r-P),q._70I=!0):(q.moveTo(Y,E),r===P?(q.F=0,q._70I=!q._70I):q.F=P-r)},bezierCurveTo:function(){var k=arguments;this.pen={x:k[4],y:k[5]},this.g.bezierCurveTo(k[0],k[1],k[2],k[3],k[4],k[5])},arc:function(t,S,x,$,P,m){m||($=-$,P=-P),dr(this,t,S,$,P-$,x,x,!1)},rect:function(P,s,F,D){var T=this;T.pen={x:P,y:s},T.moveTo(P,s),T.lineTo(P,s+D),T.lineTo(P+F,s+D),T.lineTo(P+F,s),T.lineTo(P,s)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(V,n,v,N){var x=v-V,y=N-n;return T(x*x+y*y)},_22O:function(e,I,n,S,z,t,q){for(var Z,X,k,P,C,J,N,m=0,Y=e,$=I,T=q>0?q:this._69I,v=1;T>=v;v++)k=v/T,P=1-k,C=P*P,J=2*k*P,N=k*k,Z=C*e+J*n+N*z,X=C*I+J*S+N*t,m+=this._23O(Y,$,Z,X),Y=Z,$=X;return m},_21O:function(M,L,y,m,P,F,n,c){var p=this;if(0===n)return p._20O(M,L,y,m,P,F,c);if(1===c)return p._19O(M,L,y,m,P,F,n);var D=p._20O(M,L,y,m,P,F,c);return D.push(n/c),p._19O.apply(p,D)},_20O:function(O,C,c,w,h,H,X){if(1!==X){var p=c+(h-c)*X,L=w+(H-w)*X;c=O+(c-O)*X,w=C+(w-C)*X,h=c+(p-c)*X,H=w+(L-w)*X}return[O,C,c,w,h,H]},_19O:function(k,y,q,X,A,_,M){if(1!==M){var V=k+(q-k)*M,P=y+(X-y)*M;q+=(A-q)*M,X+=(_-X)*M,k=V+(q-V)*M,y=P+(X-P)*M}return[k,y,q,X,A,_]},_72I:function(c,p){var G=this.pen;(c!==G.x||p!==G.y)&&(G.x=c,G.y=p,this.g.lineTo(c,p))},_71I:function(I,J,u,k){var p=this.pen;(I!==u||J!==k||u!==p.x||k!==p.y)&&(p.x=u,p.y=k,this.g.quadraticCurveTo(I,J,u,k))}}),e&&L){var tm=L.toString();U=tm.indexOf(Xr.substr(0,2))>0&&tm.indexOf(uc+uc.substr(1,1))>1||tm.indexOf($f.substr(0,2)+Xr.substr(2,2)+Wf[0]+Xr[4])>1?!0:!1}var dm=Z,je=Z,Hb=function(d){dm&&!d._72O&&(je||(je={}),je[d._72O=rh()]=d)},ke=function(t,k){if(k||(k=t),k&&(dm||(dm={}),!dm[t])){var B=new Lo;if(dm[k]={request:B,url:k},k=M.beforeLoadURL(k),k.data){var m=M.parse(k.data);Iq(t,m),M.handleCompTypeLoaded(t,m)}else{B.onload=function(A){if(200===this.status||0===this.status){var W=M.parse(A.target.response||A.target.responseText);Iq(t,W),M.handleCompTypeLoaded(t,W)}else Iq(t,Z)},B.onerror=function(){Iq(t,Z)};var j={};j.url=encodeURI(k),j.sync=!1,B.send(j)}}},Iq=function(p,d){if(xe[p]=d,delete dm[p],us(dm)&&(dm=Z,je)){for(var E in je){var G=je[E];G.invalidateAll&&G.invalidateAll(K,"compTypeLoaded",p),G.redraw&&G.redraw(),G.iv(),delete G._72O}je=Z}if(d&&je)for(var E in je){var G=je[E];G.invalidateAll&&G.invalidateAll(K,"compTypeLoading",p),G.redraw&&G.redraw(),G.iv()}},cp=c.chart,gk=M.compStack=[],Vn=/^style@/,Md=/^attr@/,Gd=/^field@/,Ar={x:.5,y:.5},pr=function(W,o,r,g){if(!W)return 0;if(Vc(W.fitSize,o,r)&&g)return g;var M=Vc(W.width,o,r);return null==M?20:M},Ne=function(J,S,E,b){if(!J)return 0;if(Vc(J.fitSize,S,E)&&b)return b;var l=Vc(J.height,S,E);return null==l?20:l},Vc=function(w,N,L){if(!w||!w.func)return w;var j,b=w.func,E=w.value;return j=Ck(b)?L&&L.vectorDataBindingDisabled&&!w.isSafeFunc?E:b(N,L):N instanceof Er?Md.test(b)?N.a(b.slice(5)):Vn.test(b)?N.s(b.slice(6)):Gd.test(b)?N[b.slice(6)]:N[b]?N[b](L):E:E,E!==K&&j==Z?E:j},mc=M.drawImage=function(){var i,O,C,I,W,o,Y=function(U,F){U.getValue&&U.getValue.compType===F||(U.getValue=function(D){var P=N(U,D);if(P===K&&F.properties){var v=F.properties[D];v&&(P=v.defaultValue)}return P},U.getValue.compType=F)},N=function(m,H,E){var I=m[H];return I&&I.func?(I=Vc(I,O,C),E&&(I=E(I))):E&&(I=m[H]=E(I)),I},k=function(Y,O){var r;if(r=O?N(Y,O):Y,i&&i.compGray&&r)return M.toGrayColor(r);if(W&&r){if("override"===o)return W;if("override_rgb"===o){var V=Tj(W);return r=re(r),"rgba("+v(255*V[0])+","+v(255*V[1])+","+v(255*V[2])+","+r[3]/255+")"}if("override_a"===o){var V=Tj(W);return r=re(r),"rgba("+r[0]+","+r[1]+","+r[2]+","+V[3]+")"}var V=Tj(W);return r=re(r),"rgba("+v(r[0]*V[0])+","+v(r[1]*V[1])+","+v(r[2]*V[2])+","+r[3]/255*V[3]+")"}return r},w=function(L){if(Sp(L)){for(var i=new $p,W=L.length,e=0;W>e;e+=2)i.add({x:L[e],y:L[e+1]});L=i}return L},_=function(I){var C=N(I,"anchorX"),X=N(I,"anchorY");if(C!==K||X!==K)return{x:C===K?Ar.x:C,y:X===K?Ar.y:X};var u=N(I,"type"),B=N(I,"name");if("image"!==u||!B)return Ar;var Y=Mk(B);return Y&&Y.anchorX!==K&&Y.anchorY!==K?{x:Y.anchorX,y:Y.anchorY}:Ar},P=function(K,p){var d=N(K,Kb),x=_(K);if(Sp(d)){var u=d.length,z=N(K,"relative"),L=p.width,D=p.height;if(4===u)d={x:d[0],y:d[1],width:d[2],height:d[3]},z&&(d.x*=L,d.y*=D,d.width*=L,d.height*=D);else if(3===u){var R=d[0];d={width:d[1],height:d[2]},z&&(d.width*=L,d.height*=D),"object"==typeof R?R.length&&(R={x:R[0],y:R[1]}):R=vk(R,p,d),d.x=R.x-d.width*x.x,d.y=R.y-d.height*x.y}d.x+=N(K,"offsetX")||0,d.y+=N(K,"offsetY")||0,!z&&p.fitSize&&(d=c(K,d,p))}return d},c=function(K,j,x){if(j){var D,q,b,E={x:j.x,y:j.y,width:j.width,height:j.height},t=_(K),F=N(K,"layoutH"),r=N(K,"layoutV"),y=1,S=1,H=0,m=0,Y=1,i=1;switch(F){case"left":break;case"right":E.x+=x.width-x.rw;break;case"center":E.x+=.5*(x.width-x.rw);break;case"scale":case"leftright":default:D=N(K,Zp)||0,D&&(H=Math.abs(m=Math.sin(D)),Y=Math.abs(i=Math.cos(D))),"leftright"!==F?(y+=Y*(x.widthScale-1),S+=H*(x.widthScale-1)):(y+=Y*(x.width-x.rw)/E.width,S+=H*(x.width-x.rw)/E.height,q=-Math.min(-t.x*i+t.y*m,-t.x*i-(1-t.y)*m,(1-t.x)*i+t.y*m,(1-t.x)*i-(1-t.y)*m))}switch(r){case"top":break;case"bottom":E.y+=x.height-x.rh;break;case"center":E.y+=.5*(x.height-x.rh);break;case"scale":case"topbottom":default:D==Z&&(D=N(K,Zp),D&&(H=Math.abs(m=Math.sin(D)),Y=Math.abs(i=Math.cos(D)))),"topbottom"!==r?(y+=H*(x.heightScale-1),S+=Y*(x.heightScale-1)):(y+=H*(x.height-x.rh)/E.width,S+=Y*(x.height-x.rh)/E.height,b=-Math.min(-t.x*m-t.y*i,-t.x*m+(1-t.y)*i,(1-t.x)*m-t.y*i,(1-t.x)*m+(1-t.y)*i))}return(1!==y||1!==S)&&("scale"!==F&&F?"leftright"===F&&(E.x+=E.width*(1-y)*t.x+q*(x.width-x.rw)):E.x+=E.x*(x.widthScale-1)+t.x*E.width*(x.widthScale-y),"scale"!==r&&r?"topbottom"===r&&(E.y+=E.height*(1-S)*t.y+b*(x.height-x.rh)):E.y+=E.y*(x.heightScale-1)+t.y*E.height*(x.heightScale-S),E.width*=y,E.height*=S),E}},p=function(h){return Sp(h)?new $p(h):h},D=function(v,w,n,f,l,a,e){var P=i.interactiveInfo,g=v.transform;if(g)return i.save(),i.setTransform(g.a,g.b,g.c,g.d,g.tx,g.ty),P&&P.compInfos.push({comp:v,rect:w,matrix:g.clone()}),!0;l===K&&(l=1),a===K&&(a=1);var j=N(v,"clipPercentage"),b=ul(n,w);if(b&&!f&&1===l&&1===a&&!(1>j))return P&&P.compInfos.push({comp:v,rect:w,matrix:P.matrix.clone()}),!1;e=e||Ar;var H=w.x+w.width*e.x,E=w.y+w.height*e.y,B=n.x+n.width*e.x,T=n.y+n.height*e.y,X=n.width?l*(w.width/n.width):1,O=n.height?a*(w.height/n.height):1;if(i.save(),P&&(P.matrix.appendTranslate(H,E).appendRotate(f).appendScale(X,O).appendTranslate(-B,-T),P.compInfos.push({comp:v,rect:w,matrix:P.matrix.clone()})),Kn(i,H,E),Tc(i,f||0),Zf(i,X,O),Kn(i,-B,-T),1>j){0>j&&(j=0);var D=lj(n,N(v,"clipDirection"),j);i.beginPath(),i.rect(D.x,D.y,D.width,D.height),i.clip()}return!0},A=function(){i.restore()},j=function(Y,F,M){var b=N(Y,"path"),n=N(Y,Zp),d=N(Y,"scaleX"),c=N(Y,"scaleY"),G=_(Y),u=Z,p=qj(null,b);if(M||(M=Y.unionRect,M||(M=Fp(p),Y.path.func||(Y.unionRect=M)),u=M),M){u||(u=Y.unionRect,u||(u=Fp(p),Y.path.func||(Y.unionRect=u)));var f=D(Y,M,u,n,d,c,G),v=N(Y,"borderPattern"),o=Wi(i,v),h=k(Y,"background"),S=k(Y,"borderColor"),z=N(Y,"borderWidth"),E=N(Y,"gradient"),m=k(Y,"gradientColor"),$=N(Y,"border3d"),q=N(Y,"border3dColor"),g=N(Y,"border3dAccuracy"),U=i.lineJoin,e=i.lineCap;if(i.lineJoin=N(Y,"borderJoin")||Cj,i.lineCap=N(Y,"borderCap")||Zd,h?(nc(i,h,E,m,u),qj(i,b),i.fill(),o!==i&&qj(i,b)):qj(i,b),z&&S){var X=N(Y,"borderWidthAbsolute");X&&(i.save(),i.setTransform(1,0,0,1,0,0)),i.lineWidth=z,i.strokeStyle=S,i.stroke(),X&&i.restore(),$&&gj(i,S,q,z,I,g)}if(eh(i,v),N(Y,"dash")){var L=N(Y,"dashWidth")||z;if(L>0){v=N(Y,"dashPattern")||xs;var o=Wi(i,v,N(Y,"dashOffset")),j=k(Y,"dashColor")||k(al);o!==i&&qj(i,b),i.strokeStyle=j,i.lineWidth=L,i.stroke(),N(Y,"dash3d")&&gj(i,j,k(Y,"dash3dColor"),L,I,N(Y,"dash3dAccuracy")),eh(i,v)}}F===Kb&&Mr(i,h,N(Y,"depth"),u),i.lineJoin=U,i.lineCap=e,f&&A()}},r=function(l,u,z,q){var Y=N(l,li,w),x=N(l,Zp),X=_(l);if(Y&&q.fitSize){var n=new $p,K=Fp(Y),V=c(l,K,q),J=K.x+X.x*K.width,P=K.y+X.y*K.height,e=V.x+X.x*V.width,F=V.y+X.y*V.height,E=V.width/K.width,b=V.height/K.height;Y.each(function(a){n.add({x:e+(a.x-J)*E,y:F+(a.y-P)*b})}),Y=n,l.unionRect=null}var U=N(l,"scaleX"),B=N(l,"scaleY"),m=u===Bd,T=Z;if(!z&&m&&(z=l.unionRect,z||(z=Fp(Y),l.points.func||(l.unionRect=z)),T=z),z){m?T||(T=l.unionRect,T||(T=Fp(Y),l.points.func||(l.unionRect=T))):T=z;var r,S,H,$,Q=D(l,z,T,x,U,B,X),L=N(l,"borderPattern"),d=Wi(i,L),t=k(l,"background"),y=Mk(N(l,"repeatImage"),W,o),s=N(l,"gradientPack"),g=k(l,"borderColor"),v=N(l,"borderWidth"),G=N(l,"segments",p),R=N(l,"gradient"),h=k(l,"gradientColor"),j=N(l,"border3d"),f=N(l,"border3dColor"),a=N(l,"border3dAccuracy"),M=N(l,"closePath"),Nr=N(l,"fillRule")||"nonzero",Cq=i.lineJoin,Hc=i.lineCap;if(i.lineJoin=N(l,"borderJoin")||Cj,i.lineCap=N(l,"borderCap")||Zd,m)if(t||y||s){var ab=N(l,"fillClipPercentage");if(1>ab){0>ab&&(ab=0);var mg=lj(T,N(l,"fillClipDirection"),ab);i.save(),i.beginPath(),i.rect(mg.x,mg.y,mg.width,mg.height),i.clip()}if(Le(i,Y,G,M),s)Df(i,s);else if(y){var ei=i,Pi=W,Lq=o;eb(i,y,W,o,O,C),i=ei,W=Pi,o=Lq}else{var ei=i;nc(i,t,R,h,T),i=ei}i.fill(Nr),1>ab&&i.restore(),s&&i.restore(),d!==i&&Le(d,Y,G,M)}else Le(d,Y,G,M);else if("roundRect"===u?r=N(l,"cornerRadius"):"polygon"===u?r=N(l,"polygonSide"):"arc"===u&&(r=N(l,"arcFrom"),S=N(l,"arcTo"),H=N(l,"arcClose"),$=N(l,"arcOval")),t||y||s){var ab=N(l,"fillClipPercentage");if(1>ab){0>ab&&(ab=0);var mg=lj(T,N(l,"fillClipDirection"),ab);i.save(),i.beginPath(),i.rect(mg.x,mg.y,mg.width,mg.height),i.clip()}if(ch(i,u,T,r,S,H,$),s)Df(i,s);else if(y){var ei=i,Pi=W,Lq=o;eb(i,y,W,o,O,C),i=ei,W=Pi,o=Lq}else nc(i,t,R,h,T);i.fill(Nr),1>ab&&i.restore(),s&&i.restore(),i!==d&&ch(d,u,T,r,S,H,$)}else ch(d,u,T,r,S,H,$);if(v&&g){var vm=N(l,"borderWidthAbsolute");vm&&(i.save(),i.setTransform(1,0,0,1,0,0)),i.lineWidth=v,i.strokeStyle=g,i.stroke(),vm&&i.restore(),j&&gj(i,g,f,v,I,a)}if(eh(i,L),N(l,"dash")){var Ml=N(l,"dashWidth")||v;if(Ml>0){L=N(l,"dashPattern")||xs;var d=Wi(i,L,N(l,"dashOffset")),Rp=k(l,"dashColor")||k(al);d!==i&&(m?Le(d,Y,G,M):ch(d,u,T,r,S,H,$)),i.strokeStyle=Rp,i.lineWidth=Ml,i.stroke(),N(l,"dash3d")&&gj(i,Rp,k(l,"dash3dColor"),Ml,I,N(l,"dash3dAccuracy")),eh(i,L)}}u===Kb&&Mr(i,t,N(l,"depth"),T),i.lineJoin=Cq,i.lineCap=Hc,Q&&A()}},t=function(m,A){var E=W,y=o,R=W||N(m,Mf),M=o||N(m,"blendMode"),j=Mk(N(m,"name"),R,M);j&&(Ri(i,j,N(m,"stretch"),A.x,A.y,A.width,A.height,O,C,R,null,M),W=E,o=y)},g=function(F,U){var O=N(F,"text");O!=Z&&np(i,O,N(F,"font"),k(F,Mf),U.x,U.y,U.width,U.height,N(F,"align"),N(F,"vAlign"))},q=function($,P){Il(i,k($,Mf),P.x,P.y,P.width,P.height,N($,"width"))},h=function(I,f){var q=N(I,rc),l=0;if(q&&(q.forEach(function(i){l+=i}),l>0)){for(var c=N(I,"colors")||cp,X=N(I,"startAngle")||0,H=N(I,"hollow"),s=N(I,Fe),u=N(I,rr),F=N(I,Bl),M=s?new $p:Z,_=f.x,Q=f.y,b=f.width,S=f.height,w=_+b/2,n=Q+S/2,C=z(b,S)/2,E=0,W=0;W<q.length;W++){var V=q[W],j=G*V/l,a=X+j;if(i.fillStyle=c[E++],E===c.length&&(E=0),i.beginPath(),H){var p=w+y(X)*C/2,k=n+J(X)*C/2,o=w+y(a)*C,e=n+J(a)*C;i.moveTo(p,k),i.arc(w,n,C/2,X,a,!1),i.lineTo(o,e),i.arc(w,n,C,a,X,!0)}else i.moveTo(w,n),i.arc(w,n,C,a,X,!0);M&&(j=(X+a)/2,M.add({text:Ck(s)?s(V,W,l,O):V,x:w+.75*y(j)*C,y:n+.75*J(j)*C})),i.closePath(),i.fill(),X=a}M&&M.each(function(L){np(i,L.text,u,F,L.x,L.y,0,0,Lh)})}},l=function(W,X){var H=N(W,Gr);if(H&&H.length>0){var h=H.length,p=N(W,Fe),Q=N(W,rr),D=N(W,Bl),c=p?new $p:Z,w=N(W,"minValue")||0,V=N(W,"maxValue");if(V==Z&&(V=0,H.forEach(function(m){N(m,rc).forEach(function(k){V=E(V,k)})})),w===V)return;for(var f=X.height/(V-w),u=X.y+V*f,d=N(H[0],rc).length,L=X.width/(3*d+1),n=2*L/h,k=0,m=0;h>m;m++)for(var T=H[m],t=N(T,Mf),a=N(T,"colors"),q=N(T,rc),e=0;d>e;e++){a?i.fillStyle=a[e]:t?i.fillStyle=t:(i.fillStyle=cp[k++],k===cp.length&&(k=0));var I=q[e],J=I*f,z=X.x+(1+3*e)*L+m*n;if(Rf(i,z,u-J,n,J),c){var F=Ck(p)?p(I,e,T,O):I,l=Dn(Q,F).height;c.add({x:z,y:u-J-l,width:n,height:l,text:F})}}c&&c.each(function(h){np(i,h.text,Q,D,h.x,h.y,h.width,h.height,Lh)})}},f=function(o,a){var h=N(o,Gr);if(h&&h.length>0){var H=h.length,g=N(h[0],rc).length,Y=a.width/(3*g+1),e=0,j=N(o,"maxValue"),k=N(o,Fe),M=N(o,rr),r=N(o,Bl),C=k?new $p:Z;if(j==Z){j=0;for(var A=0;g>A;A++){for(var x=0,P=0;H>P;P++)x+=N(h[P],rc)[A];j=E(j,x)}}if(j>0){for(var A=0;g>A;A++)for(var m=a.y+a.height,P=0;H>P;P++){var p=h[P],J=N(p,Mf),Q=N(p,rc)[A],I=Q/j*a.height;J?i.fillStyle=J:(i.fillStyle=cp[e++],e===cp.length&&(e=0)),m-=I;var R={x:a.x+(1+3*A)*Y,y:m,width:2*Y,height:I};Rf(i,R.x,R.y,R.width,R.height),C&&(R.text=Ck(k)?k(Q,A,p,O):Q,C.add(R))}C&&C.each(function(e){np(i,e.text,M,r,e.x,e.y,e.width,e.height,Lh)})}}},Q=function(P,S){var o=N(P,Gr);if(o&&o.length>0){for(var w=o.length,h=N(o[0],rc).length,r=S.width/(3*h+1),K=0,D=N(P,Fe),u=N(P,rr),j=N(P,Bl),A=D?new $p:Z,M=0;h>M;M++){for(var k=0,$=0;w>$;$++)k+=N(o[$],rc)[M];if(k>0){var m=S.y+S.height;for($=0;w>$;$++){var t=o[$],n=N(t,Mf),b=N(t,rc)[M],I=b/k*S.height;n?i.fillStyle=n:(i.fillStyle=cp[K++],K===cp.length&&(K=0)),m-=I;var Y={x:S.x+(1+3*M)*r,y:m,width:2*r,height:I};Rf(i,Y.x,Y.y,Y.width,Y.height),A&&(Y.text=Ck(D)?D(b,M,t,O):b,A.add(Y))}}}A&&A.each(function(G){np(i,G.text,u,j,G.x,G.y,G.width,G.height,Lh)})}},b=function(P,C){var p=N(P,Gr);if(p&&p.length>0){var v=p.length,D=N(P,"minValue")||0,F=N(P,"maxValue");if(F==Z&&(F=0,p.forEach(function(S){N(S,rc).forEach(function(z){F=E(F,z)})})),D===F)return;for(var s=C.height/(F-D),B=C.y+F*s,Y=N(p[0],rc).length,a=C.width/(3*Y+1),z=0,u=N(P,"lineWidth")||2,r=N(P,"line3d"),x=N(P,"linePoint"),m=N(P,Fe),j=N(P,rr),L=N(P,Bl),n=0;v>n;n++){var A=p[n],S=N(A,Mf),l=N(A,rc);S?i.strokeStyle=S:(S=i.strokeStyle=cp[z++],z===cp.length&&(z=0)),i.beginPath();for(var d=0;Y>d;d++){var g=C.x+(2+3*d)*a,w=B-l[d]*s;0===d?i.moveTo(g,w):i.lineTo(g,w)}if(i.lineWidth=u,i.stroke(),r&&gj(i,S,Z,u,I),x||m){var U,k=u/2+2;for(d=0;Y>d;d++){var M=l[d];if(g=C.x+(2+3*d)*a,w=B-M*s,Ck(x)?x(i,g,w,S,d,A,O):x&&(i.fillStyle=S,i.beginPath(),i.arc(g,w,k,0,G,!0),i.fill()),Ck(m)?U=m(M,d,A,O):m&&(U=M),U){var t=Dn(j,U).height,K=i.shadowBlur;if(K){var H=i.shadowOffsetX,W=i.shadowOffsetY,T=i.shadowColor;i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,i.shadowColor=Z}np(i,U,j,L,g,w-t-k+2,0,t,Lh),K&&(i.shadowOffsetX=H,i.shadowOffsetY=W,i.shadowBlur=K,i.shadowColor=T)}}}}}},m=function(){i=null,O=null,C=null},V={border:q,image:t,text:g,pieChart:h,columnChart:l,stackedColumnChart:f,percentageColumnChart:Q,lineChart:b};return function(B,R,t,c,J,l,q,v,s,z){if(R&&J&&l){var h=i?!1:!0;i=B,O=q,C=v,I=C?C._zoom?C._zoom:1:1,W=s,o=z;var b=J,Q=l;if(Dl()){var L,S,F;0===i[pg]?Dl[0]&&(L=!0):L=!0,i.texureImage2D?Dl[1]&&(S=!0):S=!0,i.texureImage3D?Dl[2]&&(F=!0):F=!0,L&&S&&F&&(b=t,Q=c)}if(R.tagName)return Gk(u)&&!x[u]||i.drawImage(R,b,Q,J,l),h&&m(),void 0;if(N(R,"visible")===!1)return h&&m(),void 0;W||(W=Vc(R.color,O,C)),z||(o=Vc(R.blendMode,O,C)),Gk(u)&&!x[u]&&(J=b,l=Q);var n=pr(R,O,C,J),$=Ne(R,O,C,l),E={x:0,y:0,width:n,height:$,fitSize:N(R,"fitSize")},f=N(R,"clip"),g=N(R,"opacity");if(E.fitSize){var e=E.rw=Vc(R.width,O,C)||20;E.widthScale=n/e;var X=E.rh=Vc(R.height,O,C)||20;E.heightScale=$/X}if(i.save(),i.interactiveInfo){var d=i.interactiveInfo.matrix,y=d.clone();d.appendTranslate(b,Q).appendScale(J/n,l/$)}Kn(i,b,Q),(n!==J||$!==l)&&i.scale(J/n,l/$),f&&(Ck(f)?f(i,n,$,O,C,R):(i.beginPath(),i.rect(0,0,n,$),i.clip())),g!=Z&&(i.globalAlpha*=g),N(R,"comps").forEach(function(g){if(N(g,Tr)!==!1){if(gk.splice(0,0,g),i.interactiveInfo)var Q=i.interactiveInfo.matrix.clone();var x=N(g,"opacity"),m=N(g,"shadow"),$=N(g,"type"),T=P(g,E);if(x!=Z){var h=i.globalAlpha;i.globalAlpha*=x}if(m){var X=i.shadowOffsetX,s=i.shadowOffsetY,d=i.shadowBlur,R=i.shadowColor,F=N(g,"shadowOffsetX"),e=N(g,"shadowOffsetY"),W=N(g,"shadowBlur"),u=k(g,"shadowColor");i.shadowOffsetX=(F==Z?3:F)*I,i.shadowOffsetY=(e==Z?3:e)*I,i.shadowBlur=(W==Z?6:W)*I,i.shadowColor=u||k(_d)}if("save"===$)i.save();else if("endClip"===$||"restore"===$)i.restore();else if("clip"===$)i.save(),Le(i,N(g,"points",w),N(g,"segments",p),!0),i.clip();else if(zo[$])T=T||{x:0,y:0,width:E.width,height:E.height},r(g,$,T,E);else if($===Bd)r(g,$,T,E);else if("SVGPath"===$)j(g,$,T);else{T=T||{x:0,y:0,width:E.width,height:E.height};var B=N(g,Zp),v=N(g,"scaleX"),J=N(g,"scaleY"),G=_(g),q=D(g,T,T,B,v,J,G);if(Ck($))Y(g,$),M.drawCompType($,i,T,g,O,C);else if(M.getCompType($)){var z=M.getCompType($),n=z.func||z;Y(g,z),M.drawCompType(n,i,T,g,O,C)}else V[$]?V[$](g,T):M.getCompType($)===K&&wb.test($)&&ke($);q&&A()}m&&(i.shadowOffsetX=X,i.shadowOffsetY=s,i.shadowBlur=d,i.shadowColor=R),x!=Z&&(i.globalAlpha=h),i.interactiveInfo&&(i.interactiveInfo.matrix=Q),gk.splice(0,1)}}),i.interactiveInfo&&(i.interactiveInfo.matrix=y),i.restore(),h&&m()}}}();M.getCurrentComp=function(){return gk[0]},M.getParentComp=function(){return gk[1]},M.getInternal=function(){return{isEnter:ve,isEsc:_g,isSpace:_f,isLeft:Th,isUp:Sc,isRight:Xf,isDown:cc,addMethod:Bm,superCall:up,toPointsArray:Ch,translateAndScale:Nn,appendArray:mf,createWorldMatrix:Jh,vec3TransformMat4:jq,setCanvas:Aq,createDiv:Ti,createView:nn,createCanvas:Od,createImage:Mc,initContext:Lf,layout:ef,fillRect:Rf,Mat:mk,drawBorder:Il,isString:Gk,setBorder:Jg,getPropertyValue:Om,setPropertyValue:Eg,drawVerticalLine:dq,draw3DRect:Mr,getPinchDist:dc,isSameRect:ul,getPosition:vk,intersectionLineRect:Xm,getNodeRect:vm,getEdgeAgentPosition:Bb,getImageWidth:pr,getImageHeight:Ne,initItemElement:Ng,drawPoints:Le,createG2:Wi,closePopup:vf,isH:Gm,createAnim:is,createNormalMatrix:qk,createNormals:Gc,toFloatArray:bo,glMV:Mm,batchShape:Rm,createNodeMatrix:go,getFaceInfo:ei,transformAppend:Yn,drawFaceInfo:os,to3dPointsArray:gd,setGLDebugMode:function(M){ag=M},cube:function(){return{vs:xm,is:Tp,uv:sh}},ui:function(){return{DataUI:Ob,NodeUI:Me,EdgeUI:xj,GroupUI:Ko,ShapeUI:Xk,GridUI:qs,Data3dUI:lh,Node3dUI:vj,Shape3dUI:Bj}},getInternalVersion:function(){return"U2FsdGVkX19umq3zJODyaMKR7uo586Q7Z4mDudaQFkQ="},getDragger:function(){return Re},addMSMap:function(y){Bm(gi,y)},k:P}},function(u){function a(A,t){A!=Z&&(t==Z&&Ke!=typeof A?this._54O(A,256):this._54O(A,t))}function I(){return new a(Z)}function i(N,L,r,K,E,I){for(;--I>=0;){var P=L*this[N++]+r[K]+E;E=v(P/67108864),r[K++]=67108863&P}return E}function N(Y,A,E,I,R,g){for(var y=32767&A,P=A>>15;--g>=0;){var O=32767&this[Y],d=this[Y++]>>15,t=P*O+d*y;O=y*O+((32767&t)<<15)+E[I]+(1073741823&R),R=(O>>>30)+(t>>>15)+P*d+(R>>>30),E[I++]=1073741823&O}return R}function k(w,P,D,N,t,Q){for(var F=16383&P,$=P>>14;--Q>=0;){var s=16383&this[w],f=this[w++]>>14,h=$*s+f*F;s=F*s+((16383&h)<<14)+D[N]+t,t=(s>>28)+(h>>14)+$*f,D[N++]=268435455&s}return t}function h(Y){return jd.charAt(Y)}function $(D,b){var s=Si[D.charCodeAt(b)];return s==Z?-1:s}function X(f){for(var q=this.t-1;q>=0;--q)f[q]=this[q];f.t=this.t,f.s=this.s}function K(f){this.t=1,this.s=0>f?-1:0,f>0?this[0]=f:-1>f?this[0]=f+this.DV:this.t=0}function S(C){var V=I();return V._58O(C),V}function U(o,m){var J,g=this;if(16==m)J=4;else if(8==m)J=3;else if(256==m)J=8;else if(2==m)J=1;else if(32==m)J=5;else{if(4!=m)return g.fromRadix(o,m),void 0;J=2}g.t=0,g.s=0;for(var p=o.length,S=!1,F=0;--p>=0;){var B=8==J?255&o[p]:$(o,p);0>B?"-"==o.charAt(p)&&(S=!0):(S=!1,0==F?g[g.t++]=B:F+J>g.DB?(g[g.t-1]|=(B&(1<<g.DB-F)-1)<<F,g[g.t++]=B>>g.DB-F):g[g.t-1]|=B<<F,F+=J,F>=g.DB&&(F-=g.DB))}8==J&&0!=(128&o[0])&&(g.s=-1,F>0&&(g[g.t-1]|=(1<<g.DB-F)-1<<F)),g._57O(),S&&a.ZERO._78O(g,g)
}function V(){for(var U=this,J=U.s&U.DM;U.t>0&&U[U.t-1]==J;)--U.t}function c(g){var b=this;if(b.s<0)return"-"+b._85O()[Um](g);var i;if(16==g)i=4;else if(8==g)i=3;else if(2==g)i=1;else if(32==g)i=5;else{if(4!=g)return b.toRadix(g);i=2}var l,B=(1<<i)-1,s=!1,T="",D=b.t,v=b.DB-D*b.DB%i;if(D-->0)for(v<b.DB&&(l=b[D]>>v)>0&&(s=!0,T=h(l));D>=0;)i>v?(l=(b[D]&(1<<v)-1)<<i-v,l|=b[--D]>>(v+=b.DB-i)):(l=b[D]>>(v-=i)&B,0>=v&&(v+=b.DB,--D)),l>0&&(s=!0),s&&(T+=h(l));return s?T:"0"}function H(){var J=I();return a.ZERO._78O(this,J),J}function D(){return this.s<0?this._85O():this}function R(w){var T=this,O=T.s-w.s;if(0!=O)return O;var x=T.t;if(O=x-w.t,0!=O)return T.s<0?-O:O;for(;--x>=0;)if(0!=(O=T[x]-w[x]))return O;return 0}function f(E){var N,r=1;return 0!=(N=E>>>16)&&(E=N,r+=16),0!=(N=E>>8)&&(E=N,r+=8),0!=(N=E>>4)&&(E=N,r+=4),0!=(N=E>>2)&&(E=N,r+=2),0!=(N=E>>1)&&(E=N,r+=1),r}function g(){var W=this;return W.t<=0?0:W.DB*(W.t-1)+f(W[W.t-1]^W.s&W.DM)}function C(V,k){var s;for(s=this.t-1;s>=0;--s)k[s+V]=this[s];for(s=V-1;s>=0;--s)k[s]=0;k.t=this.t+V,k.s=this.s}function A(N,f){for(var X=N;X<this.t;++X)f[X-N]=this[X];f.t=E(this.t-N,0),f.s=this.s}function Q(F,V){var p,h=this,A=F%h.DB,X=h.DB-A,j=(1<<X)-1,H=v(F/h.DB),$=h.s<<A&h.DM;for(p=h.t-1;p>=0;--p)V[p+H+1]=h[p]>>X|$,$=(h[p]&j)<<A;for(p=H-1;p>=0;--p)V[p]=0;V[H]=$,V.t=h.t+H+1,V.s=h.s,V._57O()}function Y(I,Q){var h=this;Q.s=h.s;var J=v(I/h.DB);if(J>=h.t)return Q.t=0,void 0;var $=I%h.DB,i=h.DB-$,g=(1<<$)-1;Q[0]=h[J]>>$;for(var X=J+1;X<h.t;++X)Q[X-J-1]|=(h[X]&g)<<i,Q[X-J]=h[X]>>$;$>0&&(Q[h.t-J-1]|=(h.s&g)<<i),Q.t=h.t-J,Q._57O()}function m(I,q){for(var L=this,u=0,b=0,k=z(I.t,L.t);k>u;)b+=L[u]-I[u],q[u++]=b&L.DM,b>>=L.DB;if(I.t<L.t){for(b-=I.s;u<L.t;)b+=L[u],q[u++]=b&L.DM,b>>=L.DB;b+=L.s}else{for(b+=L.s;u<I.t;)b-=I[u],q[u++]=b&L.DM,b>>=L.DB;b-=I.s}q.s=0>b?-1:0,-1>b?q[u++]=L.DV+b:b>0&&(q[u++]=b),q.t=u,q._57O()}function O(X,p){var v=this.abs(),L=X.abs(),b=v.t;for(p.t=b+L.t;--b>=0;)p[b]=0;for(b=0;b<L.t;++b)p[b+v.t]=v.am(0,L[b],p,b,0,v.t);p.s=0,p._57O(),this.s!=X.s&&a.ZERO._78O(p,p)}function B(q){for(var f=this.abs(),k=q.t=2*f.t;--k>=0;)q[k]=0;for(k=0;k<f.t-1;++k){var y=f.am(k,f[k],q,2*k,0,1);(q[k+f.t]+=f.am(k+1,2*f[k],q,2*k+1,y,f.t-k-1))>=f.DV&&(q[k+f.t]-=f.DV,q[k+f.t+1]=1)}q.t>0&&(q[q.t-1]+=f.am(k,f[k],q,2*k,0,1)),q.s=0,q._57O()}function W(b,d,e){var V=b.abs(),E=this;if(!(V.t<=0)){var D=E.abs();if(D.t<V.t)return d!=Z&&d._58O(0),e!=Z&&E._77O(e),void 0;e==Z&&(e=I());var J=I(),z=E.s,$=b.s,F=E.DB-f(V[V.t-1]);F>0?(V._44O(F,J),D._44O(F,e)):(V._77O(J),D._77O(e));var M=J.t,S=J[M-1];if(0!=S){var U=S*(1<<E.F1)+(M>1?J[M-2]>>E.F2:0),h=E.FV/U,i=(1<<E.F1)/U,p=1<<E.F2,P=e.t,A=P-M,Y=d==Z?I():d;for(J._59O(A,Y),e._52O(Y)>=0&&(e[e.t++]=1,e._78O(Y,e)),a.ONE._59O(M,Y),Y._78O(J,J);J.t<M;)J[J.t++]=0;for(;--A>=0;){var _=e[--P]==S?E.DM:v(e[P]*h+(e[P-1]+p)*i);if((e[P]+=J.am(0,_,e,A,0,M))<_)for(J._59O(A,Y),e._78O(Y,e);e[P]<--_;)e._78O(Y,e)}d!=Z&&(e._45O(M,d),z!=$&&a.ZERO._78O(d,d)),e.t=M,e._57O(),F>0&&e._46O(F,e),0>z&&a.ZERO._78O(e,e)}}}function q(k){var U=I();return this.abs()._49O(k,Z,U),this.s<0&&U._52O(a.ZERO)>0&&k._78O(U,U),U}function n(O){this.m=O}function M(m){return m.s<0||m._52O(this.m)>=0?m.mod(this.m):m}function j(Y){return Y}function _(P){P._49O(this.m,Z,P)}function d(Y,w,N){Y._47O(w,N),this._74O(N)}function L(K,Z){K._48O(Z),this._74O(Z)}function x(){if(this.t<1)return 0;var D=this[0];if(0==(1&D))return 0;var S=3&D;return S=15&S*(2-(15&D)*S),S=255&S*(2-(255&D)*S),S=65535&S*(2-(65535&(65535&D)*S)),S=S*(2-D*S%this.DV)%this.DV,S>0?this.DV-S:-S}function F(v){var A=this;A.m=v,A.mp=v._50O(),A.mpl=32767&A.mp,A.mph=A.mp>>15,A.um=(1<<v.DB-15)-1,A.mt2=2*v.t}function e(R){var w=I();return R.abs()._59O(this.m.t,w),w._49O(this.m,Z,w),R.s<0&&w._52O(a.ZERO)>0&&this.m._78O(w,w),w}function s(h){var E=I();return h._77O(E),this._74O(E),E}function b(T){for(var h=this;T.t<=h.mt2;)T[T.t++]=0;for(var L=0;L<h.m.t;++L){var l=32767&T[L],C=l*h.mpl+((l*h.mph+(T[L]>>15)*h.mpl&h.um)<<15)&T.DM;for(l=L+h.m.t,T[l]+=h.m.am(0,C,T,L,0,h.m.t);T[l]>=T.DV;)T[l]-=T.DV,T[++l]++}T._57O(),T._45O(h.m.t,T),T._52O(h.m)>=0&&T._78O(h.m,T)}function il(W,i){W._48O(i),this._74O(i)}function Cd(Q,n,p){Q._47O(n,p),this._74O(p)}function Kk(){return 0==(this.t>0?1&this[0]:this.s)}function ad(S,W){if(S>4294967295||1>S)return a.ONE;var z=I(),b=I(),U=W._73O(this),T=f(S)-1;for(U._77O(z);--T>=0;)if(W._76O(z,b),(S&1<<T)>0)W._75O(b,U,z);else{var O=z;z=b,b=O}return W.revert(z)}function Tn(J,f){var g;return g=256>J||f._51O()?new n(f):new F(f),this.exp(J,g)}function js(){var I=this;if(I.s<0){if(1==I.t)return I[0]-I.DV;if(0==I.t)return-1}else{if(1==I.t)return I[0];if(0==I.t)return 0}return(I[1]&(1<<32-I.DB)-1)<<I.DB|I[0]}function tf(x,G){return new a(x,G)}function Vf(){var t=this;t.n=Z,t.e=0,t.d=Z,t.p=Z,t.q=Z,t.dmp1=Z,t.dmq1=Z,t._10A=Z}function Wf(u){return u._53O(this.e,this.n)}function Zc(y){var $,m,Q,f="",o=0;for($=0;$<y.length&&y.charAt($)!=Hf;++$)Q=Jq.indexOf(y.charAt($)),0>Q||(0==o?(f+=h(Q>>2),m=3&Q,o=1):1==o?(f+=h(m<<2|Q>>4),m=15&Q,o=2):2==o?(f+=h(m),f+=h(Q>>2),m=3&Q,o=3):(f+=h(m<<2|Q>>4),f+=h(15&Q),o=0));return 1==o&&(f+=h(m<<2)),f}function qb(f){var d=f.split(""),M=Zc(f);return d.forEach(function(V){var m=V.length;m>0&&M&&(we+=l(V))}),M}function hf(S,R){var f=_m._4O.Util._56O(S,"ss"),M={},m=0;return M.v=f==R,M.t=1,M.s=0>m?-1:0,rp=M.v,m>0?M[0]=m:-1>m?M[0]=m+M.DV:M.t=0,[f,M]}function Wd(V){var _=38,i=V.substring(0,_);if(i&&30==i.indexOf("05000420")){var s=["ss",V.substring(_)];return s}return[]}function vg(E,x){x=x.replace(vd,""),x=x.replace(/[ \n]+/g,"");var F=tf(x,16);if(F._55O()>this.n._55O())return 0;var O=this._37O(F),Z=O[Um](16).replace(/^1f+00/,""),t=Wd(Z);if(0==t.length)return!1;for(var r,Y,w,$=.5,R=Ho,X=[0,.5,.75,.875,.9375],m=[],e=[],s=[],U=G/R,a=t[1],S=hf(E,a)[0],B=0,W=0;B<X.length;B++){var z=0===B%2?0:.5;for(r=0;R>=r;r++)Y=(r+z)*U,w=1-X[B],m.push(y(Y)*$*w,-$+2*X[B]*$,-J(Y)*$*w),e.push((r+z)/R,w)}for(B=0;B<X.length-1;B++){var V=B*(R+1),P=(B+1)*(R+1);for(r=0;R>r;r++)s.push(V+r,P+r+1,P+r,V+r,V+r+1,P+r+1)}return s.forEach(function(R){W+=R}),a==S&&W>10}var Fq,gs=0xdeadbeefcafe,tg=15715070==(16777215&gs),Um="toString",Wh="",Hd="nat",oq=function(){};t=u["D"+11182[Um](p(2,5))];var gb=a.prototype;Wc+=er.substr(0,1);var Ve=u.navigator?u.navigator.appName:"";tg&&"Microsoft Internet Explorer"==Ve?(gb.am=N,Fq=30):tg&&"Netscape"!=Ve?(gb.am=i,Fq=26):(gb.am=k,Fq=28),gb.DB=Fq,gb.DM=(1<<Fq)-1,gb.DV=1<<Fq;var kg=52;gb.FV=p(2,kg),gb.F1=kg-Fq,gb.F2=2*Fq-kg;var ak,Gl,jd="0123456789abcdefghijklmnopqrstuvwxyz",Si=[],qk=function(D){return String.fromCharCode(D)};for(ak="0".charCodeAt(0),Gl=0;9>=Gl;++Gl)Si[ak++]=Gl;for(ak="a".charCodeAt(0),Gl=10;36>Gl;++Gl)Si[ak++]=Gl;for(ak="A".charCodeAt(0),Gl=10;36>Gl;++Gl)Si[ak++]=Gl;var qr=n.prototype;qr._73O=M,qr.revert=j,qr._74O=_,qr._75O=d,qr._76O=L;var yf=F.prototype;yf._73O=e,yf.revert=s,yf._74O=b,yf._75O=Cd,yf._76O=il,gb._77O=X,gb._58O=K,gb._54O=U,gb._57O=V,gb._59O=C,gb._45O=A,gb._44O=Q,gb._46O=Y,gb._78O=m,gb._47O=O,gb._48O=B,gb._49O=W,gb._50O=x,gb._51O=Kk,gb.exp=ad,gb.toString=c,gb._85O=H,gb.abs=D,gb._52O=R,gb._55O=g,gb.mod=q,gb._53O=Tn,a.ZERO=S(0),a.ONE=S(1),gb._86O=js;var bo=function(u,s){var j=this;j.isPublic=!0,typeof u!==Ke?(j.n=u,j.e=s):u!=Z&&s!=Z&&u.length>0&&s.length>0&&(j.n=tf(u,16),j.e=l(s,16))};cm=function(){var v,B,k=qb(df),V=k.substr(0,4),g=k.substr(4,2),J=k.substr(6,2),n=1,d=!n,L=P,T=[],X=no.charAt(7);if(t&&(t[Um]().indexOf(Hd)<0||t[Wc][Um]().indexOf(Hd)<0||!k?v=ep(Gf[X]):(k=new t(V-0,g-n,J-0),B=k.setHours(9),t[Wc]()>B?v=ep(Gf[X]):d=!0)),k&&v&&L){for(var x in v)T.push(x);var c,C=0,z=v[T[C++]],A=v[T[C++]],f=v[T[C++]],D=v[T[C++]],p=v[T[C++]],U=v[T[C++]],$=v[T[C++]],e=Cm._27O(L);if(e&&$){c=z+A+f+D+p+U;var M=!U||U===rk;if(!M&&U)for(var i,h=0,Q=U.length;Q>h;h++)U[h]===Ug[C]?i===rk?M=!0:i=Z:(i==Z?i=U[h]:i+=U[h],h===Q-1&&i===rk&&(M=!0));c&&e._31O(c,$)&&M&&(!p||t[Wc]()<p)&&(d=!0)}}return d||(ch=wk),X};var jg=Vf.prototype;jg._37O=Wf,jg._38O=bo;var Jq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hf="=",Qe=25,un=10,df="IBkCFQ==",Lf=Lf||function(m,p){var B={},t=B._7A={},h=t._6A=function(){function Y(){}return{_80O:function(K){Y.prototype=this;var Z=new Y;return K&&Z._5A(K),Z.hasOwnProperty("_82O")||(Z._82O=function(){Z.$super._82O.apply(this,arguments)}),Z._82O.prototype=Z,Z.$super=this,Z},_3A:function(){var S=this._80O();return S._82O.apply(S,arguments),S},_82O:function(){},_5A:function(m){for(var H in m)m.hasOwnProperty(H)&&(this[H]=m[H]);m.hasOwnProperty(Um)&&(this.toString=m.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),$=t._39O=h._80O({_82O:function(r,O){r=this._84O=r||[],this._65O=O!=p?O:4*r.length},toString:function(h){return(h||U).stringify(this)},_89O:function(t){var R=this._84O,E=t._84O,I=this._65O,N=t._65O;if(this._57O(),I%4)for(var J=0;N>J;J++){var p=255&E[J>>>2]>>>24-8*(J%4);R[I+J>>>2]|=p<<24-8*((I+J)%4)}else if(E.length>65535)for(var J=0;N>J;J+=4)R[I+J>>>2]=E[J>>>2];else R.push.apply(R,E);return this._65O+=N,this},_57O:function(){var t=this._84O,I=this._65O;t[I>>>2]&=4294967295<<32-8*(I%4),t.length=r(I/4)},_88O:function(){var C=h._88O.call(this);return C._84O=this._84O.slice(0),C},_87O:function(F){for(var e=[],O=0;F>O;O+=4)e.push(0|4294967296*w);return new $._82O(e,F)}}),y=B._2A={},U=y._69O={stringify:function(S){var X,e=S._84O,E=S._65O,c=[];for(X=0;E>X;X++){var U=255&e[X>>>2]>>>24-8*(X%4);c.push((U>>>4).toString(16)),c.push((15&U).toString(16))}return c.join("")},_68O:function(n){for(var T=n.length,o=[],S=0;T>S;S+=2)o[S>>>3]|=l(n.substr(S,2),16)<<24-4*(S%8);return new $._82O(o,T/2)}},u=y._8A={stringify:function(D){var P,f=D._84O,F=D._65O,k=[];for(P=0;F>P;P++){var p=255&f[P>>>2]>>>24-8*(P%4);k.push(qk(p))}return k.join("")},_68O:function(g){var T,l=g.length,D=[];for(T=0;l>T;T++)D[T>>>2]|=(255&g.charCodeAt(T))<<24-8*(T%4);return new $._82O(D,l)}},n=y._9A={stringify:function(j){try{return decodeURIComponent(escape(u.stringify(j)))}catch(z){throw new Error("")}},_68O:function(T){return u._68O(unescape(encodeURIComponent(T)))}},g=t._32O=h._80O({_1A:function(){this._83O=new $._82O,this._23O=0},_33O:function($){typeof $==Ke&&($=n._68O($)),this._83O._89O($),this._23O+=$._65O},_25O:function(t){var d=this._83O,D=d._84O,P=d._65O,f=this._79O,V=4*f,G=P/V;G=t?r(G):E((0|G)-this._22O,0);var x=G*f,s=z(4*x,P);if(x){for(var n=0;x>n;n+=f)this._20O(D,n);var Q=D.splice(0,x);d._65O-=s}return new $._82O(Q,s)},_88O:function(){var u=h._88O.call(this);return u._83O=this._83O._88O(),u},_22O:0});t._66O=g._80O({cfg:h._80O(),_82O:function(J){this.cfg=this.cfg._80O(J),this._1A()},_1A:function(){g._1A.call(this),this._34O()},_81O:function(W){return this._33O(W),this._25O(),this},_72O:function(v){v&&this._33O(v);var P=this._21O();return P},_79O:16,_26O:function(g){return function(z,r){return new g._82O(r)._72O(z)}},_19O:function(C){return function(Z,i){return new e._71O._82O(C,i)._72O(Z)}}});var e=B._67O={};return B}();!function(){var y=Lf,M=y._7A,t=M._39O,k=M._66O,f=y._67O,N=[],w=[];!function(){function I(X){for(var k=T(X),r=2;k>=r;r++)if(!(X%r))return!1;return!0}function Z(r){return 0|4294967296*(r-(0|r))}for(var r=2,C=0;64>C;)I(r)&&(8>C&&(N[C]=Z(p(r,.5))),w[C]=Z(p(r,1/3)),C++),r++}();var I=[],U=f._41O=k._80O({_34O:function(){this._64O=new t._82O(N.slice(0))},_20O:function(a,r){for(var W=this._64O._84O,q=W[0],f=W[1],J=W[2],O=W[3],A=W[4],V=W[5],S=W[6],z=W[7],K=0;64>K;K++){if(16>K)I[K]=0|a[r+K];else{var v=I[K-15],m=(v<<25|v>>>7)^(v<<14|v>>>18)^v>>>3,N=I[K-2],L=(N<<15|N>>>17)^(N<<13|N>>>19)^N>>>10;I[K]=m+I[K-7]+L+I[K-16]}var i=A&V^~A&S,U=q&f^q&J^f&J,P=(q<<30|q>>>2)^(q<<19|q>>>13)^(q<<10|q>>>22),k=(A<<26|A>>>6)^(A<<21|A>>>11)^(A<<7|A>>>25),c=z+k+i+w[K]+I[K],l=P+U;z=S,S=V,V=A,A=0|O+c,O=J,J=f,f=q,q=0|c+l}W[0]=0|W[0]+q,W[1]=0|W[1]+f,W[2]=0|W[2]+J,W[3]=0|W[3]+O,W[4]=0|W[4]+A,W[5]=0|W[5]+V,W[6]=0|W[6]+S,W[7]=0|W[7]+z},_21O:function(){var D=this._83O,J=D._84O,N=8*this._23O,P=8*D._65O;return J[P>>>5]|=128<<24-P%32,J[(P+64>>>9<<4)+14]=v(N/4294967296),J[(P+64>>>9<<4)+15]=N,D._65O=4*J.length,this._25O(),this._64O},_88O:function(){var j=k._88O.call(this);return j._64O=this._64O._88O(),j}});y._41O=k._26O(U),y._42O=k._19O(U)}();var vd=new RegExp("");vd.compile("[^0-9a-f]","gi"),Vf._28O=-1,Vf._29O=-2,jg._31O=vg,jg._63O=vg,Vf._43O=-2;var $d=new function(){var L=this;L._5O=function(E,u){if("8"!=E.substring(u+2,u+3))return 1;var S=l(E.substring(u+3,u+4));return 0==S?-1:S>0&&10>S?S+1:-2},L._13O=function(U,H){var N=L._5O(U,H);return 1>N?"":U.substring(H+2,H+2+2*N)},L._12O=function(Y,w){var G=L._13O(Y,w);if(""==G)return-1;var T;return T=l(G.substring(0,1))<8?new a(G,16):new a(G.substring(2),16),T._86O()},L._6O=function(u,B){var h=L._5O(u,B);return 0>h?h:B+2*(h+1)},L._11O=function(O,s){var j=L._6O(O,s),m=L._12O(O,s);return O.substring(j,j+2*m)},L._10O=function(E,t){var h=L._6O(E,t),c=L._12O(E,t);return h+2*c},L._7O=function(q,f){var C=[],h=L._6O(q,f);C.push(h);for(var k=L._12O(q,f),F=h,B=0;;){var U=L._10O(q,F);if(U==Z||U-h>=2*k)break;if(B>=200)break;C.push(U),F=U,B++}return C}};if($d._90O=qk(un+24),$d._91O=o+qk(un*un+8),_m==Z||!_m)var _m={};_m._4O!=Z&&_m._4O||(_m._4O={});var $j=_m._4O;_m._4O.Util=new function(){var X=this;X._56O=function(U){var H=new _m._4O._3O;return H._30O(U)},X._4A=function(i){var f=new _m._4O._3O;return f._36O(i)},X._11A=function(k){var A=new $j._3O;return A._30O(k)}},_m._4O._3O=function(){var U=this;U._8O=function(k,$){if("ss"==k&&"cj"==$){try{U.md=Lf._67O._41O._3A()}catch(u){oq(Wh)}U._24O=function(e){U.md._81O(e)},U._35O=function(d){var L=Lf._2A._69O._68O(d);U.md._81O(L)},U._60O=function(){var Y=U.md._72O();return Y[Um](Lf._2A._69O)},U._30O=function(L){return U._24O(L),U._60O()},U._36O=function(l){return U._35O(l),U._60O()}}},U._24O=function(){oq(Wh)},U._35O=function(){oq(Wh)},U._60O=function(){oq(Wh)},U._30O=function(){oq(Wh)},U._36O=function(){oq(Wh)},U._8O("ss","cj")},Oe=function(w){var p=Zm[Sk[7]],A=1,h=!1;if(Jr.a!=Zm[hn])return Jr.a;if(Jr.forEach(function(a){A*=a}),w>A){if(p){p=p.split($d._90O);var L=p[3],E=p[7],Q=p[11],P=p[15],Z=p[19],n=p[23],R=p[27],d=L+E+Q+P+Z+n,O=n?!1:!0;if(n){var v=n&&n.split(cf("firefox")[3]);if(v)for(var $=0;$<v.length;$++)if(Xn.indexOf(v[$])>=0){O=!0;break}}h=Ij()(d,R)&&O&&(!Z||Z>w)}h||(Ob.prototype._42=cb)}else h=!0;return Jr.a=h,h},Qe=String.fromCharCode(Qe+20);var sd=function(R){return R=R.replace(vd,Wh),R=R.replace(/[ \n]+/g,Wh)},sh="30",Qc="06",eh="02",Re="03",_f=tf,Fo=/^1f+00/,Cm=function(){var B;return B={_18O:function(J){var K=J,i=K.replace(/\s+/g,""),m=Zc(i);return m},_14O:function(y){var h=this._18O(y),k=this._15O(h);return k},_15O:function(Y){var j=this._17O(Y);if("2a864886f70d010101"==j._61O){var H=this._16O(j.key),i=new Vf;return i._38O(H.n,H.e),i}oq(Wh)},_16O:function(X){var P={};X.substr(0,2)!=sh&&oq(Wh);var p=$d._7O(X,0);return 2!=p.length&&oq(Wh),X.substr(p[0],2)!=eh&&oq(Wh),P.n=$d._11O(X,p[0]),X.substr(p[1],2)!=eh&&oq(Wh),P.e=$d._11O(X,p[1]),P},_17O:function(U){var T={};T._40O=Z;var c=$d._7O(U,0);2!=c.length&&oq(Wh);var i=c[0];U.substr(i,2)!=sh&&oq(Wh);var M=$d._7O(U,i);return 2!=M.length&&oq(Wh),U.substr(M[0],2)!=Qc&&oq(Wh),T._61O=$d._11O(U,M[0]),U.substr(M[1],2)==Qc?T._40O=$d._11O(U,M[1]):U.substr(M[1],2)==sh&&(T._40O={},T._40O.p=$d._70O(U,M[1],[0],eh),T._40O.q=$d._70O(U,M[1],[1],eh),T._40O.g=$d._70O(U,M[1],[2],eh)),U.substr(c[1],2)!=Re&&oq(Wh),T.key=$d._11O(U,c[1]).substr(2),T}},B._17O?B:Z}(),Jj=Cm._27O=function(L){return Cm._14O(L)};Ij=function(){return function(q,a){if(q&&a){a=sd(a);var o=_f(a,p(2,4)),l=this;if(!l||!l.n||o._55O()>l.n._55O())return 0;var X=l._37O(o),m=X[Um](p(2,4)).replace(Fo,""),y=Wd(m);if(0==y.length)return!1;var C=y[0],u=y[1],V=function(P){return _m._4O.Util._56O(P,C)},x=V(q);return u==x}}.bind(Jj(P))};var Mg,so;return function(){var W=Up.length-qe.length;if(W>0)for(var M=0;W>M;M++)Mg=$j.Util,so=sd}(),Td=function(G,y){y=so(y);var w=Jj(fm),$=rm.length,S=2*$,J=_f(y,p($,S)),X=w,o=!0;if(X){var i=X[Ur[0]];i&&J._55O()<=i._55O()&&(o=!1)}if(o)return 0;var M=X._37O(J),N=M[Um](p($,S)).replace(Fo,""),f=Wd(N);if(0==f.length)return!1;var m=f[0],D=f[1],B=Mg._11A(G,m);return D==B},Cm}(x,C),Bm(M,{load:function(){var P={},H=function(r){return r?"c_"+(r.sync?"1":"0")+"_"+(r.post?"1":"0")+"_"+(r.responseType||"H")+"_"+(r.mimeType||"H")+"_"+(r.data?JSON.stringify(r.data):"H"):""};return function(R,w,L){var x,Y=P[R],b=H(L);return Y&&(x=Y[b])?(x.push(w),void 0):(P[R]||(Y=P[R]={count:0}),x=Y[b]=[w],Y.count++,M.xhrLoad(R,function(N){delete Y[b],Y.count--,Y.count||delete P[R],x.forEach(function(H){H(N)})},L),void 0)}}(),asyncEach:function(V,u,N){"function"!=typeof N&&(N=Function.prototype);var c=new Array(V.length),L=0,H=!1;V.forEach(function(t,Q){u(t,function(k,z){return H?void 0:k?(H=!0,N(null)):(c[Q]=z,L++,L===V.length?N(c):void 0)})})},xhrLoad:function(K,d,g){var q=!1;Sp(K)||(q=!0,K=[K]),g=g||{},K.length;var I=g.sync,m=!!g.post,p=null;return M.asyncEach(K,function(l,K){var T=new Lo;l=M.beforeLoadURL(l),l.data?K(null,l.data):(g.url=encodeURI(l),g.method=m?"POST":"GET",g.responseType?T.setResponseType(g.responseType):T.setOverrideMimeType(g.mimeType||"text/plain"),T.onload=function(){200===this.status||0===this.status?K(null,T.getResponseText()):K(!0)},T.onerror=function(){K(!0)},T.send(g))},function(L){var S="function"==typeof d;(S||I)&&(p=q&&L?L[0]:L,S&&d(p))}),I?p:void 0}}),Math.sign===K&&(Math.sign=function(S){return 0>S?-1:S>0?1:+S}),k.Math={generateUUID:function(){for(var O=[],G=0;256>G;G++)O[G]=(16>G?"0":"")+G.toString(16).toUpperCase();return function(){var e=0|4294967295*Math.random(),Z=0|4294967295*Math.random(),B=0|4294967295*Math.random(),b=0|4294967295*Math.random();return O[255&e]+O[255&e>>8]+O[255&e>>16]+O[255&e>>24]+"-"+O[255&Z]+O[255&Z>>8]+"-"+O[64|15&Z>>16]+O[255&Z>>24]+"-"+O[128|63&B]+O[255&B>>8]+"-"+O[255&B>>16]+O[255&B>>24]+O[255&b]+O[255&b>>8]+O[255&b>>16]+O[255&b>>24]}}(),clamp:function(J,L,s){return Math.max(L,Math.min(s,J))},generateIncreasingID:function(){var o=0;return function(){return++o}}()};var yp=k.Matrix=k.Math.Matrix2d=function(Y,b,V,o,f){this.setFromTransform(Y,b,V,o,f)},mk=yp;yp.prototype={},yp.prototype.constructor=yp,yp.prototype.set=function(E,O,K,k,M,i){return this.a=E,this.b=O,this.c=K,this.d=k,this.tx=M,this.ty=i,this},yp.prototype.setFromTransform=function(O,b,h,n,I){var R=this;if(O===K)return R.a=1,R.b=0,R.c=0,R.d=1,R.tx=0,R.ty=0,void 0;O=O||0;var e=J(O),N=y(O);return n=n||1,I=I||1,R.a=N*n,R.b=e*n,R.c=-e*I,R.d=N*I,R.tx=b||0,R.ty=h||0,R},yp.prototype.apply=function(D,S){S=S||new Rj;var i=D.x,G=D.y;return S.x=this.a*i+this.c*G+this.tx,S.y=this.b*i+this.d*G+this.ty,S},yp.prototype.applyInverse=function(C,h){h=h||new Rj;var M=1/(this.a*this.d+this.c*-this.b),e=C.x,c=C.y;return h.x=this.d*M*e+-this.c*M*c+(this.ty*this.c-this.tx*this.d)*M,h.y=this.a*M*c+-this.b*M*e+(-this.ty*this.a+this.tx*this.b)*M,h},yp.prototype.translate=function(A,Z){return this.tx+=A,this.ty+=Z,this},yp.prototype.scale=function(N,v){return this.a*=N,this.d*=v,this.c*=N,this.b*=v,this.tx*=N,this.ty*=v,this},yp.prototype.rotate=function(S){var W=Math.cos(S),D=Math.sin(S),h=this.a,J=this.c,X=this.tx;return this.a=h*W-this.b*D,this.b=h*D+this.b*W,this.c=J*W-this.d*D,this.d=J*D+this.d*W,this.tx=X*W-this.ty*D,this.ty=X*D+this.ty*W,this},yp.prototype.appendTranslate=function(I,e){return this.tx+=this.a*I+this.c*e,this.ty+=this.b*I+this.d*e,this},yp.prototype.appendScale=function(Z,e){return this.a*=Z,this.d*=e,this.c*=e,this.b*=Z,this},yp.prototype.appendRotate=function(v){if(!v)return this;var L=Math.cos(v),y=Math.sin(v),E=this.a,x=this.b;return this.a=E*L+this.c*y,this.b=x*L+this.d*y,this.c=-E*y+this.c*L,this.d=-x*y+this.d*L,this},yp.prototype.append=function(g){var M=this.a,W=this.b,B=this.c,o=this.d;return this.a=g.a*M+g.b*B,this.b=g.a*W+g.b*o,this.c=g.c*M+g.d*B,this.d=g.c*W+g.d*o,this.tx=g.tx*M+g.ty*B+this.tx,this.ty=g.tx*W+g.ty*o+this.ty,this},yp.prototype.setTransform=function(o,r,D,K,M,C,y,Z,n){var g,$,v,O,B,a,c,e,F,h;return B=Math.sin(y),a=Math.cos(y),c=Math.cos(n),e=Math.sin(n),F=-Math.sin(Z),h=Math.cos(Z),g=a*M,$=B*M,v=-B*C,O=a*C,this.a=c*g+e*v,this.b=c*$+e*O,this.c=F*g+h*v,this.d=F*$+h*O,this.tx=o+(D*g+K*v),this.ty=r+(D*$+K*O),this},yp.prototype.prepend=function(q){var C=this.tx;if(1!==q.a||0!==q.b||0!==q.c||1!==q.d){var U=this.a,n=this.c;this.a=U*q.a+this.b*q.c,this.b=U*q.b+this.b*q.d,this.c=n*q.a+this.d*q.c,this.d=n*q.b+this.d*q.d}return this.tx=C*q.a+this.ty*q.c+q.tx,this.ty=C*q.b+this.ty*q.d+q.ty,this},yp.prototype.transform=yp.prototype.prepend,yp.prototype.invert=function(){var E=this.a,w=this.b,a=this.c,p=this.d,n=this.tx,m=E*p-w*a;return this.a=p/m,this.b=-w/m,this.c=-a/m,this.d=E/m,this.tx=(a*this.ty-p*n)/m,this.ty=-(E*this.ty-w*n)/m,this},yp.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},yp.prototype.clone=function(){var F=new yp;return F.a=this.a,F.b=this.b,F.c=this.c,F.d=this.d,F.tx=this.tx,F.ty=this.ty,F},yp.prototype.copy=function(c){return c.a=this.a,c.b=this.b,c.c=this.c,c.d=this.d,c.tx=this.tx,c.ty=this.ty,c},yp.prototype.tf=function($,u){1===arguments.length&&(u=$.y,$=$.x);var P=this;return{x:P.a*$+P.c*u+P.tx,y:P.b*$+P.d*u+P.ty}},yp.prototype.tfi=function(w,L){1===arguments.length&&(L=w.y,w=w.x);var x=this,E=1/(x.a*x.d+x.c*-x.b);return{x:x.d*E*w+-x.c*E*L+(x.ty*x.c-x.tx*x.d)*E,y:x.a*E*L+-x.b*E*w+(-x.ty*x.a+x.tx*x.b)*E}},yp.IDENTITY=new yp,yp.TEMP_MATRIX=new yp;var Lp=k.Math.Vector3=function(x,X,I){"object"==typeof x?this.copy(x):this.set(x,X==K?x:X,I==K?x:I)};C.assign(Lp.prototype,{set:function(M,h,E){return this.x=M,this.y=h,this.z=E,this},setScalar:function(D){return this.x=D,this.y=D,this.z=D,this},setX:function(t){return this.x=t,this},setY:function(c){return this.y=c,this},setZ:function(W){return this.z=W,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(W){return W.x===K?(this.x=W[0],this.y=W[1],this.z=W[2]):(this.x=W.x,this.y=W.y,this.z=W.z),this},add:function(R){return this.x+=R.x,this.y+=R.y,this.z+=R.z,this},addScalar:function(b){return this.x+=b,this.y+=b,this.z+=b,this},addVectors:function(V,t){return this.x=V.x+t.x,this.y=V.y+t.y,this.z=V.z+t.z,this},addScaledVector:function(E,y){return this.x+=E.x*y,this.y+=E.y*y,this.z+=E.z*y,this},sub:function(n){return this.x-=n.x,this.y-=n.y,this.z-=n.z,this},subScalar:function(r){return this.x-=r,this.y-=r,this.z-=r,this},subVectors:function(e,d){return this.x=e.x-d.x,this.y=e.y-d.y,this.z=e.z-d.z,this},multiply:function(B){return this.x*=B.x,this.y*=B.y,this.z*=B.z,this},multiplyScalar:function(j){return this.x*=j,this.y*=j,this.z*=j,this},distanceTo:function(W){return Math.sqrt(this.distanceToSquared(W))},distanceToSquared:function(M){var W=this.x-M.x,i=this.y-M.y,B=this.z-M.z;return W*W+i*i+B*B},distanceToSquared2:function(I){var c=this.x-I[0],u=this.y-I[1],t=this.z-I[2];return c*c+u*u+t*t},multiplyVectors:function(k,K){return this.x=k.x*K.x,this.y=k.y*K.y,this.z=k.z*K.z,this},transformDirection:function(V){var p=this.x,$=this.y,x=this.z,h=V.el;return this.x=h[0]*p+h[4]*$+h[8]*x,this.y=h[1]*p+h[5]*$+h[9]*x,this.z=h[2]*p+h[6]*$+h[10]*x,this.normalize()},applyQuaternion:function(x){var u=this.x,$=this.y,O=this.z,S=x._x,R=x._y,r=x._z,Q=x._w,Y=Q*u+R*O-r*$,W=Q*$+r*u-S*O,w=Q*O+S*$-R*u,n=-S*u-R*$-r*O;return this.x=Y*Q+n*-S+W*-r-w*-R,this.y=W*Q+n*-R+w*-S-Y*-r,this.z=w*Q+n*-r+Y*-R-W*-S,this},applyMatrix4:function(n){var F=this.x,f=this.y,Q=this.z,C=n.el,r=1/(C[3]*F+C[7]*f+C[11]*Q+C[15]);return this.x=(C[0]*F+C[4]*f+C[8]*Q+C[12])*r,this.y=(C[1]*F+C[5]*f+C[9]*Q+C[13])*r,this.z=(C[2]*F+C[6]*f+C[10]*Q+C[14])*r,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(s){return this.x*s.x+this.y*s.y+this.z*s.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var m=this.length();return m?this.multiplyScalar(1/m):this},setLength:function(t){return this.normalize().multiplyScalar(t)},fromArray:function(t,u){return u===K&&(u=0),this.x=t[u],this.y=t[u+1],this.z=t[u+2],this},toArray:function(f,c){return f===K&&(f=[0,0,0]),c===K&&(c=0),f[c]=this.x,f[c+1]=this.y,f[c+2]=this.z,f},cross:function(D){return this.crossVectors(this,D)},angleTo:function(f){var i=this.dot(f)/Math.sqrt(this.lengthSq()*f.lengthSq());return i>1||-1>i?0:Math.acos(i)},lerpVectors:function(J,b,R){return this.subVectors(b,J).multiplyScalar(R).add(J)},crossVectors:function(O,s){var $=O.x,o=O.y,u=O.z,j=s.x,V=s.y,D=s.z;return this.x=o*D-u*V,this.y=u*j-$*D,this.z=$*V-o*j,this},min:function(Q){return this.x=Math.min(this.x,Q.x),this.y=Math.min(this.y,Q.y),this.z=Math.min(this.z,Q.z),this},max:function(m){return this.x=Math.max(this.x,m.x),this.y=Math.max(this.y,m.y),this.z=Math.max(this.z,m.z),this}});var Rj=k.Math.Vector2=function(H,J,n){"object"==typeof H&&(H.x!=K?(J=H.y,H=H.x,n=H.e):(n=H[2],J=H[1],H=H[0])),this.set(H||0,J||0,n)};Rj.prototype={},Rj.prototype.constructor=Rj,C.defineProperties(Rj.prototype,{width:{get:function(){return this.x},set:function(H){this.x=H}},height:{get:function(){return this.y},set:function(d){this.y=d}}}),Rj.prototype.clone=function(){return new Rj(this.x,this.y,this.e)},Rj.prototype.copy=function(S){return this.set(S.x,S.y,S.e),this},Rj.prototype.equals=function(y){return y.x===this.x&&y.y===this.y},Rj.prototype.set=function(t,I,s){return this.x=t||0,this.y=I||(0!==I?this.x:0),s!=K&&(this.e=s),this},Rj.prototype.setScalar=function(j){return this.x=j,this.y=j,this},Rj.prototype.setX=function(d){return this.x=d||0,this},Rj.prototype.setY=function(F){return this.y=F||0,this},Rj.prototype.add=function(f){return this.x+=f.x,this.y+=f.y,this},Rj.prototype.addVectors=function(r,d){return this.x=r.x+d.x,this.y=r.y+d.y,this},Rj.prototype.addScalar=function(Y){return this.x+=Y,this.y+=Y,this},Rj.prototype.addScaledVector=function(r,p){return this.x+=r.x*p,this.y+=r.y*p,this},Rj.prototype.sub=function(g){return this.x-=g.x,this.y-=g.y,this},Rj.prototype.subScalar=function(_){return this.x-=_,this.y-=_,this},Rj.prototype.subVectors=function(n,t){return this.x=n.x-t.x,this.y=n.y-t.y,this},Rj.prototype.multiply=function(i){return this.x*=i.x,this.y*=i.y,this},Rj.prototype.multiplyScalar=function(R){return this.x*=R,this.y*=R,this},Rj.prototype.divide=function(g){return this.x/=g.x,this.y/=g.y,this},Rj.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},Rj.prototype.min=function(x){return this.x=Math.min(this.x,x.x),this.y=Math.min(this.y,x.y),this},Rj.prototype.max=function(v){return this.x=Math.max(this.x,v.x),this.y=Math.max(this.y,v.y),this},Rj.prototype.fromArray=function(E,Q){return Q===K&&(Q=0),this.x=E[Q],this.y=E[Q+1],this},Rj.prototype.clamp=function(f,k){return this.x=Math.max(f.x,Math.min(k.x,this.x)),this.y=Math.max(f.y,Math.min(k.y,this.y)),this},Rj.prototype.clampScalar=function(){var D,G;return function(B,q){return D===K&&(D=new Rj,G=new Rj),D.set(B,B),G.set(q,q),this.clamp(D,G)}}(),Rj.prototype.clampLength=function(S,L){var B=this.length();return this.multiplyScalar(Math.max(S,Math.min(L,B))/B)},Rj.prototype.dot=function(T){return this.x*T.x+this.y*T.y},Rj.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Rj.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Rj.prototype.normalize=function(){return this.divideScalar(this.length())},Rj.prototype.angle=function(){var B=Math.atan2(this.y,this.x);return 0>B&&(B+=2*Math.PI),B},Rj.prototype.distanceTo=function(K){return Math.sqrt(this.distanceToSquared(K))},Rj.prototype.distanceToSquared=function(J){var f=this.x-J.x,Z=this.y-J.y;return f*f+Z*Z},Rj.prototype.isNearEnough=function(E){return this.distanceToSquared(E)<1e-8},Rj.prototype.setLength=function(S){var l=this.length();return l?this.multiplyScalar(S/l):this},Rj.prototype.lerp=function(Y,n){return this.x+=(Y.x-this.x)*n,this.y+=(Y.y-this.y)*n,this},Rj.prototype.lerpVectors=function(n,c,C){return this.subVectors(c,n).multiplyScalar(C).add(n)},Rj.prototype.rotateAround=function(g,S){var J=g?g.x:0,H=g?g.y:0,T=Math.cos(S),p=Math.sin(S),D=this.x-J,v=this.y-H;return this.x=D*T-v*p+J,this.y=D*p+v*T+H,this};var Rq=k.Math.Ray=function(F,D){this.origin=F!==K?F.clone():new Lp,this.direction=D!==K?D.clone():new Lp};C.assign(Rq.prototype,{set:function($,D){return this.origin.copy($),this.direction.copy(D),this},clone:function(){return(new this.constructor).copy(this)},copy:function(K){return this.origin.copy(K.origin),this.direction.copy(K.direction),this.maxHitLen=K.maxHitLen,this},at:function(C,s){var l=s||new Lp;return l.copy(this.direction).multiplyScalar(C).add(this.origin)},setMaxHitLength:function(W){this.maxHitLen=W},lookAt:function(A){return this.direction.copy(A).sub(this.origin).normalize(),this},applyMatrix4:function(G){var B=this.maxHitLen;if(B){var Q=this.direction.clone().multiplyScalar(B).add(this.origin);Q.applyMatrix4(G)}return this.origin.applyMatrix4(G),this.direction.transformDirection(G),B&&(this.maxHitLen=this.origin.distanceTo(Q)),this},intersectBox:function(y,S){var g,E,b,K,u,d,o=1/this.direction.x,W=1/this.direction.y,I=1/this.direction.z,D=this.origin;if(o>=0?(g=(y.min.x-D.x)*o,E=(y.max.x-D.x)*o):(g=(y.max.x-D.x)*o,E=(y.min.x-D.x)*o),W>=0?(b=(y.min.y-D.y)*W,K=(y.max.y-D.y)*W):(b=(y.max.y-D.y)*W,K=(y.min.y-D.y)*W),g>K||b>E)return null;if((b>g||g!==g)&&(g=b),(E>K||E!==E)&&(E=K),I>=0?(u=(y.min.z-D.z)*I,d=(y.max.z-D.z)*I):(u=(y.max.z-D.z)*I,d=(y.min.z-D.z)*I),g>d||u>E)return null;if((u>g||g!==g)&&(g=u),(E>d||E!==E)&&(E=d),0>E)return null;var R=g>=0?g:E,i=this.maxHitLen;return i&&R>i?null:this.at(R,S)},intersectTriangle:function(){var z=new Lp,g=new Lp,J=new Lp,K=new Lp;return function(M,n,t,p,L){g.subVectors(n,M),J.subVectors(t,M),K.crossVectors(g,J);var N,I=this.direction.dot(K);if(I>0){if(p)return null;N=1}else{if(!(0>I))return null;N=-1,I=-I}z.subVectors(this.origin,M);var b=N*this.direction.dot(J.crossVectors(z,J));if(0>b)return null;var Z=N*this.direction.dot(g.cross(z));if(0>Z||b+Z>I)return null;var X=-N*z.dot(K);if(0>X)return null;var s=X/I,y=this.maxHitLen;return y&&s>y?null:this.at(s,L)}}()});var _r=k.Math.Box3=function(O,h){this.min=O!==K?O:new Lp(1/0,1/0,1/0),this.max=h!==K?h:new Lp(-1/0,-1/0,-1/0)};C.assign(_r.prototype,{set:function(x,m){return this.min.copy(x),this.max.copy(m),this},setFromArray:function(A){for(var $=1/0,O=1/0,Q=1/0,e=-1/0,o=-1/0,d=-1/0,P=0,k=A.length;k>P;P+=3){var U=A[P],l=A[P+1],T=A[P+2];$>U&&($=U),O>l&&(O=l),Q>T&&(Q=T),U>e&&(e=U),l>o&&(o=l),T>d&&(d=T)}return this.min.set($,O,Q),this.max.set(e,o,d),this},setFromPoints:function(L){this.makeEmpty();for(var $=0,G=L.length;G>$;$++)this.expandByPoint(L[$]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(Y){return this.min.copy(Y.min),this.max.copy(Y.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(d){return this.min.min(d),this.max.max(d),this}});var Ln=k.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};C.assign(Ln.prototype,{set:function(H,g,C,p,T,t,V,f,D,b,M,S,i,F,O,K){var m=this.el;return m[0]=H,m[4]=g,m[8]=C,m[12]=p,m[1]=T,m[5]=t,m[9]=V,m[13]=f,m[2]=D,m[6]=b,m[10]=M,m[14]=S,m[3]=i,m[7]=F,m[11]=O,m[15]=K,this},clone:function(){return(new Ln).fromArray(this.el)},fromArray:function(h,C){C===K&&(C=0);for(var l=this.el,b=0;16>b;b++)l[b]=h[b+C];return this},scale:function(U){var I=this.el,v=U.x,i=U.y,V=U.z;return I[0]*=v,I[4]*=i,I[8]*=V,I[1]*=v,I[5]*=i,I[9]*=V,I[2]*=v,I[6]*=i,I[10]*=V,I[3]*=v,I[7]*=i,I[11]*=V,this},makeRotationFromEuler:function(Z){var g=this.el,Y=Z._x,U=Z._y,l=Z._z,o=Z._order,i=Math.cos(Y),$=Math.sin(Y),v=Math.cos(U),e=Math.sin(U),f=Math.cos(l),a=Math.sin(l);if("XYZ"===o){var D=i*f,J=i*a,V=$*f,N=$*a;g[0]=v*f,g[4]=-v*a,g[8]=e,g[1]=J+V*e,g[5]=D-N*e,g[9]=-$*v,g[2]=N-D*e,g[6]=V+J*e,g[10]=i*v}else if("YXZ"===o){var p=v*f,q=v*a,F=e*f,x=e*a;g[0]=p+x*$,g[4]=F*$-q,g[8]=i*e,g[1]=i*a,g[5]=i*f,g[9]=-$,g[2]=q*$-F,g[6]=x+p*$,g[10]=i*v}else if("ZXY"===o){var p=v*f,q=v*a,F=e*f,x=e*a;
g[0]=p-x*$,g[4]=-i*a,g[8]=F+q*$,g[1]=q+F*$,g[5]=i*f,g[9]=x-p*$,g[2]=-i*e,g[6]=$,g[10]=i*v}else if("ZYX"===o){var D=i*f,J=i*a,V=$*f,N=$*a;g[0]=v*f,g[4]=V*e-J,g[8]=D*e+N,g[1]=v*a,g[5]=N*e+D,g[9]=J*e-V,g[2]=-e,g[6]=$*v,g[10]=i*v}else if("YZX"===o){var H=i*v,C=i*e,c=$*v,w=$*e;g[0]=v*f,g[4]=w-H*a,g[8]=c*a+C,g[1]=a,g[5]=i*f,g[9]=-$*f,g[2]=-e*f,g[6]=C*a+c,g[10]=H-w*a}else if("XZY"===o){var H=i*v,C=i*e,c=$*v,w=$*e;g[0]=v*f,g[4]=-a,g[8]=e*f,g[1]=H*a+w,g[5]=i*f,g[9]=C*a-c,g[2]=c*a-C,g[6]=$*f,g[10]=w*a+H}return g[3]=0,g[7]=0,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,this},makeRotationFromQuaternion:function(U){var j=this.el,W=U._x,S=U._y,B=U._z,a=U._w,G=W+W,$=S+S,P=B+B,z=W*G,Q=W*$,r=W*P,n=S*$,y=S*P,I=B*P,h=a*G,w=a*$,X=a*P;return j[0]=1-(n+I),j[4]=Q-X,j[8]=r+w,j[1]=Q+X,j[5]=1-(z+I),j[9]=y-h,j[2]=r-w,j[6]=y+h,j[10]=1-(z+n),j[3]=0,j[7]=0,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(x){var Z=this.el,c=x.el,$=c[0],n=c[1],P=c[2],V=c[3],N=c[4],e=c[5],H=c[6],Q=c[7],s=c[8],j=c[9],M=c[10],C=c[11],F=c[12],D=c[13],m=c[14],b=c[15],X=j*m*Q-D*M*Q+D*H*C-e*m*C-j*H*b+e*M*b,v=F*M*Q-s*m*Q-F*H*C+N*m*C+s*H*b-N*M*b,O=s*D*Q-F*j*Q+F*e*C-N*D*C-s*e*b+N*j*b,Y=F*j*H-s*D*H-F*e*M+N*D*M+s*e*m-N*j*m,R=$*X+n*v+P*O+V*Y;if(0===R)return this.identity();var h=1/R;return Z[0]=X*h,Z[1]=(D*M*V-j*m*V-D*P*C+n*m*C+j*P*b-n*M*b)*h,Z[2]=(e*m*V-D*H*V+D*P*Q-n*m*Q-e*P*b+n*H*b)*h,Z[3]=(j*H*V-e*M*V-j*P*Q+n*M*Q+e*P*C-n*H*C)*h,Z[4]=v*h,Z[5]=(s*m*V-F*M*V+F*P*C-$*m*C-s*P*b+$*M*b)*h,Z[6]=(F*H*V-N*m*V-F*P*Q+$*m*Q+N*P*b-$*H*b)*h,Z[7]=(N*M*V-s*H*V+s*P*Q-$*M*Q-N*P*C+$*H*C)*h,Z[8]=O*h,Z[9]=(F*j*V-s*D*V-F*n*C+$*D*C+s*n*b-$*j*b)*h,Z[10]=(N*D*V-F*e*V+F*n*Q-$*D*Q-N*n*b+$*e*b)*h,Z[11]=(s*e*V-N*j*V-s*n*Q+$*j*Q+N*n*C-$*e*C)*h,Z[12]=Y*h,Z[13]=(s*D*P-F*j*P+F*n*M-$*D*M-s*n*m+$*j*m)*h,Z[14]=(F*e*P-N*D*P-F*n*H+$*D*H+N*n*m-$*e*m)*h,Z[15]=(N*j*P-s*e*P+s*n*H-$*j*H-N*n*M+$*e*M)*h,this},makeRotationAxis:function(l,M){var e=Math.cos(M),H=Math.sin(M),o=1-e,z=l.x,G=l.y,s=l.z,i=o*z,Q=o*G;return this.set(i*z+e,i*G-H*s,i*s+H*G,0,i*G+H*s,Q*G+e,Q*s-H*z,0,i*s-H*G,Q*s+H*z,o*s*s+e,0,0,0,0,1),this},multiply:function(I){return this.multiplyMatrices(this,I)},premultiply:function(T){return this.multiplyMatrices(T,this)},multiplyMatrices:function(d,$){var C=d.el,B=$.el,E=this.el,x=C[0],Y=C[4],z=C[8],w=C[12],b=C[1],v=C[5],j=C[9],Q=C[13],m=C[2],L=C[6],h=C[10],A=C[14],i=C[3],q=C[7],D=C[11],g=C[15],K=B[0],M=B[4],W=B[8],o=B[12],X=B[1],J=B[5],G=B[9],n=B[13],l=B[2],N=B[6],r=B[10],P=B[14],c=B[3],H=B[7],e=B[11],V=B[15];return E[0]=x*K+Y*X+z*l+w*c,E[4]=x*M+Y*J+z*N+w*H,E[8]=x*W+Y*G+z*r+w*e,E[12]=x*o+Y*n+z*P+w*V,E[1]=b*K+v*X+j*l+Q*c,E[5]=b*M+v*J+j*N+Q*H,E[9]=b*W+v*G+j*r+Q*e,E[13]=b*o+v*n+j*P+Q*V,E[2]=m*K+L*X+h*l+A*c,E[6]=m*M+L*J+h*N+A*H,E[10]=m*W+L*G+h*r+A*e,E[14]=m*o+L*n+h*P+A*V,E[3]=i*K+q*X+D*l+g*c,E[7]=i*M+q*J+D*N+g*H,E[11]=i*W+q*G+D*r+g*e,E[15]=i*o+q*n+D*P+g*V,this},lookAt:function(){var Z=new Lp,_=new Lp,E=new Lp;return function(I,W,T){var H=this.el;return E.subVectors(I,W),0===E.lengthSq()&&(E.z=1),E.normalize(),Z.crossVectors(T,E),0===Z.lengthSq()&&(1===Math.abs(T.z)?E.x+=1e-4:E.z+=1e-4,E.normalize(),Z.crossVectors(T,E)),Z.normalize(),_.crossVectors(E,Z),H[0]=Z.x,H[4]=_.x,H[8]=E.x,H[1]=Z.y,H[5]=_.y,H[9]=E.y,H[2]=Z.z,H[6]=_.z,H[10]=E.z,this}}()});var kc=k.Math.Quaternion=function(v,Y,I,L){this.set(v,Y,I,L)};C.assign(kc.prototype,{set:function(O,q,V,T){var F=this;return F._x=O||0,F._y=q||0,F._z=V||0,F._w=T!==K?T:1,F},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(T){var M=this;return M._x=T._x,M._y=T._y,M._z=T._z,M._w=T._w,M},fromArray:function(p,T){T===K&&(T=0);var l=this;return l._x=p[T],l._y=p[T+1],l._z=p[T+2],l._w=p[T+3],this},slerp:function(P,v){if(0===v)return this;if(1===v)return this.copy(P);var f=this._x,m=this._y,N=this._z,Z=this._w,j=Z*P._w+f*P._x+m*P._y+N*P._z;if(0>j?(this._w=-P._w,this._x=-P._x,this._y=-P._y,this._z=-P._z,j=-j):this.copy(P),j>=1)return this._w=Z,this._x=f,this._y=m,this._z=N,this;var l=Math.sqrt(1-j*j);if(Math.abs(l)<.001)return this._w=.5*(Z+this._w),this._x=.5*(f+this._x),this._y=.5*(m+this._y),this._z=.5*(N+this._z),this;var F=Math.atan2(l,j),E=Math.sin((1-v)*F)/l,u=Math.sin(v*F)/l;return this._w=Z*E+this._w*u,this._x=f*E+this._x*u,this._y=m*E+this._y*u,this._z=N*E+this._z*u,this},setFromAxisAngle:function(h,I){var _=I/2,P=Math.sin(_);return this._x=h.x*P,this._y=h.y*P,this._z=h.z*P,this._w=Math.cos(_),this},setFromEuler:function(v){var h=v._x,J=v._y,m=v._z,O=v._order,d=Math.cos,P=Math.sin,f=d(h/2),R=d(J/2),H=d(m/2),Q=P(h/2),C=P(J/2),T=P(m/2);return"XYZ"===O?(this._x=Q*R*H+f*C*T,this._y=f*C*H-Q*R*T,this._z=f*R*T+Q*C*H,this._w=f*R*H-Q*C*T):"YXZ"===O?(this._x=Q*R*H+f*C*T,this._y=f*C*H-Q*R*T,this._z=f*R*T-Q*C*H,this._w=f*R*H+Q*C*T):"ZXY"===O?(this._x=Q*R*H-f*C*T,this._y=f*C*H+Q*R*T,this._z=f*R*T+Q*C*H,this._w=f*R*H-Q*C*T):"ZYX"===O?(this._x=Q*R*H-f*C*T,this._y=f*C*H+Q*R*T,this._z=f*R*T-Q*C*H,this._w=f*R*H+Q*C*T):"YZX"===O?(this._x=Q*R*H+f*C*T,this._y=f*C*H+Q*R*T,this._z=f*R*T-Q*C*H,this._w=f*R*H-Q*C*T):"XZY"===O&&(this._x=Q*R*H-f*C*T,this._y=f*C*H-Q*R*T,this._z=f*R*T+Q*C*H,this._w=f*R*H+Q*C*T),this}});var Yj=k.Math.Triangle=function(h,H,x){this.a=h!==K?h:new Lp,this.b=H!==K?H:new Lp,this.c=x!==K?x:new Lp};C.assign(Yj,{barycoordFromPoint:function(){var n=new Lp,P=new Lp,g=new Lp;return function(m,r,S,i,H){n.subVectors(i,r),P.subVectors(S,r),g.subVectors(m,r);var T=n.dot(n),D=n.dot(P),Y=n.dot(g),_=P.dot(P),L=P.dot(g),J=T*_-D*D,I=H||new Lp;if(0===J)return I.set(-2,-1,-1);var O=1/J,o=(_*Y-D*L)*O,N=(T*L-D*Y)*O;return I.set(1-o-N,N,o)}}()});var Sh=k.Math.Euler=function(g,t,D,Q,M){this.set(g,t,D,Q,M)};Sh.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Sh.DefaultOrder="XYZ",Sh.ReverseOrder=function(a){return a=a[2]+a[1]+a[0],a.toUpperCase()},C.defineProperties(Sh.prototype,{x:{get:function(){return this._x},set:function(h){this._x=h,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(O){this._y=O,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(C){this._z=C,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(M){this._order=M,this.onChangeCallback()}}}),C.assign(Sh.prototype,{set:function(h,n,I,E,s){return Sp(h)&&(s=I,E=n,I=h[2],n=h[1],h=h[0]),E?s&&(E=Sh.ReverseOrder(E)):E="ZYX",this._x=h||0,this._y=n||0,this._z=I||0,this._order=E||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(q){return this._x=q._x,this._y=q._y,this._z=q._z,this._order=q._order,this.onChangeCallback(),this},setFromRotationMatrix:function(v,A,_){var o=k.Math.clamp,K=v.el||v,C=K[0],Q=K[4],g=K[8],P=K[1],t=K[5],H=K[9],p=K[2],X=K[6],J=K[10];return A=A||this._order,"XYZ"===A?(this._y=Math.asin(o(g,-1,1)),Math.abs(g)<.99999?(this._x=Math.atan2(-H,J),this._z=Math.atan2(-Q,C)):(this._x=Math.atan2(X,t),this._z=0)):"YXZ"===A?(this._x=Math.asin(-o(H,-1,1)),Math.abs(H)<.99999?(this._y=Math.atan2(g,J),this._z=Math.atan2(P,t)):(this._y=Math.atan2(-p,C),this._z=0)):"ZXY"===A?(this._x=Math.asin(o(X,-1,1)),Math.abs(X)<.99999?(this._y=Math.atan2(-p,J),this._z=Math.atan2(-Q,t)):(this._y=0,this._z=Math.atan2(P,C))):"ZYX"===A?(this._y=Math.asin(-o(p,-1,1)),Math.abs(p)<.99999?(this._x=Math.atan2(X,J),this._z=Math.atan2(P,C)):(this._x=0,this._z=Math.atan2(-Q,t))):"YZX"===A?(this._z=Math.asin(o(P,-1,1)),Math.abs(P)<.99999?(this._x=Math.atan2(-H,t),this._y=Math.atan2(-p,C)):(this._x=0,this._y=Math.atan2(g,J))):"XZY"===A?(this._z=Math.asin(-o(Q,-1,1)),Math.abs(Q)<.99999?(this._x=Math.atan2(X,t),this._y=Math.atan2(g,C)):(this._x=Math.atan2(-H,J),this._y=0)):console.warn("unsupported order: "+A),this._order=A,_!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var M=new Ln;return function(E,O,q){return M.makeRotationFromQuaternion(E),this.setFromRotationMatrix(M,O,q)}}(),setFromVector3:function(E,t){return this.set(E.x,E.y,E.z,t||this._order)},reorder:function(){var S=new kc;return function(C){return S.setFromEuler(this),this.setFromQuaternion(S,C)}}(),equals:function(y){return y._x===this._x&&y._y===this._y&&y._z===this._z&&y._order===this._order},fromArray:function(W){return this._x=W[0],this._y=W[1],this._z=W[2],W[3]!==K&&(this._order=W[3]),this.onChangeCallback(),this},toArray:function(l,i){return l===K&&(l=[]),i===K&&(i=0),l[i]=this._x,l[i+1]=this._y,l[i+2]=this._z,l[i+3]=this._order,l},toVector3:function(C){return C?C.set(this._x,this._y,this._z):new Lp(this._x,this._y,this._z)},onChange:function(T){return this.onChangeCallback=T,this},onChangeCallback:function(){}});var $p=k.List=function(){this._as=[];var $,G,F=arguments.length;if(1===F){var k=arguments[0];if(ff(k)&&(k=k._as),Sp(k))for(G=k.length,$=0;G>$;$++)this._as.push(k[$]);else k!=Z&&this._as.push(k)}else if(F>1)for($=0;F>$;$++)this._as.push(arguments[$])};to("List",C,{forEach:function(X,G){this.each(X,G)},push:function(){for(var K=0;K<arguments.length;K++)this.add(arguments[K])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(b,z){return z===K?this._as.push(b):this._as.splice(z,0,b)},addAll:function(u){ff(u)&&(u=u._as),Sp(u)?mf(this._as,u):this._as.push(u)},get:function(q){return this._as[q]},slice:function(N,U){return new $p(this._as.slice(N,U))},remove:function(e){var c=this._as.indexOf(e);return c>=0&&c<this._as.length&&this.removeAt(c),c},removeAt:function(O){return this._as.splice(O,1)[0]},set:function(r,w){return this._as[r]=w},clear:function(){return this._as.splice(0,this._as.length)},contains:function(s){return this._as.indexOf(s)>=0},indexOf:function(j){return this._as.indexOf(j)},each:function(G,g){for(var l=0,_=this._as.length;_>l;l++){var p=this._as[l];g?G.call(g,p,l,this):G(p,l,this)}},reverseEach:function(v,B){for(var M=this._as.length-1;M>=0;M--){var p=this._as[M];B?v.call(B,p):v(p)}},toArray:function(O,J){if(O){for(var B,f=[],F=0,N=this._as.length;N>F;F++)B=this._as[F],J?O.call(J,B)&&f.push(B):O(B)&&f.push(B);return f}return this._as.concat()},toList:function(Z,T){if(Z){for(var X,E=new $p,N=0,J=this._as.length;J>N;N++)X=this._as[N],T?Z.call(T,X)&&E.add(X):Z(X)&&E.add(X);return E}return new $p(this)},reverse:function(){this._as.reverse()},sort:function(w){return this._as.sort(w?w:Uo),this},toString:function(){return this._as.toString()}}),C.defineProperties($p.prototype,{length:{get:function(){return this._as.length},set:function(t){this._as.length=t}}});var kh=new $p;Bm(kh,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:mb,each:mb,reverseEach:mb,toArray:function(){return[]},toList:function(){return new $p},add:pf,addAll:pf,set:pf,remove:pf,removeAt:pf,clear:pf});var Kh=k.Notifier=function(){this._f=0};to("Notifier",C,{contains:function(i,Q){if(this._ls)for(var y,O=0,R=this._ls.size();R>O;O++)if(y=this._ls.get(O),i===y.l&&Q===y.s)return!0;return!1},add:function(s,S,C){var P=this,K={l:s,s:S,a:C};P._ls||(P._ls=new $p),P._f?(P._as||(P._as=new $p),P._as.add(K)):K.a?P._ls.add(K,0):P._ls.add(K)},remove:function(l,b){var u=this;u._ls&&(u._f?(u._rs||(u._rs=new $p),u._rs.add({l:l,s:b})):u._remove(l,b))},_remove:function(A,H){for(var R,c=this._ls,$=0,d=c.size();d>$;$++)if(R=c.get($),R.l===A&&R.s===H)return c.removeAt($),void 0},fire:function(R){var h=this,D=h._ls;if(h._b=1e4,D){++h._f;try{for(var A,M=0,C=D.size();C>M;M++)A=D.get(M),A.s?A.l.call(A.s,R):A.l(R)}finally{if(--h._f)return;if(h._rs){for(C=h._rs.size(),M=0;C>M;M++)A=h._rs.get(M),h._remove(A.l,A.s);delete h._rs}if(h._as){for(C=h._as.size(),M=0;C>M;M++)A=h._as.get(M),A.a?D.add(A,0):D.add(A);delete h._as}}}}});var Er=k.Data=function(){this._id=rh()};to("Data",C,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:Z,_parent:Z,_children:kh,_childMap:Z,_styleMap:Z,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return Z},_22Q:function(){return Z},s:function(r,_){var T=this;if(2===arguments.length)T.setStyle(r,_);else{if(!Eq(r))return T.getStyle(r);for(var j in r)T.setStyle(j,r[j])}return T},fp:function(I,c,G,r,s){return this.firePropertyChange(I,c,G,r,s)},firePropertyChange:function(f,x,e,d,B){if(d){if(d(x,e))return!1}else if(x===e)return!1;var t=this,K=B||{};return K.property=f,K.oldValue=x,K.newValue=e,K.data=t,t._dataModel&&t._dataModel.handleDataPropertyChange(K),t.onPropertyChanged(K),!0},onPropertyChanged:function(n){var a=this,l=a._parent,Y=n.property;if(Em(l)){var O=a.s(hh),_="s:ingroup"===Y;(O&&Kd[Y]||Y===_)&&l._81I(),(O||_)&&l.fp("childChange",!0,!1)}Ai(l)&&Kd[Y]&&l.updateFromChildren()},_21I:function(D){var p=this;if(D&&p._dataModel)throw"Remove data from dataModel before adding";p._dataModel=D},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var W=0,k=this._children.toArray(),D=k.length;D>W;W++)k[W].removeFromDataModel()},getId:function(){return this._id},setId:function(X){this._id=X},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(v,c){return this._children.toList(v,c)},eachChild:function(E,I){this._children.each(E,I)},addChild:function(o,y){var P=this;o!==P&&(P._children===kh&&(P._children=new $p,P._childMap={}),y>=0||(y=P._children.size()),P._childMap[o._id]||P.isDescendantOf(o)||(o._parent&&o._parent.removeChild(o),(0>y||y>P._children.size())&&(y=P._children.size()),P._children.add(o,y),P._childMap[o._id]=o,o.setParent(P),P.onChildAdded(o,y),P.fp(nb,Z,o)))},onChildAdded:function(){},removeChild:function(y){var m=this;if(m._childMap&&m._childMap[y._id]){var s=m._children.remove(y);delete m._childMap[y._id],m.fp(nb,y,Z),y.setParent(Z,s),m.onChildRemoved(y,s)}},onChildRemoved:function(){},getChildAt:function(A){return this._children.get(A)},clearChildren:function(){var O=this;if(!O._children.isEmpty())for(var P=0,v=O._children.toArray(),H=v.length;H>P;P++)O.removeChild(v[P])},getParent:function(){return this._parent},setParent:function(D,s){var O=this;if(!(O._73I||O._parent===D||O===D||D&&D.isDescendantOf(O))){var S,Y=O._parent;O._parent=D,O._73I=1,Y?(s==Z&&(s=Y.getChildren().indexOf(O)),Y.removeChild(O)):O._dataModel&&s==Z&&(s=O._dataModel.getRoots().indexOf(O)),D&&(D.addChild(O),S=D.getChildren().indexOf(O)),delete O._73I,O.fp("parent",Y,D,K,{oldIndex:s,newIndex:S}),O.onParentChanged(Y,D)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(Z){return Z?this.isDescendantOf(Z)||Z.isDescendantOf(this):!1},isParentOf:function(S){return S&&this._childMap?!!this._childMap[S._id]:!1},isDescendantOf:function(Z){if(!Z||Z.isEmpty())return!1;for(var A=this._parent;A;){if(Z===A)return!0;A=A._parent}return!1},getStyle:function(r,H){H===K&&(H=1);var d=this._styleMap?this._styleMap[r]:K;return d===K&&H?S[r]:d},setStyle:function(t,R){var c=this;c._styleMap||(c._styleMap={});var G=c._styleMap[t];R===K?delete c._styleMap[t]:c._styleMap[t]=R,c.fp("s:"+t,G,R)&&c.onStyleChanged(t,G,R)},onStyleChanged:function(){},iv:function(T){this.invalidate(T)},invalidate:function(O){this.fp(O||"*",!1,!0)},toString:function(){var n=this;return n._displayName||n._name||n._tag||n._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(v,h){var P=this,M=P.s(of);M||P.s(of,M={}),h?M[v]=h:delete M[v],P.fp(of,Z,M)},removeStyleIcon:function(p){var I=this.s(of);if(I){var t=I[p];delete I[p],this.fp(of,Z,I)}return t},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var b,V={};for(b in this._styleMap)V[b]=1;return V}});var Sn=k.DataModel=function(){var X=this;X._datas=new $p,X._dataMap={},X._roots=new $p,X._rootMap={},X._fsDataMap={},X._78O={},X._36I=new Kh,X._35I=new Kh,X._serializeNotifier=new Kh,X._selectionModel=new Sm(X);var a=X._29Q=[],m=X._scheduleCallback=function(){for(var f=Date.now(),Q=0;Q<a.length;Q++){var z=a[Q];z.enabled&&f-z.lastTime>z.interval&&(z.beforeAction&&z.beforeAction(),X.each(function(C){z.action(C)}),z.afterAction&&z.afterAction(),z.lastTime=f)}a.length&&(X._30Q=x.requestAnimationFrame(m))}};to("DataModel",C,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:K,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:K,_init:K,_envmap:K,_postProcessingData:K,sm:function(){return this.getSelectionModel()},mm:function(r,w,y){this.addDataModelChangeListener(r,w,y)},umm:function(t,K){this.removeDataModelChangeListener(t,K)},md:function(G,Q,S){this.addDataPropertyChangeListener(G,Q,S)},umd:function(e,q){this.removeDataPropertyChangeListener(e,q)},mh:function(c,t,X){this.addHierarchyChangeListener(c,t,X)},umh:function(J,o){this.removeHierarchyChangeListener(J,o)},getAttrObject:function(){return this._attrObject},setAttrObject:function(p){return this._attrObject=p},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(y){return this._dataMap[y]},removeDataById:function(F){this.remove(this.getDataById(F))},toDatas:function(x,P){return this._datas.toList(x,P)},each:function(q,X){this._datas.each(q,X)},getDataByTag:function(V){return this._78O[V]},getTagMap:function(){return this._78O},removeDataByTag:function(t){this.remove(this.getDataByTag(t))},add:function(Q,m,I){var V=this,n=Q._id,r=Q._tag,c=V._roots;if(V._dataMap[n])throw"'"+n+"' already exists";r!=Z&&(V._78O[r]=Q),V._dataMap[n]=Q,I>=0?V._datas.add(Q,I):V._datas.add(Q),Q._parent||(V._rootMap[n]=Q,m>=0?c.add(Q,m):c.add(Q)),Q.s("fullscreen")!==K&&(V._fsDataMap[n]=Q),Q._21I(V),V.onAdded(Q),V._36I.fire({kind:"add",data:Q,rootsIndex:m,datasIndex:I})},onAdded:function(){},remove:function(l,E){if(l){var y=this,j=l._id,p=E&&E.keepStructure,d=E&&E.keepChildren,m=l.getTag();if(l._dataModel===y){this.beginTransaction(),p?y._removingData||(y._removingData=l):y.prepareRemove(l),d||l.toChildren().each(function($){y.remove($,E)},y),p?y._removingData===l&&(l._parent&&l._parent.removeChild(l),delete y._removingData):l._parent&&l._parent.removeChild(l);var M=y._datas.remove(l);delete y._dataMap[j],m!=Z&&delete y._78O[m];var x;y._rootMap[j]&&(delete y._rootMap[j],x=y._roots.remove(l)),y._fsDataMap[j]&&delete y._fsDataMap[j],l._21I(Z),y.onRemoved(l),y._36I.fire({kind:tr,data:l,rootsIndex:x,datasIndex:M}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var k=this;if(k._datas.size()){var r=k._historyManager?this.toJSON():K;k._datas.toArray().forEach(function(q){q._21I(Z)}),k._datas.clear(),k._dataMap={},k._roots.clear(),k._rootMap={},k._fsDataMap={},k._78O={},k._36I.fire({kind:Dk,json:r})}},contains:function(r){return r&&r._dataModel===this},handleDataPropertyChange:function(b){var $=this,y=b.data,J=b.property;if("parent"===J){var p=y._id,B=$._rootMap,i=$._roots;y._parent?B[p]&&(delete B[p],i.remove(y)):B[p]||(B[p]=y,i.add(y))}else if("tag"===J){var d=b.oldValue,K=b.newValue,n=$._78O;d!=Z&&delete n[d],K!=Z&&(n[K]=y)}else if("s:fullscreen"===J){var p=y._id,M=$._fsDataMap;b.oldValue!=Z&&delete M[p],b.newValue!=Z&&(M[p]=y)}this.onDataPropertyChanged(y,b),this._35I.fire(b)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(x,L,p){this._36I.add(x,L,p)},removeDataModelChangeListener:function(r,q){this._36I.remove(r,q)},addSerializeListener:function(D,F,G){this._serializeNotifier.add(D,F,G)},removeSerializeListener:function(S,D){this._serializeNotifier.remove(S,D)},fireSerializeEvent:function(B){this._serializeNotifier.fire(B)},addDataPropertyChangeListener:function(e,A,p){this._35I.add(e,A,p)},removeDataPropertyChangeListener:function(m,L){this._35I.remove(m,L)},_38I:function(U,F,S){this._37I&&this._37I.fire({data:U,oldIndex:F,newIndex:S})},addHierarchyChangeListener:function(p,x,k){this._37I||(this._37I=new Kh),this._37I.add(p,x,k)},removeHierarchyChangeListener:function(m,Y){this._37I.remove(m,Y)},getSiblings:function(d){var W=d._parent;return W?W._children:this._roots},eachByHierarchical:function(w,z,p){if(z)return this._eachByHierarchical(w,z,p);for(var $=0,Y=this._roots,G=Y.size();G>$;$++)if(this._eachByHierarchical(w,Y.get($),p)===!1)return!1;return!0},_eachByHierarchical:function(T,S,J){if(J){if(T.call(J,S)===!1)return!1}else if(T(S)===!1)return!1;for(var e=S.size(),l=0;e>l;l++)if(this._eachByHierarchical(T,S.getChildAt(l),J)===!1)return!1;return!0},reverseEachByHierarchical:function(G,r,j){if(r)return this._reverseEachByHierarchical(G,r,j);for(var U=this._roots,e=U.size(),Q=e-1;Q>=0;Q--)if(this._reverseEachByHierarchical(G,U.get(Q),j)===!1)return!1;return!0},_reverseEachByHierarchical:function(Y,c,V){for(var S=c.size(),a=S-1;a>=0;a--)if(this._reverseEachByHierarchical(Y,c.getChildAt(a),V)===!1)return!1;if(V){if(Y.call(V,c)===!1)return!1}else if(Y(c)===!1)return!1;return!0},eachByDepthFirst:function(X,O,o){if(O)return this._11I(X,O,o);for(var N=0,S=this._roots,D=S.size();D>N;N++)if(this._11I(X,S.get(N),o)===!1)return!1;return!0},_11I:function(B,D,u){for(var l=D.size(),Z=0;l>Z;Z++)if(this._11I(B,D.getChildAt(Z),u)===!1)return!1;if(u){if(B.call(u,D)===!1)return!1}else if(B(D)===!1)return!1;return!0},eachByBreadthFirst:function(Z,H,N){var K=new $p;for(H?K.add(H):this._roots.each(K.add,K);K.size()>0;)if(H=K.removeAt(0),H.eachChild(K.add,K),N){if(Z.call(N,H)===!1)return!1}else if(Z(H)===!1)return!1;return!0},moveTo:function(X,q){var b=this.getSiblings(X),M=b.indexOf(X);M===q||0>M||q>=0&&q<=b.size()&&(b.remove(X),q>b.size()&&q--,b.add(X,q),this._38I(X,M,q))},moveUp:function($){this.moveTo($,this.getSiblings($).indexOf($)-1)},moveDown:function(Q){this.moveTo(Q,this.getSiblings(Q).indexOf(Q)+1)},moveToTop:function(q){this.moveTo(q,0)},moveToBottom:function(D){this.moveTo(D,this.getSiblings(D).size())},moveSelectionUp:function(x){this.beginTransaction(),x||(x=this.sm());var P=new $p;An(x,P,this._roots),P.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(S){this.beginTransaction(),S||(S=this.sm());var N=new $p;Qf(S,N,this._roots),N.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(u){this.beginTransaction(),u||(u=this.sm());var b=new $p;Xj(u,b,this._roots),b.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(D){this.beginTransaction(),D||(D=this.sm());var o=new $p;Dr(D,o,this._roots),o.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(j,F,T){var M=this.getDatas();null==T&&(T=M.indexOf(j)),T===F||0>T||F>=0&&F<=M.size()&&(M.remove(j),F>M.size()&&F--,M.add(j,F),this._76I(j,T,F))},bringForward:function(u){this.moveToIndex(u,this.getDatas().indexOf(u)+1)},bringToFront:function(M){this.moveToIndex(M,this.size())},sendBackward:function(m){this.moveToIndex(m,this.getDatas().indexOf(m)-1)},sendToBack:function(W){this.moveToIndex(W,0)},bringSelectionForward:function(W){this.beginTransaction(),W||(W=this.sm());for(var o=new $p,D=this.getDatas(),f=!1,P=0;P<D.size();P++){var r=D.get(D.size()-1-P);W.contains(r)?f&&o.add(r):f=!0}o.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(e){this.beginTransaction(),e||(e=this.sm());for(var O=new $p,b=this.getDatas(),I=0;I<b.size();I++){var p=b.get(I);e.contains(p)&&O.add(p)}O.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(I){this.beginTransaction(),I||(I=this.sm());for(var i=new $p,r=this.getDatas(),C=!1,O=0;O<r.size();O++){var K=r.get(O);I.contains(K)?C&&i.add(K):C=!0}i.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(l){this.beginTransaction(),l||(l=this.sm());for(var g=new $p,f=this.getDatas(),O=0;O<f.size();O++){var c=f.get(f.size()-1-O);l.contains(c)&&g.add(c)}g.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(A){var y=this;y.removeScheduleTask(A),A.enabled==Z&&(A.enabled=!0),A.interval==Z&&(A.interval=10),A.action==Z&&(A.action=mb),A.lastTime=Date.now(),y._29Q.push(A),y._30Q==Z&&(y._30Q=x.requestAnimationFrame(y._scheduleCallback))},removeScheduleTask:function(v){var i=this,V=i._29Q,S=V.indexOf(v);S>=0&&V.splice(S,1),V.length||i._30Q==Z||(x.cancelAnimationFrame(i._30Q),delete i._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(O){this._historyManager||new k.HistoryManager(this),null!=O&&this._historyManager.setMaxHistoryCount(O),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(u){this._historyManager&&this._historyManager.undo(u)},redo:function(p){this._historyManager&&this._historyManager.redo(p)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(s){this._historyManager&&this._historyManager.addHistory(s)},onHistoryManagerChanged:function(){}});var Sm=k.SelectionModel=function(W){var K=this;K._68O=vp,K._map={},K._73O=new $p,K._74I=new Kh,K._21I(W)};to("SelectionModel",C,{ms_fire:1,ms_dm:1,ms:function(i,c,u){this.addSelectionChangeListener(i,c,u)},ums:function(w,i){this.removeSelectionChangeListener(w,i)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===fe},co:function(T){return this._map[T._id]!=Z},ss:function(z){this.setSelection(z)},as:function(T){this.appendSelection(T)},rs:function(D){this.removeSelection(D)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(s){var z=this;if(z._68O!==s&&(s===Ur||s===fe||s===vp)){z.cs();var Y=z._68O;z._68O=s,z.fp("selectionMode",Y,s)}},_21I:function(T){var v=this,h=v._dataModel;h!==T&&(h&&(v.cs(),h.umm(v.handleDataModelChange,v)),v._dataModel=T,T.mm(v.handleDataModelChange,v,!0),v.fp(Xd,h,T))},dispose:function(){var q=this;q.cs(),q._dataModel.umm(q.handleDataModelChange,q)},handleDataModelChange:function(E){var r=this;if(E.kind===tr){var s=E.data;r.co(s)&&(r._73O.remove(s),delete r._map[s._id],r._75I(tr,new $p(s)))}else E.kind===Dk&&r.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(A){var N=this;if(N._filterFunc!==A){N.cs();var T=N._filterFunc;N._filterFunc=A,N.fp("filterFunc",T,N._filterFunc)}},_75I:function(a,z,C,H){C&&(this._73O.each(function(u){H[u._id]?C.remove(u):C.add(u)}),z=C.toList()),this._74I.fire({kind:a,datas:new $p(z)})},addSelectionChangeListener:function(k,t,p){this._74I.add(k,t,p)},removeSelectionChangeListener:function(r,v){this._74I.remove(r,v)},_97O:function(k,b){for(var o,$=this,H=0,w=new $p(k);H<w.size();H++)o=w.get(H),($._filterFunc&&!$._filterFunc(o)||b&&$.co(o)||!b&&!$.co(o)||!$._dataModel.contains(o))&&(w.removeAt(H),H--);return w},appendSelection:function(d){var D=this;if(D._68O!==Ur){var V,u,s=D._73O,Q=D._97O(d,!0);Q.isEmpty()||(D.sg()&&(V=new $p(s),u=D._map,s.clear(),D._map={},Q=new $p(Q.get(Q.size()-1))),Q.each(function(x){s.add(x),D._map[x._id]=x}),D._75I("append",Q,V,u))}},removeSelection:function(z){var q=this,J=q._97O(z),x=0,X=J.size();if(0!==X){for(;X>x;x++){var D=J.get(x);q._73O.remove(D),delete q._map[D._id]}q._75I(tr,J)}},toSelection:function(Z,E){return this._73O.toList(Z,E)},getSelection:function(){return this._73O},each:function(f,g){this._73O.each(f,g)},setSelection:function(I){var j=this,k=j._73O;if(j._68O!==Ur&&!(k.isEmpty()&&!I||1===k.size()&&j.ld()===I)){var n=new $p(k),N=j._map;k.clear(),j._map={};var _=j._97O(I,!0);j.sg()&&_.size()>1&&(_=new $p(_.get(_.size()-1))),_.each(function(d){k.add(d),j._map[d._id]=d}),j._75I("set",Z,n,N)}},clearSelection:function(){var L=this,q=L._73O;if(q.size()>0){var O=q.toList();q.clear(),L._map={},L._75I(Dk,O)}},selectAll:function(){var G=this;if(G._68O!==Ur){var d,p,P=G._dataModel.toDatas();if(G._filterFunc)for(d=0;d<P.size();d++)p=P.get(d),G._filterFunc(p)||(P.removeAt(d),d--);var b=G._73O,O=new $p(b),L=G._map;b.clear(),G._map={},G.sg()&&P.size()>1&&(P=new $p(P.get(P.size()-1)));var x=P.size();for(d=0;x>d;d++)p=P.get(d),b.add(p),G._map[p._id]=p;G._75I("all",Z,O,L)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(C){return this._map[C._id]!=Z},getLastData:function(){var L=this._73O;return L.size()>0?L.get(L.size()-1):Z},getFirstData:function(){var J=this._73O;return J.size()>0?J.get(0):Z},isSelectable:function(w){var a=this;return w&&a._68O!==Ur?a._filterFunc?a._filterFunc(w):!0:!1},getTopSelection:function(){var x=this,t=new $p;return x._73O.each(function(u){for(var m=u.getParent();m;){if(x.contains(m)){u=Z;break}m=m.parent}u&&t.add(u)}),t}});var vm=function(){return Bk(0),function(D,q){var C;if(Oc(q)){var L=D.getDataUI(q);L&&L._88I&&(C=L._88I.rect)}return C?C:q.getRect()}}();Bm(M,{edgeGroupAgentFunc:Z,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:c.rectSelectBorder,graphViewRectSelectBackground:Xg,graphViewEditPointSize:Jq?17:7,graphViewEditPointBorderColor:c.editPointBorder,graphViewEditPointBackground:c.editPointBackground,setEdgeType:function(n,j,g){Al[n]=j,uq[n]=g},getEdgeType:function(e){return Al[e]},getEdgeTypeMap:function(){return Al},getNodeRect:vm},!0),Bm(S,{layout:!1,"layout.h":K,"layout.h.value":K,"layout.v":K,"layout.v.value":K,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":K,interactive:!1,"image.stretch":"fill",icons:K,ingroup:!0,"body.color":K,"2d.gray":!1,fullscreen:K,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:K,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":_d,"select.width":1,"select.padding":2,"select.type":Kb,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":K,"border.width":2,"border.padding":2,"border.type":Kb,label:K,"label.font":K,"label.color":op,"label.background":K,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":K,"label.max":K,"label.opacity":K,"label.scale":1,"label.align":K,"label.selectable":!0,label2:K,"label2.font":K,"label2.color":op,"label2.background":K,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":K,"label2.max":K,"label2.opacity":K,"label2.scale":1,"label2.align":K,"label2.selectable":!0,note:K,"note.expanded":!0,"note.font":K,"note.color":xh,"note.background":_d,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":K,"note.toggleable":!0,"note.border.width":1,"note.border.color":K,"note.opacity":K,"note.scale":1,"note.align":K,note2:K,"note2.expanded":!0,"note2.font":K,"note2.color":xh,"note2.background":_d,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":K,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":K,"note2.opacity":K,"note2.scale":1,"note2.align":K,"group.type":K,"group.image":K,"group.image.stretch":"fill","group.repeat.image":K,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":K,"group.title.color":xh,"group.title.background":c.groupTitleBackground,"group.title.align":Wf,"group.title.orientation":uc,"group.background":c.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":K,"group.border.color":wn,"group.border.radius":0,"group.border.cap":Zd,"group.border.join":Cj,"group.splitLine":!1,"group.gradient":Z,"group.gradient.color":"#FFF",shape:K,"shape.background":wn,"shape.repeat.image":K,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":wn,"shape.border.3d":!1,"shape.border.3d.color":K,"shape.border.3d.accuracy":K,"shape.border.cap":Zd,"shape.border.join":Cj,"shape.border.pattern":K,"shape.gradient":Z,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":xs,"shape.dash.offset":0,"shape.dash.color":al,"shape.dash.width":K,"shape.dash.3d":!1,"shape.dash.3d.color":K,"shape.dash.3d.accuracy":K,"shape.polygon.side":6,"shape.arc.from":B,"shape.arc.to":G,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":K,"shape.gradient.pack":K,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":K,"shape.foreground.gradient":Z,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":K,"autolayout.hgap":K,"autolayout.vgap":K,"edge.type":K,"edge.points":K,"edge.segments":K,"edge.color":wn,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":K,"edge.3d.accuracy":K,"edge.cap":Zd,"edge.join":Cj,"edge.source.position":17,"edge.source.anchor.x":K,"edge.source.anchor.y":K,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":K,"edge.target.anchor.y":K,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":K,"edge.dash":!1,"edge.dash.pattern":xs,"edge.dash.offset":0,"edge.dash.color":al,"edge.dash.width":K,"edge.dash.3d":!1,"edge.dash.3d.color":K,"edge.dash.3d.accuracy":K,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":K,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":K,"grid.column.percents":K,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":c.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":c.gridCellBorderColor,"grid.block":K,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":c.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":op,"text.font":Hp,"text.shadow":!1,"text.shadow.color":_d,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),Bm(Sn,{_76I:function(W,L,d){this._39I&&this._39I.fire({data:W,oldIndex:L,newIndex:d})
},addIndexChangeListener:function(K,m,A){var Y=this;Y._39I||(Y._39I=new Kh),Y._39I.add(K,m,A)},removeIndexChangeListener:function(v,f){this._39I.remove(v,f)},prepareRemove:function(E){el(E)&&(E.setSource(Z),E.setTarget(Z)),E._70O&&E._70O.toList().each(this.remove,this),E._69O&&E._69O.toList().each(function(k){k.setHost(Z)}),E._host&&E.setHost(Z)},onAdded:function(d){this.isAutoAdjustIndex()&&this.adjustIndex(d)},onDataPropertyChanged:function(S,P){Co[P.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(S)},isAdjustable:function(r){return vs(r)||el(r)},isAdjustedToBottom:function(U){return Em(U)?U.isExpanded()&&Qc(U):!1},adjustIndex:function(X){var c=this;this.isHierarchicalRendering()||(c.isAdjustedToBottom(X)?(c.sendToBottom(X),X.eachChild(c.adjustIndex,c)):c.sendToTop(X))},sendToTop:function(M){var $=this;if($.contains(M)&&$.isAdjustable(M)){var X=$._datas;if(M!==X.get($.size()-1)){var v=X.indexOf(M);X.removeAt(v),X.add(M),$._76I(M,v,$.size()-1)}if(el(M)){var P=M._40I;P&&!$.isAdjustedToBottom(P)&&$.sendToTop(P),P=M._41I,P&&!$.isAdjustedToBottom(P)&&$.sendToTop(P)}M._69O&&M._69O.each(function(o){o.isRelatedTo(M)||vs(M)&&o.isLoopedHostOn(M)||$.sendToTop(o)}),M.ISubGraph||(!Em(M)||M.isExpanded())&&M._adjustChildrenToTop&&M.eachChild(function(x){el(x)||$.sendToTop(x)})}},sendToBottom:function(c,O){var _=this;if(c!==O&&_.contains(c)&&_.isAdjustable(c)&&(!O||_.contains(O))){var X=_._datas,s=X.remove(c),h=O?_._datas.indexOf(O):0;if(X.add(c,h),s!==h){_._76I(c,s,h);var k=c._parent;!k||k.ISubGraph||el(k)||_.sendToBottom(c._parent,c)}}}}),Bm(gi,{ms_edit:function(O){O._46O=function(p){var u=this,V=u.gv.dm(),U=u._index,X=u._89I,c=u._node,C=u._shape,M=u._edge,j=u._77I;c&&X?(this.fi({kind:"endEditRect",event:p,data:c,direction:X}),V.endTransaction()):C&&U>=0?(u.fi({kind:"endEditPoint",event:p,data:C,index:U}),V.endTransaction()):M&&U>=0?(u.fi({kind:"endEditPoint",event:p,data:M,index:U}),V.endTransaction()):j&&(u.fi({kind:"endEditRotation",event:p,data:j}),V.endTransaction())},O._78I=function(F){var j=this;j.autoScroll(F);var A=j.gv.lp(F),E=j._index,G=j._89I,L=j._node,Q=j._shape,i=j._edge,W=j._77I;if(L&&G)j._80O(A),j.fi({kind:"betweenEditRect",event:F,data:L,direction:G});else if(Q&&E>=0)A.e=Q.getPoints().get(E).e,Q.setPoint(E,A),j.fi({kind:"betweenEditPoint",event:F,data:Q,index:E});else if(i&&E>=0){var x=i.s(wp);A.e=x.get(E).e,x.set(E,A),i.fp(wp,Z,x),j.fi({kind:"betweenEditPoint",event:F,data:i,index:E})}else if(W){var y=W.p(),k=W.getScale(),v=I+g(A.y-y.y,A.x-y.x);k.y<0&&(v+=B),s(v)<.04&&(v=0),W.setRotation(v),j.fi({kind:"betweenEditRotation",event:F,data:W})}},O._80O=function(x){var b=this,E=b._node,c=b._rect,w=c.x,J=c.y,a=c.width,t=c.height,X=b._89I,F=b._anchor,R=b._matrix,x=R.tfi(x);"northwest"===X?c=Fp(x,{x:w+a,y:J+t}):X===fl?c=Fp({x:w,y:x.y},{x:w+a,y:J+t}):"northeast"===X?c=Fp({x:w,y:x.y},{x:x.x,y:J+t}):X===er?c=Fp({x:x.x,y:J},{x:w+a,y:J+t}):X===Mp?c=Fp({x:w,y:J},{x:x.x,y:J+t}):"southwest"===X?c=Fp({x:x.x,y:J},{x:w+a,y:x.y}):"south"===X?c=Fp({x:w,y:J},{x:w+a,y:x.y}):"southeast"===X&&(c=Fp({x:w,y:J},x)),E.setPosition(R.tf(c.x+c.width*F.x,c.y+c.height*F.y)),E.setWidth(c.width),E.setHeight(c.height)},O._80I=function(k,B,I,Z){var H=this,F=H.gv._zoom,l=(H.gv.getEditPointSize()+2)/F;return Um({x:B-l/2,y:I-l/2,width:l,height:l},k)?(H._89I!==Z&&(H._89I=Z),!0):!1},O._79I=function(s,T,B){var f=this,e=f.gv,H=T?e.getDataUI(T):Z,K=H?H._55O:Z;if(K){var m,o,U,I,C=e._zoom,j=(e.getEditPointSize()+2)/C,Q=e.lp(s);if(vs(T)){if(K._56O&&vs(T)&&(o=K._98o,Um({x:o.x-j/2,y:o.y-j/2,width:j,height:j},Q)))return f._77I=T,B&&f.fi({kind:"beginEditRotation",event:s,data:T}),f.setCursor("crosshair"),!0;if(K._43O&&T instanceof Vl)for(U=T.getPoints(),m=U.size()-1;m>=0;m--)if(o=U.get(m),Um({x:o.x-j/2,y:o.y-j/2,width:j,height:j},Q))return f._index=m,f._shape=T,B&&f.fi({kind:"beginEditPoint",event:s,data:T,index:m}),f.setCursor("crosshair"),!0;if(K._42O)for(var v=T.getEditControlPoints(),k=["northwest",-1,-1,er,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Mp,1,0,"northeast",1,-1,fl,0,-1],m=0,I=v.length;I>m;m++){var t=k[3*m],W=v[m];if(f._80I(Q,W.x,W.y,t)){f._node=T;var X=T.getWidth(),i=T.getHeight(),u=T.getAnchor();f._rect={x:-X*u.x,y:-i*u.y,width:X,height:i},f._anchor=u,f._matrix=T.getMatrix();var N=T.getRotation(),G=y(N),b=J(N),P=k[3*m+1]*wq(T.getScale().x),q=k[3*m+2]*wq(T.getScale().y),l=Math.atan2(-b*P-G*q,G*P-b*q),z=(Math.round(l/(Math.PI/4))+8)%8,L=[zi,"nesw-resize",no,"nwse-resize",zi,"nesw-resize",no,"nwse-resize"][z];return f.setCursor(L),B&&f.fi({kind:"beginEditRect",event:s,data:T,direction:f._89I}),!0}}}if(K._43O&&el(T)&&T.s(qq)===li&&(U=T.s(wp)))for(m=U.size()-1;m>=0;m--)if(o=U.get(m),Um({x:o.x-j/2,y:o.y-j/2,width:j,height:j},Q))return f._index=m,f._edge=T,B&&f.fi({kind:"beginEditPoint",event:s,data:T,index:m}),f.setCursor("crosshair"),!0}return!1}},ms_gv:function(j){j._currentSubGraph=Z,j.upSubGraph=function(){this.setCurrentSubGraph(Dp(this._currentSubGraph))},j.isVisible=function(E){var G=this;if(Dp(E)!==G._currentSubGraph)return!1;if(el(E)){var S=E._40I,J=E._41I;if(!S||!J)return!1;if(!(E.s("edge.independent")||G.isVisible(S)&&G.isVisible(J)))return!1;if(E.isEdgeGroupHidden())return!1}else for(var Z=E._parent;Z&&!Z.ISubGraph;){if(Em(Z)&&(!Z.isExpanded()||!G.isVisible(Z)))return!1;Z=Z._parent}if(E._parent instanceof Gl&&!G.isVisible(E._parent))return!1;if(E._refGraph instanceof Gp&&!G.isVisible(E._refGraph))return!1;if(G instanceof Kq){if(!E.s("3d.visible"))return!1}else{var M=G.getLayersInfo();if(M){var D=M[E._layer];if(D&&D.visible===!1)return!1}if(!E.s("2d.visible"))return!1}return G._visibleFunc?G._visibleFunc(E):!0},j.handleSelectionChange=function(D){var P=this;D.datas.each(function(R){P.invalidateData(R);var n=R._parent;Em(n)&&vs(R)&&R.s(hh)&&(P.invalidateData(n),n._49I&&n._49I.each(function(R){P.invalidateData(R)}))}),P.onSelectionChanged(D)},j.onSelectionChanged=function(g){var K=this,U=K.sm();if(1===U.size()&&("set"===g.kind||"append"===g.kind)){var i=U.ld();K.isAutoMakeVisible()&&K.makeVisible(i),K.adjustIndex&&K._dataModel.isAutoAdjustIndex()&&K.adjustIndex(i)}},j.makeVisible=function(s){if(s){var f=this,u=f.getDataUI?f.getDataUI(s):f.getData3dUI(s);if(u){var e=s,A=Dp(s);for(A!==f._currentSubGraph&&f.setCurrentSubGraph(A);(e=e._parent)&&e!==A;)Em(e)&&e.setExpanded(!0);f._23I=s,f.iv()}}},j.getLabel=function(I){var h=I.getStyle(Fe);return h===K?I.getName():h},j.getLabelBackground=function(E){return E.getStyle("label.background")},j.getLabelColor=function(K){return K.getStyle("label.color")},j.getLabel2=function(W){return W.getStyle("label2")},j.getLabel2Background=function(T){return T.getStyle("label2.background")},j.getLabel2Color=function(M){return M.getStyle("label2.color")},j.getNote=function(W){return W.getStyle(xk)},j.getNoteBackground=function(E){return E.getStyle("note.background")},j.getNote2=function(h){return h.getStyle(Hq)},j.getNote2Background=function(j){return j.getStyle("note2.background")},j.handleClick=function(K,V,w){var y=this;V?(y.fi({kind:"clickData",event:K,data:V,part:w}),y.onDataClicked(V,K)):(y.fi({kind:"clickBackground",event:K}),y.onBackgroundClicked(K))},j.handleDoubleClick=function(M,o,u){var Y=this;em(M)&&(o?(Y.fi({kind:"doubleClickData",event:M,data:o,part:u}),Y.onDataDoubleClicked(o,M,u),Y.checkDoubleClickOnNote(M,o,u)||Y.checkDoubleClickOnRotation&&Y.checkDoubleClickOnRotation(M,o,u)||(el(o)?Y.onEdgeDoubleClicked(o,M,u):o.ISubGraph?Y.onSubGraphDoubleClicked(o,M,u):Em(o)?Y.onGroupDoubleClicked(o,M,u):o.IDoorWindow?Y.onDoorWindowDoubleClicked(o,M,u):o.ICSGBox&&Y.onCSGBoxDoubleClicked(o,M,u))):(Y.fi({kind:"doubleClickBackground",event:M}),Y.onBackgroundDoubleClicked(M)))},j.onSubGraphDoubleClicked=function(j){this.setCurrentSubGraph(j)},j.onEdgeDoubleClicked=function(S,Q){S.ISubGraph&&!Ah(Q)?this.setCurrentSubGraph(S):S.s("edge.toggleable")&&S.toggle()},j.onGroupDoubleClicked=function(j){j.s("group.toggleable")&&j.toggle()},j.onDoorWindowDoubleClicked=function(S){S.s("dw.toggleable")&&S.toggle(!0)},j.onCSGBoxDoubleClicked=function(m,g){var p=this;if(p instanceof Kq){var i=p.getHitFaceInfo(g);i&&i.face&&m.s(i.face+".toggleable")&&m.toggleFace(i.face,!0)}},j.onBackgroundClicked=function(){},j.onBackgroundDoubleClicked=function(){this.upSubGraph()},j.onDataClicked=function(){},j.onDataDoubleClicked=function(){},j.onAutoLayoutEnded=function(){},j.onMoveEnded=function(){},j.onPanEnded=function(){},j.onPinchEnded=function(){},j.onRectSelectEnded=function(){},j.onZoomEnded=function(){},j.serialize=function(O){return this.dm().serialize(O)},j.toJSON=function(){return this.dm().toJSON()},j.deserialize=function(D,a){return a=a instanceof Er?{rootParent:a}:hf(a)?{setId:a}:Ck(a)?{finishFunc:a}:a||{},a.view=this,this.dm().deserialize(D,a.rootParent,a)}},ms_icons:function(A){A.getRotation=function(e){return e==Z?0:e},A._15O=function(){var z=this,y=z.s(of);if(y){var k=z,h=z.data||z._data,B=z._38o={icons:y,rects:{}};for(var g in y){var x=y[g],b=Vc(x.shape3d,h,k);if(!(Vc(x.visible,h,k)===!1||Vc(x.for3d,h,k)&&!z.I3d||b&&!z.I3d)){var v=b?[b]:Vc(x.names,h,k),u=v?v.length:0,X=Vc(x.position,h,k)||3,L=Vc(x.offsetX,h,k)||0,A=Vc(x.offsetY,h,k)||0,U=Vc(x.direction,h,k)||Mp,c=Vc(x.gap,h,k),G=c!=Z?c:1,K=Vc(x.rotation,h,k),w=Vc(x.keepOrien,h,k),V=Vc(x.rotationFixed,h,k)?K:z.getRotation(K,w,X),Y=Z,r=B.rects[g]=new Array(u);r.rotation=V;for(var M=0;u>M;M++){var F,J,o,T,n=v[M];if(b)o=0,T=0;else{var W=Mk(n);o=Vc(x.width,h,k),T=Vc(x.height,h,k),o==Z&&(o=pr(W,h)),T==Z&&(T=Ne(W,h))}if(Y?U===Mp?L+=o/2:U===er?L-=o/2:U===fl?A-=T/2:A+=T/2:Y={width:o,height:T},z.I3d){var H=-o/2,l=-T/2;J={width:o,height:T,mat:z._16O(Vc(x.autorotate,h,k),X,Y,Vc(x.face,h,k)||Nm,Vc(x.t3,h,k),Vc(x.r3,h,k),Vc(x.rotationMode,h,k),L,A),vs:new Wp([H,-l,0,H,-l-T,0,H+o,-l-T,0,H+o,-l,0])}}else F=z.getPosition(X,L,A,Y,Vc(x.positionFixed,h,k)),J={x:F.x-o/2,y:F.y-T/2,width:o,height:T},z._68o(J,V);r[M]=J,U===Mp?L+=o/2+G:U===er?L-=o/2+G:U===fl?A-=T/2+G:A+=T/2+G}}}}}}});var Yc={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},ur={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Ie={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Co={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Kd={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Mq={"edge.type":1,"edge.group":1},xc={rotation:1,rotationX:1,rotationZ:1},Ge={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},lf={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},iq={shape:1,thickness:1,position:1,anchor:1,scale:1},qc=function(p,N){if(!p||!Em(N)||N.isEmpty())return!1;for(p=p._parent;Em(p);){if(p===N)return!0;p=p._parent}return!1},Yg=function(k,U){if(!k||!Ai(U)||U.isEmpty())return!1;for(k=k._parent;Ai(k);){if(k===U)return!0;k=k._parent}return!1},Dp=function(U){if(!U)return Z;if(el(U)){var D=U._40I,H=U._41I;if(!D||!H)return Z;var x=Dp(D),O=Dp(H);return x===O?x:Z}for(var q=U._parent;el(q)&&!q.ISubGraph;)q=q._parent;return q?q.ISubGraph?q:Dp(q):Z},Ak=function(K,h,R,l){var r=h.getStyle(R)*l;r&&$l(K,r),r=h.getStyle(R+".left")*l,r&&(K.x-=r,K.width+=r),r=h.getStyle(R+".right")*l,r&&(K.width+=r),r=h.getStyle(R+".top")*l,r&&(K.y-=r,K.height+=r),r=h.getStyle(R+".bottom")*l,r&&(K.height+=r),K.width<0&&(K.width=-K.width,K.x-=K.width),K.height<0&&(K.height=-K.height,K.y-=K.height)},Qc=function(h){for(var g,N=0,E=h.size();E>N;N++)if(g=h.getChildAt(N),vs(g)&&Qc(g))return!0;return h.hasAgentEdges()},$i=function(v){if(!v)return Z;for(var w=v._parent;Em(w);){if(!Em(w._parent))return w.isExpanded()?v:w;w.isExpanded()||(v=w),w=w._parent}return v},jm=function(F,z){if(!F||!z)return Z;var _,w,U,h=Dp(F),E=Dp(z);if(h!==E){for(;E&&h!==E;)E=Dp(E);if(h===E)return F;_=new $p,_.add(F,0);for(var k=F._parent;vs(k)&&!z.isDescendantOf(k);)_.add(k,0),k=k._parent;for(U=_.size(),w=0;U>w;w++){var C=_.get(w);if(Em(C)&&!C.isExpanded())return C;if(C.ISubGraph)return C}return F}return F},gh=function(J){if(J.isLooped())return J._source;var r=$i(J._source),L=$i(J._target);return r===L?J._source:jm(r,L)},Wo=function(B){if(B.isLooped())return B._target;var E=$i(B._source),t=$i(B._target);return E===t?B._target:jm(t,E)},Bb=function(d,e,E,n,p,C,z){if(!e)return Z;var N,F=e.getRotation?e.getRotation():0;if(C!==K||z!==K)if(C=C===K?.5:C,z=z===K?.5:z,F&&!Oc(e,d)){var W=e.getPosition(),G=e.getWidth(),m=e.getHeight(),j=e.getAnchor(),H=e.getScale(),L=new mk(F,W.x,W.y,H.x,H.y);E=L.tf((C-j.x)*G,(z-j.y)*m)}else N=vm(d,e),E={x:N.x+C*N.width,y:N.y+z*N.height};else E=vk(E,vm(d,e));if(F){var $=y(F),t=J(F),D=n*$-p*t;p=n*t+p*$,n=D}return E.x+=n,E.y+=p,E},Ee=function(g,u){if(!g||!u)return Z;var z,X,L,e,$,k;if(g===u){if(e=g.getLoopedEdges(),!e)return Z;e=new $p(e)}else{if($=g.getAgentEdges(),k=u.getAgentEdges(),!$||!k)return Z;for(X=$.size(),z=0;X>z;z++)L=$.get(z),k.contains(L)&&(e||(e=new $p),e.add(L))}if(e)for(z=0;z<e.size();z++)L=e.get(z),L.getStyle(qq)===li&&(L._22I(Z),e.removeAt(z),z--);return e},Eh=function(t,b){var I=Ee(t,b);if(I&&!I.isEmpty()){if(1===I.size())return I.get(0)._22I(Z),void 0;var $=new $p,T=new $p;I.each(function(t){var W=t.s("edge.group");$.contains(W)||$.add(W)}),$.sort(),$.each(function(f){T.add(new k.EdgeGroup(I.toList(function(n){return f===n.s("edge.group")}),T))}),T.each(function(E){E.each(function(n){n._22I(E)})})}},xp=function(m,k){if(k){var $=k.rect,f=k.color,H=k.rotation,h=k.labelWidth,S=k.background,q=k.opacity,o=k.scale,A=o!=Z&&1!==o;if(q!=Z){var G=m.globalAlpha;m.globalAlpha*=q}if(H||A){m.save();var e=$.x+$.width/2,l=$.y+$.height/2;Kn(m,e,l),H&&Tc(m,H),A&&m.scale(o,o),Kn(m,-e,-l)}if(S&&Rf(m,$.x,$.y,$.width,$.height,S),h){var v=$.width,I=m.createLinearGradient($.x,$.y,$.x+v,$.y);I.addColorStop(0,f),I.addColorStop(.9,f),I.addColorStop(1,ud),f=I,$.width=h}pk(m,k.ss,$,k.font,f,k.align),h&&($.width=v),(H||A)&&m.restore(),q!=Z&&(m.globalAlpha=G)}},Jf=function(o,T){if(T){var N=T.rect,u=N.x,_=N.y,f=N.width,E=N.height,O=T.background,L=T.backgroundImage,j=T.borderWidth,q=T.borderColor,m=T.labelWidth,c=T.opacity,b=T.scale,d=b!=Z&&1!==b;if(c!=Z){var r=o.globalAlpha;o.globalAlpha*=c}if(d){o.save();var p=N.x+N.width/2,w=N.y+N.height/2;Kn(o,p,w),o.scale(b,b),Kn(o,-p,-w)}if(T.expanded){var a=z(8,f/4),A=_+E-8;if(o.fillStyle=O,o.beginPath(),o.moveTo(u,_),o.lineTo(u,A),o.lineTo(u+f/2,A),o.lineTo(u+f/2,_+E),o.lineTo(u+f/2+a,A),o.lineTo(u+f,A),o.lineTo(u+f,_),o.closePath(),o.fill(),j&&(o.lineWidth=j,o.lineJoin="round",o.lineCap="round",q?(o.strokeStyle=q,o.stroke()):(o.strokeStyle=Ab(O),o.beginPath(),o.moveTo(u+f,_),o.lineTo(u+f,A),o.lineTo(u+f/2+a,A),o.lineTo(u+f/2,_+E),o.stroke(),o.strokeStyle=um(O),o.beginPath(),o.moveTo(u+f,_),o.lineTo(u,_),o.lineTo(u,A),o.lineTo(u+f/2,A),o.lineTo(u+f/2,_+E),o.stroke())),L)Ri(o,Mk(L),Yr,N.x,N.y,N.width,N.height-8,T.data,T.view);else{if(N.height-=8,O=T.color,m){var i=f,V=o.createLinearGradient(u,_,u+i,_);V.addColorStop(0,O),V.addColorStop(.9,O),V.addColorStop(1,ud),O=V,N.width=m}pk(o,T.ss,N,T.font,O,T.align),m&&(N.width=i),N.height+=8}}else if(T.icon)mc(o,Mk(T.icon),u,_,f,E,T.data,T.view);else{var s=f/2;j&&(o.lineWidth=j,o.lineJoin="round",o.lineCap="round",o.strokeStyle=q?q:Ab(O),o.beginPath(),o.arc(u+s,_+s,s,I,1.6*B,!0),o.moveTo(u+s,_+E),o.lineTo(u+f-s/5,_+s),o.stroke(),o.strokeStyle=q?q:um(O),o.beginPath(),o.arc(u+s,_+s,s,1.6*B,I,!0),o.moveTo(u+s,_+E),o.lineTo(u+s/5,_+s),o.stroke()),o.fillStyle=O,o.beginPath(),o.arc(u+s,_+s,s,0,G,!0),o.moveTo(u+s,_+E),o.lineTo(u+f-s/5,_+s),o.lineTo(u+s/5,_+s),o.closePath(),o.fill(),o.fillStyle=T.color,o.beginPath(),o.arc(u+s,_+s,s/3,0,G,!0),o.fill()}d&&o.restore(),c!=Z&&(o.globalAlpha=r)}},se=function(l,$){return $>2*l?l:$/2},Po=function(j,I,M,$){if(!j||!I)return 0;var Z=g(I.y-j.y,I.x-j.x);return M||(Z=I.x<j.x?Z+B:Z),Z+$},br=function(_,U,T,Q,b,c,Z){Z&&(_.x>U.x||_.x===U.x&&_.y>U.y)&&(T=Kk[T],b=-b);var W=vk(T,{x:0,y:0,width:Qn(_,U),height:0},c);return W.x+=Q,W.y+=b,W=new mk(g(U.y-_.y,U.x-_.x)).tf(W),W.x+=_.x,W.y+=_.y,W},Bs=function(D,w,K,B,U){if(D._19Q=!0,!K.getEdgeGroup())return B?K.s("edge.gap"):0;var c,t=0,E=0,h=0;if(K.getEdgeGroup().getSiblings().each(function(S){S.each(function(B){if(w.isVisible(B)&&B.s(qq)==U){var v=B.s("edge.gap");c?(E+=h/2+v/2,h=v):(c=B,h=v),B===K&&(t=E)}})}),B)return E-t+h;var G=t-E/2;return c&&K._40I!==c._40I&&(D._19Q=!1),G},sj=function(){var x=function(s){var p=[];return s.forEach(function(R){p.push({x:R.x,y:R.y}),p.push({x:R.x+R.width,y:R.y+R.height}),p.push({x:R.x+R.width,y:R.y}),p.push({x:R.x,y:R.y+R.height})}),p};return function(s,o,$){if("oval"===s){var M=0,D=$.height/$.width,Z=D*D,W=$.x+$.width/2,J=$.y+$.height/2,d=x(o);d.forEach(function(L){var u=L.x-W,$=L.y-J,a=u*u+$*$/Z;a>M&&(M=a)}),M=T(M);var j=D*M;return{x:W-M,y:J-j,width:2*M,height:2*j}}if("circle"===s){var U=0,W=$.x+$.width/2,J=$.y+$.height/2,d=x(o);return d.forEach(function(u){var N=u.x-W,w=u.y-J,a=N*N+w*w;a>U&&(U=a)}),U=T(U),{x:W-U,y:J-U,width:2*U,height:2*U}}return"roundRect"===s?($l($,z($.width,$.height)/16),$):$}}(),El=k.graph={},Kg=function(a,L,S){_p(o+".graph."+a,L,S)};k.layout={};var sm={comps:[{type:Bd,points:[85,50,70,115,100,71,86,107,88,49,47,89,81,79,75,112,98,74,105,107,81,115,83,50,47,75,99,52,100,122,75,77,47,51,47,119,98,50,108,78,114,87,107,61],borderWidth:1,borderColor:Z}]};if(sm[Br]=sm[Yk]=160,x.Image){var Jd=new x.Image;Jd.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",ii("default_blank",Jd)}ii("node_image",Mc(30,30,[{type:Kb,rect:[4,5,22,16],gradient:$o,gradientColor:jp,background:wn},{type:Kb,rect:[2,3,26,20],borderWidth:1,borderColor:wn},{type:Kb,rect:[11,23,8,4],background:wn},{type:Kb,rect:[6,27,18,2],background:wn}])),ii("node_icon",Mc(16,16,[{type:Kb,rect:[2,2,12,10],gradient:$o,gradientColor:jp,background:wn},{type:Hg,rect:[2,2,12,10],width:1,color:wn},{type:Kb,rect:[6,12,4,2],background:wn},{type:Kb,rect:[4,14,8,1],background:wn}])),ii("block_icon",Mc(16,16,[{type:Hg,rect:[1,1,14,14],width:1,color:wn}])),ii("group_image",Mc(66,39,[{type:Kb,rect:[44.3,18,18.1,12.8],gradient:$o,gradientColor:jp,background:wn},{type:Kb,rect:[3.3,17.8,18.1,12.8],gradient:$o,gradientColor:jp,background:wn},{type:Kb,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:wn,gradient:$o,gradientColor:jp,background:wn},{type:Kb,rect:[26.2,29.4,12.8,4.2],background:wn},{type:Kb,rect:[21.3,33.5,22.5,2.3],background:wn},{type:Kb,rect:[5.3,32.7,14.1,2.1],background:wn},{type:Kb,rect:[9,30.4,6.7,2.4],background:wn},{type:Kb,rect:[50,30.7,6.7,2.4],background:wn},{type:Kb,rect:[46.3,33,14.1,2.1],background:wn}])),ii("group_icon",Mc(16,16,[{type:Kb,rect:[4,12,4,2],background:wn},{type:Kb,rect:[2,13,8,1],background:wn},{type:Kb,rect:[12,12,2,1],background:wn},{type:Kb,rect:[11,13,4,1],background:wn},{type:Kb,rect:[10,7,6,5],gradient:$o,gradientColor:jp,background:wn},{type:Kb,rect:[1,2,10,10],gradient:$o,gradientColor:jp,background:wn},{type:Hg,rect:[1,2,10,10],width:1,color:wn}])),ii("refGraph_icon",Mc(16,16,[{type:"shape",borderWidth:1,borderColor:wn,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:wn,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),ii("edge_icon",Mc(16,16,[{type:Kb,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:$o,gradientColor:jp,background:wn},{type:Kb,rect:[10.8,1,4,4],background:wn},{type:Kb,rect:[1,11,4,4],background:wn}])),ii("subGraph_image",Mc(72,45,[{type:Bd,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:$o,gradientColor:jp,background:wn},{type:Kb,rect:[29.6,30.7,3.6,1.8],background:wn},{type:Kb,rect:[28.4,32.3,6,1.2],background:wn},{type:Kb,rect:[37.3,32,10.8,1.8],background:wn},{type:Kb,rect:[39.1,29.9,7.2,2.3],background:wn},{type:Kb,rect:[26.6,23.7,9.6,7.2],gradient:$o,gradientColor:jp,background:wn},{type:Kb,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:wn,gradient:$o,gradientColor:jp,background:wn}])),ii("subGraph_icon",Mc(17,17,[{type:Bd,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:$o,gradientColor:jp,background:wn}])),ii("shape_icon",Mc(16,16,[{type:Bd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:wn}])),ii("polyline_icon",Mc(16,16,[{type:Bd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:wn},th(7.5,.4),th(7.5,6.3),th(13.6,6.3),th(13.6,14),th(.7,13.9),th(.7,.3)])),ii("grid_icon",Mc(16,16,[{type:Kb,rect:[1,1,4,4],background:wn,gradient:$o,gradientColor:jp},{type:Kb,rect:[6,1,4,4],background:wn,gradient:$o,gradientColor:jp},{type:Kb,rect:[11,1,4,4],background:wn,gradient:$o,gradientColor:jp},{type:Kb,rect:[11,6,4,4],background:wn,gradient:$o,gradientColor:jp},{type:Kb,rect:[6,6,4,4],background:wn,gradient:$o,gradientColor:jp},{type:Kb,rect:[1,6,4,4],background:wn,gradient:$o,gradientColor:jp},{type:Kb,rect:[11,11,4,4],background:wn,gradient:$o,gradientColor:jp},{type:Kb,rect:[6,11,4,4],background:wn,gradient:$o,gradientColor:jp},{type:Kb,rect:[1,11,4,4],background:wn,gradient:$o,gradientColor:jp}])),ii("light_icon",Mc(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:wn},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:wn,gradient:$o,gradientColor:jp,background:{func:function(h){var k=h?h.s(Gb):Z;return Sp(k)?"rgb("+l(255*k[0])+","+l(255*k[1])+","+l(255*k[2])+")":k||wn}}}])),ii("text_icon",Mc(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:wn}])),ii("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),ii("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),ii("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),ii("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var ek=function(h,Z){for(var S=h.vertices,z=0;z<S.length;z++){var _=S[z],R=_.y;_.y=_.z,_.z=-R,Z&&(_.y+=Z)}},_l=function(h){for(var i,Y,M,e,j,W,b=[],v=[],U=[],p=h.faces,K=0,F=0,r=0,E=p.length;E>K;K++,F+=6,r+=9){var n=p[K];1===n.i?(i||(i=[],Y=[],M=[]),Sb(n,K,F,r,h,i,M,Y)):2===n.i?(e||(e=[],j=[],W=[]),Sb(n,K,F,r,h,e,W,j)):Sb(n,K,F,r,h,b,U,v)}return{vs:b,uv:v,ns:U,top_vs:i,top_uv:Y,top_ns:M,bottom_vs:e,bottom_uv:j,bottom_ns:W}},Sb=function(W,C,A,P,L,t,i,n){var J=L.vertices,V=L.faceVertexUvs,o=J[W.a],b=J[W.b],D=J[W.c];t[P]=o.x,t[P+1]=o.y,t[P+2]=o.z,t[P+3]=b.x,t[P+4]=b.y,t[P+5]=b.z,t[P+6]=D.x,t[P+7]=D.y,t[P+8]=D.z;var w=W.vertexNormals;if(3===w.length){var p=w[0],T=w[1],Q=w[2];i[P]=p.x,i[P+1]=p.y,i[P+2]=p.z,i[P+3]=T.x,i[P+4]=T.y,i[P+5]=T.z,i[P+6]=Q.x,i[P+7]=Q.y,i[P+8]=Q.z}else{var M=W.normal;i[P]=M.x,i[P+1]=M.y,i[P+2]=M.z,i[P+3]=M.x,i[P+4]=M.y,i[P+5]=M.z,i[P+6]=M.x,i[P+7]=M.y,i[P+8]=M.z}var v=V[0][C][0],F=V[0][C][1],H=V[0][C][2];n[A]=v.x,n[A+1]=v.y,n[A+2]=F.x,n[A+3]=F.y,n[A+4]=H.x,n[A+5]=H.y},io=function(W){var G=W._lineModel;if(G)return G;var S;S=Sp(W)?W:[W];var E,b,u,x,i,q,N,O,L,p,m,h,j=["","top","bottom"];for(G=[],E=0,b=S.length;b>E;E++)for(L=S[E],u=0,x=j.length;x>u;u++)if(N=L[j[u]+"vs"]){O=L[j[u]+"is"],q=O?O.length:N.length/3;for(var i=0;q>i;i+=3)O?(p=O[i],m=O[i+1],h=O[i+2]):(p=i,m=i+1,h=i+2),p*=3,m*=3,h*=3,G.push(N[p],N[p+1],N[p+2],N[m],N[m+1],N[m+2],N[m],N[m+1],N[m+2],N[h],N[h+1],N[h+2],N[h],N[h+1],N[h+2],N[p],N[p+1],N[p+2])}return W._lineModel=G,G},ko=function(d,O,h,v,e,o,U,y,A){h==Z&&(h=!0),v==Z&&(v=!0),U==Z&&(U=1),y==Z&&(y=0);var q=new Jk;return Le(q,d,O,A),q=q.toShapes(),_l(new oi(q,{top:h,bottom:v,curveSegments:e,amount:U,repeatUVLength:o},-U/2+y))},yj=function(I,z){this.x=I||0,this.y=z||0};yj.prototype={constructor:yj,add:function(m){return this.x+=m.x,this.y+=m.y,this},sub:function(Y){return this.x-=Y.x,this.y-=Y.y,this},equals:function(i){return i.x===this.x&&i.y===this.y},multiplyScalar:function(F){return this.x*=F,this.y*=F,this},distanceTo:function(e){return T(this.distanceToSquared(e))},distanceToSquared:function($){var f=this.x-$.x,e=this.y-$.y;return f*f+e*e},clone:function(){return new yj(this.x,this.y)}};var sc=function(j,V,K){this.x=j||0,this.y=V||0,this.z=K||0};sc.prototype={constructor:sc,set:function($,q,R){return this.x=$,this.y=q,this.z=R,this},setY:function(P){return this.y=P,this},copy:function(f){return this.x=f.x,this.y=f.y,this.z=f.z,this},add:function(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this},addVectors:function(C,h){return this.x=C.x+h.x,this.y=C.y+h.y,this.z=C.z+h.z,this},sub:function(y){return this.x-=y.x,this.y-=y.y,this.z-=y.z,this},subVectors:function(v,H){return this.x=v.x-H.x,this.y=v.y-H.y,this.z=v.z-H.z,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this},applyMatrix4:function(T){var z=this.x,Y=this.y,A=this.z,U=T.elements;return this.x=U[0]*z+U[4]*Y+U[8]*A+U[12],this.y=U[1]*z+U[5]*Y+U[9]*A+U[13],this.z=U[2]*z+U[6]*Y+U[10]*A+U[14],this},divideScalar:function(g){if(0!==g){var X=1/g;this.x*=X,this.y*=X,this.z*=X}else this.x=0,this.y=0,this.z=0;return this},dot:function(j){return this.x*j.x+this.y*j.y+this.z*j.z},length:function(){return T(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(v){var j=this.x,t=this.y,P=this.z;return this.x=t*v.z-P*v.y,this.y=P*v.x-j*v.z,this.z=j*v.y-t*v.x,this},crossVectors:function(z,S){var K=z.x,i=z.y,N=z.z,J=S.x,x=S.y,U=S.z;return this.x=i*U-N*x,this.y=N*J-K*U,this.z=K*x-i*J,this},distanceTo:function(i){return T(this.distanceToSquared(i))},distanceToSquared:function(s){var O=this.x-s.x,g=this.y-s.y,T=this.z-s.z;return O*O+g*g+T*T},clone:function(){return new sc(this.x,this.y,this.z)}};var lr=function(){this.elements=new Float32Array(16)};lr.prototype={constructor:lr,set:function(o,z,N,_,X,j,l,G,L,M,F,r,T,x,R,B){var w=this.elements;return w[0]=o,w[4]=z,w[8]=N,w[12]=_,w[1]=X,w[5]=j,w[9]=l,w[13]=G,w[2]=L,w[6]=M,w[10]=F,w[14]=r,w[3]=T,w[7]=x,w[11]=R,w[15]=B,this},makeRotationAxis:function(e,A){var r=y(A),f=J(A),O=1-r,T=e.x,E=e.y,z=e.z,I=O*T,h=O*E;return this.set(I*T+r,I*E-f*z,I*z+f*E,0,I*E+f*z,h*E+r,h*z-f*T,0,I*z-f*E,h*z+f*T,O*z*z+r,0,0,0,0,1),this}};var Rn=function(p){this.repeatUVLength=p};Rn.prototype={generateTopUV:function(p,q,W,o,G,f,r){var Z,N,k,U,L=p.vertices,c=L[o].x,d=L[o].y,P=L[G].x,x=L[G].y,y=L[f].x,u=L[f].y,D=this.repeatUVLength;if(D)Z=0,N=0,k=D,U=D;else{this._bb||(this._bb=q.getBoundingBox());var s=this._bb;Z=s.minX,N=s.minY,k=s.maxX-Z,U=s.maxY-N}return r?[new yj((c-Z)/k,(d-N)/U),new yj((P-Z)/k,(x-N)/U),new yj((y-Z)/k,(u-N)/U)]:[new yj((c-Z)/k,1-(d-N)/U),new yj((P-Z)/k,1-(x-N)/U),new yj((y-Z)/k,1-(u-N)/U)]},generateBottomUV:function(d,h,H,A,b,I){return this.generateTopUV(d,h,H,A,b,I,!0)},generateSideWallUV:function(v,K,B,O,j,P,A,Z,D,M,k,o){if(!this._cl){for(var F,s,$=[],x=0,H=B.length,Y=0;H>Y;Y++){F=B[Y],s=B[(Y+1)%H];var p=F.x-s.x,I=F.y-s.y,R=T(p*p+I*I);$.push(x),x+=R}for(var Y=0;H>Y;Y++)$[Y]/=x;this._cl=$}var $=this._cl,g=1-D/M,i=1-(D+1)/M,c=$[k],N=$[o];return N>c&&(c+=1),[new yj(c,g),new yj(N,g),new yj(N,i),new yj(c,i)]}};var wr=function(m,s,t,U,J,S){this.a=m,this.b=s,this.c=t,this.i=S,this.normal=U instanceof sc?U:new sc,this.vertexNormals=U instanceof Array?U:[]};wr.prototype={constructor:wr};var ic=[-8,13,-2,6,-4,12,5,10,-1],Dl=function(){if(Dl[og]!=Z)return Dl[og];for(var V=_q[og],X=ic,B=Er.prototype.getClassName(),g='"',b=0,h="",a=!1,D=+new(x[B.substr(3,3)+zi[b]]),G=b;G<X.length;G++){var v=X.length-G;h+=G%2===b?X[G]+v+"":X[G]-v+""}for(var G=b;4>G;G++)h+=b;if(h=h*h.length/h.length,D>h){if(V){for(var m,l,k,R,W,i,M,r,A="",Q=0,G=0;G<V.length;G++)V[G]===g?r?(r=!1,0!==Q%2&&(m==Z?m=A:l==Z?l=A:k==Z?k=A:R==Z?R=A:W==Z?W=A:i==Z?i=A:M==Z&&(M=A)),Q++,A=""):r=!0:r&&(A+=V[G]);var O=m+l+k+R+W+i;(a=Td(O,M)&&(!i||i.indexOf(rk)>=0)&&(!W||W>D))&&k.indexOf(ue[0])>=0&&(Dl[ue[0]]=1),a&&k.indexOf(1)>=0&&(Dl[1]=1),a&&k.indexOf(2)>=0&&(Dl[2]=1)}}else a=!0,Dl[ue[0]]=Dl[1]=Dl[2]=1;return Dl[og]=a,a},ws=function(){},sn=ws.prototype;sn.getPointAt=function(X){var $=this.getUtoTmapping(X);return this.getPoint($)},sn.getPoints=function(g){g||(g=5);var S,x=[];for(S=0;g>=S;S++)x.push(this.getPoint(S/g));return x},sn.getSpacedPoints=function(L){L||(L=5);var a,H=[];for(a=0;L>=a;a++)H.push(this.getPointAt(a/L));return H},sn.getLength=function(){var t=this.getLengths();return t[t.length-1]},sn.getLengths=function(d){if(d||(d=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==d+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var p,N,y=[],P=this.getPoint(0),G=0;for(y.push(0),N=1;d>=N;N++)p=this.getPoint(N/d),G+=p.distanceTo(P),y.push(G),P=p;return this.cacheArcLengths=y,y},sn.getUtoTmapping=function(C,J){var V,q=this.getLengths(),p=0,W=q.length;V=J?J:C*q[W-1];for(var l,w=0,n=W-1;n>=w;)if(p=v(w+(n-w)/2),l=q[p]-V,0>l)w=p+1;else{if(!(l>0)){n=p;break}n=p-1}if(p=n,q[p]==V){var j=p/(W-1);return j}var y=q[p],k=q[p+1],m=k-y,T=(V-y)/m,j=(p+T)/(W-1);return j},sn.getTangent=function(p){var X=1e-4,r=p-X,M=p+X;0>r&&(r=0),M>1&&(M=1);var g=this.getPoint(r),U=this.getPoint(M),R=U.clone().sub(g);return R.normalize()},sn.getTangentAt=function(d){var A=this.getUtoTmapping(d);return this.getTangent(A)},ws.create=function(r,X){return r.prototype=oe(ws.prototype),r.prototype.getPoint=X,r};var In=function(){this.curves=[],this.autoClose=!1},Di=In.prototype=oe(sn);Di.add=function(i){this.curves.push(i)},Di.closePath=function(){var L=this.curves[0].getPoint(0),z=this.curves[this.curves.length-1].getPoint(1);L.equals(z)||this.curves.push(new Kc(z,L))},Di.getPoint=function(v){for(var l,W,b=v*this.getLength(),t=this.getCurveLengths(),z=0;z<t.length;){if(t[z]>=b){l=t[z]-b,W=this.curves[z];var M=1-l/W.getLength();return W.getPointAt(M)}z++}return null},Di.getLength=function(){var j=this.getCurveLengths();return j[j.length-1]},Di.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var r,S=[],n=0,G=this.curves.length;for(r=0;G>r;r++)n+=this.curves[r].getLength(),S.push(n);return this.cacheLengths=S,S
},Di.getTransformedPoints=function(d){return this.getPoints(d)},Di.getBoundingBox=function(){var x,N,$,u,P,v,g=this.getPoints();x=N=Number.NEGATIVE_INFINITY,u=P=Number.POSITIVE_INFINITY;var k,q,w,R,f=g[0]instanceof sc;for(R=f?new sc:new yj,q=0,w=g.length;w>q;q++)k=g[q],k.x>x&&(x=k.x),k.x<u&&(u=k.x),k.y>N&&(N=k.y),k.y<P&&(P=k.y),f&&(k.z>$&&($=k.z),k.z<v&&(v=k.z)),R.add(k);var U={minX:u,minY:P,maxX:x,maxY:N};return f&&(U.maxZ=$,U.minZ=v),U};var Kl=function(s){In.call(this),this.actions=[],s&&this.fromPoints(s)},$j=Kl.prototype=oe(In.prototype),gp="moveTo",hl="lineTo",cq="quadraticCurveTo",Bc="bezierCurveTo",ng="arc",co="ellipse";$j.fromPoints=function(S){this.moveTo(S[0].x,S[0].y);for(var Q=1,g=S.length;g>Q;Q++)this.lineTo(S[Q].x,S[Q].y)},$j.moveTo=function(){var R=Array.prototype.slice.call(arguments);this.actions.push({action:gp,args:R})},$j.lineTo=function(h,l){var Z=Array.prototype.slice.call(arguments),H=this.actions[this.actions.length-1].args,j=H[H.length-2],b=H[H.length-1],q=new Kc(new yj(j,b),new yj(h,l));this.curves.push(q),this.actions.push({action:hl,args:Z})},$j.quadraticCurveTo=function(G,u,p,S){var _=Array.prototype.slice.call(arguments),V=this.actions[this.actions.length-1].args,A=V[V.length-2],T=V[V.length-1],I=new bs(new yj(A,T),new yj(G,u),new yj(p,S));this.curves.push(I),this.actions.push({action:cq,args:_})},$j.bezierCurveTo=function(W,q,X,Y,l,h){var R=Array.prototype.slice.call(arguments),g=this.actions[this.actions.length-1].args,n=g[g.length-2],J=g[g.length-1],c=new ac(new yj(n,J),new yj(W,q),new yj(X,Y),new yj(l,h));this.curves.push(c),this.actions.push({action:Bc,args:R})},$j.arc=function(A,S,c,Z,u,t){var b=this.actions[this.actions.length-1].args,l=b[b.length-2],R=b[b.length-1];this.absarc(A+l,S+R,c,Z,u,t)},$j.absarc=function(A,h,d,J,u,P){this.absellipse(A,h,d,d,J,u,P)},$j.ellipse=function(G,S,b,U,M,x,p){var $=this.actions[this.actions.length-1].args,r=$[$.length-2],P=$[$.length-1];this.absellipse(G+r,S+P,b,U,M,x,p)},$j.absellipse=function(_,h,U,f,E,C,A){var B=Array.prototype.slice.call(arguments),Q=new eg(_,h,U,f,E,C,A);this.curves.push(Q);var K=Q.getPoint(1);B.push(K.x),B.push(K.y),this.actions.push({action:co,args:B})},$j.getSpacedPoints=function(m){m||(m=40);for(var x=[],A=0;m>A;A++)x.push(this.getPoint(A/m));return x},$j.getPoints=function(R,Y){R=R||12;var S,K,C,p,a,x,f,O,E,k,V,w,n,B,o,F,W,N,l=[];for(S=0,K=this.actions.length;K>S;S++)switch(C=this.actions[S],p=C.action,a=C.args,p){case gp:l.push(new yj(a[0],a[1]));break;case hl:l.push(new yj(a[0],a[1]));break;case cq:for(x=a[2],f=a[3],k=a[0],V=a[1],l.length>0?(B=l[l.length-1],w=B.x,n=B.y):(B=this.actions[S-1].args,w=B[B.length-2],n=B[B.length-1]),o=1;R>=o;o++)F=o/R,W=wm.b2(F,w,k,x),N=wm.b2(F,n,V,f),l.push(new yj(W,N));break;case Bc:for(x=a[4],f=a[5],k=a[0],V=a[1],O=a[2],E=a[3],l.length>0?(B=l[l.length-1],w=B.x,n=B.y):(B=this.actions[S-1].args,w=B[B.length-2],n=B[B.length-1]),o=1;R>=o;o++)F=o/R,W=wm.b3(F,w,k,O,x),N=wm.b3(F,n,V,E,f),l.push(new yj(W,N));break;case ng:var r,q=a[0],A=a[1],g=a[2],m=a[3],v=a[4],_=!!a[5],c=v-m,T=2*R;for(o=1;T>=o;o++)F=o/T,_||(F=1-F),r=m+F*c,W=q+g*y(r),N=A+g*J(r),l.push(new yj(W,N));break;case co:var r,q=a[0],A=a[1],i=a[2],Z=a[3],m=a[4],v=a[5],_=!!a[6],c=v-m,T=2*R;for(o=1;T>=o;o++)F=o/T,_||(F=1-F),r=m+F*c,W=q+i*y(r),N=A+Z*J(r),l.push(new yj(W,N))}var Q=l[l.length-1],u=1e-10;return s(Q.x-l[0].x)<u&&s(Q.y-l[0].y)<u&&l.splice(l.length-1,1),Y&&l.push(l[0]),l},$j.toShapes=function(H,a){function Y(i){var R,X,t,o,P,b=[],B=new Kl;for(R=0,X=i.length;X>R;R++)t=i[R],P=t.args,o=t.action,o==gp&&0!=B.actions.length&&(b.push(B),B=new Kl),B[o].apply(B,P);return 0!=B.actions.length&&b.push(B),b}function y(p){for(var q=[],Z=0,K=p.length;K>Z;Z++){var O=p[Z],H=new Jk;H.actions=O.actions,H.curves=O.curves,q.push(H)}return q}function E(n,H){for(var $=1e-10,Z=H.length,h=!1,L=Z-1,X=0;Z>X;L=X++){var y=H[L],o=H[X],O=o.x-y.x,t=o.y-y.y;if(s(t)>$){if(0>t&&(y=H[X],O=-O,o=H[L],t=-t),n.y<y.y||n.y>o.y)continue;if(n.y==y.y){if(n.x==y.x)return!0}else{var g=t*(n.x-y.x)-O*(n.y-y.y);if(0==g)return!0;if(0>g)continue;h=!h}}else{if(n.y!=y.y)continue;if(o.x<=n.x&&n.x<=y.x||y.x<=n.x&&n.x<=o.x)return!0}}return h}var k=Y(this.actions);if(0==k.length)return[];if(a===!0)return y(k);var m,A,e,F=[];if(1==k.length)return A=k[0],e=new Jk,e.actions=A.actions,e.curves=A.curves,F.push(e),F;var P=!wm.isClockWise(k[0].getPoints());P=H?!P:P;var f,i=[],w=[],u=[],I=0;w[I]=K,u[I]=[];var p,U;for(p=0,U=k.length;U>p;p++)A=k[p],f=A.getPoints(),m=wm.isClockWise(f),m=H?!m:m,m?(!P&&w[I]&&I++,w[I]={s:new Jk,p:f},w[I].s.actions=A.actions,w[I].s.curves=A.curves,P&&I++,u[I]=[]):u[I].push({h:A,p:f[0]});if(!w[0])return y(k);if(w.length>1){for(var O=!1,n=[],M=0,N=w.length;N>M;M++)i[M]=[];for(var M=0,N=w.length;N>M;M++){w[M];for(var h=u[M],J=0;J<h.length;J++){for(var d=h[J],x=!0,V=0;V<w.length;V++)E(d.p,w[V].p)&&(M!=V&&n.push({froms:M,tos:V,hole:J}),x?(x=!1,i[V].push(d)):O=!0);x&&i[M].push(d)}}n.length>0&&(O||(u=i))}var l,o,Z;for(p=0,U=w.length;U>p;p++)for(e=w[p].s,F.push(e),l=u[p],o=0,Z=l.length;Z>o;o++)e.holes.push(l[o].h);return F};var Jk=function(){Kl.apply(this,arguments),this.holes=[]},Sg=Jk.prototype=oe($j);Sg.getPointsHoles=function(I){var r,d=this.holes.length,l=[];for(r=0;d>r;r++)l[r]=this.holes[r].getTransformedPoints(I);return l},Sg.extractAllPoints=function(H){return{shape:this.getTransformedPoints(H),holes:this.getPointsHoles(H)}},Sg.extractPoints=function(k){return this.extractAllPoints(k)};var wm={triangulateShape:function(n,l){function C(Z,r,l){return Z.x!=r.x?Z.x<r.x?Z.x<=l.x&&l.x<=r.x:r.x<=l.x&&l.x<=Z.x:Z.y<r.y?Z.y<=l.y&&l.y<=r.y:r.y<=l.y&&l.y<=Z.y}function F(k,K,a,J,M){var Q=1e-10,t=K.x-k.x,g=K.y-k.y,G=J.x-a.x,$=J.y-a.y,l=k.x-a.x,N=k.y-a.y,f=g*G-t*$,r=g*l-t*N;if(s(f)>Q){var e;if(f>0){if(0>r||r>f)return[];if(e=$*l-G*N,0>e||e>f)return[]}else{if(r>0||f>r)return[];if(e=$*l-G*N,e>0||f>e)return[]}if(0==e)return!M||0!=r&&r!=f?[k]:[];if(e==f)return!M||0!=r&&r!=f?[K]:[];if(0==r)return[a];if(r==f)return[J];var T=e/f;return[{x:k.x+T*t,y:k.y+T*g}]}if(0!=r||$*l!=G*N)return[];var E=0==t&&0==g,w=0==G&&0==$;if(E&&w)return k.x!=a.x||k.y!=a.y?[]:[k];if(E)return C(a,J,k)?[k]:[];if(w)return C(k,K,a)?[a]:[];var L,b,X,q,n,P,v,y;return 0!=t?(k.x<K.x?(L=k,X=k.x,b=K,q=K.x):(L=K,X=K.x,b=k,q=k.x),a.x<J.x?(n=a,v=a.x,P=J,y=J.x):(n=J,v=J.x,P=a,y=a.x)):(k.y<K.y?(L=k,X=k.y,b=K,q=K.y):(L=K,X=K.y,b=k,q=k.y),a.y<J.y?(n=a,v=a.y,P=J,y=J.y):(n=J,v=J.y,P=a,y=a.y)),v>=X?v>q?[]:q==v?M?[]:[n]:y>=q?[n,b]:[n,P]:X>y?[]:X==y?M?[]:[L]:y>=q?[L,b]:[L,P]}function J(n,Y,v,W){var R=1e-10,y=Y.x-n.x,G=Y.y-n.y,M=v.x-n.x,q=v.y-n.y,$=W.x-n.x,w=W.y-n.y,I=y*q-G*M,L=y*w-G*$;if(s(I)>R){var N=$*q-w*M;return I>0?L>=0&&N>=0:L>=0||N>=0}return L>0}function w(u,i){function W(h,u){var c=A.length-1,E=h-1;0>E&&(E=c);var p=h+1;p>c&&(p=0);var Y=J(A[h],A[E],A[p],e[u]);if(!Y)return!1;var Z=e.length-1,v=u-1;0>v&&(v=Z);var I=u+1;return I>Z&&(I=0),Y=J(e[u],e[v],e[I],A[h]),Y?!0:!1}function q(W,D){var M,J,R;for(M=0;M<A.length;M++)if(J=M+1,J%=A.length,R=F(W,D,A[M],A[J],!0),R.length>0)return!0;return!1}function Q(j,c){var W,n,f,Z,V;for(W=0;W<v.length;W++)for(n=i[v[W]],f=0;f<n.length;f++)if(Z=f+1,Z%=n.length,V=F(j,c,n[f],n[Z],!0),V.length>0)return!0;return!1}for(var e,x,L,t,j,f,D,N,T,d,U,A=u.concat(),v=[],c=[],h=0,y=i.length;y>h;h++)v.push(h);for(var k=0,S=2*v.length;v.length>0&&(S--,!(0>S));)for(L=k;L<A.length;L++){t=A[L],x=-1;for(var h=0;h<v.length;h++)if(f=v[h],D=t.x+":"+t.y+":"+f,c[D]===K){e=i[f];for(var C=0;C<e.length;C++)if(j=e[C],W(L,C)&&!q(t,j)&&!Q(t,j)){x=C,v.splice(h,1),N=A.slice(0,L+1),T=A.slice(L),d=e.slice(x),U=e.slice(0,x+1),A=N.concat(d).concat(U).concat(T),k=L;break}if(x>=0)break;c[D]=!0}if(x>=0)break}return A}for(var R,U,H,M,z,g,p={},Z=n.concat(),y=0,V=l.length;V>y;y++)Array.prototype.push.apply(Z,l[y]);for(R=0,U=Z.length;U>R;R++)z=Z[R].x+":"+Z[R].y,p[z]!==K,p[z]=R;var f=w(n,l),D=Mh.Triangulate(f,!1);for(R=0,U=D.length;U>R;R++)for(M=D[R],H=0;3>H;H++)z=M[H].x+":"+M[H].y,g=p[z],g!==K&&(M[H]=g);return D.concat()},isClockWise:function(c){return Mh.Triangulate.area(c)<0},b2p0:function(i,t){var v=1-i;return v*v*t},b2p1:function(M,d){return 2*(1-M)*M*d},b2p2:function(G,$){return G*G*$},b2:function(x,D,L,O){return this.b2p0(x,D)+this.b2p1(x,L)+this.b2p2(x,O)},b3p0:function(c,i){var $=1-c;return $*$*$*i},b3p1:function(e,n){var V=1-e;return 3*V*V*e*n},b3p2:function(D,H){var T=1-D;return 3*T*D*D*H},b3p3:function(L,f){return L*L*L*f},b3:function(L,A,k,c,W){return this.b3p0(L,A)+this.b3p1(L,k)+this.b3p2(L,c)+this.b3p3(L,W)}},Mh={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var z=C.keys(this.faces);return z.length?z[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(u){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(M){var I=M.familyName.toLowerCase(),d=this;return d.faces[I]=d.faces[I]||{},d.faces[I][M.cssFontWeight]=d.faces[I][M.cssFontWeight]||{},d.faces[I][M.cssFontWeight][M.cssFontStyle]=M,M},drawText:function(R){var E,o=this.getFace(),y=this.size/o.resolution,c=0,i=String(R).split(""),O=i.length,F=[];for(E=0;O>E;E++){var V=new Kl,u=this.extractGlyphPoints(i[E],o,y,c,V);u&&(c+=u.offset*this.spacing,F.push(u.path))}var I=c/2;return{paths:F,offset:I}},extractGlyphPoints:function(K,p,B,E,k){var d,G,x,S,P,b,_,O,Q,X,f,T,e,C,Z,H,u,D,v,$=[],h=p.glyphs[K]||p.glyphs["?"];if(h){if(h.o)for(S=h._cachedOutline||(h._cachedOutline=h.o.split(" ")),b=S.length,_=B,O=B,d=0;b>d;)switch(P=S[d++]){case"m":Q=S[d++]*_+E,X=S[d++]*O,k.moveTo(Q,X);break;case"l":Q=S[d++]*_+E,X=S[d++]*O,k.lineTo(Q,X);break;case"q":if(f=S[d++]*_+E,T=S[d++]*O,Z=S[d++]*_+E,H=S[d++]*O,k.quadraticCurveTo(Z,H,f,T),v=$[$.length-1])for(e=v.x,C=v.y,G=1,x=this.divisions;x>=G;G++){var I=G/x;wm.b2(I,e,Z,f),wm.b2(I,C,H,T)}break;case"b":if(f=S[d++]*_+E,T=S[d++]*O,Z=S[d++]*_+E,H=S[d++]*O,u=S[d++]*_+E,D=S[d++]*O,k.bezierCurveTo(Z,H,u,D,f,T),v=$[$.length-1])for(e=v.x,C=v.y,G=1,x=this.divisions;x>=G;G++){var I=G/x;wm.b3(I,e,Z,u,f),wm.b3(I,C,H,D,T)}}return{offset:h.ha*B,path:k}}}};Mh.generateShapes=function(O,m){m=m||{};var p=m.font;if(p===K&&(p=Mh.getDefaultFont(),!p))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var N=m.size!==K?m.size:1,$=m.curveSegments!==K?m.curveSegments:4,S=m.spacing!==K?m.spacing:1,V=m.weight!==K?m.weight:"normal",Q=m.style!==K?m.style:"normal";Mh.size=N,Mh.divisions=$,Mh.face=p,Mh.weight=V,Mh.style=Q,Mh.spacing=S;for(var r=Mh.drawText(O),z=r.paths,a=[],G=0,c=z.length;c>G;G++)Array.prototype.push.apply(a,z[G].toShapes());return a},function(K){var j=1e-10,Y=function(u,r){var Y=u.length;if(3>Y)return null;var _,W,o,Z=[],R=[],D=[];if(U(u)>0)for(W=0;Y>W;W++)R[W]=W;else for(W=0;Y>W;W++)R[W]=Y-1-W;var X=Y,k=2*X;for(W=X-1;X>2;){if(k--<=0)return r?D:Z;if(_=W,_>=X&&(_=0),W=_+1,W>=X&&(W=0),o=W+1,o>=X&&(o=0),t(u,_,W,o,X,R)){var c,I,f,N,g;for(c=R[_],I=R[W],f=R[o],Z.push([u[c],u[I],u[f]]),D.push([R[_],R[W],R[o]]),N=W,g=W+1;X>g;N++,g++)R[N]=R[g];X--,k=2*X}}return r?D:Z},U=function(j){for(var P=j.length,Z=0,D=P-1,v=0;P>v;D=v++)Z+=j[D].x*j[v].y-j[v].x*j[D].y;return.5*Z},t=function(G,r,w,b,Q,e){var z,D,q,V,C,t,L,X,u;if(D=G[e[r]].x,q=G[e[r]].y,V=G[e[w]].x,C=G[e[w]].y,t=G[e[b]].x,L=G[e[b]].y,j>(V-D)*(L-q)-(C-q)*(t-D))return!1;var R,I,M,P,T,v,H,K,_,p,i,W,B,s,N;for(R=t-V,I=L-C,M=D-t,P=q-L,T=V-D,v=C-q,z=0;Q>z;z++)if(X=G[e[z]].x,u=G[e[z]].y,!(X===D&&u===q||X===V&&u===C||X===t&&u===L)&&(H=X-D,K=u-q,_=X-V,p=u-C,i=X-t,W=u-L,N=R*p-I*_,B=T*K-v*H,s=M*W-P*i,N>=-j&&s>=-j&&B>=-j))return!1;return!0};return K.Triangulate=Y,K.Triangulate.area=U,K}(Mh),x._typeface_js={faces:Mh.faces,loadFace:Mh.loadFace};var sr=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},uj=sr.prototype={constructor:sr,computeFaceNormals:function(){for(var m=new sc,d=new sc,Z=0,k=this.faces.length;k>Z;Z++){var n=this.faces[Z],u=this.vertices[n.a],q=this.vertices[n.b],V=this.vertices[n.c];m.subVectors(V,q),d.subVectors(u,q),m.cross(d),m.normalize(),n.normal.copy(m)}},computeVertexNormals:function(m){var o,P,n,G,K,t;for(t=new Array(this.vertices.length),o=0,P=this.vertices.length;P>o;o++)t[o]=new sc;if(m){var A,l,S,D=new sc,M=new sc;for(n=0,G=this.faces.length;G>n;n++)K=this.faces[n],A=this.vertices[K.a],l=this.vertices[K.b],S=this.vertices[K.c],D.subVectors(S,l),M.subVectors(A,l),D.cross(M),t[K.a].add(D),t[K.b].add(D),t[K.c].add(D)}else for(n=0,G=this.faces.length;G>n;n++)K=this.faces[n],t[K.a].add(K.normal),t[K.b].add(K.normal),t[K.c].add(K.normal);for(o=0,P=this.vertices.length;P>o;o++)t[o].normalize();for(n=0,G=this.faces.length;G>n;n++)K=this.faces[n],K.vertexNormals[0]=t[K.a].clone(),K.vertexNormals[1]=t[K.b].clone(),K.vertexNormals[2]=t[K.c].clone()},mergeVertices:function(){var O,f,y,r,Z,R,U,h,C={},v=[],J=[],d=4,D=p(10,d);for(y=0,r=this.vertices.length;r>y;y++)O=this.vertices[y],f=Q(O.x*D)+"_"+Q(O.y*D)+"_"+Q(O.z*D),C[f]===K?(C[f]=y,v.push(this.vertices[y]),J[y]=v.length-1):J[y]=J[C[f]];var N=[];for(y=0,r=this.faces.length;r>y;y++){Z=this.faces[y],Z.a=J[Z.a],Z.b=J[Z.b],Z.c=J[Z.c],R=[Z.a,Z.b,Z.c];for(var w=0;3>w;w++)if(R[w]==R[(w+1)%3]){N.push(y);break}}for(y=N.length-1;y>=0;y--){var P=N[y];for(this.faces.splice(P,1),U=0,h=this.faceVertexUvs.length;h>U;U++)this.faceVertexUvs[U].splice(P,1)}var m=this.vertices.length-v.length;return this.vertices=v,m}},eg=function(p,R,m,M,n,I,T){this.aX=p,this.aY=R,this.xRadius=m,this.yRadius=M,this.aStartAngle=n,this.aEndAngle=I,this.aClockwise=T};eg.prototype=oe(sn),eg.prototype.getPoint=function(t){var h,k=this.aEndAngle-this.aStartAngle;0>k&&(k+=G),k>G&&(k-=G),h=this.aClockwise===!0?this.aEndAngle+(1-t)*(G-k):this.aStartAngle+t*k;var e=this.aX+this.xRadius*y(h),E=this.aY+this.yRadius*J(h);return new yj(e,E)};var Kc=function(H,U){this.v1=H,this.v2=U},Qq=Kc.prototype=oe(sn);Qq.getPoint=function($){var M=this.v2.clone().sub(this.v1);return M.multiplyScalar($).add(this.v1),M},Qq.getPointAt=function(K){return this.getPoint(K)},Qq.getTangent=function(){var S=this.v2.clone().sub(this.v1);return S.normalize()};var bs=function(S,n,f){this.v0=S,this.v1=n,this.v2=f};bs.prototype=oe(sn),bs.prototype.getPoint=function(_){var Y,D;return Y=wm.b2(_,this.v0.x,this.v1.x,this.v2.x),D=wm.b2(_,this.v0.y,this.v1.y,this.v2.y),new yj(Y,D)};var ac=function(M,m,n,Z){this.v0=M,this.v1=m,this.v2=n,this.v3=Z};ac.prototype=oe(sn),ac.prototype.getPoint=function(g){var h,X;return h=wm.b3(g,this.v0.x,this.v1.x,this.v2.x,this.v3.x),X=wm.b3(g,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new yj(h,X)},ws.create(function(D,L){this.v1=D,this.v2=L},function(J){var P=new sc;return P.subVectors(this.v2,this.v1),P.multiplyScalar(J),P.add(this.v1),P});var fs=ws.create(function(L,D,N){this.v0=L,this.v1=D,this.v2=N},function(r){var A,T,m;return A=wm.b2(r,this.v0.x,this.v1.x,this.v2.x),T=wm.b2(r,this.v0.y,this.v1.y,this.v2.y),m=wm.b2(r,this.v0.z,this.v1.z,this.v2.z),new sc(A,T,m)}),bl=ws.create(function(A,R,X,F){this.v0=A,this.v1=R,this.v2=X,this.v3=F},function(V){var G,Y,y;return G=wm.b3(V,this.v0.x,this.v1.x,this.v2.x,this.v3.x),Y=wm.b3(V,this.v0.y,this.v1.y,this.v2.y,this.v3.y),y=wm.b3(V,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new sc(G,Y,y)}),Nr=function(F,R,C,O,P,b,o,Z){sr.call(this),O=O!==K?O:.5,P=P!==K?P:.5,Z=Z!==K?Z:1,F=F||8,b=b||0,o=o||G;var Q,E,c=1,X=Z/2,m=[],v=[],a=this.vertices,r=this.faces,p=this.faceVertexUvs;for(E=0;c>=E;E++){var L=[],w=[],j=E/c,Y=j*(P-O)+O;for(Q=0;F>=Q;Q++){var $=Q/F,W=new sc,I=-($*o+b);W.z=Y*J(I),W.y=-j*Z+X,W.x=Y*y(I),a.push(W),L.push(a.length-1),w.push(new yj($,j))}m.push(L),v.push(w)}var N,B,U=(P-O)/Z;for(Q=0;F>Q;Q++)for(0!==O?(N=a[m[0][Q]].clone(),B=a[m[0][Q+1]].clone()):(N=a[m[1][Q]].clone(),B=a[m[1][Q+1]].clone()),N.setY(T(N.x*N.x+N.z*N.z)*U).normalize(),B.setY(T(B.x*B.x+B.z*B.z)*U).normalize(),E=0;c>E;E++){var k=m[E][Q],D=m[E+1][Q],u=m[E+1][Q+1],x=m[E][Q+1],i=N.clone(),A=N.clone(),t=B.clone(),z=B.clone(),l=v[E][Q].clone(),q=v[E+1][Q].clone(),n=v[E+1][Q+1].clone(),d=v[E][Q+1].clone();r.push(new wr(k,D,x,[i,A,z])),p[0].push([l,q,d]),r.push(new wr(D,u,x,[A.clone(),t,z.clone()])),p[0].push([q.clone(),n,d.clone()])}if(R&&O>0)for(this.vertices.push(new sc(0,X,0)),Q=0;F>Q;Q++){var k=m[0][Q],D=m[0][Q+1],u=this.vertices.length-1,i=new sc(0,1,0),A=new sc(0,1,0),t=new sc(0,1,0),l=v[0][Q].clone(),q=v[0][Q+1].clone(),n=new yj(q.x,0);r.push(new wr(k,D,u,[i,A,t],null,1));var f=Q/F*G,_=y(f),M=J(f),V=(Q+1)/F*G,h=y(V),H=J(V);p[0].push([new yj(.5+.5*_,.5+.5*M),new yj(.5+.5*h,.5+.5*H),new yj(.5,.5)])}if(C&&P>0)for(this.vertices.push(new sc(0,-X,0)),Q=0;F>Q;Q++){var k=m[E][Q+1],D=m[E][Q],u=a.length-1,i=new sc(0,-1,0),A=new sc(0,-1,0),t=new sc(0,-1,0),l=v[E][Q+1].clone(),q=v[E][Q].clone();r.push(new wr(k,D,u,[i,A,t],null,2));var f=Q/F*G,_=y(f),M=J(f),V=(Q+1)/F*G,h=y(V),H=J(V);p[0].push([new yj(.5+.5*h,.5-.5*H),new yj(.5+.5*_,.5-.5*M),new yj(.5,.5)])}};Nr.prototype=oe(uj);var pl=function(d,j,n,g,b,m,W){sr.call(this),W=W||.5,d=d||16,j=j||16,n=(n!==K?n:0)-B,g=g!==K?g:G,b=b!==K?b:0,m=m!==K?m:B;var X,$,E=[],S=[],C=this.vertices,D=this.faces,Q=this.faceVertexUvs;for($=0;j>=$;$++){var t=[],k=[];for(X=0;d>=X;X++){var q=X/d,p=$/j,o=new sc;o.x=-W*y(n+q*g)*J(b+p*m),o.y=W*y(b+p*m),o.z=W*J(n+q*g)*J(b+p*m),C.push(o),t.push(C.length-1),k.push(new yj(q,p))}E.push(t),S.push(k)}for($=0;j>$;$++)for(X=0;d>X;X++){var Y=E[$][X+1],i=E[$][X],h=E[$+1][X],x=E[$+1][X+1],v=C[Y].clone().normalize(),A=C[i].clone().normalize(),R=C[h].clone().normalize(),e=C[x].clone().normalize(),w=S[$][X+1].clone(),z=S[$][X].clone(),H=S[$+1][X].clone(),M=S[$+1][X+1].clone();s(C[Y].y)===W?(w.x=(w.x+z.x)/2,D.push(new wr(Y,h,x,[v,R,e])),Q[0].push([w,H,M])):s(C[h].y)===W?(H.x=(H.x+M.x)/2,D.push(new wr(Y,i,h,[v,A,R])),Q[0].push([w,z,H])):(D.push(new wr(Y,i,x,[v,A,e])),Q[0].push([w,z,M]),D.push(new wr(i,h,x,[A.clone(),R,e.clone()])),Q[0].push([z.clone(),H,M.clone()]))}};pl.prototype=oe(uj);var Rd=function(W,t,c,H,f,p){sr.call(this),W=W||.33,t=t||.17,H=H||8,c=c||6,f=f||0,p=p||G;for(var O=new sc,E=[],D=[],m=0;H>=m;m++)for(var z=m/H*G+B,M=0;c>=M;M++){var Y=M/c*p+f;O.x=W*y(Y),O.z=-W*J(Y);var C=new sc,s=W+t*y(z);C.x=s*y(Y),C.z=-s*J(Y),C.y=t*J(z),this.vertices.push(C),E.push(new yj(M/c,1-m/H)),D.push(C.clone().sub(O).normalize())}for(var m=1;H>=m;m++)for(var M=1;c>=M;M++){var u=(c+1)*m+M-1,Z=(c+1)*(m-1)+M-1,T=(c+1)*(m-1)+M,U=(c+1)*m+M,l=new wr(u,Z,U,[D[u].clone(),D[Z].clone(),D[U].clone()]);this.faces.push(l),this.faceVertexUvs[0].push([E[u].clone(),E[Z].clone(),E[U].clone()]),l=new wr(Z,T,U,[D[Z].clone(),D[T].clone(),D[U].clone()]),this.faces.push(l),this.faceVertexUvs[0].push([E[Z].clone(),E[T].clone(),E[U].clone()])}this.computeFaceNormals()};Rd.prototype=oe(uj);var oi=function(Q,J,F){return Q?(sr.call(this),Q=Q instanceof Array?Q:[Q],this.addShapeList(Q,J),J.convertYZ!==!1&&ek(this,F),this.computeFaceNormals(),void 0):(Q=[],void 0)},fr=oi.prototype=oe(sr.prototype);fr.addShapeList=function(B,L){for(var P=B.length,k=0;P>k;k++){var M=B[k];this.addShape(M,L)}},fr.addShape=function(F,c){function d(){if(c.bottom)for(var S=0;x>S;S++)t=m[S],N(t[2],t[1],t[0],!0);if(c.top)for(S=0;x>S;S++)t=m[S],N(t[0]+o*O,t[1]+o*O,t[2]+o*O,!1)}function I(){var K=0;for(z(y,K),K+=y.length,V=0,X=g.length;X>V;V++)h=g[V],z(h,K),K+=h.length}function z(g,a){for(var r,E,q=g.length;--q>=0;){r=q,E=q-1,0>E&&(E=g.length-1);var v=0,Z=O;for(v=0;Z>v;v++){var y=o*v,j=o*(v+1),t=a+r+y,J=a+E+y,f=a+E+j,l=a+r+j;Q(t,J,f,l,g,v,Z,r,E)}}}function k(s,U,P){C.vertices.push(new sc(s,U,P))}function N(l,$,D,i){l+=H,$+=H,D+=H,C.faces.push(new wr(l,$,D,null,null,i?2:1));var e=i?r.generateBottomUV(C,F,c,l,$,D):r.generateTopUV(C,F,c,l,$,D);C.faceVertexUvs[0].push(e)}function Q(e,j,A,v,Y,h,L,S,R){e+=H,j+=H,A+=H,v+=H,C.faces.push(new wr(e,j,v)),C.faces.push(new wr(j,A,v));var O=r.generateSideWallUV(C,F,Y,c,e,j,A,v,h,L,S,R);C.faceVertexUvs[0].push([O[0],O[1],O[3]]),C.faceVertexUvs[0].push([O[1],O[2],O[3]])}var j,P,W,$,B,U=c.amount,Y=c.curveSegments||Ye,O=c.steps||1,w=c.extrudePath,A=!1,r=new Rn(c.repeatUVLength);w&&(j=w.getSpacedPoints(O),A=!0,P=c.frames!==K?c.frames:new Fc.FrenetFrames(w,O,!1),W=new sc,$=new sc,B=new sc);var h,V,X,C=this,H=this.vertices.length,E=F.extractPoints(Y),i=E.shape,g=E.holes,s=!wm.isClockWise(i);if(s){for(i=i.reverse(),V=0,X=g.length;X>V;V++)h=g[V],wm.isClockWise(h)&&(g[V]=h.reverse());s=!1}var m=wm.triangulateShape(i,g),y=i;for(V=0,X=g.length;X>V;V++)h=g[V],i=i.concat(h);for(var a,t,o=i.length,x=m.length,u=0;o>u;u++)a=i[u],A?($.copy(P.normals[0]).multiplyScalar(a.x),W.copy(P.binormals[0]).multiplyScalar(a.y),B.copy(j[0]).add($).add(W),k(B.x,B.y,B.z)):k(a.x,a.y,0);var e;for(e=1;O>=e;e++)for(u=0;o>u;u++)a=i[u],A?($.copy(P.normals[e]).multiplyScalar(a.x),W.copy(P.binormals[e]).multiplyScalar(a.y),B.copy(j[e]).add($).add(W),k(B.x,B.y,B.z)):k(a.x,a.y,U/O*e);d(),I()};var Fc=function(D,A,n,F,X){function N(T,V,x){return l.vertices.push(new sc(T,V,x))-1}sr.call(this),A=A||64,n=n||1,F=F||8,X=X||!1;var e,j,g,x,V,_,Q,t,f,B,M,h,R,r,I,P,d,u,v,$,E=[],l=this,q=A+1,a=new sc,K=new Fc.FrenetFrames(D,A,X),b=K.tangents,L=K.normals,O=K.binormals;for(this.tangents=b,this.normals=L,this.binormals=O,f=0;q>f;f++)for(E[f]=[],x=f/(q-1),t=D.getPointAt(x),e=b[f],j=L[f],g=O[f],B=0;F>B;B++)V=B/F*G,_=-n*y(V),Q=n*J(V),a.copy(t),a.x+=_*j.x+Q*g.x,a.y+=_*j.y+Q*g.y,a.z+=_*j.z+Q*g.z,E[f][B]=N(a.x,a.y,a.z);for(f=0;A>f;f++)for(B=0;F>B;B++)M=X?(f+1)%A:f+1,h=(B+1)%F,R=E[f][B],r=E[M][B],I=E[M][h],P=E[f][h],d=new yj(f/A,B/F),u=new yj((f+1)/A,B/F),v=new yj((f+1)/A,(B+1)/F),$=new yj(f/A,(B+1)/F),this.faces.push(new wr(R,r,P)),this.faceVertexUvs[0].push([d,u,$]),this.faces.push(new wr(r,I,P)),this.faceVertexUvs[0].push([u.clone(),v,$.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Fc.prototype=oe(uj),Fc.FrenetFrames=function(D,v,W){function r(){K[0]=new sc,k[0]=new sc,c=Number.MAX_VALUE,p=s(Z[0].x),e=s(Z[0].y),O=s(Z[0].z),c>=p&&(c=p,$.set(1,0,0)),c>=e&&(c=e,$.set(0,1,0)),c>=O&&$.set(0,0,1),w.crossVectors(Z[0],$).normalize(),K[0].crossVectors(Z[0],w),k[0].crossVectors(Z[0],K[0])}var x,c,p,e,O,U,J,$=new sc,Z=[],K=[],k=[],w=new sc,R=new lr,n=v+1,h=1e-4;for(this.tangents=Z,this.normals=K,this.binormals=k,U=0;n>U;U++)J=U/(n-1),Z[U]=D.getTangentAt(J),Z[U].normalize();for(r(),U=1;n>U;U++)K[U]=K[U-1].clone(),k[U]=k[U-1].clone(),w.crossVectors(Z[U-1],Z[U]),w.length()>h&&(w.normalize(),x=V(qi(Z[U-1].dot(Z[U]),-1,1)),K[U].applyMatrix4(R.makeRotationAxis(w,x))),k[U].crossVectors(Z[U],K[U]);if(W)for(x=V(qi(K[0].dot(K[n-1]),-1,1)),x/=n-1,Z[0].dot(w.crossVectors(K[0],K[n-1]))>0&&(x=-x),U=1;n>U;U++)K[U].applyMatrix4(R.makeRotationAxis(Z[U],x*U)),k[U].crossVectors(Z[U],K[U])};var Am=function(n,p,E,e){sr.call(this),p=p||18,E=E||0,e=e==Z?G:e;for(var u=1/(n.length-1),F=1/p,s=0,W=p;W>=s;s++)for(var w=E+s*F*e,M=y(w),V=J(w),R=0,P=n.length;P>R;R++){var x=n[R],c=new sc;c.x=M*x.x-V*x.y,c.y=V*x.x+M*x.y,c.z=x.z,this.vertices.push(c)}for(var g=n.length,s=0,W=p;W>s;s++)for(var R=0,P=n.length-1;P>R;R++){var d=R+g*s,H=d,v=d+g,M=d+1+g,m=d+1,O=s*F,X=R*u,B=O+F,l=X+u;this.faces.push(new wr(H,m,v)),this.faceVertexUvs[0].push([new yj(O,X),new yj(O,l),new yj(B,X)]),this.faces.push(new wr(v,m,M)),this.faceVertexUvs[0].push([new yj(B,X),new yj(O,l),new yj(B,l)])}this.mergeVertices(),ek(this),this.computeFaceNormals(),this.computeVertexNormals()};Am.prototype=oe(uj);var Mn=function(V,L){L=L||{};var M=Mh.generateShapes(V,L);L.amount=L.amount!==K?L.amount:.5,L.convertYZ=!1,L.fill!==!1&&(L.bottom=!0,L.top=!0),oi.call(this,M,L)};Mn.prototype=oe(fr);var Vq=k.Node=function(){up(Vq,this)},Ll={X:Ih,Y:Rk,Z:sp},gm={X:0,Y:1,Z:2},yo={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},ik="xzy",Dh=function(s,d,Y){if(d){var K=d[0],m=d[1],v=d[2];"xzy"===Y?(Rk(s,m),sp(s,v),Ih(s,K)):"xyz"===Y?(sp(s,v),Rk(s,m),Ih(s,K)):"yxz"===Y?(sp(s,v),Ih(s,K),Rk(s,m)):"yzx"===Y?(Ih(s,K),sp(s,v),Rk(s,m)):"zxy"===Y?(Rk(s,m),Ih(s,K),sp(s,v)):"zyx"===Y?(Ih(s,K),Rk(s,m),sp(s,v)):(Rk(s,m),sp(s,v),Ih(s,K))}};to("Node",Er,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:ik,_64O:0,_rotationX:0,_53O:0,_host:Z,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Me},_22Q:function(){return vj},getX:function(){return this.p().x},setX:function(H){this.p(H,this.p().y)},getY:function(){return this.p().y},setY:function(x){this.p(this.p().x,x)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(y){this.setAnchor(y,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(S){this.setAnchor(this.getAnchor().x,S)},getScaleX:function(){return this.getScale().x},setScaleX:function(b){this.setScale(b,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(Q){this.setScale(this.getScale().x,Q)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(K,M){jq(K,Jh(Z,Z,this.r3(),this.getRotationMode())),this.translate3d(K[0]*M,K[1]*M,K[2]*M)},translateFront:function(r){this.translate3dBy([0,0,1],r)},translateBack:function(J){this.translate3dBy([0,0,-1],J)},translateLeft:function(A){this.translate3dBy([-1,0,0],A)},translateRight:function(S){this.translate3dBy([1,0,0],S)},translateTop:function(J){this.translate3dBy([0,1,0],J)},translateBottom:function(P){this.translate3dBy([0,-1,0],P)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(O,E,j){1===arguments.length&&(E=O[1],j=O[2],O=O[0]),this.p(O,j),this.setElevation(E)},translate3d:function(E,q,Y){1===arguments.length&&(q=E[1],Y=E[2],E=E[0]),this.translate(E,Y),this.setElevation(this._54O+q)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(h,p,S){1===arguments.length&&(p=h[1],S=h[2],h=h[0]),this.setSize(h,S),this.setTall(p)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(X,Q,$){1===arguments.length&&(Q=X[1],$=X[2],X=X[0]),this.setRotationX(X),this.setRotation(-Q),this.setRotationZ($)},setRotationY:function(N){this.setRotation(-N)},getRotationY:function(){return-this._64O},lookAtDirection:function(Q,R){R=R||Nm;var x=this,s=Qn(Q);R===Nm?(x.r3([-m(Q[1]/s),-g(Q[2],Q[0])+I,0]),x.setRotationMode("xzy")):R===qb?(x.r3(0,-g(Q[2],Q[0]),m(Q[1]/s)),x.setRotationMode("zyx")):R===Wf?(x.r3(0,-g(Q[2],Q[0])+B,-m(Q[1]/s)),x.setRotationMode("zyx")):R===uc?(x.r3([-m(Q[1]/s)+I,-g(Q[2],Q[0])+I,0]),x.setRotationMode("xzy")):R===Ul&&(x.r3([-m(Q[1]/s)-I,-g(Q[2],Q[0])+I,0]),x.setRotationMode("xzy")),R===Fd&&(x.r3([-m(Q[1]/s)+B,-g(Q[2],Q[0])+I,B]),x.setRotationMode("zxy"))},lookAt:function(i,l){return this.lookAtDirection(xo(i,this.p3()),l)},lookAtX:function(){var V=new Lp,d=new Lp,p=new Lp,u=new Ln,x=new Ln,I=new k.Math.Euler;return function(w,i,y){i===Wf||i===qb?u.makeRotationAxis(new k.Math.Vector3(0,1,0),Math.PI/2):i===uc||i===Ul?u.makeRotationAxis(new k.Math.Vector3(1,0,0),Math.PI/2):u.identity(),i===Ul||i===qb||i===Fd?(V.fromArray(this.p3()),d.fromArray(w)):(V.fromArray(w),d.fromArray(this.p3())),x.lookAt(V,d,y?p.fromArray(y):p.set(0,1,0)),I.setFromRotationMatrix(x.multiply(u),Sh.ReverseOrder(this.getRotationMode())),this.r3([I.x,I.y,I.z])}}(),getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(w){var L=this;if(L!==w&&L._host!==w){var l=L._host;l&&l._removeAttach(L),L._host=w,L._host&&L._host._addAttach(L),L.fp("host",l,w),L.onHostChanged(l,w)}},getAttaches:function(){return this._69O},_addAttach:function(m){var O=this;O._69O||(O._69O=new $p),O._69O.add(m),O.fp("attaches",Z,m)},_removeAttach:function(K){var X=this;X._69O.remove(K),X._69O.isEmpty()&&delete X._69O,X.fp("attaches",K,Z)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(m){var J=this;J._44I||(J._44I=new $p),J._42I||(J._42I=new $p),J._44I.add(m),J._42I.add(m),J._20I()},_4I:function(x){var e=this;e._44I||(e._44I=new $p),e._43I||(e._43I=new $p),e._44I.add(x),e._43I.add(x),e._20I()},_16I:function(r){var g=this;g._44I.remove(r),g._42I.remove(r),g._44I.isEmpty()&&delete g._44I,g._42I.isEmpty()&&delete g._42I,g._20I()},_18I:function(d){var g=this;g._44I.remove(d),g._43I.remove(d),g._44I.isEmpty()&&delete g._44I,g._43I.isEmpty()&&delete g._43I,g._20I()},_20I:function(){var i=this;if(delete i._45I,!i._44I||i._44I.isEmpty())return delete i._70O,void 0;var C;i._44I.each(function(w){w.isLooped()&&(C||(C={}),C[w._id]||(i._45I||(i._45I=new $p),i._45I.add(w),C[w._id]=w))}),C?(i._70O=new $p,i._44I.each(function(z){C[z._id]?"A"===C[z._id]||(C[z._id]="A",i._70O.add(z)):i._70O.add(z)})):i._70O=i._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(D){var P=this;P._46I||(P._46I=new $p),P._48I||(P._48I=new $p),P._46I.add(D),P._48I.add(D),P._19I()},_3I:function(R){var r=this;r._47I||(r._47I=new $p),r._48I||(r._48I=new $p),r._47I.add(R),r._48I.add(R),r._19I()},_15I:function(l){var o=this;o._46I.remove(l),o._48I.remove(l),o._46I.isEmpty()&&delete o._46I,o._48I.isEmpty()&&delete o._48I,o._19I()},_17I:function(l){var R=this;R._47I.remove(l),R._48I.remove(l),R._47I.isEmpty()&&delete R._47I,R._48I.isEmpty()&&delete R._48I,R._19I()},_19I:function(){var s=this;delete s._49I;var U=s._48I;if(U&&!U.isEmpty()){var B={};U.each(function(n){B[n._id]?s._49I||(s._49I=new $p):B[n._id]=n}),s._49I?U.each(function(T){B[T._id]&&(s._49I.add(T),delete B[T._id])}):s._49I=U}},getImage:function(){if(this._pendingCheckImageJSON){var Z=M.getImage(this._image);Z&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Gp&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(B){var g=this,x=g._image,X=g.getWidth(),O=g.getHeight();g._image=B,g.fp("image",x,B)&&(null!=B&&(Eq(B)||Gk(B)&&/\.json$/i.test(B))&&(this._pendingCheckImageJSON=!0),g.fp(Br,X,g.getWidth()),g.fp(Yk,O,g.getHeight()))},getElevation:function(){return this._54O},setElevation:function(Z){var M=this;if(!M._50O){M._50O=1;var H=M._54O;M._54O=Z,M.fp(sg,H,Z),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(k){var s=this;if(!s._49O){s._49O=1;var f=s._64O;s._64O=k,s.fp(Zp,f,k),delete s._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(h){var W=this;if(!W._51O){W._51O=1;var s=W._rotationX;W._rotationX=h,W.fp("rotationX",s,h),delete W._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(V){var d=this;if(!d._52O){d._52O=1;var L=d._53O;d._53O=V,d.fp("rotationZ",L,V),delete d._52O}},getPosition:function(){return this._position},setPosition:function(N,E){var K=this;if(!K._50I){K._50I=1;var y;if(y=2===arguments.length?{x:N,y:E}:N,y.x!==K._position.x||y.y!==K._position.y){var o=K._position;K._position=y,K.fp(ed,o,y)}delete K._50I}},translate:function(l,V){var X=this._position;this.p(X.x+l,X.y+V)},getWidth:function(){var E=this;if(E._width>=0)return E._width;var D=E.getStyle("shape3d");if(D){var $=pm(D);if($&&$.rawS3)return $.rawS3[0];if("billboard"===D||"plane"===D){var Z=Mk(E.getStyle("shape3d.image"));return Z?pr(Z,E):20}}var Z=Mk(E._image);return Z?pr(Z,E):20},setWidth:function(L){var Z=this,B=Z._width;Z._width=L,Z.fp(Br,B,L)},getHeight:function(){var u=this;if(u._height>=0)return u._height;var W=u.getStyle("shape3d");if(W){var e=pm(W);if(e&&e.rawS3)return e.rawS3[2];if("plane"===W){var v=Mk(u.getStyle("shape3d.image"));return v?Ne(v,u):20}if("billboard"===W)return 2}var v=Mk(u._image);return v?Ne(v,u):20},setHeight:function(E){var W=this,z=W._height;W._height=E,W.fp(Yk,z,E)
},getTall:function(){var L=this;if(L._tall>=0)return L._tall;var Q=L.getStyle("shape3d");if(Q){var Z=pm(Q);if(Z&&Z.rawS3)return Z.rawS3[1];if("billboard"===Q){var n=Mk(L.getStyle("shape3d.image"));return n?Ne(n,L):20}if("plane"===Q)return 2}return 20},setTall:function(t){var i=this,H=i._tall;i._tall=t,i.fp("tall",H,t)},setSize:function(z,U){var D=this;2===arguments.length?(D.setWidth(z),D.setHeight(U)):(D.setWidth(z.width),D.setHeight(z.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(J,a,Q,w,A){var W=this,_=W.getAnchor(),Z=W.getScale();arguments.length<=2&&(A=a,a=J.y,Q=J.width,w=J.height,J=J.x);var H=A&&Z.x<0?1-_.x:_.x,e=A&&Z.y<0?1-_.y:_.y;W.p(J+Q*H,a+w*e),A&&(Q/=Math.abs(Z.x),w/=Math.abs(Z.y)),W.setWidth(Q),W.setHeight(w)},getMatrix:function(){var S=this,W=S._64O,D=S._position,p=S.getScale();return new mk(W,D.x,D.y,p.x,p.y)},getAnchorRect:function(){var t=this,m=t.getWidth(),u=t.getHeight(),o=t.getAnchor();return{x:-m*o.x,y:-u*o.y,width:m,height:u}},toLocal:function(a){return this.getMatrix().tfi(a)},toGlobal:function(b){return this.getMatrix().tf(b)},getAttachPosition:function(){var C=new mk;return function(_,w,u,s){u=u||0,s=s||0;var A=this,r=A.getAnchor(),D=A._64O,k=A._position,J=A.getScale();return C.setFromTransform(D,k.x,k.y).tf({x:u+J.x*A.getWidth()*(_-r.x),y:s+J.y*A.getHeight()*(w-r.y)})}}(),isInRect:function(I){I=this.toLocal(I);var T=this.getWidth(),Q=this.getHeight();return I.x+=T*this.getAnchorX(),I.y+=Q*this.getAnchorY(),!(I.x<0||I.y<0||I.x>T||I.y>Q)},getRect:function(){var J=this,n=J.getWidth(),v=J.getHeight(),p=J.getAnchor(),K={x:-n*p.x,y:-v*p.y,width:n,height:v},k=J.getMatrix();return K=Fp([k.tf(K.x,K.y),k.tf(K.x+K.width,K.y),k.tf(K.x+K.width,K.y+K.height),k.tf(K.x,K.y+K.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var w=this,S=w.getAnchor(),v=w._anchorElevation;return{x:S.x,y:v,z:S.y}},setAnchorElevation:function(Q){var U=this,g=U._anchorElevation;return g!==Q?(U._anchorElevation=Q,U.fp("anchorElevation",g,Q),!0):!1},setAnchor3d:function(u,r,J,X){var p,D=this;"number"==typeof u?p={x:u,y:r,z:J}:(p=u.length?{x:u[0],y:u[1],z:u[2]}:u,X=r);var s=D.getDataModel();s&&s.beginTransaction();var T=D.getAnchor3d(),w=D.setAnchor(p.x,p.z);if(D.setAnchorElevation(p.y)&&(w=!0),w&&X&&!Dg){D.getAnchor3d();var z=go(D),K=jq([p.x-T.x,p.y-T.y,p.z-T.z],z);D.p3(K)}return s&&s.endTransaction(),w},getAnchor:function(){var C=this;if(C.hasOwnProperty("_anchor"))return C._anchor;var F=Mk(C._image);return F&&F.anchorX!==K?{x:F.anchorX,y:F.anchorY}:C._anchor},setAnchor:function(O,x,e){var N,Z=this;"number"==typeof O?N={x:O,y:x}:(N=O.length?{x:O[0],y:O[1]}:O,e=x);var U=Z.getAnchor();if(U.x!==N.x||U.y!==N.y){var D=Z.getDataModel();if(D&&D.beginTransaction(),Z._anchor=N,Z.fp("anchor",U,N),e&&!Dg){var G=Z.getPosition(),I=Z.getSize(),C=Z.getRotation(),l=Z.getScale(),m=-I.width*(U.x-N.x)*l.x,s=-I.height*(U.y-N.y)*l.y,V=J(C),$=y(C);Z.setPosition(G.x+$*m-V*s,G.y+V*m+$*s)}return D&&D.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function($,J){var C,p=this;C=2===arguments.length?{x:$,y:J}:$;var D=p.getScale();(D.x!==C.x||D.y!==C.y)&&(p._scale=C,p.fp("scale",D,C))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var d=this,G=d._scaleTall,_=d.getScale();return[_.x,G,_.y]},getFinalScale3d:function(){var D=this,j=D.s3(),x=D._dynamicScale3d,q=D.getScale3d();return j&&(q[0]*=j[0],q[1]*=j[1],q[2]*=j[2]),x&&(q[0]*=x[0],q[1]*=x[1],q[2]*=x[2]),q},getFinalRotation3d:function(){var X=this;return X._dynamicRotation||X.r3()},setScaleTall:function(a){var u=this,J=u._scaleTall;J!==a&&(u._scaleTall=a,u.fp("scaleTall",J,a))},setScale3d:function(W,k,o){var I,A=this;I="number"==typeof W?{x:W,y:k,z:o}:W.length?{x:W[0],y:W[1],z:W[2]}:W,A.setScaleTall(I.y),A.setScale(I.x,I.z)},getCorners:function(t,B){t==Z&&(t=0),B==Z&&(B=t);var h=this,Q=h.getAnchor(),_=h.getWidth(),Y=h.getHeight(),N=-_*Q.x-t,p=-Y*Q.y-B,T=_+2*t,L=Y+2*B,W=h.getMatrix();return[W.tf(N,p),W.tf(N,p+L),W.tf(N+T,p+L),W.tf(N+T,p)]},getEditControlPoints:function(S,J,o){J==Z&&(J=0),o==Z&&(o=J);var w=this,K=w.getAnchor(),x=w.getWidth(),R=w.getHeight(),C=-x*K.x-J,a=-R*K.y-o,p=x+2*J,G=R+2*o;if(S)return[{x:C,y:a},{x:C,y:0},{x:C,y:a+G},{x:0,y:a+G},{x:C+p,y:a+G},{x:C+p,y:0},{x:C+p,y:a},{x:0,y:a}];var k=w.getMatrix();return[k.tf(C,a),k.tf(C,0),k.tf(C,a+G),k.tf(0,a+G),k.tf(C+p,a+G),k.tf(C+p,0),k.tf(C+p,a),k.tf(0,a)]},rotateAt:function(f,c,r){var p=this,$=p._position,P=p._64O,I=new mk(P,$.x,$.y).tf(f,c),R=T(f*f+c*c),t=g($.y-I.y,$.x-I.x)+r;p.setRotation(P+r),p.p(I.x+R*y(t),I.y+R*J(t))},onParentChanged:function(){Vq.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(e){e._7I()})},onPropertyChanged:function(){var q={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(C){q[C]=!0}),function(S){var g=this;Vq.superClass.onPropertyChanged.call(g,S),q[S.property]&&!g._layoutUpdating&&g.updateLayoutParameters(null,S.property),g._69O&&g._69O.each(function(A){A.handleHostPropertyChange(S)}),g._49I&&g._49I.each(function(Z){Z.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(_){this.updateAttach(_)},onStyleChanged:function(F){Vq.superClass.onStyleChanged.apply(this,arguments),lf[F]&&this.updateAttach()},updateAttach:function(l){var I=this;I._51I||Dg||(I._51I=1,I._71O(l),delete I._51I)},_71O:function(F){var G,h,t,r,P,N,R=this,E=R._host,x=F?F.property:Z,U=F?F.oldValue:Z,n=F?F.newValue:Z;if(E instanceof k.Grid){if(x===sg)R.setElevation(R._54O+n-U);else if(!F||Ge[x]){if(G=R.s("attach.row.index"),h=R.s("attach.column.index"),t=E.getCellRect(G,h),!t)return;r=R.s("attach.row.span"),P=R.s("attach.column.span"),(1!==r||1!==P)&&(t=Gi(t,E.getCellRect(G+r-1,h+P-1))),Ak(t,R,"attach.padding",1),R.setRect(t)}}else if(E instanceof Vl&&(N=R.s("attach.index"))>=0&&(!F||iq[x])){var c=R.s("attach.thickness");c!=Z&&R.setHeight(E.getThickness()*c);var B=R.s("attach.offset"),e=E.getPoints(),H=e.size();if(H>N){var V=e.get(N),S=H===N+1?e.get(0):e.get(N+1),Y=[S.x-V.x,S.y-V.y],_=Qn(Y);if(_){R.s("attach.offset.relative")&&(B*=_),R.s("attach.offset.opposite")&&(B=_-B);var X={x:V.x+Y[0]/_*B,y:V.y+Y[1]/_*B},C=R.s("attach.gap");C&&(R.s("attach.gap.relative")&&(C*=E.getThickness()),X=Qd(Z,X,S,C)),R.p(X),R.setRotation(g(Y[1],Y[0]))}}}else F&&(x===ed?R.translate(n.x-U.x,n.y-U.y):x===sg?R.setElevation(R._54O+n-U):xc[x]?R._11Q(E,x,n-U):("anchor"===x||"width"===x||"height"===x||"scale"===x)&&R.layout(E))},_11Q:function(){var U=new k.Math.Euler,y=k.Math.Euler.ReverseOrder,j=new k.Math.Vector2,t=new k.Math.Vector2;return function(D,K,B){var e=this,x=D.p3(),m=D.r3(),M=e.p3(),C=e.r3();if(K===Zp&&(K="rotationY",B=-B),(K===Zp||"rotationY"===K)&&0===C[0]&&0===C[2]&&0===m[0]&&0===m[2]&&0===M[1]&&0===x[1])return e.setRotation(-C[1]-B),j.set(M[0],M[2]).rotateAround(t.set(x[0],x[2]),-B),e.p(j.x,j.y),void 0;var $=yo[D.getRotationMode()],p=$[0],b=$[1],q=$[2],n=Ll[p],X=Ll[b],J=Ll[q],i=Zg();K===Zp+p?(J(i,m[gm[q]]),X(i,m[gm[b]]),n(i,B),X(i,-m[gm[b]]),J(i,-m[gm[q]])):K===Zp+b?(J(i,m[gm[q]]),X(i,B),J(i,-m[gm[q]])):K===Zp+q&&J(i,B);var Q=xo(M,x);jq(Q,i),e.p3(x[0]+Q[0],x[1]+Q[1],x[2]+Q[2]);var h=e.getRotationMode();Dh(i,e.r3(),h),U.setFromRotationMatrix(i,y(h)),e.r3([U.x,U.y,U.z])}}(),isHostOn:function(x){var P=this;if(P._host&&x&&x._69O)for(var y={},s=P._host;s&&s!==P&&!y[s._id];){if(s===x)return!0;y[s._id]=s,s=s._host}return!1},isLoopedHostOn:function(G){return this.isHostOn(G)&&G.isHostOn(this)},getScaledSize:function(){var k=this.getSize(),d=this.getScale();return k.width*=Math.abs(d.x),k.height*=Math.abs(d.y),k},layout:function(E){if(E=E||this.getHost()){var c=this,Z=c.s("layout.h")||"center",b=c.s("layout.v")||"center";if("center"!==Z||"center"!==b){var e=new k.Math.Vector2,Q=E.getPosition(),I=E.getAnchor(),$=E.getScaledSize();c.getPosition();var U,L,t,R,S,h=1,g=1;switch(c._layoutUpdating=!0,Z){case"left":e.setX(c._layoutHValue-I.x*$.width);break;case"right":e.setX((1-I.x)*$.width-c._layoutHValue);break;case"leftright":U=$.width-c._layoutHValue[2],t=c.getRotation()-E.getRotation(),R=Math.abs(Math.sin(t)),S=Math.abs(Math.cos(t)),h+=S*U/c._layoutHValue[3],g+=R*U/c._layoutHValue[4],e.setX(c._layoutHValue[1]+(c._layoutHValue[5]-I.x)*$.width);break;case"center":e.setX((.5-I.x)*$.width-c._layoutHValue);break;case"scale":t=c.getRotation()-E.getRotation(),R=Math.abs(Math.sin(t)),S=Math.abs(Math.cos(t)),e.setX((.5-I.x)*$.width-c._layoutHValue[1]*$.width/c._layoutHValue[0]),L=$.width/c._layoutHValue[2]-1,h+=S*L,g+=R*L}switch(b){case"top":e.setY(c._layoutVValue-I.y*$.height);break;case"bottom":e.setY((1-I.y)*$.height-c._layoutVValue);break;case"topbottom":t||(t=c.getRotation()-E.getRotation(),R=Math.abs(Math.sin(t)),S=Math.abs(Math.cos(t))),U=$.height-c._layoutVValue[2],h+=R*U/c._layoutVValue[3],g+=S*U/c._layoutVValue[4],e.setY(c._layoutVValue[1]+(c._layoutVValue[5]-I.y)*$.height);break;case"center":e.setY((.5-I.y)*$.height-c._layoutVValue);break;case"scale":t||(t=c.getRotation()-E.getRotation(),R=Math.abs(Math.sin(t)),S=Math.abs(Math.cos(t))),e.setY((.5-I.y)*$.height-c._layoutVValue[1]*$.height/c._layoutVValue[0]),L=$.height/c._layoutVValue[2]-1,h+=R*L,g+=S*L}(1!==h||1!==g)&&("leftright"===Z||"scale"===Z?c.setSize(c._layoutHValue[3]*h,c._layoutHValue[4]*g):c.setSize(c._layoutVValue[3]*h,c._layoutVValue[4]*g)),e.rotateAround(null,E.getRotation()),this.setPosition(e.x+Q.x,e.y+Q.y),c._layoutUpdating=K}}},updateLayoutParameters:function(p,G){if(p=p||this.getHost()){var u=this,V=u.s("layout.h"),_=u.s("layout.v");if(V||_){var c,d,x,L,C,v,U=new k.Math.Vector2,s=p.getPosition(),e=p.getAnchor(),B=p.getScaledSize(),W=u.getPosition(),M=u.getSize();switch(U.set(W.x-s.x,W.y-s.y),U.rotateAround(null,-p.getRotation()),V){case"left":u._layoutHValue=U.x+e.x*B.width;break;case"right":u._layoutHValue=-U.x+(1-e.x)*B.width;break;case"center":u._layoutHValue=-U.x+(.5-e.x)*B.width;break;case"leftright":case"scale":"scale"===V?c=-U.x+(.5-e.x)*B.width:(d=u.getAnchor(),x=u.getRotation()-p.getRotation(),L=Math.cos(x),C=Math.sin(x),v=-Math.min(-d.x*L+d.y*C,-d.x*L-(1-d.y)*C,(1-d.x)*L+d.y*C,(1-d.x)*L-(1-d.y)*C),c=U.x-(v-e.x)*B.width),"position"===G&&"object"==typeof u._layoutHValue?(u._layoutHValue[0]=B.width,u._layoutHValue[1]=c):u._layoutHValue=[B.width,c,B.width,M.width,M.height,v]}switch(_){case"top":u._layoutVValue=U.y+e.y*B.height;break;case"bottom":u._layoutVValue=-U.y+(1-e.y)*B.height;break;case"center":u._layoutVValue=-U.y+(.5-e.y)*B.height;break;case"topbottom":case"scale":"scale"===_?c=-U.y+(.5-e.y)*B.height:(x||(d=u.getAnchor(),x=u.getRotation()-p.getRotation(),L=Math.cos(x),C=Math.sin(x)),v=-Math.min(-d.x*C-d.y*L,-d.x*C+(1-d.y)*L,(1-d.x)*C-d.y*L,(1-d.x)*C+(1-d.y)*L),c=U.y-(v-e.y)*B.height),"position"===G&&"object"==typeof u._layoutVValue?(u._layoutVValue[0]=B.height,u._layoutVValue[1]=c):u._layoutVValue=[B.height,c,B.height,M.width,M.height,v]}}}},getSerializableProperties:function(){var r=Vq.superClass.getSerializableProperties.call(this);return Bm(r,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),r}});var po=k.Edge=function(p,Q){var W=this;up(po,W),W.setSource(p),W.setTarget(Q)};to("Edge",Er,{_icon:"edge_icon",getUIClass:function(){return xj},_22Q:function(){return Wl},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(b){var f=this;if(f._source!==b){var _=f._source;f._source=b,_&&_._16I(f),b&&b._2I(f),f._7I(),f.fp("source",_,b)}},setTarget:function(R){var L=this;if(L._target!==R){var z=L._target;L._target=R,z&&z._18I(L),R&&R._4I(L),L._7I(),L.fp("target",z,R)}},isLooped:function(){var Z=this;return Z._source===Z._target&&!!Z._source&&!!Z._target},_7I:function(){var l,x=this,e=gh(x);x._40I!==e&&(l=this._40I,l&&l._15I(x),x._40I=e,e&&e._1I(x),x.fp("sourceAgent",l,e),Eh(l,x._41I),Eh(e,x._41I));var o=Wo(x);x._41I!==o&&(l=x._41I,l&&l._17I(x),x._41I=o,o&&o._3I(x),x.fp("targetAgent",l,o),Eh(l,x._40I),Eh(o,x._40I))},_22I:function(L){this._52I=L,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var w=this;return w._52I&&w._52I.get(0)!==w&&!w.getStyle(Pb)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var A=this,s=A._52I;return s&&!A.getStyle(Pb)&&s.size()>1&&A===s.get(0)},toggle:function(){var V=this._52I,R=!this.s(Pb);V&&V.size()>1&&(V.each(function(c){c.s(Pb,R)}),V.getSiblings().each(function(X){X!==V&&X.each(function(e){e.fp("edgeGroup",Z,X)})}))},setStyle:function(l,X){(l===wp||"edge.segments"===l)&&(X=Or(X)),po.superClass.setStyle.call(this,l,X)},onStyleChanged:function(x){po.superClass.onStyleChanged.apply(this,arguments),Mq[x]&&Eh(this._41I,this._40I)},getSerializableProperties:function(){var d=po.superClass.getSerializableProperties.call(this);return Bm(d,{source:1,target:1}),d}});var dd=k.Group=function(){up(dd,this)};to("Group",Vq,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Ko},onChildAdded:function(){dd.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){dd.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var v=this;if(!v._54I&&!Dg){var W=v.getChildrenRect();W&&(v._53I=1,v.p(vk(v.s("group.position"),W,v.getSize())),delete v._53I)}},getChildrenRect:function(){var E,_=this;return _.eachChild(function(l){E=Gi(E,_.getChildRect(l))}),E},getChildRect:function($){var l;return vs($)&&$.s(hh)&&(Em($)&&$.isExpanded()&&$.eachChild(function(X){l=Gi(l,$.getChildRect(X))}),!l&&$.getRect&&(l=$.getRect())),l},setPosition:function(E,u){var d=this;if(!d._54I){var $;$=2===arguments.length?{x:E,y:u}:E,Dg||d._53I||(d._54I=1,$e(d._children,$.x-d._position.x,$.y-d._position.y),delete d._54I),dd.superClass.setPosition.call(this,$)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(k){var x=this;if(x._57O!==k){var t=x._57O;x._57O=k,x.fp("expanded",t,x._57O),x._fireInvalidateDeep(),x._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(x){Em(x)?x._fireInvalidateDeep():x.iv()})},_8I:function(){dd.superClass._8I.call(this),this.eachChild(function(o){vs(o)&&o._8I()})},onStyleChanged:function(B){dd.superClass.onStyleChanged.apply(this,arguments),"group.position"===B&&this._81I()},getSerializableProperties:function(){var M=dd.superClass.getSerializableProperties.call(this);return M.expanded=1,M}});var Gl=k.Block=function(){up(Gl,this)};to("Block",Vq,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return eo},onChildAdded:function(){Gl.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Gl.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var v=this;if(!Dg&&!v._updatingToChildren&&v._syncSize&&!v._freezeSyncFromChildren){var i,$,b,f,h,w=[],L=v.getRotation();if(v.eachChild(function(V){vs(V)&&w.push.apply(w,V.getCorners())}),w.length){v._updatingFromChildren=1;var K=y(-L),j=J(-L),l=1/0,k=-1/0,O=1/0,P=-1/0;for(f=0,h=w.length;h>f;f++)b=w[f],i=b.x,$=b.y,b.x=K*i-j*$,b.y=j*i+K*$,l=z(l,b.x),k=E(k,b.x),O=z(O,b.y),P=E(P,b.y);var t=v.getScale();v.setSize(s((k-l)/t.x),s((P-O)/t.y));var U;t.x<0&&(U=l,l=k,k=U),t.y<0&&(U=O,O=P,P=U),K=y(L),j=J(L);var n=v.getAnchor();i=l+(k-l)*n.x,$=O+(P-O)*n.y,v.setPosition(K*i-j*$,j*i+K*$),delete v._updatingFromChildren}}},setPosition:function(F,P){var C=this;if(!C._updatingToChildren){var d;d=2===arguments.length?{x:F,y:P}:F,Dg||C._updatingFromChildren||(C._updatingToChildren=1,$e(C._children,d.x-C._position.x,d.y-C._position.y),delete C._updatingToChildren),Gl.superClass.setPosition.call(this,d)}},setWidth:function(G){return this.setSize(G,this.getHeight())},setHeight:function(z){return this.setSize(this.getWidth(),z)},setSize:function(L,C){1>L&&(L=1),1>C&&(C=1);var N=this;if(!N._updatingToChildren){2!==arguments.length&&(C=L.height,L=L.width);var m=N.getWidth(),q=N.getHeight();if(L!==m&&Gl.superClass.setWidth.call(N,L),C!==q&&Gl.superClass.setHeight.call(N,C),!Dg&&!N._updatingFromChildren){N._updatingToChildren=1;var o=L/m,n=C/q;N._adjustChildScaleOrSize(o,n,"size"),delete N._updatingToChildren,N.updateFromChildren()}}},_adjustChildScaleOrSize:function(S,p,w){var q=this;if(q._syncSize){var f=q.getPosition(),H=q.getRotation();q.getScale(),q.eachChild(function(X){if(vs(X)){var d=X.getPosition(),I=X.getRotation(),N=X.getWidth(),j=X.getHeight(),x=X.getScale(),P=x.x*N,C=x.y*j,D=new mk(I,d.x,d.y,P,C);D.translate(-f.x,-f.y),D.rotate(-H),I=g(D.b*Math.sign(P),D.a*Math.sign(P)),D.scale(S,p);var F,l,$,B=y(I);if(Math.abs(B)<.001?(F=J(I),l=D.b/F,$=-D.c/F):(l=D.a/B,$=D.d/B),"scale"===w)X.setScale(l/N,$/j);else if("size"===w){var U=l/x.x,i=$/x.y;X.setScale(wq(l)*Math.abs(x.x),wq($)*Math.abs(x.y)),X.setSize(Math.max(.1,Math.abs(U)),Math.max(.1,Math.abs(i)))}D.rotate(H),D.translate(f.x,f.y),X.setPosition(D.tx,D.ty)}})}},_calcChangeFactor:function(J,_,b,q){var P,B,c,j;return P=s(J),B=s(b),c=P>B?P/B:B/P,P=s(_),B=s(q),j=P>B?P/B:B/P,E(c,j)},setAnchor:function(){var o=this;if(!o._updatingToChildren){var d=o.getAnchor();if(Gl.superClass.setAnchor.apply(o,arguments),!Dg&&!o._updatingFromChildren&&o._syncSize){o._updatingToChildren=1;var $=o.getAnchor();o.getPosition();var K=o.getSize(),H=o.getScale(),k=o.getRotation(),_=-K.width*H.x*(d.x-$.x),D=-K.height*H.y*(d.y-$.y),M=J(k),b=y(k),F=b*_-M*D,x=M*_+b*D;o.eachChild(function(W){if(vs(W)){var b=W.getPosition();W.setPosition(b.x-F,b.y-x)}}),delete o._updatingToChildren}}},setRotation:function(J){var P=this;if(!P._updatingToChildren){var N=P.getRotation();if(Gl.superClass.setRotation.apply(P,arguments),!Dg&&!P._updatingFromChildren){P._updatingToChildren=1;var M=P.getPosition(),A=J-N;P.eachChild(function(W){if(vs(W)){var D=W.getMatrix();D.translate(-M.x,-M.y),D.rotate(A),D.translate(M.x,M.y);var I=Math.sign(W.getScale().x);W.setRotation(g(D.b*I,D.a*I)),W.setPosition(D.tx,D.ty)}}),delete P._updatingToChildren}}},setScale:function(y,g){var b=this;if(!b._updatingToChildren){null==g&&(g=y.y,y=y.x);var j=b.getScale();if(s(y)<.01&&(y=.01*(wq(y)||wq(j.x))),s(g)<.01&&(g=.01*(wq(g)||wq(j.y))),Gl.superClass.setScale.call(b,y,g),!Dg&&!b._updatingFromChildren){b._updatingToChildren=1;var z=y/j.x,W=g/j.y;b._adjustChildScaleOrSize(z,W,"size"),delete b._updatingToChildren,b.updateFromChildren()}}},getSerializableProperties:function(){var t=Gl.superClass.getSerializableProperties.call(this);return t.clickThroughEnabled=1,t.syncSize=1,t}});var Dm=k.Grid=function(){up(k.Grid,this)};to("Grid",Vq,{IRotatable:!1,_icon:"grid_icon",_image:Z,getUIClass:function(){return qs},setRotation:function(){},getCellRect:function(k,b){var y=this,r=y.s("grid.row.count"),Y=y.s("grid.column.count");if(0>=r||0>=Y||0>k||k>=r||0>b||b>=Y)return Z;var q,B,x,m=y.getRect(),Q=y.s("grid.row.percents"),V=y.s("grid.column.percents");if(Ak(m,y,"grid.border",-1),Q&&Q._as&&(Q=Q._as),V&&V._as&&(V=V._as),Q&&Q.length===r){for(x=0,q=0;k>q;q++)x+=m.height*Q[q];m.y+=x,m.height=m.height*Q[k]}else m.height=m.height/r,m.y+=m.height*k;if(V&&V.length===Y){for(B=0,q=0;b>q;q++)B+=m.width*V[q];m.x+=B,m.width=m.width*V[b]}else m.width=m.width/Y,m.x+=m.width*b;return $l(m,-y.s("grid.gap")),m}});var zq=k.Text=function(){up(zq,this),this.setSize(100,50),this.s("text","TEXT")};to("Text",Vq,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return _b},setWidth:function(J){J||(J=.001),zq.superClass.setWidth.call(this,J)},setHeight:function(l){l||(l=.001),zq.superClass.setHeight.call(this,l)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),ii("__text__",{width:{value:100,isSafeFunc:!0,func:function(N){return N._width}},height:{value:50,isSafeFunc:!0,func:function(E){return E._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Vl=k.Shape=function(){up(Vl,this),this._59O=new $p};Vl.__de__=sm,to("Shape",Vq,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Xk},_22Q:function(){return Bj},getLength:function(h){return qh(Ch(this._59O,this._58O,h,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var k=this._58O;return k?new $p(k._as.slice(0)):k},setSegments:function(d){var z=this._58O;d=d?Sp(d)?new $p(d.slice(0)):new $p(d._as.slice(0)):null,(z&&d&&z._as.join(",")!==d._as.join(",")||z!==d)&&(this._58O=d,this.fp("segments",z,d))},getPoints:function(){return this._59O},toPoints:function(){var E=this._59O;return new $p(E._as.slice(0))},setPoints:function(t,U){var k=this,c=k._59O;t=t?Sp(t)?new $p(t.slice(0)):new $p(t._as.slice(0)):new $p;var p,E,T,A,y,$;U&&(p=k.getPosition(),$=new mk(k.getRotation(),0,0,k.getScale().x,k.getScale().y)),(c&&t&&c._as.join(",")!==t._as.join(",")||c!==t)&&(k._59O=t,k.fs(),k.fp("points",c,t)),U&&(E=k.getPosition(),T=E.x-p.x,A=E.y-p.y,y=$.tf(T,A),k.setPosition(E.x-T+y.x,E.y-A+y.y))},addPoint:function(e,_,R){var B=this.toPoints();B.add(e,_),this.setPoints(B,R)},setPoint:function(I,l,b){var x=this.toPoints();x.set(I,l),this.setPoints(x,b)},removePointAt:function(R){var L=this.toPoints();L.removeAt(R),this.setPoints(L)},setWidth:function(i){var s=this;if(1>i&&(i=1),!s._55I&&!Dg&&s.getWidth()){s._55I=1;var k=s._position.x,y=i/s.getWidth(),E=s.toPoints(),A=new $p;E.each(function(H){A.add({x:(H.x-k)*y+k,y:H.y,e:H.e})}),s.setPoints(A),Gf(s,[y,0,0,1,k*(1-y),0]),s.fs(),delete s._55I}Vl.superClass.setWidth.call(s,i)},setHeight:function(r){var C=this;if(1>r&&(r=1),!C._55I&&!Dg&&C.getHeight()){C._55I=1;var e=C._position.y,p=r/C.getHeight(),d=C.toPoints(),J=new $p;d.each(function(m){J.add({x:m.x,y:(m.y-e)*p+e,e:m.e})}),C.setPoints(J),Gf(C,[1,0,0,p,0,e*(1-p)]),C.fs(),delete C._55I}Vl.superClass.setHeight.call(C,r)},setAnchorElevation:function(F){var d=this;d._55I=!0;var c=d._updatingAnchor3d,o=!Dg&&!c;if(o){var L,u=F,l=d.getAnchorElevation(),w=d.getTall();L=w*(l-u),d.shiftPointsElevation(L)}var M=Vl.superClass.setAnchorElevation.apply(d,arguments);return c||delete d._55I,M},getShapeElevation:function(){var i=this,q=i._54O;return q-(i.getTall()||0)*(i._anchorElevation-.5)},setAnchor3d:function(O,W,s,q){var y,X=this;"number"==typeof O?y={x:O,y:W,z:s}:(y=O.length?{x:O[0],y:O[1],z:O[2]}:O,q=W),X._55I=!0,X._updatingAnchor3d=!0;var F=X.getDataModel();if(F&&F.beginTransaction(),!Dg){var S=X.getAnchor3d(),T=X.getSize(),c=X.getTall(),j=T.width*(S.x-y.x),J=T.height*(S.z-y.z),E=c*(S.y-y.y);q||X.shiftPoints(j,J,E);var h=X.p3()}var r=Vl.superClass.setAnchor3d.apply(X,arguments);if(!Dg&&q){var U=X.p3();X.shiftPoints(U[0]-h[0]+j,U[2]-h[2]+J,U[1]-h[1]+E)}return F&&F.endTransaction(),delete X._updatingAnchor3d,delete X._55I,r},setAnchor:function(v,L,$){var n=this;n._55I=!0;var A=n._updatingAnchor3d,G=!Dg&&!A;if(G){var y,M,K;"number"==typeof v?K={x:v,y:L}:(K=v.length?{x:v[0],y:v[1]}:v,$=L);var _=n.getAnchor(),a=n.getSize();y=a.width*(_.x-K.x),M=a.height*(_.y-K.y),$||n.shiftPoints(y,M);var p=n.getPosition()}var D=Vl.superClass.setAnchor.apply(n,arguments);if(G){var k=n.getPosition();$&&n.shiftPoints(k.x-p.x+y,k.y-p.y+M)}return A||delete n._55I,D},shiftPoints:function(F,R,G){var c=this,n=c.getElevation()||0,L=c.toPoints(),J=new $p;L.each(function(u){var c=u.e;G&&(c=(c==Z?n:c)+G),J.add({x:u.x+F,y:u.y+R,e:c})}),c.setPoints(J),c.fs()},shiftPointsElevation:function(c){return this.shiftPoints(0,0,c)},setPosition:function(S,v){var p,H=this;if(!H._28Q){if(H._28Q=1,!H._55I&&!Dg){p=2===arguments.length?{x:S,y:v}:S;var B=p.x-H._position.x,V=p.y-H._position.y;if(0===B&&0===V)return delete H._28Q,void 0;H._55I=1,H.shiftPoints(B,V),Gf(H,[1,0,0,1,B,V]),delete H._55I}Vl.superClass.setPosition.apply(H,arguments),delete H._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var g=this;if(2!==g._59O.size())return!1;var S=g._58O;return S?2===S.size()&&1===S.get(0)&&2===S.get(1)?!0:!1:!0},fireShapeChange:function(){var b=this;if(!b._55I&&!Dg){var T=Fp(b._59O);T&&(b._55I=1,b.setRect(T),delete b._55I)}b.fp(Bd,!1,!0)},getSerializableProperties:function(){var n=Vl.superClass.getSerializableProperties.call(this);return n.segments=1,n.points=1,n.thickness=1,n.closePath=1,n}});var ar=k.Polyline=function(){up(ar,this),this.s({"shape.background":null,"shape.border.width":2})};to("Polyline",Vl,{_icon:"polyline_icon",_22Q:function(){return Vf},getUIClass:function(){return uf},setClosePath:function(){},setTall:function(q){var P=this;if(!P._55I&&!P._24Q&&!Dg&&P.getTall()){P._24Q=1;var Q=P._54O,p=q/P.getTall();P._59O.each(function(c){c.e=c.e==Z?Q:(c.e-Q)*p+Q}),P.fs(),delete P._24Q}ar.superClass.setTall.call(P,q)},setElevation:function(W){var s=this;if(!s._55I&&!s._24Q&&!Dg){s._24Q=1;var v=W-s._54O;s._59O.each(function(T){T.e==Z?T.e=W:T.e+=v}),s.fs(),delete s._24Q}ar.superClass.setElevation.apply(s,arguments)},fireShapeChange:function(){var c=this,T=c._59O;if(!c._55I&&!c._24Q&&!Dg){var X=T.size();if(X){var $=1,G=T.get(0),U=c._54O;G.e==Z&&(G.e=U);for(var N=G.e,Q=0;X>$;$++){G=T.get($),G.e==Z&&(G.e=U);var F=z(N,G.e),b=E(N+Q,G.e);N=F,Q=b-F}c._24Q=1,c.setTall(Q),c.setElevation(N+Q*c._anchorElevation),delete c._24Q}}ar.superClass.fireShapeChange.apply(c,arguments)}});var gr=k.SubGraph=function(){up(gr,this)};to("SubGraph",Vq,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){gr.superClass._8I.call(this),this.eachChild(function(Z){vs(Z)&&Z._8I()})}}),M.loadingRefGraph=0;var Gp=k.RefGraph=function(){up(Gp,this)};to("RefGraph",Gl,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(X){var d=this._ref;this._ref=X,this.fp("ref",d,X),this.updateRef()},_21I:function(){Gp.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var H=this;if(M.loadingRefGraph++,H.clearChildrenFromDataModel(),M.loadingRefGraph--,H._ref&&H._dataModel){H._xhrLoadHandler&&(H._xhrLoadHandler.cancel=!0);var b=Dg,N=H._xhrLoadHandler=function(w){if(w&&H._dataModel){M.loadingRefGraph++;var F=H._pendingUpdateInfo={needToRestore:b};b&&(F.position=H.p(),F.width=H.getWidth(),F.height=H.getHeight(),F.rotation=H.getRotation(),F.anchor=H.getAnchor(),F.scale=H.getScale()),H.p(0,0),H.setAnchor(.5,.5),H.setRotation(0),H.setScale(1,1);var q=M.parse(w),Q=H._dataModel.deserialize(q,H,{justDatas:!0});Q.each(function(y){y._refGraph=H}),H.checkPendingUpdateInfo(),M.loadingRefGraph--,M.handleRefGraphLoaded(H,Q,q)}};N.xhrLoadCalled=!1,M.load(H._ref,function(V){N.cancel||(N.xhrLoadCalled?N(V):zj(function(){N(V)}))}),N.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var Z=this,H=Z._pendingUpdateInfo;if(!H)return Z.onPendingUpdated&&(M.loadingRefGraph++,Z.onPendingUpdated(),M.loadingRefGraph--),void 0;var u=!0;this.eachChild(function(m){(m._pendingCheckImageJSON||m._pendingUpdateInfo)&&(u=!1)}),u&&(M.loadingRefGraph++,Z._pendingUpdateInfo=null,Z.updateFromChildren(),H.needToRestore&&(Z.setSize(H.width,H.height),Z.setAnchor(H.anchor),Z.setRotation(H.rotation),Z.setScale(H.scale),Z.p(H.position)),this.getParent()instanceof Gp&&this.getParent().checkPendingUpdateInfo(),Z.onPendingUpdated&&Z.onPendingUpdated(),M.loadingRefGraph--)},getSerializableProperties:function(){var y=Gp.superClass.getSerializableProperties.call(this);return y.ref=1,y}}),k.EdgeGroup=function(I,a){this._70O=I,this._siblings=a;for(var L,g,c=0,w=I.size(),q=S[Pb];w>c;c++)if(L=I.get(c).getStyle(Pb,!1),L!=Z){q=L;break}q==Z&&(q=!0);var T=M.edgeGroupAgentFunc;for(T&&(g=T(I),g&&g!==I.get(0)&&(I.remove(g),I.add(g,0))),c=0;w>c;c++)I.get(c).s(Pb,q)},to("EdgeGroup",C,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(f){return this._70O.get(f)},indexOf:function(M){return this._70O.indexOf(M)},each:function(s,x){this._70O.each(s,x)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(L,E){this._siblings.each(function(A){A._70O.each(L,E)})}});var de=function(y,a,w){var m=Jb[y]={type:y,action:a};if(w)for(var n in w)m[n]=w[n]};Bm(M,{setConnectAction:de,getConnectAction:function(W,p){if(!p){if(!W)return null;p=W.getCurrentConnectActionType()}return Jb[p]},doConnectAction:function(s,c,H,a){a=a||s.getCurrentConnectActionType();var z=Jb[a];if(!z)return!1;var d=z.action;return d?(c instanceof Nl.Group?s.sm().getSelection().each(function(Z){d.call(null,s,Z,H)}):d.call(null,s,c,H),!0):!1},doDeleteConnectionAction:function(c,V,d){d=d||c.getCurrentConnectActionType();var Y=Jb[d];if(!Y||!Y.delete)return!1;var U=Y.delete.action;return U?(V instanceof Nl.Group?c.sm().getSelection().each(function(g){U.call(null,c,g)}):U.call(null,c,V),!0):!1}});var mh=k.JSONSerializer=function(j,q){this.dm=this._dataModel=j,this._hierarchical=M.forceHierarchicalSerialization?!0:q==Z?j.isHierarchicalRendering():q};to("JSONSerializer",C,{ms_ac:["hierarchical"],serialize:function(h){return M.stringify(this.toJSON(),h)},toJSON:function(){var h=this,b=h.dm,N=b.getRoots(),Q=h.json={v:M.getVersion(),p:{},a:{},d:[]},F=b.getSerializableAttrs();b.getInit()&&(Q.init=b.getInit()),b.getName()&&(Q.p.name=b.getName()),b.getBackground()&&(Q.p.background=b.getBackground()),b.getLayers()&&(Q.p.layers=b.getLayers()),b.getEnvmap()&&(Q.p.envmap=b.getEnvmap()),Q.p.autoAdjustIndex=b.isAutoAdjustIndex(),Q.p.hierarchicalRendering=b.isHierarchicalRendering();for(var P in F){var E=b.a(P);E!==K&&h[Sk](P,E,Q.a)}return us(Q.a)&&delete Q.a,h._hierarchical?N.each(h.serializeData,this):b.each(function($){h.serializeData($)}),b.fireSerializeEvent({type:"serialize",json:Q}),b.getPostProcessingData()&&(Q.p.postProcessingData=b.getPostProcessingData()),Q},isSerializable:function(){return!0},getProperties:function(h){return h.getSerializableProperties()},getStyles:function(k){return k.getSerializableStyles()},getAttrs:function(g){return g.getSerializableAttrs()},serializeData:function(X){var t=this;if(t.isSerializable(X)&&!X._refGraph){var p,o,Y,b,R=jk(X.getClassName())||X.getClass(),A=new R,h={c:X.getClassName(),i:X.getId(),p:{},s:{},a:{}};t.json.d.push(h),p=t.getProperties(X);for(o in p)if(/^_/.test(o)){if(Y=X[o],("_width"===o||"_height"===o)&&Y===K){var i;((X.s("layout.h")||X.s("layout.v"))&&X.getHost()||X instanceof k.Node&&(i=X.getParent())&&i instanceof k.Block||X.s("fullscreen"))&&(Y=X[o]="_width"===o?X.getWidth():X.getHeight())}Y!==A[o]&&t[Sk](o.substr(1),Y,h.p)}else b=$d(o),X[b]&&(Y=X[b](),Y!==A[b]()&&t[Sk](o,Y,h.p));p=t.getStyles(X);for(o in p)Y=X.s(o),Y!==A.s(o)&&t[Sk](o,Y,h.s);p=t.getAttrs(X);for(o in p)Y=X.a(o),Y!==A.a(o)&&t[Sk](o,Y,h.a);us(h.p)&&delete h.p,us(h.s)&&delete h.s,us(h.a)&&delete h.a}t._hierarchical&&X.getChildren().each(t.serializeData,t)},serializeValue:function(F,q,n){ff(q)?q={__a:q._as}:q instanceof Er&&(q={__i:q.getId()}),n[F]=q},deserialize:function(j,A,R){var L=this;return Gk(j)&&/.json$/.test(j)?(M.xhrLoad(j,function(X){L.deserializeImpl(X,A,R)}),void 0):L.deserializeImpl(j,A,R)},deserializeImpl:function(O,u,d){var j=this,Q=j.dm;d=hf(d)?{setId:d}:Ck(d)?{finishFunc:d}:d||{},O=j.json=Gk(O)?M.parse(O):O,O.a&&O.a.onPreDeserialize&&!d.disableOnPreDeserialize&&O.a.onPreDeserialize(O,Q,d.view),Q.beginTransaction(),Dg++,j._82I={};var G=new $p,k=new $p,c=0,h=O.d.length;if(d.justDatas||(Ck(O.init)&&O.init(Q),Q.setInit(O.init)),!d.justDatas){for(var g in O.a)Q.a(g,j[Bq](O.a[g]));for(var S in O.p)Q[cf(S)](O.p[S])}for(;h>c;c++){var q=O.d[c],X=jk(q.c),N=new X,K=q.i;
d.setId&&K!=Z&&(N._id=K),j._82I[K]=N,G.add(N),k.add(q)}for(c=0;h>c;c++)j.deserializeData(G.get(c),k.get(c));return G.each(function(a){u&&!a.getParent()&&a.setParent(u),Q.add(a)}),Q.fireSerializeEvent({type:"deserialize",json:O}),Dg--,Q.endTransaction(),O.a&&O.a.onPostDeserialize&&!d.disableOnPostDeserialize&&O.a.onPostDeserialize(O,Q,d.view,G),d.finishFunc&&d.finishFunc(O,Q,d.view,G),G},deserializeData:function(o,g){for(var P in g.p)o[cf(P)](this[Bq](g.p[P]));for(P in g.s)o.s(P,this[Bq](g.s[P]));for(P in g.a)o.a(P,this[Bq](g.a[P]))},deserializeValue:function(q){if(Eq(q)){var d=q.__i;if(d!=Z)return this._82I[d];if(d=q.__a,Sp(d))return new $p(d)}return q}}),Bm(Sn,{serialize:function(R,Y){return new mh(this,Y).serialize(R)},toJSON:function(P){return new mh(this,P).toJSON()},deserialize:function(r,j,o){return new mh(this).deserialize(r,j,o)}});var Lj=k.OverlappingBox=function(x){this.gv=x,this.boxes={}};to("OverlappingBox",C,{clear:function(){var L,Y,v=this.boxes;for(L in v)Y=v[L],Y.length=0},isOverlapping:function(b,S){var r,m,P=this,D=P.boxes,o=D[b];o?(r=o.rects,m=o.length):o=D[b]={rects:r=[],length:m=0};var v,L,S;for(v=0;m>v;v++)if(L=r[v],L.x<S.x+S.w&&L.x+L.w>S.x&&L.y<S.y+S.h&&L.h+L.y>S.y)return!0;return r.length<=m?(r.push(S),o.length++):r[o.length++]=S,!1}}),Bm(M,{fetch:function(Q,O){var b="GET",V=!1,p=null,t="";O&&(b=O.method||"GET",V=O.sync,t=O.url,p=O.data||null),Q.open(b,t,!V),O.responseType?Q.responseType=O.responseType:O.overrideMimeType&&Q.overrideMimeType(O.overrideMimeType),Q.send(p)},convertImageSrc:function(t,v){v&&"function"==typeof v||(v=function(){}),v(t)}});var Lo=k.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};to("Request",C,{_responseType:null,_overrideMimeType:"text/plain",send:function(f){var G=this._xhr,D=this.onload,o=this.onerror;this.getResponseType()?f.responseType=this.getResponseType():this.getOverrideMimeType()&&(f.overrideMimeType=this.getOverrideMimeType()),G.onload=D,G.onerror=o,M.fetch(G,f)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(Y){this._responseType=Y},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(s){this._overrideMimeType=s},getResponseText:function(){var l=this._xhr;return l.response||l.responseText}}),El.GraphView=function($){var j=this;j._24I={},j._34I=new $p,j._25I={},j._56I={},j._view=nn(1,j),j._canvas=Od(j._view),j.dm($?$:new Sn),this._coreInteractor=new tf(this),j.setEditable(!1),j.setScrollBarVisible(M.graphViewScrollBarVisible)},Kg("GraphView",C,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[bc,fq,yf,If,"resettable","editInteractor",Nj,"pannable","rectSelectable","autoScrollZone",Ug,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:M.graphViewResettable,_pannable:M.graphViewPannable,_rectSelectable:M.graphViewRectSelectable,_autoScrollZone:M.graphViewAutoScrollZone,_rectSelectBackground:M.graphViewRectSelectBackground,_rectSelectBorderColor:M.graphViewRectSelectBorderColor,_editPointSize:M.graphViewEditPointSize,_editPointBorderColor:M.graphViewEditPointBorderColor,_editPointBackground:M.graphViewEditPointBackground,_scrollBarColor:Zb,_scrollBarSize:fp,_autoHideScrollBar:Ae,_autoMakeVisible:mo,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(K){this._dataModel.setLayers(K)},setEditable:function(S){var i=this,p=i.__interactorMap__;if(!p){var H=El.XEditInteractor;p=i.__interactorMap__={scrollBar:new Nq(i),select:new Oi(i),edit:H?new H(i):new ih(i),move:new Eo(i),"default":new So(i),touch:new yb(i,{editable:!1})}}S?(i._uieditable=!0,i.setInteractors([p.scrollBar,p.select,p.edit,p.move,p.default,p.touch])):(i._uieditable=!1,i.setInteractors([p.scrollBar,p.select,p.move,p.default,p.touch]))},getCanvas:function(){return this._canvas},_33I:function(T){var V=T.getUIClass();return V?new V(this,T):Z},getDataUI:function(z){var u=this,a=u._25I[z._id];return a===K&&(a=u._33I(z),u._25I[z._id]=a),a},getNodeRect:function(D){return M.getNodeRect(this,D)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(u){var J=this.getDataUI(u);return J?(J._79o(),J._78o):null},getEdgeSourcePosition:function(F){var v=this,W=v.getDataUI(F),N=W.s,_=W._data._40I;return Bb(v,_,N("edge.source.position"),N("edge.source.offset.x"),N("edge.source.offset.y"),N("edge.source.anchor.x"),N("edge.source.anchor.y"))},getEdgeTargetPosition:function(L){var B=this,a=B.getDataUI(L),X=a.s,n=a._data._41I;return Bb(B,n,X("edge.target.position"),X("edge.target.offset.x"),X("edge.target.offset.y"),X("edge.target.anchor.x"),X("edge.target.anchor.y"))},invalidateAll:function(E){var R=this;if(E){for(var t in R._25I){var K=R._25I[t];K&&K.dispose()}R._25I={},R._56I={},R._24I={},R._34I.clear(),R.redraw()}else R.dm().each(function(d){R.invalidateData(d)})},invalidateSelection:function(){var n=this;n.sm().each(function(a){n.invalidateData(a)})},invalidateData:function(R){var f=this;f._24I[R._id]=R,f._21Q(R),f.iv()},_21Q:function(B){var p=this,Q=p._24I;if(el(B)&&uq[B.s(qq)]){var x=B.getSourceAgent();x&&x.getAgentEdges().each(function(N){Q[N._id]=N}),x=B.getTargetAgent(),x&&x.getAgentEdges().each(function(g){Q[g._id]=g}),p.iv()}},redraw:function(b){var B=this;B._32I||(b?B._34I.add(b):(B._32I=1,B._34I.clear()),B.iv())},each:function(b,i){var D,Q,E,I=0,V=this.getLayers(),Z=this._dataModel,H=Z._datas._as,C=H.length;if(V){for(var r=V.length;r>I;I++)if(E=V[I],Eq(E)&&(E=E.name),Z.isHierarchicalRendering()){var u=function(Y){return Y._layer===E?i?b.call(i,Y):b(Y):void 0};if(this._dataModel.eachByHierarchical(u)===!1)return}else for(var v=0;C>v;v++)if(D=H[v],D._layer===E&&(Q=i?b.call(i,D):b(D),Q===!1))return}else if(Z.isHierarchicalRendering())this._dataModel.eachByHierarchical(b,null,i);else for(;C>I;I++)if(D=H[I],Q=i?b.call(i,D):b(D),Q===!1)return},reverseEach:function(p,K){var J,S,A,z,N=this._dataModel,c=N._layers,i=N._datas._as,k=i.length;if(c){for(J=c.length-1;J>=0;J--)if(z=c[J],Eq(z)&&(z=z.name),N.isHierarchicalRendering()){var h=function(w){return w._layer===z?K?p.call(K,w):p(w):void 0};if(N.reverseEachByHierarchical(h)===!1)return}else for(var L=k-1;L>=0;L--)if(S=i[L],S._layer===z&&(A=K?p.call(K,S):p(S),A===!1))return}else if(N.isHierarchicalRendering())N.reverseEachByHierarchical(p,null,K);else for(J=k-1;J>=0;J--)if(S=i[J],A=K?p.call(K,S):p(S),A===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var V=this,P=V._84I;if(!P){var U=this.dm().a("width"),g=this.dm().a("height");U>0&&g>0?V._84I={x:0,y:0,width:U,height:g}:(V.each(function(L){V.isVisible(L)&&(P=Gi(P,V.getDataUIBounds(L)))}),V._84I=P?P:Xi)}return V._84I},getScrollRect:function(){return Gi(this.getContentRect(),this._29I)},makeCenter:function(t,C,O){var v=this;if(!v.getWidth()||!v.getHeight())return O||zj(v.centerData,v,[t,C,!0],500),void 0;v.makeVisible(t),v.validate();var V=v.getDataUIBounds(t);if(V){var Y=v.getWidth(),n=v.getHeight(),U=V.x+V.width/2,d=V.y+V.height/2,c=-U*v._zoom+Y/2,h=-d*v._zoom+n/2;v.setTranslate(c,h,C)}},fitData:function(b,N,D,F,u){var E=this;if(!E.getWidth()||!E.getHeight())return u||zj(E.fitData,E,[b,N,D,F,!0],500),void 0;var O=function(){E.makeVisible(b),E.validate();var p=E.getDataUIBounds(b);p&&(p=nh(p),$l(p,D==Z?20:D),E.fitRect(p,N,F))};N?M.callWhenLoaded(O):O()},fitContent:function(I,r,U,v){var _=this;if(!_.getWidth()||!_.getHeight())return v||zj(_.fitContent,_,[I,r,U,!0],500),void 0;var j=function(){_.validate();var M=nh(_.getContentRect());$l(M,r==Z?20:r),_.fitRect(M,I,U)};I?M.callWhenLoaded(j):j()},fitRect:function(e,d,_){var B=this,K=B.getWidth(),w=B.getHeight(),p=e.x+e.width/2,m=e.y+e.height/2,k=z(K/e.width,w/e.height),G=B._zoom,O=-p*G+K/2,v=-m*G+w/2;0===k||isNaN(k)||(_&&(k=z(1,k)),d?(B._65I&&(delete B._65I.finishFunc,B._65I.stop(!0)),B._14o&&B._14o.stop(!0),B.setTranslate(O,v,{finishFunc:function(){B.setZoom(k,d)}})):(B.setTranslate(O,v),B.setZoom(k)))},toCanvas:function(G,J){J=J||this._zoom,this.validateImpl();var H=this,L=H.getContentRect();L.width||(L.width=10),L.height||(L.height=10);var u=Od(),w=L.x*J,E=L.y*J,Z=L.width*J,Q=L.height*J;Aq(u,Z,Q,1);var k=Lf(u);return G=G||this._dataModel.getBackground(),G&&Rf(k,0,0,Z,Q,G),Kn(k,-w,-E),k.scale(J,J),H._42(k),k.restore(),u},toDataURL:function(J,k,x){return this.toCanvas(J,x).toDataURL(k||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(U,i){var z=this,F=this.__htmlOrderList,N=[];if(z._93db(U,i),z.each(function(E){var G=z.getDataUI(E);if(G){var y=z._56I[E._id],d=G._htmlView;if(y){var P=G._79o();if(d=G._htmlView,k.HtmlNode&&E instanceof k.HtmlNode)G._42(U);else{var X=z.getViewRect(),K=d&&d.layoutHTML;!i||xr(i,P)?(K&&(d.layoutHTML(),G.__outerLayout&&delete G.__outerLayout),G._42(U)):xr(X,P)||!K||G.__outerLayout||(d.layoutHTML(),G.__outerLayout=!0)}}d&&(N.push(d),d.getView&&(d=d.getView()),d.style.display=y?"block":Ur)}}),F&&N.length>0){var E=!1;if(F.length!==N.length)E=!0;else for(var X=0;X<N.length;X++)if(N[X]!==F[X]){E=!0;break}E&&(N.forEach(function(F){z.appendHTML(F,!0)}),this.__htmlOrderList=N)}else this.__htmlOrderList=N;z._92db(U,i)},validateImpl:function(){this.tryUpdateRootData();var C,R,f,u,B,_=this,m=_.tx(),I=_.ty(),k=_._zoom,P=_._canvas,d=this.getWidth(),Y=this.getHeight(),K=_._29I,A={x:-m/k,y:-I/k,width:d/k,height:Y/k},D={},H=_._34I,o=_._24I,V=_._32I,j=_._23I;_._24I={},(d!==P.clientWidth||Y!==P.clientHeight)&&(Aq(P,d,Y),V=1),V||ul(A,K)||(V=1),_._29I=A,_.each(function(y){R=y._id;var E=D[R]=_.isVisible(y);E!==_._56I[R]&&(o[R]=y,f=_.getDataUI(o[R]),f&&f._84o(E),_._84o(y,E))},_);for(R in o)f=_.getDataUI(o[R]),f&&(!V&&_._56I[R]&&(B=f._79o(),B&&H.add(B)),f.invalidate()),_._83I=1;if(_._56I=D,!V)for(R in o)D[R]&&(f=_.getDataUI(o[R]),f&&(B=f._79o(),B&&H.add(B)));if(V?u=A:(H.each(function(q){xr(A,q)&&(u=Gi(u,q))}),u&&($l(u,E(1,1/k)),u.x=v(u.x*k)/k,u.y=v(u.y*k)/k,u.width=r(u.width*k)/k,u.height=r(u.height*k)/k,u=Hr(A,u))),_._74O=u,u){C=Lf(P);var n=u.x,t=u.y,c=u.width,y=u.height;n=Math.floor((n*k+m)*vn),t=Math.floor((t*k+I)*vn),c=Math.ceil(c*k*vn)+1,y=Math.ceil(y*k*vn)+1,C.beginPath(),C.rect(n,t,c,y),C.clip(),C.clearRect(n,t,c,y),Nn(C,m,I,k),_._42(C,u),C.restore(),delete _._74O}if(H.clear(),delete _._32I,j&&d>0&&Y>0){var f=_.getDataUI(j);if(f){var B=f._79o(),J=_._29I,W=J.x,X=J.y,F=J.width,M=J.height,k=_._zoom;B&&!xr(B,J)&&(B.x+B.width<W&&_.tx(-B.x*k),B.x>W+F&&_.tx(-(B.x+B.width-F)*k),B.y+B.height<X&&_.ty(-B.y*k),B.y>X+M&&_.ty(-(B.y+B.height-M)*k))}delete _._23I}_._83I&&(delete _._83I,delete _._84I),_._98O(),us(_._24I)||zj(_.iv,_)},tryUpdateRootData:function(){var M,f=this.getFullscreenDatas();for(var o in f)M=f[o],this.scaleRootData(M)},scaleRootData:function(v){var d=v.s("fullscreen");if("uniform"===d||"fill"===d){v.setRotation(0);var $,z=v.s("fullscreen.gap")||0,Q=this.getWidth()-2*z,r=this.getHeight()-2*z,X=v.getAnchor(),I=v.getScaledSize(),p=I.width,A=I.height,U=v.s("fullscreen.lock");if(U)return"uniform"===d?Q/r>p/A?($=r/A,p=A*Q/r):($=Q/p,A=p*r/Q):"v"===U?($=r/A,p=Q/$,v.setWidth(p)):($=Q/p,A=r/$,v.setHeight(A)),this.setZoom($),this.tx(z-(v.getX()-X.x*p)*$),this.ty(z-(v.getY()-X.y*A)*$),void 0;var N=this.tx(),o=this.ty();$=this._zoom;var j={x:(-N+z)/$,y:(-o+z)/$,width:Q/$,height:r/$};if("uniform"===d){var u=p/A,M=Math.min(j.width,j.height*u),m=M/u;j.x+=.5*(j.width-M),j.y+=.5*(j.height-m),j.width=M,j.height=m}v.setSize(j.width/v.getScaleX(),j.height/v.getScaleY()),v.setPosition(j.x+X.x*j.width,j.y+X.y*j.height)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(T){var u=this;T!==u.isScrollBarVisible()&&(T?(Xh(u._view,u._79O=Ti()),Xh(u._79O,u._27I=Ti()),Xh(u._79O,u._28I=Ti())):(Xq(u._79O),delete u._79O,delete u._27I,delete u._28I),u.fp("scrollBarVisible",!T,T))},showScrollBar:function(){var I=this;I._79O&&(I._85I||(H(function(){I._86I()},ds),I.iv()),I._85I=new Date)},_86I:function(){var w=this;if(w._85I){var i=new Date,m=i.getTime();m-w._85I.getTime()>=ds?(delete w._85I,w.iv()):H(function(){w._86I()},ds)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var q=this,O=this._27I,e=this._28I;if(q._79O){if(q._autoHideScrollBar&&!q._85I)return O.style.visibility=Xr,e.style.visibility=Xr,void 0;var j=q.getScrollBarColor(),f=q._zoom,Y=q.getScrollBarSize(),x=q.getViewRect(),G=q.getScrollRect(),N=x.height*f,X=G.height*f,s=x.width*f-Y-2,p=N*((x.y-G.y)*f/X),L=N*(N/X),V=O.style;X-.5>N?(Nk>L&&(p=p+L/2-Nk/2,0>p&&(p=0),p+Nk>N&&(p=N-Nk),L=Nk),ef(O,s,p,Y,L),V.visibility=Tr,V.background=j,V.borderRadius=Y/2+rm):V.visibility=Xr;var y=x.width*f,D=G.width*f,p=x.height*f-Y-2,s=y*((x.x-G.x)*f/D),C=y*(y/D),V=e.style;D-.5>y?(Nk>C&&(s=s+C/2-Nk/2,0>s&&(s=0),s+Nk>y&&(s=y-Nk),C=Nk),ef(e,s,p,C,Y),V.visibility=Tr,V.background=j,V.borderRadius=Y/2+rm):V.visibility=Xr}},setDataModel:function(S){var V=this,R=V._dataModel,u=V._selectionModel;R!==S&&(R&&(R.ump(V.handleDataModelPropertyChange,V),R.umm(V.handleDataModelChange,V),R.umd(V.handleDataPropertyChange,V),R.removeIndexChangeListener(V._75O,V),R.removeHierarchyChangeListener(V.handleHierarchyChange,V),u||R.sm().ums(V.handleSelectionChange,V)),V._dataModel=S,S.mp(V.handleDataModelPropertyChange,V),S.mm(V.handleDataModelChange,V),S.md(V.handleDataPropertyChange,V),S.addIndexChangeListener(V._75O,V),S.addHierarchyChangeListener(V.handleHierarchyChange,V),u?u._21I(S):S.sm().ms(V.handleSelectionChange,V),V.invalidateAll(!0),V.fp(Xd,R,S),V._canvas.style.background=S.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===K){var g=this.getLayers();g?(this._layersInfo={},g.forEach(function(i){var e=Eq(i)?i.name:i;this._layersInfo[e]=i},this)):this._layersInfo=null}return this._layersInfo},calculateAttachPoint:function(){var L=new Rj,U=new Rj,m=new Rj;return function(r,D){var p=this.getAttachPoints(r);if(!p||!p.length)return null;m.set(D.x,D.y);for(var i,F,H,w,I=1/0,J=0,y=p.length;y>J;J++)H=p[J],U.x=H.x,U.y=H.y,L.x=H.offsetX||0,L.y=H.offsetY||0,w=Bb(this,r,0,L.x,L.y,U.x,U.y),F=m.distanceToSquared(w),I>F&&(i=J,I=F);I=Math.sqrt(I);var g=this.getAttachStyle(r);if("close"===g){var f=r.s("attach.close.threshold")/this._zoom;if(I>f)return null}return{index:i,distance:I,info:p[i]}}}(),getAttachPoints:function(M){var v=M.s("attach.points");if(v)return v;var Q=Mk(M._image);return Q?Vc(Q.attachPoints,M,this)||null:void 0},getAttachStyle:function(G){var h=G.s("attach.style");if(h)return h;var r=Mk(G._image);return r?Vc(r.attachStyle,G,this)||"close":void 0},updateLayers:function(){this._layersInfo=K,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(c){if("background"===c.property){var L=this._canvas.style.background,o=c.newValue||"";this._canvas.style.background=o,this.fp("canvasBackground",L,o)}else"a:width"===c.property||"a:height"===c.property?(this._83I=1,this.redraw()):"layers"===c.property?this.updateLayers():"hierarchicalRendering"===c.property&&this.redraw()},handleDataPropertyChange:function(x){this.dm().isHierarchicalRendering()&&"parent"===x.property&&x.data.hasChildren()&&this.redraw(),this.invalidateData(x.data)},onPropertyChanged:function(o){var i=this,d=o.property;if(i.redraw(),"zoom"===d){var S=i.sm().getSelection();S.size()&&S.each(function(W){W.invalidate()})}Ie[d]?i.showScrollBar():d===Nj&&i.onCurrentSubGraphChanged(o)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(S){var T=this,I=S.kind,F=S.data;if(T._83I=1,"add"===I)T.invalidateData(F),el(F)&&F.getEdgeGroup()&&F.getEdgeGroup().eachSiblingEdge(T.invalidateData,T);else if(I===tr){T._21Q(F);var D=F._id,q=T._25I[D];if(q){if(T._56I[D]){var W=q._79o();W&&T.redraw(W)}q.dispose(),delete T._25I[D],delete T._24I[D],delete T._56I[D]}F===T._currentSubGraph&&T.setCurrentSubGraph(Z)}else I===Dk&&(T.invalidateAll(!0),T.setCurrentSubGraph(Z))},_75O:function(s){this.invalidateData(s.data)},handleHierarchyChange:function(Q){this.dm().isHierarchicalRendering()&&Q.data.hasChildren()&&this.redraw(),this.invalidateData(Q.data)},adjustIndex:function(E){var u=this;if(u.isVisible(E)){u.dm().beginTransaction();for(var e=E;e._parent&&u.isVisible(e._parent);)e=e._parent;e&&e!==E&&u._dataModel.adjustIndex(e),u._dataModel.adjustIndex(E),u.dm().endTransaction()}},getImage:function(f){return f.getImage?f.getImage():K},getSelectWidth:function(u){var N=Mk(this.getImage(u));return N&&Vc(N.disableSelectedBorder,u,this)?0:u.s("select.width")},getSelectColor:function(R){return R.s("select.color")},isSelectable:function(T,w){if(this.isSelected(T))return!0;if(!w&&T.getParent()instanceof Gl&&this.isSelectable(T.getParent(),!0)&&T.getParent().isSyncSize())return!1;var t=this.getLayersInfo();if(t){var z=t[T._layer];if(z&&z.selectable===!1)return!1}return T.s("2d.selectable")&&this.sm().isSelectable(T)},isMovable:function(N){var b=this;if(el(N)&&N.getStyle(qq)!==li)return!1;var w=this.getLayersInfo();if(w){var C=w[N._layer];if(C&&C.movable===!1)return!1}return N.s("2d.movable")?b._movableFunc?b._movableFunc(N):!0:!1},isEditable:function(B){var W=this;if(k._uiSerializing)return W._uieditable;if(!W._editInteractor||!W.isSelected(B))return!1;if(Em(B)){var z=W.getDataUI(B);if(!z||z._88I)return!1}if(el(B)&&B.getStyle(qq)!==li)return!1;var q=this.getLayersInfo();if(q){var j=q[B._layer];if(j&&j.editable===!1)return!1}return B.s("2d.editable")?W._editableFunc?W._editableFunc(B):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(p){return vs(p)&&0!==p.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(p):!0},isRectEditable:function(K){return this._rectEditableFunc?this._rectEditableFunc(K):!0},isAnchorEditable:function(G){return this._anchorEditableFunc?this._anchorEditableFunc(G):!0},isRotationEditable:function(Y){return Y.setRotation&&Y.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(Y):!0:!1},getRotationPoint:function(P){var Y=P.getAnchor(),T=P.getScale(),e=this._zoom,a=kd(P.getRotation(),0,-P.getHeight()*T.y*Y.y-(T.y<0?-1:1)*(Jq?32:16)/e),x=P.p();return a.x+=x.x,a.y+=x.y,a},getLogicalPoint:function(I){var Z=this;return il(I,Z._canvas,Z.tx(),Z.ty(),Z._zoom,Z._zoom)},getScreenPoint:function(O,v){var N,k=this;return"object"==typeof O?O.x!==K?(N=O.x,v=O.y):(N=O[0],v=O[1]):N=O,zk(N,v,k._canvas,k.tx(),k.ty(),k._zoom,k._zoom)},getSelectedDataAt:function(S){var i=this;return this.getDataAt(S,function(j){return i.isSelected(j)})},getDataInfoAt:function(f,Y,y){var V,N=this.lp(f),U=this.getDataAt(N,Y,y);if(U){var x=this.getDataUI(U);V={data:U,ui:x,point:N};var o=x._38o;if(o){var q=o.icons;for(var e in q){var w=q[e],C=o.rects[e];if(C)for(var X=Vc(w.names,U,this),L=X?X.length:0,H=C.rotation,h=L-1;h>=0;h--){var t=X[h],m=C[h];if(Um(m,N,H))return V.part="icons",V.name=e,V.icon=t,V.rect=m,V.index=h,V.rotation=H,V}}}if(this.isNoteVisible(U)){if(x.note2Info&&Um(x.note2Info.clickRect,N,Z,x.note2Info.scale))return V.part="note2",V;if(x.noteInfo&&Um(x.noteInfo.clickRect,N,Z,x.noteInfo.scale))return V.part="note",V}if(this.isLabelVisible(U)){if(x.label2Info&&Um(x.label2Info.rect,N,x.label2Info.rotation,x.label2Info.scale))return V.part="label2",V;if(x.labelInfo&&Um(x.labelInfo.rect,N,x.labelInfo.rotation,x.labelInfo.scale))return V.part="label",V}if(U.isInRect&&U.isInRect(N))return V.part="body",V}return V},getDataAt:function(n,d,j){n.target&&(n=this.lp(n));var r,T=this._zoom;return this.reverseEach(function(z){return(d?d(z):this.isSelectable(z))&&this.rectIntersects(z,ml(n.x,n.y,j,T))?(r=z,!1):void 0},this),r},getIconInfoAt:function(r,b){var T=this;if(r.target&&(r=T.lp(r)),b||(b=T.getDataAt(r)),b){var B=T.getDataUI(b);if(B&&B._38o){var m,k=B._38o,c=new $p;for(m in k.icons)c.add(m);for(var g=c.size()-1;g>=0;g--){m=c.get(g);for(var i=k.rects[m],I=i.rotation,v=i.length-1;v>=0;v--){var L=i[v],a=L.width,Q=L.height,P={x:r.x-L.x-a/2,y:r.y-L.y-Q/2};I!=Z&&(P=kd(-I,P.x,P.y));var L={x:-a/2,y:-Q/2,width:a,height:Q};if(Um(L,P))return{key:m,index:v,name:k.icons[m].names[v],rect:i[v],point:r,rotation:I,relativeRect:L,relativePoint:P,data:b}}}}}return Z},getDatasInRect:function(x,Y,_){_===K&&(_=1);var q=this,T=new $p;return q.reverseEach(function(n){_&&!q.isSelectable(n)||(Y?q.rectIntersects(n,x):q.rectContains(n,x))&&T.add(n)}),T},moveSelection:function(W,T){var t=this;t.dm().beginTransaction(),$e(t.sm().toSelection(t.isMovable,t),W,T),t.dm().endTransaction()},moveDatas:function($,c,H){var F=this;F.dm().beginTransaction(),$ instanceof $p||($=new $p($)),$e($,c,H),F.dm().endTransaction()},getDataUIBounds:function(g){var T=this.getDataUI(g);return T?T._79o():Z},drawData:function(G,X,e){var q=this.getDataUI(X);if(q){var Q=q._79o();(!e||xr(e,Q))&&(q._42(G),X instanceof k.Block&&X.eachChild(function(p){this.drawData(G,p,e)},this))}},getBoundsForGroup:function(f){return f.s(hh)?this.getDataUIBounds(f):Z},isPixelPerfect:function(V){return V.s("pixelPerfect")},rectIntersects:function(E,I){this.validate();var i=Z;if(this._56I[E._id]){var C=this._25I[E._id];if(C){var c=C._79o();if(ne(I,c))i=!0;else if((I=Hr(I,c))&&(C.rectIntersects&&(i=C.rectIntersects(I)),i==Z)){if(!this.isPixelPerfect(E))return!0;var q=I.x,r=I.y,L=I.width,z=I.height,f=this._zoom,v=M.hitMaxArea,_=L*z*f*f;if(_>v){var j=Math.sqrt(v/_);f*=j}L*=f,z*=f,2>L&&(L=2),2>z&&(z=2),q*=f,r*=f;var w=Zj(L,z);Kn(w,-q,-r),w.scale(f,f),this._drawForChecking=!0,this.drawData(w,E,I),this._drawForChecking=!1;try{for(var h=0,K=w.getImageData(0,0,L,z).data;h<K.length;h+=4)if(0!==K[h+3]){i=!0;break}w.restore()}catch(g){Yp=Z,i=!1}}}}return i?!0:!1},rectContains:function(v,S){if(this._56I[v._id]){var R=this._25I[v._id];if(R)return ne(S,R._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(b){if(!M.isInput(b.target)){var z=this,X=z._focusData,f=X&&z._25I[X._id],Q=0,h=z._dataModel._datas;if(!(X&&X._enabled&&X._editable&&f&&f.onKeyDown&&f.onKeyDown(b)===!0))if(9===b.keyCode&&(X&&(Q=h.indexOf(X),Cd(b)?-1===--Q&&(Q=0):++Q===h.size()&&(Q=0)),z._focusData=X=h.get(Q),z.sm().setSelection(X)),hj(b)?z.selectAll():_f(b)&&z.isResettable()&&z.reset(),z.sm().isEmpty()){if(z._editing)return;var w=z.tx(),R=z.ty(),g=!1,y=Cd()?100:10;Th(b)&&(w-=y,g=!0),Sc(b)&&(R-=y,g=!0),Xf(b)&&(w+=y,g=!0),cc(b)&&(R+=y,g=!0),g&&z.setTranslate(w,R)}else{bm(b)&&z.handleDelete(b);var P=Cd()?10:1;Th(b)&&(z.moveSelection(-P,0),z.fi({kind:"moveLeft"})),Sc(b)&&(z.moveSelection(0,-P),z.fi({kind:"moveUp"})),Xf(b)&&(z.moveSelection(P,0),z.fi({kind:"moveRight"})),cc(b)&&(z.moveSelection(0,P),z.fi({kind:"moveDown"}))}}},handleScroll:function(l,K){if(xf(l),!this.getEditInteractor()){var J=this.getDataAt(l);if(J){var G=Mk(this.getImage(J));if(G&&Vc(G.scrollable,J,this))return}}var z=this.lp(l);K>0?this.scrollZoomIn(z):0>K&&this.scrollZoomOut(z)},handlePinch:function(f,l,d){this._68I||(l>d?this.pinchZoomIn(f):this.pinchZoomOut(f))},checkDoubleClickOnNote:function(K,I){var A=this,B=A.lp(K),a=A.getDataUI(I),G=a.note2Info;return G&&I.s("note2.toggleable")&&Um(G.clickRect,B)?(I.s(Ki,!I.s(Ki)),A.fi({kind:"toggleNote2",event:K,data:I}),!0):(G=a.noteInfo,G&&I.s("note.toggleable")&&Um(G.clickRect,B)?(I.s(tq,!I.s(tq)),A.fi({kind:"toggleNote",event:K,data:I}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(T,B){var w=this,p=w.getAutoScrollZone(),r=p/w.getZoom(),W=p/4,K=w._29I,H=w.lp(T),z={x:w.tx(),y:w.ty()};return H&&p>0&&K&&(H.x-K.x<r?w.translate(W,0):K.x+K.width-H.x<r&&w.translate(-W,0),H.y-K.y<r?w.translate(0,W):K.y+K.height-H.y<r&&w.translate(0,-W)),z.x=w.tx()-z.x,z.y=w.ty()-z.y,B&&(B.x+=z.x,B.y+=z.y),z},getMoveMode:function(A,f){var $=f.s("2d.move.mode");return $?$:te["88"]?"x":te["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(I,c,t){var J=this;return"currentSubGraph"===c?{__i:I.getId()}:t.serializeProperty(I,c,J)},deserializeProperty:function(N,F,q){var H=this;if("currentSubGraph"===F){var G=H.dm(),Z=G.__idMap;return Z[N.__i]}return q.deserializeProperty(N,F,H)},setDefaultCursor:function(n,k){this._defaultCursor=n,k!==!1&&this.setCursor(n)},setCursor:function(W){"default"===W&&(W=this._defaultCursor||W);var g=this.getView().style;g.cursor=W,g.cursor="-webkit-"+W,g.cursor="-moz-"+W},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(E){return E===Z||M.getConnectAction(null,E)?(this._currentActionType=E,this.redraw(),!0):!1},isConnectActionVisible:function(I){var p=M.getConnectAction(this);if(!p)return!1;var $=p.visible;return Ck($)&&($=$(this,I)),$},isInteractive:function(H){var e=Mk(this.getImage(H));return e&&Vc(e.interactive,H,this)?!0:H.s("interactive")},appendHTML:function(R,g){var w=this.getView();if(!(g||R&&R.parentNode!==w))return!1;var J=R.getView&&R.getView();return!g&&J&&J.parentNode===w?!1:R.isSelfViewEvent?(R.addToDOM(w),!0):(R.getView&&(R=R.getView()),this.isScrollBarVisible()?w.insertBefore(R,this.getView().lastChild):Xh(w,R),!0)},layoutHTML:function(t,C,A){var Z,p=this,j=p._zoom;if(C.getView&&(Z=C,C=C.getView()),C.style.position="absolute",A){var E=t.getRect();ef(Z||C,p.tx()+E.x*j,p.ty()+E.y*j,E.width*j,E.height*j)}else{var z=new yp,E=t.getAnchorRect(),I=t.getPosition(),K=t.getScale(),O=C.style;ef(Z||C,E),z.appendTranslate(p.tx(),p.ty()),z.appendScale(j,j),z.append(new yp(t.getRotation(),I.x,I.y,K.x,K.y)),Ud(O,"transform","matrix("+z.a.toFixed(5)+", "+z.b.toFixed(5)+", "+z.c.toFixed(5)+",\n    "+z.d.toFixed(5)+", "+z.tx.toFixed(5)+", "+z.ty.toFixed(5)+")"),Ud(O,"transformOrigin",(-E.x).toFixed(5)+"px "+(-E.y).toFixed(5)+"px"),C.maxtrixAppend=z.invert().translate(-E.x,-E.y)}}});var Ob=function(c,L){var T=this;T.gv=c,T.s=function(u){return L.getStyle(u)},T._data=L,T._87I=new $p};_p(Ob,C,{_6I:Z,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var o=this,M=o.gv.isSelected(o._data);return!M||o.isShadowed()?0:o.gv.getSelectWidth(o._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(J){var g=this._data,d=this.gv.getBodyColor(g);return d?d:J?g.getStyle(J):Z},_2Q:function(S){return this.s(S)},_1Q:function(Z,D,L,J){var V=this.s,R=V("2d.gray"),s=V(D+".dash.color");if(R&&(s=M.toGrayColor(s)),Z.strokeStyle=s,Z.lineWidth=L,Z.stroke(),V(D+".dash.3d")){var b=V(D+".dash.3d.color");gj(Z,s,R?M.toGrayColor(b):b,L,this.gv._zoom,V(D+".dash.3d.accuracy"))}eh(Z,J)},invalidate:function(){this._6I=Z},_79o:function(){var l=this;if(!l._6I){var K=l._data,N=l.gv;l.labelInfo=l.label2Info=l.noteInfo=l.note2Info=l._38o=Z,l._87I.clear(),l.interactiveInfo=N.isInteractive(K)?{}:Z,l._3O(),l._55O=N.isEditable(K)?{_42O:N.isRectEditable(K),_43O:N.isPointEditable(K),_56O:N.isRotationEditable(K)}:Z,l._6I=l._81o()}return l._6I},_3O:function(){},getPosition:function(){return Xi},_68o:function(D,x){D&&this._87I.add(wi(D,x))},_81o:function(){var K=this,x=K.s;K._24O(Fe,"getLabel"),K._24O(Zh,"getLabel2"),K._26O(xk,"getNote"),K._26O(Hq,"getNote2"),K._15O(),K._55O&&K._48O();var o;if(K._87I.each(function(X){o=Gi(o,X)}),o&&K.isShadowed()){var V=nh(o);V.x+=x("shadow.offset.x"),V.y+=x("shadow.offset.y"),$l(V,x("shadow.blur")),o=Gi(o,V)}return K._87I.clear(),o},_42:function(I){var r=this,T=r._data,P=r.gv,R=r.s,m=R("opacity"),g=this.isShadowed();if(g){var _=I.shadowOffsetX,v=I.shadowOffsetY,d=I.shadowBlur,f=I.shadowColor,A=P.getZoom();I.shadowOffsetX=R("shadow.offset.x")*A,I.shadowOffsetY=R("shadow.offset.y")*A,I.shadowBlur=R("shadow.blur")*A,I.shadowColor=r.getSelectColor()}if(m!=Z){var X=I.globalAlpha;I.globalAlpha=m}r._80o(I),P.isLabelVisible(T)&&((!P._drawForChecking||R("label.selectable"))&&xp(I,r.labelInfo),(!P._drawForChecking||R("label2.selectable"))&&xp(I,r.label2Info)),P.isNoteVisible(T)&&(Jf(I,r.noteInfo),Jf(I,r.note2Info)),r._99O(I),m!=Z&&(I.globalAlpha=X),g&&(I.shadowOffsetX=_,I.shadowOffsetY=v,I.shadowBlur=d,I.shadowColor=f)},_80o:function(){},_47O:function(){},_24O:function(d,Y){var f=this,u=f._data,C=f.gv,I=f.s,H=C[Y](u);if(H!=Z){var k=I(d+".scale"),R=I(d+".max"),l=I(d+".position"),K=f[d+"Info"]={label:H,scale:k,color:C[Y+"Color"](u),font:I(d+".font"),opacity:I(d+".opacity"),align:I(d+".align"),rotation:f.getRotation(I(d+".rotation"),!1,l),background:C[Y+"Background"](u)},F=Vo(K,H);R>0&&R<F.width&&(K.labelWidth=F.width,F.width=R),1!==k&&(F.width*=k,F.height*=k);var X=f.getPosition(l,I(d+".offset.x"),I(d+".offset.y"),F,I(d+".position.fixed"));if(F.x=X.x-F.width/2,F.y=X.y-F.height/2,f._68o(K.rect=F,K.rotation),1!==k){var q=F.width/k,c=F.height/k;K.rect={x:X.x-q/2,y:X.y-c/2,width:q,height:c}}}},_26O:function(w,L){var f=this,P=f.gv,i=f._data,m=f.s,$=P[L](i);if($!=Z){var X,x,k=m(w+".scale"),C=f[w+"Info"]={note:$,scale:k,data:i,view:P,expanded:m(w+".expanded"),font:m(w+".font"),color:m(w+".color"),opacity:m(w+".opacity"),align:m(w+".align"),icon:m(w+".icon"),backgroundImage:m(w+".backgroundImage"),borderWidth:m(w+".border.width"),borderColor:m(w+".border.color"),background:P[L+"Background"](i)},s=f.getPosition(m(w+".position"),m(w+".offset.x"),m(w+".offset.y")),q=s.x,p=s.y;if(C.expanded){var u,e=m(w+".max"),d=m(w+".backgroundImage");d?(d=Mk(d),u={width:pr(d,i),height:Ne(d,i)}):u=Vo(C,$),u.width+=6,u.height+=2,e>0&&e<u.width&&(C.labelWidth=u.width,u.width=e),X=u.width,x=u.height+8,C.clickRect={x:q-X*k/2,y:p-x*k,width:X*k,height:x*k*u.height/x}}else{var T=m(w+".icon");T?(T=Mk(T),X=pr(T,i),x=Ne(T,i)):(X=12,x=18),C.clickRect={x:q-X*k/2,y:p-x*k,width:X*k,height:x*k}}C.rect={x:q-X/2,y:p-x*k/2-x/2,width:X,height:x};var v=r(C.borderWidth/2)*k;f._68o({x:q-X*k/2-v,y:p-x*k-v,width:X*k+2*v,height:x*k+2*v})}},_48O:function(){},_99O:function(J){var h=this,Y=h._38o;if(Y){var E=h.gv,b=h._data,R=Y.icons,s=h.interactiveInfo;s&&(s._38o={});for(var C in R){var x=R[C],_=Y.rects[C];if(_){s&&(s._38o[C]=[]);var W=Vc(x.opacity,b,E),X=Vc(x.names,b,E),k=X?X.length:0,D=_.rotation;if(W!=Z){var e=J.globalAlpha;J.globalAlpha*=W}for(var I=0;k>I;I++){var O=X[I],A=Mk(O),f=_[I];if(D){var n=f.x+f.width/2,B=f.y+f.height/2;J.save(),Kn(J,n,B),Tc(J,D),Kn(J,-n,-B)}s&&s._38o[C].push(J.interactiveInfo={compInfos:[],matrix:D?new yp(D,n,B).appendTranslate(-n,-B):new yp}),Ri(J,A,Vc(x.stretch,b,E),f.x,f.y,f.width,f.height,h._data,h.gv),J.interactiveInfo=Z,D&&J.restore()}W!=Z&&(J.globalAlpha=e)}}}}});var Me=function(C,o){up(Me,this,[C,o])};_p(Me,Ob,{_checkEmptyRect:!0,_40O:function(Z,c){var W=this,R=W.s,y=Z.rect;(Z.borderColor=W.gv.getBorderColor(W._data))&&(Z.borderType=R("border.type"),Z.borderWidth=R("border.width"),Z.borderPadding=R("border.padding"),c=E(c,Z.borderPadding+Z.borderWidth/2));var F=W._data.getScale(),b=E(1,E(s(F.x),s(F.y)));if(Z.selectWidth=W.getSelectWidth()){var a=W.gv._zoom;Z.selectType=R("select.type"),Z._97o=W.getSelectColor(),Z.selectPadding=R("select.padding"),c=E(c,(Z.selectPadding+Z.selectWidth/2/a)/b)}c>0&&(c*=b,y=nh(y),$l(y,c)),W._68o(y)},_39O:function(N,v){var P,e=this,p=v.rect;if(v.borderWidth>0&&(P=v.borderPadding,N.strokeStyle=v.borderColor,N.lineWidth=v.borderWidth,ch(N,v.borderType,{x:p.x-P,y:p.y-P,width:p.width+2*P,height:p.height+2*P}),N.stroke()),v.selectWidth>0){var E=e.gv._zoom;
if(P=v.selectPadding,N.strokeStyle=v._97o,N.lineWidth=v.selectWidth/E,v.rotation!=Z){N.save(),N.translate(v.position.x,v.position.y),N.rotate(v.rotation);var F=e._data,a=F.getWidth(),g=F.getHeight(),$=v.scale,S=v.anchor;p={x:$.x*-a*S.x,y:$.y*-g*S.y,width:$.x*a,height:$.y*g}}ch(N,v.selectType,{x:p.x-P,y:p.y-P,width:p.width+2*P,height:p.height+2*P}),v.rotation!=Z&&N.restore(),N.stroke()}},dispose:function(){var f=this,U=f._htmlView;Me.superClass._3O.call(f),U&&(U.onHTMLRemoved&&U.onHTMLRemoved(),Xq(U))},_3O:function(){var R=this,Y=R.s,n=R._data,G=R.gv,z=n.getStyle(Bd),b=R.getBodyColor(),N=R._83o=z?{shape:z,_53o:R.getBodyColor("shape.background"),_27Q:Mk(Y("shape.repeat.image"),b),shapeGradientPack:Y("shape.gradient.pack"),_54o:Y("shape.border.width"),_55o:Y("shape.border.color"),_56o:Y("shape.border.3d"),_57o:Y("shape.border.3d.color"),_58o:Y("shape.border.3d.accuracy"),shapeGradient:Y("shape.gradient"),_59o:Y("shape.gradient.color"),_60o:Y("shape.border.pattern"),_61o:Y("shape.border.cap"),_62o:Y("shape.border.join"),shapeForeground:Y("shape.foreground"),bodyColor:b,gray:Y("2d.gray")}:{img:Mk(G.getImage(n),b),bodyColor:b,gray:Y("2d.gray"),stretch:Y("image.stretch")};if(e&&!U);else{var $,H=N.img;H&&H.renderHTML?(R._htmlInfo&&R._htmlInfo.img!==H&&(R._htmlInfo=Z),R._htmlInfo||(R._htmlInfo={img:H,cache:{}}),$=H.renderHTML(n,G,R._htmlInfo.cache)):R._htmlInfo=Z,R._htmlView&&R._htmlView!==$&&(R._htmlView.onHTMLRemoved&&R._htmlView.onHTMLRemoved(),Xq(R._htmlView.getView?R._htmlView.getView():R._htmlView)),(R._htmlView=$)&&G.appendHTML($)&&$.onHTMLAdded&&$.onHTMLAdded(),N.rect=n.getRect(),N.position=n.p(),N.scale=n.getScale(),N.anchor=n.getAnchor(),N.rotation=n.getRotation(),z===Kb&&(N._63o=Y("shape.depth"));var j=0;if(z)j=_q(Z,N._54o/2,N._62o),R.s("shape.dash")&&(j=E(j,(R.s("shape.dash.width")||N._54o)/2));else if(H&&H.boundExtend)if(j=Vc(H.boundExtend,n,G),H.boundExtendAbsolute){var d=n.getScale();j/=G._zoom*E(1,E(s(d.x),s(d.y)))}else if(!Vc(H.fitSize,n,G)){var V=Vc(H.width,n,G),L=Vc(H.height,n,G);j*=E(n.getWidth()/V,n.getHeight()/L)}R._40O(N,j);var p=Y("clip.percentage");if(1>p&&(0>p&&(p=0),N.clipRect=lj(n.getAnchorRect(),Y("clip.direction"),p)),z){var I=Y("shape.fill.clip.percentage");1>I&&(0>I&&(I=0),N.shapeClipRect=lj(n.getAnchorRect(),Y("shape.fill.clip.direction"),I));var o=Y("shape.foreground.clip.percentage");1>o&&(0>o&&(o=0),N.shapeForegroundClipRect=lj(n.getAnchorRect(),Y("shape.foreground.clip.direction"),o))}}},getPosition:function(P,U,L,X){var M=vk(P,this._83o.rect,X);return M.x+=U,M.y+=L,M},_80o:function(p){var m=this,r=m.s,z=m.gv,f=m._data,W=m._83o,S=W.rect,a=W.position,D=W.rotation,o=W.anchor,g=W.scale,O=W.shape,Q=W.clipRect;if(!m._checkEmptyRect||S.width>0&&S.height>0){var $=f.getSize();if($.x=-$.width*o.x,$.y=-$.height*o.y,p.save(),Kn(p,a.x,a.y),Tc(p,D),Zf(p,g.x,g.y),Q&&(p.beginPath(),p.rect(Q.x,Q.y,Q.width,Q.height),p.clip()),z._drawForChecking&&W.img&&Vc(W.img.pixelPerfect,f,z)===!1)Rf(p,$.x,$.y,$.width,$.height,"#888888");else if(m.freeDraw)m.freeDraw(p,$,W);else if(O){var A,v,H,n,R=W._60o,j=Wi(p,R),F=W._27Q,Y=W._54o,K=W.shapeGradientPack,s=W.gray,y=p.lineJoin,P=p.lineCap,t=function(u){return s?M.toGrayColor(u):u};"roundRect"===O?A=r("shape.corner.radius"):"polygon"===O?A=r("shape.polygon.side"):"arc"===O&&(A=r("shape.arc.from"),v=r("shape.arc.to"),H=r("shape.arc.close"),n=r("shape.arc.oval")),p.lineJoin=W._62o,p.lineCap=W._61o;var i=t(W._53o);if(i||F||K){var u=W.shapeClipRect;u&&(p.save(),p.beginPath(),p.rect(u.x,u.y,u.width,u.height),p.clip()),ch(p,O,$,A,v,H,n),K?Df(p,K):F?eb(p,F,t(W.bodyColor),null,f,z):nc(p,i,W.shapeGradient,t(W._59o),$),p.fill(),u&&p.restore(),K&&p.restore(),p!==j&&ch(j,O,$,A,v,H,n)}else ch(j,O,$,A,v,H,n);var N=W.shapeForeground;if(N){p.save();var V=W.shapeForegroundClipRect;V&&(p.beginPath(),p.rect(V.x,V.y,V.width,V.height),p.clip()),ch(p,O,$,A,v,H,n),nc(p,N,r("shape.foreground.gradient"),t(r("shape.foreground.gradient.color")),$),p.fill(),p.restore()}if(Y>0){var C=r("shape.border.width.absolute");C&&(p.save(),p.setTransform(1,0,0,1,0,0)),p.lineWidth=Y;var T=t(W._55o);p.strokeStyle=T,p.stroke(),C&&p.restore(),W._56o&&gj(p,T,t(W._57o),Y,z._zoom,W._58o)}if(eh(p,R),r("shape.dash")){var B=r("shape.dash.width")||Y;if(B>0){R=r("shape.dash.pattern");var j=Wi(p,R,m._2Q("shape.dash.offset"));j!==p&&ch(j,O,$,A,v,H,n),m._1Q(p,"shape",B,R)}}Mr(p,i,W._63o,$),p.lineJoin=y,p.lineCap=P}else{var X=m.interactiveInfo;X&&(p.interactiveInfo=X.bodyInfo={compInfos:[],matrix:new yp(D,a.x,a.y,g.x,g.y)}),W.gray&&(p.compGray=!0),Ri(p,W.img,W.stretch,$.x,$.y,$.width,$.height,f,z,W.bodyColor),p.compGray=!1,p.interactiveInfo=Z}p.restore()}m._39O(p,W)},_48O:function(){},_47O:function(){}});var xj=function(D,H){up(xj,this,[D,H])},id=function(U,a,y,w){var l=Qn(U,a);return y=w?z(y,l):se(y,l),l?y/=l:y=0,{x:U.x+(a.x-U.x)*y,y:U.y+(a.y-U.y)*y}};_p(xj,Ob,{_3O:function(){var e,T=this,G=T._data,x=T.gv,s=T.s,L=s(qq),U=G.isLooped(),z=s("edge.width"),$=s("edge.center"),w=s("edge.offset"),m=x.getBorderColor(G),b=m?s("border.width"):0,V=T.getSelectWidth(),d=G._40I,I=G._41I,v=T._78o=d&&I?{looped:U,type:L,width:z,center:$,color:T.getBodyColor("edge.color"),borderColor:m,borderWidth:b,_97o:V?T.getSelectColor():Z,selectWidth:V,pattern:s("edge.pattern"),cap:s("edge.cap"),join:s("edge.join"),is3d:s("edge.3d"),_67o:s("edge.3d.color"),_66o:s("edge.3d.accuracy"),gray:s("2d.gray")}:Z;if(v){var i=M.getEdgeType(L);if(i){var C=i(G,Bs(T,x,G,U,L),x,T._19Q);C.points&&C.points.size()>1?(v.edgeTypeInfo=C,e=Fp(v.edgeTypeInfo.points)):C[cl]&&C.rect&&(v.edgeTypeInfo=C,e=C.rect)}else{var N=s("edge.source.anchor.x"),Q=s("edge.source.anchor.y"),P=s("edge.target.anchor.x"),O=s("edge.target.anchor.y"),H=Bb(x,d,s("edge.source.position"),s("edge.source.offset.x"),s("edge.source.offset.y"),N,Q),F=Bb(x,I,s("edge.target.position"),s("edge.target.offset.x"),s("edge.target.offset.y"),P,O);if(L===li){var p=v.points=s(wp)||kh,a=p.size();v.segments=s("edge.segments");var h=N!==K||Q!==K,l=P!==K||O!==K;if(!$)if(w)h||(H=id(H,a?p.get(0):F,w,a)),l||(F=id(F,a?p.get(a-1):H,w,a));else{var J;h||(J=Xm(H,a?p.get(0):F,vm(x,d)),J&&(H={x:J[0],y:J[1]})),l||(J=Xm(a?p.get(a-1):H,F,vm(x,I)),J&&(F={x:J[0],y:J[1]}))}e=Gi(Fp(v.points),Fp(H,F))}else{var q=Bs(T,x,G,U,L);if(T._19Q||(q=-q),U)H=nh(H),H.x=x.getNodeRect(d).x,v.radius=q,e={x:H.x-q,y:H.y-q,width:2*q,height:2*q};else{var n=Qn(H,F),o=se(w,n),R={x:o,y:q},r={x:n-o,y:q},D=g(F.y-H.y,F.x-H.x),X=v.mat=new mk(D);if(v.orienAngle=D,v.angle=F.x<H.x?D+B:D,v.rect={x:R.x,y:R.y,width:r.x-R.x,height:0},v.origin=H,R=X.tf(R),R.x+=H.x,R.y+=H.y,r=X.tf(r),r.x+=H.x,r.y+=H.y,$){var f={x:n,y:0};f=X.tf(f),f.x+=H.x,f.y+=H.y,e=Fp([H,R,r,f]),v.c1=H,v.c2=f}else e=Fp(R,r);H=R,F=r}}v.sourcePoint=H,v.targetPoint=F,G._lastSourcePoint=H,G._lastTargetPoint=F}var A=0;s("edge.dash")&&(A=s("edge.dash.width")||z);var W="square"===v.cap?.71:.5;_q(e,E(A*W,z*W+b+V),v.join),T._68o(e)}},getRotation:function(S,W,o){S=S||0;var Q=this._78o;if(Q){var j,E=Q.angle,q=Q.points,L=Q.edgeTypeInfo;if(E!=Z)return W?Q.orienAngle+S:E+S;if(L&&L[cl])return L.getRotation?L.getRotation(this,S,W,o):0;if(L&&L.points){var G=L.points;return j=G.size(),ur[o]?j&&0===j%2?Po(G.get(j/2-1),G.get(j/2),W,S):S:Yc[o]?Po(G.get(0),G.get(1),W,S):Po(G.get(j-2),G.get(j-1),W,S)}if(q)return j=q.size(),ur[o]?j&&0===j%2?Po(q.get(j/2-1),q.get(j/2),W,S):S:Yc[o]?Po(Q.sourcePoint,j?q.get(0):Q.targetPoint,W,S):Po(j?q.get(j-1):Q.sourcePoint,Q.targetPoint,W,S)}return S},getPosition:function(M,J,R,A,r){var q=this._78o;if(q){var H,g=q.type,W=q.points,z=q.edgeTypeInfo,k=q.sourcePoint,c=q.targetPoint;if(!g)return q.looped?{x:k.x-q.radius+J,y:k.y+R}:(r&&k&&c&&(k.x>c.x||k.x===c.x&&k.y>c.y)&&(M=Kk[M],R=-R),H=vk(M,q.rect,A),H.x+=J,H.y+=R,H=q.mat.tf(H),H.x+=q.origin.x,H.y+=q.origin.y,H);if(z&&z[cl])return z.getPosition?z.getPosition(this,M,J,R,A,r):{x:(k.x+c.x)/2,y:(k.y+c.y)/2};if(W){var H,Q=W.size();if(ur[M]){if(Q){var m=Q%2;if(0===m)return br(W.get(Q/2-1),W.get(Q/2),M,J,R,A,r);H=W.get((Q-m)/2)}else H={x:(k.x+c.x)/2,y:(k.y+c.y)/2};return H=vk(M,{x:H.x,y:H.y,width:0,height:0},A),H.x+=J,H.y+=R,H}return Yc[M]?br(k,Q?W.get(0):c,M,J,R,A,r):br(Q?W.get(Q-1):k,c,M,J,R,A,r)}if(z){var x=z.points,Q=x.size();if(ur[M]){var m=Q%2;return 0===m?br(x.get(Q/2-1),x.get(Q/2),M,J,R,A,r):(H=x.get((Q-m)/2),H=vk(M,{x:H.x,y:H.y,width:0,height:0},A),H.x+=J,H.y+=R,H)}return Yc[M]?br(x.get(0),x.get(1),M,J,R,A,r):br(x.get(Q-2),x.get(Q-1),M,J,R,A,r)}}return Xi},_42:function(j){this._78o&&xj.superClass._42.call(this,j)},drawPath:function(R,X){R.beginPath();var Q=X.type,_=X.points,p=X.segments,F=X.edgeTypeInfo;if(!Q||_){var L=X.sourcePoint,P=L.x,U=L.y,k=X.targetPoint,y=k.x,a=k.y;if(Q)if(p){var T=new $p({x:P,y:U});T.addAll(_),T.add({x:y,y:a}),Le(R,T,p)}else R.moveTo(P,U),_.each(function(E){R.lineTo(E.x,E.y)}),R.lineTo(y,a);else X.looped?R.arc(P,U,X.radius,0,G,!0):X.center?(R.moveTo(X.c1.x,X.c1.y),R.lineTo(P,U),R.lineTo(y,a),R.lineTo(X.c2.x,X.c2.y)):(R.moveTo(P,U),R.lineTo(y,a))}else F&&(F.points?Le(R,F.points,F.segments):F[cl]&&F[cl](R,F))},_80o:function(r){var p=this,R=p.s,B=p._78o,N=B.width,D=B.selectWidth,O=B.borderWidth,b=r.lineJoin,i=r.lineCap,T=B.gray,f=B.pattern;r.lineJoin=B.join,r.lineCap=B.cap,p.drawPath(Wi(r,f),B);var I=R("edge.width.absolute");I&&(r.save(),r.setTransform(1,0,0,1,0,0)),D&&(r.strokeStyle=B._97o,r.lineWidth=N+2*(O+D),r.stroke()),O&&(r.strokeStyle=T?M.toGrayColor(B.borderColor):B.borderColor,r.lineWidth=N+2*O,r.stroke());var e=T?M.toGrayColor(B.color):B.color,m=T?M.toGrayColor(B._67o):B._67o;if(r.strokeStyle=e,r.lineWidth=N,r.stroke(),B.is3d&&gj(r,e,m,N,p.gv._zoom,B._66o),I&&r.restore(),eh(r,f),R("edge.dash")){f=R("edge.dash.pattern");var P=Wi(r,f,p._2Q("edge.dash.offset"));P!==r&&p.drawPath(P,B),p._1Q(r,"edge",R("edge.dash.width")||N,f)}r.lineJoin=b,r.lineCap=i},_48O:function(){},_47O:function(){},_71o:function(j,p){var k=this,x=k._data;if(k._19Q=!0,!x.getEdgeGroup())return j?x.s("edge.gap"):0;var i,C=0,n=0,a=0;if(x.getEdgeGroup().getSiblings().each(function(b){b.each(function(L){if(k.gv.isVisible(L)&&L.s(qq)==p){var T=L.s("edge.gap");i?(n+=a/2+T/2,a=T):(i=L,a=T),L===x&&(C=n)}})}),j)return n-C+a;var J=C-n/2;return i&&x._40I!==i._40I&&(k._19Q=!1),J}});var Ko=function(e,q){up(Ko,this,[e,q])};_p(Ko,Me,{_3O:function(){var F,Y,L=this,O=L.s,U=L._data,j=L.gv;if(L._88I=Z,U.isExpanded()&&U.eachChild(function(q){var t=j.getBoundsForGroup(q);t&&(Y||(Y=[]),Y.push(t),F=Gi(F,t))}),F){var i=j.getLabel(U),a=O("group.type");F=sj(a,Y,F),Ak(F,U,"group.padding",1);var y=L._88I={type:a,rect:F,_64o:F};if(!a&&i!=Z){var R,C=L.labelInfo={label:i,color:O("group.title.color"),font:O("group.title.font"),align:O("group.title.align")},E=Vo(C,i),I=E.width,e=E.height,W=O("group.title.align"),n=O("group.title.orientation");if((n===uc||n===Ul)&&I>F.width?F.width=I:(n===Wf||n===qb)&&I>F.height&&(F.height=I),C.rect={y:F.y-e,width:E.width,height:e},R=W===Wf?F.x:W===qb?F.x+F.width-I:F.x+F.width/2-I/2,C.rect.x=R,n===Ul)y.titleRect={x:F.x,y:F.y+F.height,width:F.width,height:e},y.rect={x:F.x,y:F.y,width:F.width,height:F.height+e},C.rect={x:R,y:F.y+F.height,width:I,height:e};else if(n===Wf){var w=y.titleRect={x:F.x-e,y:F.y,width:e,height:F.height};y.rect={x:F.x-e,y:F.y,width:F.width+e,height:F.height},C.rect={x:w.x+e/2-F.height/2,y:w.y+F.height/2-e/2,width:F.height,height:e},C.rotation=-Math.PI/2}else if(n===qb){var w=y.titleRect={x:F.x+F.width,y:F.y,width:e,height:F.height};y.rect={x:F.x,y:F.y,width:F.width+e,height:F.height},C.rect={x:w.x+e/2-F.height/2,y:w.y+F.height/2-e/2,width:F.height,height:e},C.rotation=Math.PI/2}else y.titleRect={x:F.x,y:F.y-e,width:F.width,height:e+1},y.rect={x:F.x,y:F.y-e,width:F.width,height:F.height+e}}L._40O(y,O("group.border.width")/2)}else Ko.superClass._3O.call(L)},getPosition:function(P,V,S,O){var I=this._88I;if(I){var G=vk(P,I.rect,O);return G.x+=V,G.y+=S,G}return Ko.superClass.getPosition.apply(this,arguments)},_24O:function(j,n){var q=this._88I;(!q||q.type||"label2"===j)&&Ko.superClass._24O.call(this,j,n)},_80o:function(I){var U=this,r=U._88I;if(r){var A=U._data,D=U.s,S=U.gv,w=r.type,l=r.rect,n=r._64o,x=r.titleRect,k=U.getBodyColor(),M=Mk(D("group.image"),k),s=D("group.image.stretch"),N=U.getBodyColor("group.background"),v=Mk(D("group.repeat.image"),k),Q=D("group.gradient.pack"),V=D("group.gradient"),g=D("group.gradient.color"),$=D("group.border.width"),Z=D("group.border.color"),b=D("group.border.pattern"),q=D("group.title.orientation"),d=D("group.depth");if(w){var a=I.lineJoin,J=I.lineCap;if(I.lineJoin=D("group.border.join"),I.lineCap=D("group.border.cap"),M){if(I.save(),ch(I,w,l),I.clip(),Ri(I,M,s,l.x,l.y,l.width,l.height,A,S,k),I.restore(),$>0){var X=Wi(I,b);ch(X,w,l),I.lineWidth=$,I.strokeStyle=Z,I.stroke(),eh(I,b)}}else{var X=Wi(I,b);N||v||Q?(ch(I,w,l),Q?Df(I,Q):v?eb(I,v,k,null,A,S):nc(I,N,V,g,l),I.fill(),Q&&I.restore(),I!==X&&ch(X,w,l)):ch(X,w,l),$>0&&(I.lineWidth=$,I.strokeStyle=D("group.border.color"),I.stroke()),eh(I,b),w===Kb&&Mr(I,N,d,l)}I.lineJoin=a,I.lineCap=J}else{var m=D("group.title.background"),i=D("group.border.radius");if(M)Ri(I,M,s,n.x,n.y,n.width,n.height,A,S,U.getBodyColor());else if(N||v)if(v?eb(I,v,k,null,A,S):nc(I,N,V,g,n),0===$)ch(I,Kb,n),I.fill(),Mr(I,N,d,n);else{switch(I.beginPath(),q){case Ul:Wd(I,n.x,n.y,n.width,n.height,i,i,0,0);break;case Wf:Wd(I,n.x,n.y,n.width,n.height,0,i,0,i);break;case qb:Wd(I,n.x,n.y,n.width,n.height,i,0,i,0);break;case uc:Wd(I,n.x,n.y,n.width,n.height,0,0,i,i)}I.fill()}if(x&&m)if(0===$)Rf(I,x.x,x.y,x.width,x.height,m),Mr(I,m,d,x);else{switch(I.beginPath(),I.fillStyle=m,q){case Ul:Wd(I,x.x,x.y,x.width,x.height,0,0,i,i);break;case Wf:Wd(I,x.x,x.y,x.width,x.height,i,0,i,0);break;case qb:Wd(I,x.x,x.y,x.width,x.height,0,i,0,i);break;case uc:Wd(I,x.x,x.y,x.width,x.height,i,i,0,0)}I.fill()}if($>0){var X=Wi(I,b);if(ch(X,"roundRect",l,i),I.lineWidth=$,I.strokeStyle=Z,x&&D("group.splitLine")){var C=x.x,Y=x.y,u=x.width,O=x.height;q===Ul?(I.moveTo(C,Y),I.lineTo(C+u,Y)):q===Wf?(I.moveTo(C+u,Y),I.lineTo(C+u,Y+O)):q===qb?(I.moveTo(C,Y),I.lineTo(C,Y+O)):(I.moveTo(C,Y+O),I.lineTo(C+u,Y+O))}I.stroke(),eh(I,b)}}U._39O(I,r)}else Ko.superClass._80o.call(U,I)}});var eo=function(Q,f){up(eo,this,[Q,f])};_p(eo,Me,{_80o:function(K){this._39O(K,this._83o)}});var Xk=function(v,u){up(Xk,this,[v,u])};_p(Xk,Me,{_3O:function(){var x=this,h=x._data,V=x.s,c=x.gv,X=h.getPoints(),C=c.getBorderColor(h),K=C?V("border.width"):0,t=x.getSelectWidth(),w=V("shape.border.width"),W=h.getRect(),r=c.getBodyColor(h),J=x._99o=X.isEmpty()?Z:{rect:W,rotation:h.getRotation(),fillRule:V("shape.fill.rule"),scale:h.getScale(),position:h.p(),points:X,segments:h.getSegments(),bodyColor:r,borderColor:C,borderWidth:K,_94o:V("shape.border.3d"),_95o:V("shape.border.3d.color"),_96o:V("shape.border.3d.accuracy"),_97o:t?x.getSelectColor():Z,selectWidth:t,_53o:V("shape.background"),_27Q:Mk(V("shape.repeat.image"),r),shapeGradientPack:V("shape.gradient.pack"),_54o:w,_55o:V("shape.border.color"),shapeGradient:V("shape.gradient"),_59o:V("shape.gradient.color"),_60o:V("shape.border.pattern"),_61o:V("shape.border.cap"),_62o:V("shape.border.join"),shapeForeground:V("shape.foreground"),gray:V("2d.gray")};if(J){var P=h.getScale(),L=E(1,E(s(P.x),s(P.y)));V("shape.dash")&&V("shape.dash.width")>w&&(w=V("shape.dash.width"));var B=w*("square"===J._61o?.71:.5)+K+t/x.gv._zoom/L;B&&(B*=L,W=nh(W),_q(W,B,J._62o)),x._68o(W);var D=V("clip.percentage");1>D&&(0>D&&(D=0),J.clipRect=lj(h.getAnchorRect(),V("clip.direction"),D));var y=V("shape.fill.clip.percentage");1>y&&(0>y&&(y=0),J.shapeClipRect=lj(h.getAnchorRect(),V("shape.fill.clip.direction"),y));var R=V("shape.foreground.clip.percentage");1>R&&(0>R&&(R=0),J.shapeForegroundClipRect=lj(h.getAnchorRect(),V("shape.foreground.clip.direction"),R))}},getPosition:function(n,w,T,z){var G=this._99o;if(G){var $=vk(n,G.rect,z);return $.x+=w,$.y+=T,$}return Xi},_42:function(L){this._99o&&Xk.superClass._42.call(this,L)},_80o:function(O){var D,s=this,e=s.s,j=s._99o,H=j.position,d=j.scale,n=j.rotation,T=j.borderWidth,Y=j.selectWidth/s.gv._zoom,o=j._27Q,X=j.shapeGradientPack,V=j._54o,p=j.clipRect,r=j.shapeClipRect,z=j.points,N=j.segments,L=s._data.isClosePath(),S=j.fillRule,f=j.gray,$=function(b){return f?M.toGrayColor(b):b},c=$(j._53o),v=c||o||X;O.save(),Kn(O,H.x,H.y),Tc(O,n),Zf(O,d.x,d.y),p&&(O.beginPath(),O.rect(p.x,p.y,p.width,p.height),O.clip()),v&&r&&(O.save(),O.beginPath(),O.rect(r.x,r.y,r.width,r.height),O.clip()),Kn(O,-H.x,-H.y);var b=j._60o,K=Wi(O,b),i=O.lineJoin,E=O.lineCap;O.lineJoin=j._62o,O.lineCap=j._61o;var C=$(j.bodyColor);v?(Le(O,z,N,L),X?Df(O,X):o?eb(O,o,C,null,s._data,s.gv):(D=C?C:c,nc(O,D,j.shapeGradient,$(j._59o),j.rect)),O.fill(S),r&&(O.restore(),Kn(O,-H.x,-H.y)),X&&O.restore(),K!==O&&Le(K,z,N,L)):Le(K,z,N,L);var J=j.shapeForeground;if(J){O.save();var P=j.shapeForegroundClipRect;P&&(Kn(O,H.x,H.y),O.beginPath(),O.rect(P.x,P.y,P.width,P.height),O.clip(),Kn(O,-H.x,-H.y)),Le(O,z,N,L),nc(O,J,e("shape.foreground.gradient"),$(e("shape.foreground.gradient.color")),j.rect),O.fill(S),O.restore()}var l=e("shape.border.width.absolute");if(l&&(O.save(),O.setTransform(1,0,0,1,0,0)),Y&&(O.strokeStyle=j._97o,O.lineWidth=V+2*(T+Y),O.stroke()),T&&(O.strokeStyle=$(j.borderColor),O.lineWidth=V+2*T,O.stroke()),V&&(D=$(j._55o),!c&&C&&(D=C),O.strokeStyle=D,O.lineWidth=V,O.stroke(),j._94o&&gj(O,D,$(j._95o),V,s.gv._zoom,j._96o)),l&&O.restore(),eh(O,b),e("shape.dash")){var G=e("shape.dash.width")||V;if(G>0){b=e("shape.dash.pattern");var K=Wi(O,b,s._2Q("shape.dash.offset"));K!==O&&Le(K,z,N,L),s._1Q(O,"shape",G,b)}}O.lineJoin=i,O.lineCap=E,O.restore()},_48O:function(){},_47O:function(){}});var uf=function(e,m){up(uf,this,[e,m])};_p(uf,Xk,{getRotation:function(P,c,J){P=P||0;var G=this._data.getPoints(),E=G.size();return E>1?ur[J]?E&&0===E%2?Po(G.get(E/2-1),G.get(E/2),c,P):P:Yc[J]?Po(G.get(0),G.get(1),c,P):Po(G.get(E-2),G.get(E-1),c,P):P},getPosition:function(h,P,N,v,Y){var Q=this._data.getPoints(),D=Q.size();if(D>1){if(ur[h]){var a=D%2;if(0===a)return br(Q.get(D/2-1),Q.get(D/2),h,P,N,v,Y);var J=Q.get((D-a)/2),C={x:J.x,y:J.y,width:0,height:0};return J=vk(h,C,v),J.x+=P,J.y+=N,J}return Yc[h]?br(Q.get(0),Q.get(1),h,P,N,v,Y):br(Q.get(D-2),Q.get(D-1),h,P,N,v,Y)}return Xi}});var qs=function(N,V){up(qs,this,[N,V])};_p(qs,Me,{_3O:function(){var l=this;qs.superClass._3O.call(l);var r=l.s,i=l._83o;l._82o=i.img||i.shape?Z:{background:l.getBodyColor("grid.background"),depth:r("grid.depth"),rect:i.rect,_88o:r("grid.cell.depth"),cellBorderColor:r("grid.cell.border.color"),_89o:r("grid.row.count"),_90o:r("grid.column.count"),block:r("grid.block"),_91o:r("grid.block.color"),_92o:r("grid.block.padding"),_93o:r("grid.block.width")}},_80o:function(D){var A=this,t=A._82o;if(!t)return qs.superClass._80o.call(A,D),void 0;var T,d,M=A._data,V=t.background,q=t.rect,Y=t.block,E=t._91o,y=t._92o,N=t._93o,R=t._88o,L=t.cellBorderColor,$=t._89o,j=t._90o;if(V)if(Rf(D,q.x,q.y,q.width,q.height,V),Mr(D,V,t.depth,q),R)for(T=0;$>T;T++)for(d=0;j>d;d++)q=M.getCellRect(T,d),q&&Mr(D,V,R,q);else if(L){for(D.beginPath(),T=0;$>T;T++)for(d=0;j>d;d++)q=M.getCellRect(T,d),q&&D.rect(q.x,q.y,q.width,q.height);D.strokeStyle=L,D.lineWidth=1,D.stroke()}if("h"===Y)for(T=0;$>T;T++)q=Gi(M.getCellRect(T,0),M.getCellRect(T,j-1)),$l(q,y),Il(D,E,q.x,q.y,q.width,q.height,N);else if("v"===Y)for(d=0;j>d;d++)q=Gi(M.getCellRect(0,d),M.getCellRect($-1,d)),$l(q,y),Il(D,E,q.x,q.y,q.width,q.height,N);A._39O(D,A._83o)}});var _b=function(m,r){up(_b,this,[m,r])};_p(_b,Me,{_checkEmptyRect:!1,_81o:function(){var s=this._data,Y=_b.superClass._81o.call(this),f=s.s("text");if(f!=Z){var G,c,j=s.s("text.font"),h=s.s("text.align"),I=s.s("text.vAlign"),q=Dn(j,f),n=q.width,b=q.height,y=s.getAnchor(),$=s.getWidth(),E=s.getHeight();"left"===h?G=-$*y.x:"center"===h?G=-$*y.x+($-n)/2:"right"===h&&(G=$*(1-y.x)-q.width),"top"===I?c=-E*y.y:"middle"===I?c=-E*y.y+(E-b)/2:"bottom"===I&&(c=E*(1-y.y)-q.height);var u,M=s.getMatrix();if(u=Fp([M.tf(G,c),M.tf(G+n,c),M.tf(G+n,c+b),M.tf(G,c+b)]),Y=Gi(Y,u),Y&&s.s("text.shadow")){var t=nh(Y);t.x+=s.s("text.shadow.offset.x"),t.y+=s.s("text.shadow.offset.y"),$l(t,s.s("text.shadow.blur")),Y=Gi(Y,t)}}return Y}});var Ol=El.Interactor=function(B){this.gv=this._graphView=B};Kg("Interactor",C,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(V){this.gv.fi(V)},setCursor:function(q){Jq||this.gv.setCursor(q)},startDragging:function(j){var U=this;U._lastClientPoint=bk(j),U._lastLogicalPoint=U.gv.lp(j),nf(U,j)},clearDragging:function(){var d=this;d._lastClientPoint=d._lastLogicalPoint=d._logicalPoint=Z},autoScroll:function(f){return this.gv.autoScroll(f,this._lastClientPoint)}});var Yl=Z,un=function(X){Yl.handleWindowTouchMove(X)},Fg=function(z){Yl.handleWindowTouchEnd(z),x.removeEventListener(Fm,un,R),x.removeEventListener(Aj,Fg,R),Yl=Z},Af=function(T){Yl.handleWindowMouseMove(T)},ug=function(s){Yl.handleWindowMouseUp(s),x.removeEventListener(ti,Af,R),x.removeEventListener(xq,ug,R),Yl=Z},$b=function(Y,$){Y!==Yl&&(Yl?Jq?Yl.handleWindowTouchEnd($):Yl.handleWindowMouseUp($):Jq?(x.addEventListener(Fm,un,R),x.addEventListener(Aj,Fg,R)):(x.addEventListener(ti,Af,R),x.addEventListener(xq,ug,R)),Yl=Y)},tf=function(j){var h=this;h.gv=j,h._is2d=j instanceof El.GraphView,h._is2d&&(h.filter=function(x){return j.isSelectable(x)&&j.isInteractive(x)}),j.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",Ic].forEach(function(x){h.addListener(x)}),h.initImageResource()};_p(tf,Ol,{enableVR:function(l){var B=this;if(!!B._vrEnable!==l)if(B._vrEnable=l,l)B.gv.vr.mp(B.onVRControllerChange,B);else if(B.gv.vr.ump(B.onVRControllerChange,B),B._vrRayPolyline){var D=B.gv.dm();D.remove(B._vrRayPolyline),D.remove(B._vrRayHitPoint),B._vrRayPolyline=K,B._vrRayHitPoint=K}},onVRControllerChange:function(F){var N=this,g=F.property,b=F.newValue,C=N.gv.vr.getController(b.id),d=C.getRay();d&&("gamepad.button.trigger"===g?"down"===b._62O?N.handle_mousedown(d):N.handleWindowMouseUp(d):"gamepad.pose"===g&&(N.handle_mousemove(d),N.handleWindowMouseMove(d)))},drawVRRay:function(c,v,D){var L,x=this,h=x.gv,K=x._vrRayPolyline,u=!1;if(K)L=x._vrRayHitPoint;else{var $=h.dm();x._vrRayPolyline=K=new k.Polyline,x._vrRayHitPoint=L=new k.Node,L.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),L.setAnchor3d(.5,.5,.499);var U=.2/h.vr.measureOflength;L.s3(U,U,U),K.s("intersect",!1),L.s("intersect",!1),$.add(K),$.add(L),u=!0}if(v){var O=D.world,z=D.worldNormal,B=O.x,l=O.y,r=O.z;K.s("shape.border.color","red"),K.setPoints([{x:c.origin.x,y:c.origin.z,e:c.origin.y},{x:B,y:r,e:l}]),L.s("3d.visible",!0),L.p3(B,l,r),L.lookAtDirection([z.x,z.y,z.z],"front")}else{K.s("shape.border.color","blue");var s=new k.Math.Vector3;s.copy(c.direction).setLength(1e3/x.gv.vr.measureOflength).add(c.origin),K.setPoints([{x:c.origin.x,y:c.origin.z,e:c.origin.y},{x:s.x,y:s.z,e:s.y}]),L.s("3d.visible",!1)}h.fi({kind:"vrRayIntersect",ray:c,data:v,intersect:D,polyline:K,hitNode:L,begin:u})},addListener:function(p){var F=this;F.gv.getView().addEventListener(p,function(c){M.preventDefault(c),F.disabled||F["handle_"+p](c)},R)},handleWindowTouchMove:function(e){this.handleWindowMouseMove(e)},handleWindowMouseMove:function(B){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",B):(this.handleDownInfo("onBeginDrag",B),this.isDragging=!0))},handleWindowTouchEnd:function(S){this.handleWindowMouseUp(S)},handleWindowMouseUp:function(M){if(this.isDragging&&(this.handleDownInfo("onEndDrag",M),this.isDragging=!1),this.downInfo){var z=this.handle("onUp",M);z&&z.data===this.downInfo.data?this.handleMissingUp(M):this.handleDownInfo("onUp",M),this.downInfo=Z}},handle_mouseleave:function(b){var x=this,o=x.gv,W=x.currentInfo?x.currentInfo.data:Z;if(W){W.s("onLeave")&&W.s("onLeave")(b,W,o),x.fire("data","onLeave",b,W);var E=x.currentInfo?x.currentInfo.hits:Z;if(E)for(var A in E)x.handleLeave(b,A);x.currentInfo=Z}},handle_mousewheel:function(Z){Z.scrollDelta=Z.wheelDelta/40,this.handle("onScroll",Z)},handle_DOMMouseScroll:function(d){d.scrollDelta=2===d.axis?-d.detail:0,this.handle("onScroll",d)},handle_touchstart:function(i){this.handle_mousedown(i)},handle_touchmove:function($){this.handle("onMove",$)},handle_mousedown:function(t){this.isDragging&&(this.handleDownInfo("onEndDrag",t),this.isDragging=!1),this.downInfo=this.handle("onDown",t),this.downInfo&&$b(this,t)},handle_mousemove:function(m){var h=this,B=h.gv;h._hoverTimer&&(W(h._hoverTimer),delete h._hoverTimer);var c,r,Y,n=h.handle("onMove",m),b=this.currentInfo?this.currentInfo.data:Z,t=this.currentInfo?this.currentInfo.hits:Z;if(n&&(r=n.data,Y=n.hits,h._hoverTimer=H(function(){W(h._hoverTimer),delete h._hoverTimer,h.handle("onHover",m,n)},B.getHoverDelay()||M.hoverDelay)),r!==b){if(b&&(b.s("onLeave")&&b.s("onLeave")(m,b,B),this.fire("data","onLeave",m,b)),r&&(r.s("onEnter")&&r.s("onEnter")(m,r,B),this.fire("data","onEnter",m,r)),t)for(c in t)this.handleLeave(m,c);if(Y)for(c in Y){var J=Y[c];J.target.onEnter&&J.target.onEnter(m,r,B,J.point,J.width,J.height),this.fire(J.type,"onEnter",J.event,J.data,J.image,J.comp,J.point,J)}}else{if(t)for(c in t)Y&&Y[c]||this.handleLeave(m,c);if(Y)for(c in Y)if(!t||!t[c]){var J=Y[c];J.target.onEnter&&J.target.onEnter(m,r,B,J.point,J.width,J.height),this.fire(J.type,"onEnter",J.event,J.data,J.image,J.comp,J.point,J)}}this.currentInfo=n},handle:function(u,L,e){var K,o=this,f=o.gv;if(o._is2d){if(e=e||f.getDataInfoAt(L,this.filter),!e)return;if(K=e.ui.interactiveInfo){var P,s=e.data;if(s.s(u)&&s.s(u)(L,s,f),this.fire("data",u,L,s),"body"===e.part&&K.bodyInfo)P="body",e.hits=this.handleImage(P,f.getImage(s),u,L,s,e.point,K.bodyInfo);else if("icons"===e.part&&K._38o){var h=K._38o[e.name];h&&h[e.index]&&(P="icons|"+e.name+"|"+e.index,e.hits=this.handleImage(P,e.icon,u,L,s,e.point,h[e.index]))}}return e}var s,t;if(!e)if(L&&L instanceof k.Math.Ray){var Y=f.vr.intersectWorld(L);if(s=Y.data,t=Y.intersect,o.drawVRRay(L,s,t),!s)return;var n=f.getData3dUI(s);if(K=n.interactiveInfo,!K)return;e={data:s,part:t.part,ui:n}}else{if(e=f.getDataInfoAt(L),!e)return;e&&(e={data:e.data,part:e.part})}if(!t){s=e.data;var n=f.getData3dUI(s);if(e.ui=n,K=n.interactiveInfo,!K)return e;if(t=f.intersectObject(L,s),!t)return}s.s(u)&&s.s(u)(L,s,f),this.fire("data",u,L,s);var U,g=t.part;return"body"!==g&&(U=s.s(g+".image")||s.s("shape3d."+g+".image")),U||(U=s.s("all.image")||s.s("shape3d.image")),K="object"==typeof U?K[U.uuid]:K[U],K&&K.bodyInfo?(e.part="body",e.interactiveInfo=K,e.point=t.uv.multiply({x:K.bodyInfo.rect.width,y:K.bodyInfo.rect.height}),e.image=U,e.hits=this.handleImage("body",U,u,L,s,e.point,K.bodyInfo),e):e},_handleLeaveOrMissing:function(z,I,o){var G="leave"===z?this.currentInfo:this.downInfo;if(G){var P=G.interactiveInfo||G.ui.interactiveInfo;if(P){var r,v,j=G.data;if(this._is2d){if(v=this.gv.lp(I),"body"===G.part&&P.bodyInfo)r="body","leave"===z?this.handleLeaveImage(o,r,this.gv.getImage(j),I,j,v,P.bodyInfo):this.handleMissingUpImage(r,this.gv.getImage(j),I,j,v,P.bodyInfo);else if("icons"===G.part&&P._38o){var Z=P._38o[G.name];Z&&Z[G.index]&&(r="icons|"+G.name+"|"+G.index,"leave"===z?this.handleLeaveImage(o,r,G.icon,I,j,v,Z[G.index]):this.handleMissingUpImage(r,G.icon,I,j,v,Z[G.index]))}}else{if(!P.bodyInfo)return;var x=this.gv.intersectObject(I,j);v=x?x.uv.multiply({x:P.bodyInfo.rect.width,y:P.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===z?this.handleLeaveImage(o,"body",G.image,I,j,v,P.bodyInfo):this.handleMissingUpImage("body",G.image,I,j,v,P.bodyInfo)}}}},handleDownInfo:function(H,e){if(this.downInfo){var L=this.downInfo,d=this.gv,P=L.interactiveInfo||L.ui.interactiveInfo;if(P){var z,T=L.data;if(T.s(H)&&T.s(H)(e,T,d),this.fire("data",H,e,T),this._is2d){var m=d.lp(e);if("body"===L.part&&P.bodyInfo)z="body",this.handleDownInfoImage(z,d.getImage(T),H,e,T,m,P.bodyInfo);else if("icons"===L.part&&P._38o){var N=P._38o[L.name];N&&N[L.index]&&(z="icons|"+L.name+"|"+L.index,this.handleDownInfoImage(z,L.icon,H,e,T,m,N[L.index]))}}else{if(!P.bodyInfo)return;var f=d.intersectObject(e,T);if(!f)return;m=f.uv.multiply({x:P.bodyInfo.rect.width,y:P.bodyInfo.rect.height}),this.handleDownInfoImage("body",L.image,H,e,T,m,P.bodyInfo)}}}},fire:function(O,A,f,C,u,s,z,x){this.gv.fi({kind:A,type:O,event:f,data:C,image:u,comp:s,view:this.gv,point:z,width:x?x.width:K,height:x?x.height:K})},handleImage:function(p,I,V,o,P,n,x){var $={};if(I&&(I=Mk(I))){var i=this.gv,M=x.rect,Z=this.convertPoint(n,x);Z.inRect&&(I[V]&&I[V](o,P,i,Z,M.width,M.height),this.fire("image",V,o,P,I,K,Z,M),$[p+"|image"]={target:I,type:"image",image:I,data:P,event:o,point:Z,width:M.width,height:M.height});for(var m=x.compInfos,z=I,E=m.length-1;E>=0;E--){var e=m[E],s=e.comp;Z=this.convertPoint(n,e,z,s,i,P),Z.inRect&&(M=e.rect,s[V]&&s[V](o,P,i,Z,M.width,M.height),this.fire("comp",V,o,P,I,s,Z,M),(I=M.image)&&(I[V]&&I[V](o,P,i,Z,M.width,M.height),this.fire("image",V,o,P,I,K,Z,M)),$[p+"|"+E]={target:s,type:"comp",comp:s,image:I,data:P,event:o,point:Z,width:M.width,height:M.height},I&&($[p+"|"+E+"|image"]={target:I,type:"image",image:I,data:P,event:o,point:Z,width:M.width,height:M.height}))}}return $},handleLeave:function(d,u){return this._handleLeaveOrMissing("leave",d,u)},handleMissingUp:function(o){return this._handleLeaveOrMissing("missing",o)},handleLeaveImage:function(S,s,$,B,v,F,Y){if($&&($=Mk($))){var J=this.gv,y=Y.rect,n=this.convertPoint(F,Y);S===s+"|image"&&($.onLeave&&$.onLeave(B,v,J,n,y.width,y.height),this.fire("image","onLeave",B,v,$,K,n,y));for(var h=Y.compInfos,N=$,d=h.length-1;d>=0;d--){var P=h[d],H=P.comp;n=this.convertPoint(F,P,N,H,J,v),y=P.rect,S===s+"|"+d&&(H.onLeave&&H.onLeave(B,v,J,n,y.width,y.height),this.fire("comp","onLeave",B,v,$,H,n,y)),($=y.image)&&S===s+"|"+d+"|image"&&($.onLeave&&$.onLeave(B,v,J,n,y.width,y.height),this.fire("image","onLeave",B,v,$,K,n,y))}}},handleMissingUpImage:function(m,Y,V,f,e,j){var Z="onUp",b=this.downInfo.hits;if(b&&Y&&(Y=Mk(Y))){var q=this.gv,G=j.rect,R=this.convertPoint(e,j);!R.inRect&&b[m+"|image"]&&(Y[Z]&&Y[Z](V,f,q,R,G.width,G.height),this.fire("image",Z,V,f,Y,K,R,G));for(var w=j.compInfos,T=Y,X=w.length-1;X>=0;X--){var k=w[X],y=k.comp;R=this.convertPoint(e,k,T,y,q,f),R.inRect||(G=k.rect,b[m+"|"+X]&&(y[Z]&&y[Z](V,f,q,R,G.width,G.height),this.fire("comp",Z,V,f,Y,y,R,G)),(Y=G.image)&&b[m+"|"+X+"|image"]&&(Y[Z]&&Y[Z](V,f,q,R,G.width,G.height),this.fire("image",Z,V,f,Y,K,R,G)))}}},handleDownInfoImage:function(k,T,L,A,w,P,b){var X=this.downInfo.hits;if(X&&T&&(T=Mk(T))){var V=this.gv,_=b.rect,I=this.convertPoint(P,b);X[k+"|image"]&&(T[L]&&T[L](A,w,V,I,_.width,_.height),this.fire("image",L,A,w,T,K,I,_));for(var M=b.compInfos,e=T,r=M.length-1;r>=0;r--){var S=M[r],c=S.comp;I=this.convertPoint(P,S,e,c,V,w),_=S.rect,X[k+"|"+r]&&(c[L]&&c[L](A,w,V,I,_.width,_.height),this.fire("comp",L,A,w,T,c,I,_)),(T=_.image)&&X[k+"|"+r+"|image"]&&(T[L]&&T[L](A,w,V,I,_.width,_.height),this.fire("image",L,A,w,T,K,I,_))}}},initImageResource:function(){M.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(I,U,l,p,A,e){var N=U.rect,b=U.matrix.applyInverse(I).sub(N),i=b.x>=0&&b.y>=0&&b.x<=N.width&&b.y<=N.height;if(!i)return b;if(p&&Vc(p.pixelPerfect,e,A)){var N,t=1;this._is2d?(t=A.getZoom(),N=ml(I.x,I.y,K,t)):N=ml(I.x,I.y);var F=!1,X=N.x,_=N.y,T=N.width,v=N.height,C=M.hitMaxArea,j=T*v*t*t;if(j>C){var Q=Math.sqrt(C/j);t*=Q}T*=t,v*=t,2>T&&(T=2),2>v&&(v=2),X*=t,_*=t;var $=Zj(T,v),a=new yp(0,-X,-_,t,t);a.append(U.matrix),A._drawForChecking=!0,p.transform=a;var O=l.comps;l.comps=[p],mc($,l,0,0,T,v,e,self),l.comps=O,delete p.transform,A._drawForChecking=!1;try{for(var k=0,u=$.getImageData(0,0,T,v).data;k<u.length;k+=4)if(0!==u[k+3]){F=!0;break}$.restore()}catch(s){Yp=Z,F=!1
}b.inRect=F}else b.inRect=!0;return b}});var So=El.DefaultInteractor=function(I){up(So,this,[I])};Kg("DefaultInteractor",Ol,{handle_mousedown:function(U){xf(U);var x=this,V=x.gv,t=V.getDataAt(U);!V.setFocus(U)||V._editing||V._scrolling||(yn(U)?V.handleDoubleClick(U,t):V.handleClick(U,t),!_f()&&t&&(V.isMovable(t)||V.isInteractive(t))||!V.isPannable()||!em(U)||Ah(U)||(x._tx=V.tx(),x._ty=V.ty(),x.startDragging(U)))},handleWindowMouseUp:function(I){var Z=this,$=Z.gv;$._panning&&(delete $._panning,$.onPanEnded(),Z.fi({kind:"endPan",event:I})),delete Z._tx,delete Z._ty,Z.clearDragging()},handle_mousemove:function(m){var Z=this,X=Z.gv;Z._hoverTimer&&(W(Z._hoverTimer),delete Z._hoverTimer),Z._hoverTimer=H(function(){Z.fi({kind:"hover",event:m}),W(Z._hoverTimer),delete Z._hoverTimer},X.getHoverDelay()||M.hoverDelay)},handle_touchmove:function(m){this.handle_mousemove(m)},handleWindowMouseMove:function(h){var v=this,M=v.gv,q=v._lastClientPoint;v.fi({kind:M._panning?"betweenPan":"beginPan",event:h}),M._panning=1,M.setTranslate(v._tx+h.clientX-q.x,v._ty+h.clientY-q.y)},handle_mousewheel:function(M){this.gv.handleScroll(M,M.wheelDelta)},handle_DOMMouseScroll:function(B){2===B.axis&&this.gv.handleScroll(B,-B.detail)},handle_keydown:function(c){this.gv.handleKeyDown(c)}});var Oi=El.SelectInteractor=function(d){up(Oi,this,[d])};Kg("SelectInteractor",Ol,{_42:function(){var W=this,n=W.gv,L=n.getZoom(),X=W.mark,w=W.div;w||(w=W.div=Ti(),Xh(W.getView(),w));var m={};m.x=X.x*L+n.tx(),m.y=X.y*L+n.ty(),m.width=X.width*L,m.height=X.height*L,ef(w,m),this.intersects()?(w.style.border="",w.style.background=n.getRectSelectBackground()):(w.style.background="",w.style.border="1px solid "+n.getRectSelectBorderColor())},handle_mousedown:function(j){var N=this,q=N.gv;if(N._57I=Z,N.pendingClickThrough=Z,!(q._editing||q._scrolling||_f())){var e=q.getDataAt(j),p=q.sm();e?Ah(j)?p.co(e)?p.rs(e):p.as(e):p.co(e)?e instanceof Gl&&e.isClickThroughEnabled()&&em(j)&&(N.pendingClickThrough=bk(j)):p.ss(e):Ah(j)||!q.isPannable()?em(j)&&(Ah(j)||p.cs(),q.isRectSelectable()&&(N.startDragging(j),q._77O=1)):em(j)&&(N._57I=bk(j))}},handle_mouseup:function(Q){var $=this,J=$.gv,h=$._57I;if(h&&(Qn(h,bk(Q))<=1&&J.sm().cs(),$._57I=Z),$.pendingClickThrough){if(Qn($.pendingClickThrough,bk(Q))<=1){var L=J.getDataAt(Q);if(L instanceof Gl&&L.isClickThroughEnabled()){var B=J.getDataAt(Q,function(f){var A=f.getParent()===L&&J.isSelectable(f,!0);return A});B&&(Q.clickThrough=!0,J.sm().ss(B))}}$.pendingClickThrough=Z}},handleWindowMouseUp:function(M){this.clear(M)},handleWindowMouseMove:function(j){var L=this,r=L.gv;L._logicalPoint=r.lp(j),L.mark?(L.fi({kind:"betweenRectSelect",event:j}),r.isPannable()&&L.autoScroll(j),L.redraw()):L.fi({kind:"beginRectSelect",event:j}),L.mark=Fp(L._lastLogicalPoint,L._logicalPoint),L.redraw()},intersects:function(){var b=this,n=b._lastLogicalPoint,p=b._logicalPoint;return n.x>p.x||n.y>p.y},clear:function(H){var j=this,m=j.gv,a=j.mark;if(j._57I=Z,j.pendingClickThrough=Z,j._lastLogicalPoint){if(a){if(0!==a.width&&0!==a.height){var l=m.getDatasInRect(a,j.intersects());if(!l.isEmpty()){var B=m.sm(),n=B.toSelection();l.each(function(r){B.co(r)?n.remove(r):n.add(r)}),B.ss(n)}}Xq(j.div),delete j.div,delete j.mark,j.redraw(),j.fi({kind:"endRectSelect",event:H}),m.onRectSelectEnded()}j.clearDragging(),delete m._77O}},redraw:function(){var y=this;y._draw||(y._draw=1,H(function(){y.mark&&y._42(),delete y._draw},16))}});var Eo=El.MoveInteractor=function(v){up(Eo,this,[v])};Kg("MoveInteractor",Ol,{handle_mousedown:function(o){var O=this,C=O.gv;if(em(o)&&!C._editing&&!C._scrolling&&!_f()){var u=C.getSelectedDataAt(o);!u||C.isInteractive(u)&&!C.isMovable(u)?C._focusData=Z:(O._data=u,C.handleMouseDown&&C.handleMouseDown(o,u),O.startDragging(o),C.isMovable(u)&&(C._moving=1))}},handleWindowMouseUp:function(H){var d=this,D=d.gv;D.handleMouseUp&&D.handleMouseUp(H,d._data),d.clear(H)},handleWindowMouseMove:function(J){var g=this,q=g._data,i=g.gv;if((!i._93O||!i._93O(J,q))&&i._moving){g._logicalPoint||g.fi({kind:"prepareMove",event:J});var X=g._logicalPoint?"betweenMove":"beginMove",S={kind:X,event:J},u=g._logicalPoint=i.lp(J);"beginMove"!==X||g._alreadyBeginTransaction||(g._alreadyBeginTransaction=!0,i.getDataModel().beginTransaction());var e=g._calcShift(X,J),F=e.x,z=e.y,o=g.gv.getMoveMode(J,q);o&&("x"===o?z=0:"y"===o?F=0:"xy"!==o&&(F=z=0)),i.moveSelection(F,z),g._lastLogicalPoint=u,g.autoScroll(J),g.fi(S)}},_calcShift:function(){var D=this,S=D._logicalPoint,A=D._lastLogicalPoint,G=S.x-A.x,o=S.y-A.y;return{x:G,y:o}},clear:function(g){var k=this,q=k.gv;k._lastLogicalPoint&&(k._lastLogicalPoint=k._data=q._moving=Z,k._logicalPoint&&(k.fi({kind:"endMove",event:g}),q.onMoveEnded()),k.clearDragging()),k._alreadyBeginTransaction&&(k._alreadyBeginTransaction=!1,q.getDataModel().endTransaction())}});var Nq=El.ScrollBarInteractor=function(G){up(Nq,this,[G])};Kg("ScrollBarInteractor",Ol,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(V){var n=this.gv.getViewRect();return this._41o()&&(n.x+n.width-this.gv.lp(V).x)*this.gv.getZoom()<Zn},isH:function(M){var n=this.gv.getViewRect();return this._40o()&&(n.y+n.height-this.gv.lp(M).y)*this.gv.getZoom()<Zn},handle_mousemove:function(j){this.handle_touchmove(j)},handle_touchmove:function(U){if(!Re&&em(U)&&this.gv.isScrollBarVisible()){var w=this,m=w.isV(U),A=w.isH(U);(m||A)&&w.gv.showScrollBar(),w.gv._scrolling=m||A}},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},handleWindowTouchEnd:function(a){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=Z,this.fi({kind:"endScroll",event:a})},handle_mousedown:function(Y){this.handle_touchstart(Y)},handle_touchstart:function(q){var H=this;if(H.gv.setFocus(q),xf(q),H.handle_touchmove(q),!(Tm(q)>1)&&H.gv._scrolling&&H.gv.isScrollBarVisible()){H._cp=bk(q),H._tx=H.gv.tx(),H._ty=H.gv.ty();var z=H.isV(q);H._state=z?"vScroll":"hScroll",nf(H,q),H.fi({kind:"beginScroll",event:q})}},handleWindowMouseMove:function(w){this.handleWindowTouchMove(w)},handleWindowTouchMove:function(D){var s=bk(D),c=this.gv.getViewRect(),z=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-s.y)*z.height/c.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-s.x)*z.width/c.width),this.fi({kind:"betweenScroll",event:D})}});var yb=El.TouchInteractor=function(_,V){V=V||{},V.selectable===K&&(V.selectable=!0),V.movable===K&&(V.movable=!0),V.pannable===K&&(V.pannable=!0),V.pinchable===K&&(V.pinchable=!0),V.editable===K&&(V.editable=!0),this.params=V,up(yb,this,[_])};Kg("TouchInteractor",Ol,{ms_edit:1,setUp:function(){var B=this;yb.superClass.setUp.call(B),Jq&&B.params.editable&&B.gv.setEditInteractor(B)},tearDown:function(){var H=this;yb.superClass.tearDown.call(H),Jq&&H.params.editable&&H.gv.setEditInteractor(Z)},clear:function(v){var R=this,g=R.gv;g._moving&&(R.fi({kind:"endMove",event:v}),delete g._moving,g.onMoveEnded(),g.dm().endTransaction()),g._panning&&(R.fi({kind:"endPan",event:v}),delete g._panning,g.onPanEnded()),g._pinching&&(R.fi({kind:"endPinch",event:v}),delete g._pinching,g.onPinchEnded()),g._editing&&(R._46O(v),R._77I=R._node=R._edge=R._shape=R._rect=R._89I=R._index=g._editing=Z),R._moving=R._panning=R._pinching=R._editing=R._57I=R._data=R._beginHistory=Z,R.clearDragging()},handle_touchstart:function(D){var B=this;if(!B.gv._editing){xf(D),B._57I=Z;var U=B.params,d=B.gv,J=d.sm(),v=d.getDataAt(D),X=Tm(D);if(1===X){if(yn(D))return d.handleDoubleClick(D,v),void 0;d.handleClick(D,v),v&&(d.handleMouseDown&&d.handleMouseDown(D,v),B._data=v),U.selectable||(v=Z),v?(J.co(v)||J.ss(v),U.editable&&d.isEditable(v)&&B._79I(D,v,!0)?(B._editing=1,B.startDragging(D)):U.movable&&d.isMovable(v)&&(B._moving=1,B.startDragging(D))):(B._57I=bk(D),U.pannable&&d.isPannable()&&(B._panning=1,B.startDragging(D),B._translate={x:d.tx(),y:d.ty()}))}else if(U.pinchable&&2===X){B._pinching=1,B.startDragging(D);var r=d.getView(),T=d.getZoom(),l=r.getBoundingClientRect(),k=D.touches[0],H=D.touches[1],W={x:(k.clientX+H.clientX)/2-l.left,y:(k.clientY+H.clientY)/2-l.top};W.x-=d.tx(),W.y-=d.ty(),W.x/=T,W.y/=T,B._p=W,B._d=dc(D)}}},handle_touchend:function(e){var j=this,l=j.gv,N=j._57I,c=j._data;N&&(Qn(N,bk(e))<=1&&l.sm().cs(),j._57I=Z),c&&l.handleMouseUp&&l.handleMouseUp(e,c)},handleWindowTouchEnd:function(Q){this.clear(Q)},handleWindowTouchMove:function(M){var v=this,w=v.gv,E=Tm(M);if(1===E){if(v._editing&&(v._beginHistory||(v._beginHistory=1,w.dm().beginTransaction()),w._editing=1,v._78I(M)),v._moving)v._beginHistory||(v._beginHistory=1,w.dm().beginTransaction()),v.handleMove(M);else if(v._panning){var u=bk(M);w.setTranslate(v._translate.x+u.x-v._lastClientPoint.x,v._translate.y+u.y-v._lastClientPoint.y),v.fi({kind:w._panning?"betweenPan":"beginPan",event:M}),w._panning=1}}else if(2===E&&v._pinching){var Y=dc(M);w.handlePinch(v._p,Y,v._d),v._d=Y,v.fi({kind:w._pinching?"betweenPinch":"beginPinch",event:M}),w._pinching=1}},handleMove:function(J){var A=this,q=A.gv,L=q.lp(J);q._93O&&q._93O(J,A._data)||(q.moveSelection(L.x-A._lastLogicalPoint.x,L.y-A._lastLogicalPoint.y),A._lastLogicalPoint=L,A.autoScroll(J),A.fi({kind:q._moving?"betweenMove":"beginMove",event:J}),q._moving=1)}});var k=x.ht,Nl=k.graph._editor={Math:k.Math,Guide:{}};Nl.getStyle=function(_){var a,f=Nl.StyleMap;return f&&(a=f[_],a!==K)?a:Nl.DefaultStyleMap[_]},Nl.setStyle=function(i,L){var s=Nl.StyleMap;s||(s=Nl.StyleMap={}),s[i]=L},Nl.inEdit=function(X){return X._inXEdit===!0},Nl.startEdit=function(e){e._inXEdit=!0,Nl.Inject.doInject(e)},Nl._46O=function(b){b._inXEdit=!1,Nl.Inject.undoInject(b)},Nl.toScreenPosition=function(T,H){var s=T.tx(),M=T.ty(),R=T._zoom;return new Nl.Math.Vector2(H.x*R+s,H.y*R+M)},Nl.checkHit=function(V,b,G){return V.distanceTo(b)<G?!0:!1},Nl.toWorldPosition=function(I,r){var y=I.tx(),E=I.ty(),T=I._zoom;return{x:(r.x-y)/T,y:(r.y-E)/T}},Nl.setAntialias=function(p,z){for(var M,L=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],o=0,y=L.length;y>o&&(M=L[o],!(M in p));o++);p[M],p[M]=z},Nl.getTargetCornersOnScreen=function(g,F){if(!F)return null;var c,S=[];if(Oc(F,g)){var E=vm(g,F);c=[{x:E.x,y:E.y},{x:E.x+E.width,y:E.y},{x:E.x+E.width,y:E.y+E.height},{x:E.x,y:E.y+E.height}]}else{if(!F.getCorners)return null;c=F.getCorners()}return c.forEach(function(J){var f=Nl.toScreenPosition(g,J);S.push(f.x,f.y)}),S},Nl.log=function(){};var De=Nl.Inject={_modules:[]};De.registAsModule=function(N,m){var x={},r={};for(var z in N){var R=m.prototype[z];x[z]=R}N.getBackup=function(K){return x[K]},N.getBackups=function(){return x},r.doInject=function(){for(var t in N)"getBackup"!==t&&(m.prototype[t]=N[t])},r.undoInject=function(){for(var A in N)"getBackup"!==A&&(m.prototype[A]=x[A])},De._modules.push(r)},De.doInject=function(V){for(var O,l=De._modules,s=0,S=l.length;S>s;s++)O=l[s],O.doInject(V)},De.undoInject=function(x){for(var c,e=De._modules,Y=0,U=e.length;U>Y;Y++)c=e[Y],c.undoInject(x)};var Ol=k.graph.EditInteractor=function(O){var n=this,d=D.createElement("canvas");d.className="editCanvas",d.style.position="absolute",n._styleMap={},n._canvas=d,n._context=d.getContext("2d"),Ol.superClass.constructor.call(n,O),Nl.setAntialias(n._context,!1),n._subModules=[new Nl.Anchor(n),new Nl.RotateX(n),new Nl.Rect(n),new Nl.Curve(n),new Nl.MoveHelper(n)],n._gridGuide=new Nl.Guide.Grid(n),n._rectGuide=new Nl.Guide.Rect(n)},ih=Ol;k.Default.def(Ol,k.graph.Interactor,{ms_edit:1,ms_fire:1}),C.defineProperties(Ol.prototype,{editDetail:{get:function(){var n=!!this._editDetail;return n},set:function(F){var W=this,r=W._editDetail;r!==F&&(W._editDetail=F,W.gv._editing=F,W.fp("editDetail",r,F),W.fp("pointsEditingMode",r,F),W.fi({kind:F?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(R){(!this._editDetail||R)&&(this.gv._editing=R,R||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(t){this._editing=t,this.gvEditing=t}},pointsEditingMode:{get:function(){return this.editDetail},set:function(p){var E=this;E.editDetail!==p&&(p?E._tryEnterEditDetailMode():E._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var u=this._gridEnabled;if(!u)return!1;var Y=this.gv;return Y?!0:!0},set:function(i){i!==this._gridEnabled&&(this._gridEnabled=i,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(k){k!==this._agEnabled&&(this._agEnabled=k,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Ol.prototype.getSubModule=function(H){var j,b,o,B=this._subModules;for(b=0,o=B.length;o>b;b++)if(j=B[b],j.catalog===H)return j},Ol.prototype.invokeSubModule=function(j,U){var s=this,y=s._subModules;if(y)for(var $,a,L,E=Array.prototype.slice.call(arguments,2),P=0,e=y.length;e>P;P++)if($=y[P],a=$[j],a&&(L=a.apply($,E),L!=K&&U))return $},Ol.prototype.invokeSubModuleInverse=function(Y,u){var N=this,w=N._subModules;if(w)for(var V,J,E,t=Array.prototype.slice.call(arguments,2),O=w.length-1;O>=0;O--)if(V=w[O],J=V[Y],J&&(E=J.apply(V,t),E!=K&&u))return V},Ol.prototype.setUp=function(){Nl.log("setUp");var i=this,f=i.gv,Z=f.getView(),Q=i._canvas;Ol.superClass.setUp.call(i),f.setEditInteractor(i),f._79O?Z.insertBefore(Q,f._79O):Z.appendChild(Q),Nl.startEdit(f),i.invokeSubModule("setUp"),f.dm().mm(i._onDataModelChanged,i),f.dm().md(i._onDataPropertyChanged,i)},Ol.prototype.tearDown=function(){Nl.log("tearDown");var X=this,b=X.gv,n=b.getView();X._resetCustomCursorStyle(),Ol.superClass.tearDown.call(X),b.dm().umm(X._onDataModelChanged,X),b.dm().umd(X._onDataPropertyChanged,X),b.setEditInteractor(null),n.removeChild(X._canvas),X._drawTimer&&(W(X._drawTimer),X._drawTimer=null),Nl._46O(b),X.invokeSubModule("tearDown")},Ol.prototype._onDataModelChanged=function(m){var x=this;("clear"===m.kind||"remove"===m.kind&&x.editDetail&&m.data===x.getSubModule("Curve").target)&&(x.editDetail=!1,x._42())},Ol.prototype._onDataPropertyChanged=function(g){var x=this;if(x.editDetail){var j=x.getSubModule("Curve"),W=g.data;W===j.target&&(W._writing||j._handleDataChanged())}},Ol.prototype.clear=function(){Nl.log("clear")},Ol.prototype.redraw=function(){this._42()},Ol.prototype._42=function(){var n=this;n._drawTimer||(n._drawTimer=H(function(){n._drawTimer=null,n.drawImpl()},0))},Ol.prototype.drawImpl=function(){var v;for(v in{_42:!0})break;return function(){var l=this,U=l._canvas,E=l.gv,Y=E.getWidth(),t=E.getHeight(),s=l._context,a=k.Default.getInternal();(U.width!==Y||U.height!==t)&&a.setCanvas(U,Y,t),s.clearRect(0,0,U.width,U.height);var D=l._getValidSelection();s.save();var A=k.Default.devicePixelRatio;s.scale(A,A),l._gridGuide._42(),l.invokeSubModuleInverse(v,!1,s,E,D),l._rectGuide._42(),s.restore()}}(),Ol.prototype._getValidSelection=function(){var J=this,O=J.gv,C=O.sm().getSelection(),P=[];return C.each(function(B){O.isVisible(B)&&O.isEditable(B)&&P.push(B)}),P},Ol.prototype.handle_touchmove=function(D){return this.handle_mousemove(D)},Ol.prototype.handle_mousemove=function(r){if(!k.Default.isDragging()){var M=this;(M.editDetail||!_f())&&(M.gvEditing=!1,M._checkEdit(r)&&(M.gvEditing=!0))}},Ol.prototype.handle_touchstart=function(W){return this.handle_mousedown(W)},Ol.prototype.handle_mousedown=function(V){xf(V);var _=this;if(_.editDetail||!_f()){if(yn(V)&&!V.clickThrough){if(_.editDetail){if(_._tryQuitEditDetailMode(V))return}else if(_._tryEnterEditDetailMode())return;_.gv.dm().beginTransaction();var R=_.invokeSubModule("handleDoubleClick",!0,V);if(_.gv.dm().endTransaction(),R)return}var C=_._checkEdit(V);C&&(_._downPosition=_._getLogicalPoint(V),_.gv.dm().beginTransaction(),C.startEdit(_,V),_.editing=!0)}},Ol.prototype._checkEdit=function(C){var o=this,x=o.gv,g=o._getLogicalPoint(C),Z=o.invokeSubModule("check",!0,x,C,g)||null;return o._editMod=Z,Z},Ol.prototype.handleWindowTouchMove=function(Z){return this.handleWindowMouseMove(Z)},Ol.prototype.handleWindowMouseMove=function(a){var v=this,r=v._downPosition;if(r){var o=v._getLogicalPoint(a);if(o.distanceTo(r)<v.getStyle("moveSensitivity"))return;delete v._downPosition}var s=v._editMod;s&&s.handleEdit(v.gv,a)},Ol.prototype._getLogicalPoint=function(w){var I=this,x=k.Default.getLogicalPoint(w,I._canvas);return new Nl.Math.Vector2(x)},Ol.prototype.handleWindowTouchEnd=function(I){return this.handleWindowMouseUp(I)},Ol.prototype.handleWindowMouseUp=function(){var p;for(p in{_46O:!0})break;return function(E){var n=this;n.editing=!1,n.setCursor("default"),n.invokeSubModule(p,!1,E),n._42(),n.gv.dm().endTransaction()}}(),Ol.prototype.handle_mousewheel=function(y){var F=this;xf(y),F.invokeSubModule("preHandleScroll",!0)||F.gv.handleScroll(y,y.wheelDelta)},Ol.prototype.handleDelete=function(){var u=this;if(!u.editDetail){u.gv.dm().beginTransaction();var R=u.invokeSubModule("handleNormalStateDelete",!0);return u.gv.dm().endTransaction(),R||u.gv.removeSelection(),void 0}u.gv.dm().beginTransaction(),u.invokeSubModule("handleDelete",!0),u.gv.dm().endTransaction(),u._42()},Ol.prototype.handle_keydown=function(U){var n=this;if((U.metaKey||U.ctrlKey)&&n._42(),_f(U)&&!n.editing)return n.gvEditing=!1,n.setCursor("default"),n._42(),void 0;var O=ve(U);return n.editDetail?((O||_g(U))&&(n.editDetail=!1,n._42()),n.gv.dm().beginTransaction(),n.invokeSubModule("handle_keydown",!0,U),n.gv.dm().endTransaction(),void 0):(n.gv.dm().beginTransaction(),n.invokeSubModule("handleNormalStateKeyDown",!0,U),n.gv.dm().endTransaction(),O&&n._tryEnterEditDetailMode(),void 0)},Ol.prototype.handle_keyup=function(W){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,W),this.gv.dm().endTransaction()},Ol.prototype._tryEnterEditDetailMode=function(){var i=this;return!i.editDetail&&i.invokeSubModule("canEnterEditDetailMode",!0)&&1===i._getValidSelection().length?(i.editDetail=!0,i._42(),!0):void 0},Ol.prototype._tryQuitEditDetailMode=function(o){var U=this;if(U.editDetail){var c=U.gv,I=U.getSubModule("Curve").target;return o&&c.getDataAt(o)===I?void 0:(U.editDetail=!1,U._42(),!0)}},Ol.prototype.setStyle=function(n,p,g){var e=this;g?Nl.setStyle(n,p):e._styleMap[n]=p,e.fp("styleChanged",null,{key:n,value:p,base:g}),e._42()},Ol.prototype.getStyle=function(F){var M=this,A=M._styleMap[F];return A!==K?A:Nl.getStyle(F)},Ol.prototype.setCursor=function(h){this._resetCustomCursorStyle(),k.graph.EditInteractor.superClass.setCursor.call(this,h)},Ol.prototype._resetCustomCursorStyle=function(){var o=this;if(o._customStyle){var i=this.gv.getView();i.classList&&i.classList.remove&&i.classList.remove(o._customStyle),o._customStyle=null}},Ol.prototype._setRotateCursor=function(W){var h=this,b=h._cursorFactory;b||(b=h._cursorFactory=new Nl.CursorFactory(h));var R=b.getRotateCursor(W),w=h.gv.getView();h._resetCustomCursorStyle(),h._customStyle=R,w.classList&&w.classList.add&&w.classList.add(R)};var wl=Nl.Group=function(W){var z=this;z._entities=W,z._64O=0,z._position={x:0,y:0},z._scale={x:1,y:1},z._anchor={x:.5,y:.5},z._anchor2={x:.5,y:.5}};wl.prototype={},wl.prototype.constructor=wl;var Tg=null;wl.findOrCreateGroup=function(Z){if(Tg&&Tg.checkIsMe(Z))return Tg;var m=new Nl.Group(Z);return m.getKeyOb()?(Tg=m,m):void 0},wl.prototype.checkIsMe=function(K){var w=this._entities;if(w.length!==K.length)return!1;var k,c={},s=K.length;for(k=0;s>k;k++)c[K[k]._id]=!0;for(k=0;s>k;k++)if(!c[w[k]._id])return!1;return!0},wl.prototype.getRotation=function(){return this._64O},wl.prototype.getPosition=function(){return this._position},wl.prototype.getAnchor=function(){return this._anchor},wl.prototype.getWidth=function(){return this._width},wl.prototype.getScale=function(){return this._scale},wl.prototype.getSize=function(){return{width:this._width,height:this._height}},wl.prototype.getHeight=function(){return this._height},wl.prototype.getKeyOb=function(){for(var A=this._entities,p=A.length-1;p>=0;p--){var M=A[p];if(this.isNode(M))return M}},wl.prototype.getAnchor2=function(){var c=this,C=c.rotateCenter;if(C)return C;var a=c.getKeyOb();if(!a)return c._anchor;var S=c._anchor2,X=a.getMatrix();return X.tf({x:a.getWidth()*(S.x-a.getAnchor().x),y:a.getHeight()*(S.y-a.getAnchor().y)})},wl.prototype.setAnchor2=function(L,o){var e=this,Z=e.getKeyOb();if(Z){var l,j=Z.getMatrix();l="number"==typeof L?{x:L,y:o}:L;var k=j.tfi(l);e._anchor2={x:Z.getAnchor().x+k.x/Z.getWidth(),y:Z.getAnchor().y+k.y/Z.getHeight()}}},wl.prototype.setRotation=function(){},wl.prototype.beginRotate=function(H){this.rotateCenter=H.pos,this.rotateMode=H.groupRotateMode},wl.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},wl.prototype.addRotation=function(C,O){return"batch"===O?this._addRotationInBatchMode(C):"block"===O?this._addRotationInBlockMode(C):void 0},wl.prototype._addRotationInBlockMode=function(z){var B=this,i=B.rotateCenter||B.getPosition();B._entities.forEach(function(o){if(B.isNode(o)){var E=o.getMatrix();E.translate(-i.x,-i.y),E.rotate(z),E.translate(i.x,i.y);var m=Math.sign(o.getScale().x);o.setRotation(g(E.b*m,E.a*m)),o.setPosition(E.tx,E.ty)}})},wl.prototype._addRotationInBatchMode=function(P){var i=this,q=i._anchor2;i._entities.forEach(function(p){if(i.isNode(p)){var J=p.getAnchor(),I=p.getMatrix(),r=I.tf({x:p.getWidth()*(q.x-J.x),y:p.getHeight()*(q.y-J.y)}),m=new Nl.Math.Matrix2d;m.set(I.a,I.b,I.c,I.d,I.tx,I.ty),m.translate(-r.x,-r.y),m.rotate(P),m.translate(r.x,r.y);var W=Math.sign(p.getScale().x);p.setRotation(g(m.b*W,m.a*W)),p.setPosition(m.tx,m.ty)}})},wl.prototype.setPosition=function(w){var t,T,W,P,s=this,c=s._position,R=w.x-c.x,h=w.y-c.y,A=s._entities;for(T=0,W=A.length;W>T;T++)t=A[T],vs(t)&&(P=t.getPosition(),t.setPosition(P.x+R,P.y+h));s._position=w},wl.prototype.setScale=function(a,H){var J=this,m=a/J._scale.x,x=H/J._scale.y;J._adjustChildScaleOrSize(m,x,"size"),J._scale={x:a,y:H}},wl.prototype.getRect=function(){var f=this,z=f._position,G=f._width,$=f._height;return{x:z.x-G/2,y:z.y-$/2,width:G,height:$}},wl.prototype.setSize=function(H,j){var $=this,H=Math.max(1,H),j=Math.max(1,j),w=H/$._width,I=j/$._height;$._adjustChildScaleOrSize(w,I,"size"),$._width=H,$._height=j},wl.prototype._adjustChildScaleOrSize=function(A,t,p){var a,w,D,k,J,Z,f,l,z,P,b,S,j,d,e=this,u=e._position,q=e._entities,h=new Nl.Math.Matrix2d;for(w=0,D=q.length;D>w;w++)if(a=q[w],e.isNode(a)){if(k=a.getPosition(),J=a.getRotation(),Z=a.getWidth(),f=a.getHeight(),l=a.getScale(),b=l.x*Z,S=l.y*f,h.identity().scale(b,S).rotate(J).translate(k.x,k.y).translate(-u.x,-u.y).rotate(-e._64O),J=g(h.b*Math.sign(b),h.a*Math.sign(b)),h.scale(A,t),z=Math.cos(J),P=Math.sin(J),Math.abs(z)<.001?(j=h.b/P,d=-h.c/P):(j=h.a/z,d=h.d/z),"scale"===p)a.setScale(j/Z,d/f);else if("size"===p){var o=j/l.x,F=d/l.y;a.setScale(wq(j)*Math.abs(l.x),wq(d)*Math.abs(l.y)),a.setSize(Math.max(.1,Math.abs(o)),Math.max(.1,Math.abs(F)))}h.rotate(e._64O).translate(u.x,u.y),a.setPosition(h.tx,h.ty)}},wl.prototype.getMatrix=function(){var w=this,h=w._position,c=k.Default.getInternal(),s=w._scale;return new c.Mat(w._64O,h.x,h.y,s.x,s.y)},wl.prototype.toGlobal=function(O){return this.getMatrix().tf(O)},wl.prototype.getCorners=function(){var x=this,i=x._width,S=x._height,C=x._anchor,r=-i*C.x,X=-S*C.y,l=x.getMatrix();return[l.tf(r,X),l.tf(r,X+S),l.tf(r+i,X+S),l.tf(r+i,X)]},wl.prototype.calcInfo=function(){var Z,h,W,q,o,C,M=this,v=[],l=M._entities,$=M._64O;for(q=0,o=l.length;o>q;q++)C=l[q],M.isNode(C)&&C.getCorners&&v.push.apply(v,C.getCorners());if(v.length){var P=Math.cos(-$),O=Math.sin(-$),n=1/0,F=-1/0,e=1/0,D=-1/0;for(q=0,o=v.length;o>q;q++)W=v[q],Z=W.x,h=W.y,W.x=P*Z-O*h,W.y=O*Z+P*h,n=Math.min(n,W.x),F=Math.max(F,W.x),e=Math.min(e,W.y),D=Math.max(D,W.y);M._width=(F-n)/M._scale.x,M._height=(D-e)/M._scale.y,P=Math.cos($),O=Math.sin($);var _=M._anchor;Z=n+(F-n)*_.x,h=e+(D-e)*_.y,M._position={x:P*Z-O*h,y:O*Z+P*h}}},wl.prototype.isNode=function(y){return vs(y)?Oc(y)?!1:!0:!1},wl.prototype._42=function(F,C,v){var h,l,r,c,H,L,U,a,B=this,w=B._entities,i=B.rotateMode;for("batch"===i&&(a=B.getKeyOb()),h=0,l=w.length;l>h;h++)r=w[h],B.isNode(r)&&(L=r.getRect(),c=Nl.toScreenPosition(v,{x:L.x,y:L.y}),H=Nl.toScreenPosition(v,{x:L.x+L.width,y:L.y+L.height}),U={min:c,max:H},r===a&&(U.isKeyOb=!0),Nl.Icons.DrawIcon(F,C,Nl.Icons.GroupSubEntityRect,U))};var Fh=Nl.CurveActiving=function(S,b){this._curve=S,this._interactor=S._interactor;for(var $ in b)this[$]=b[$]};Fh.prototype={},Fh.prototype.constructor=Fh,C.defineProperties(Fh.prototype,{point:{get:function(){return this._point},set:function($){var X=this;X._point=$,X.editingCtrl||X._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(F){var G=this;G._pairs=F,G.editingCtrl&&G._firePointChange()}}}),Fh.prototype._firePointChange=function(){var B=this,M=B.getCurrentEditingPoint();if(!M)return e.fi({kind:"selectPoint"}),void 0;var e=B._interactor,k=this._curve.target;if(k){var _=Nl.getDataMatrix(k).invert(),N=M.e;M=_.apply(Nl.toWorldPosition(e.gv,M)),M.e=N;var c=B._lastFirePoint;c&&Math.abs(M.x-c.x)<1e-5&&Math.abs(M.y-c.y)<1e-5&&(M.e==K&&c.e==K||Math.abs(M.e-c.e)<1e-5)||(B._lastFirePoint=M,e.fi({kind:"selectPoint",x:M.x,y:M.y,e:M.e}))}},Fh.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Fh.prototype.getCurrentEditingPoint=function(){var W=this,H=W.editingCtrl;if(H){var T=W.pairs;if(T){var V=T[H.pairId],U=V[H.type];if(U)return U}}return W._point};var ph=Nl.CursorFactory=function(U){var x=this;x._interactor=U,x._rotateCursorStyles={}};ph.prototype={},ph.prototype.constructor=ph,ph.prototype.getRotateCursor=function(D){var h=this;0>D&&(D+=2*Math.PI);var c=h._interactor,a=c.getStyle("rotateCursorSize"),Z=c.getStyle("rotateCursorRound"),g=Math.round(180*(D/Math.PI)/Z);g*Z>=360&&(g=0);var E=h._rotateCursorStyles,y="htCustomRotateStyle_"+a+"_"+Z+"_"+g;return E[y]||(h._produceRotateCursor(y,a,Z,g),E[y]=!0),y},ph.prototype._produceRotateCursor=function(B,p,Y,X){var x=this;x._interactor;var w=x._canvas;w||(w=x._canvas=D.createElement("canvas")),w.width=w.height=p*devicePixelRatio,w.style.width=w.style.height=p+" px";var l=w.getContext("2d");Nl.setAntialias(l,!1),l.scale(devicePixelRatio,devicePixelRatio);var v,h,i,Z,I,b=Math.round(p/2),P=""+b+" "+b+",auto !important;";v=Math.PI/180*X*Y,l.clearRect(0,0,p,p),l.save(),l.scale(p/32,p/32),l.translate(16,16),l.rotate(v+Math.PI/2),l.beginPath(),l.moveTo(-8,0),l.lineTo(-8,3),l.lineTo(-5,3),l.moveTo(8,0),l.lineTo(8,3),l.lineTo(5,3),l.moveTo(-8,3),l.quadraticCurveTo(0,-6,8,3),l.restore(),l.strokeStyle="white",l.lineWidth=4,l.stroke(),l.strokeStyle="black",l.lineWidth=2,l.stroke(),h=JSON.stringify(w.toDataURL()),Z="cursor:url("+h+")"+P,1!==devicePixelRatio&&(i='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+p+'px" height="'+p+'px"><image xlink:href='+h+' width="'+p+'" height="'+p+'"/></svg>',Z+="cursor:url(data:image/svg+xml;base64,"+btoa(i)+")"+P,Z+="cursor:-webkit-image-set(url("+h+")"+devicePixelRatio+"x,url("+h+")1x)"+P),I=D.createElement("style"),I.textContent="body."+B+" *, ."+B+"{"+Z+"}",D.head.appendChild(I)};var Dm=Nl.Guide.Grid=function(C){var x=this;x._interactor=C,x._alignmentGuideId=0,x._xAlignmentGuide=[],x._yAlignmentGuide=[]};Dm.prototype={},Dm.prototype.constructor=Dm,C.defineProperties(Dm.prototype,{gridBlockSize:{get:function(){var J=this;return J._gridBlockSize||J._interactor.getStyle("gridBlockSize")},set:function(N){this._gridBlockSize=N,this._interactor._42()}},gridThickLinesEvery:{get:function(){var j=this;return j._gridThickLinesEvery||j._interactor.getStyle("gridThickLinesEvery")},set:function(g){this._gridThickLinesEvery=g,this._interactor._42()}},gridEnabled:{get:function(){var g=this,W=g._interactor;return W.gridEnabled&&g.isValidGrid()}}}),Dm.prototype._42=function(){var T=this,G=T._interactor;T.gridEnabled&&T.drawGrid(),G.alignmentGuideEnabled&&T.drawAlignmentGuide()},Dm.prototype.makeMatrix=function(){var t=this,j=t._interactor.getStyle("gridAngle"),S=t._interactor.getStyle("gridRotation"),k=new Nl.Math.Matrix2d,$=Math.sin(j),f=Math.cos(j);return k.set(1,0,f,$,0,0),k.rotate(S),k},Dm.prototype.isValidGrid=function(){var U=this,k=Math.PI,V=U._interactor,D=V.gv;if(D._zoom<V.getStyle("gridZoomThreshold"))return!1;var G=V.getStyle("gridAngle"),J=Math.abs(180*(G%k/k)),r=1-1e-8;return r>J||J>180-r?!1:!0},Dm.prototype.drawAlignmentGuide=function(){var F=this,q=F._interactor,R=q.gv,Q=q._canvas,o=q._context,y=Q.width,b=Q.height,k=R.tx(),i=R.ty(),G=R._zoom;o.beginPath(),o.strokeStyle=q.getStyle("gridAlignmentGuideColor"),o.lineWidth=1,F._xAlignmentGuide.forEach(function(d){var u=d.p*G+k;o.moveTo(u,0),o.lineTo(u,b)}),F._yAlignmentGuide.forEach(function(E){var B=E.p*G+i;o.moveTo(0,B),o.lineTo(y,B)}),o.stroke()},Dm.prototype.drawGrid=function(){function r(s,f,V,w){var C=Nl.toScreenPosition(k,n.apply({x:s,y:f})),y=Nl.toScreenPosition(k,n.apply({x:V,y:w}));D.moveTo(C.x,C.y),D.lineTo(y.x,y.y)}var z=this,c=z._interactor,e=z.gridBlockSize,P=z.gridThickLinesEvery,g=c.getStyle("gridThickColor"),t=c.getStyle("gridLightColor"),k=c.gv,M=c._canvas,D=c._context,X=M.width,m=M.height,n=z.makeMatrix(),C=n.applyInverse(Nl.toWorldPosition(k,{x:0,y:0})),T=n.applyInverse(Nl.toWorldPosition(k,{x:X,y:0})),i=n.applyInverse(Nl.toWorldPosition(k,{x:0,y:m})),y=n.applyInverse(Nl.toWorldPosition(k,{x:X,y:m})),f=Math.min(C.x,T.x,i.x,y.x),N=Math.max(C.x,T.x,i.x,y.x),W=Math.min(C.y,T.y,i.y,y.y),l=Math.max(C.y,T.y,i.y,y.y);X=N-f,m=l-W;var B=Math.ceil(f/e),b=Math.floor(N/e),G=Math.ceil(W/e),Q=Math.floor(l/e);k.tx(),k.ty(),k._zoom;var O,L,Y;for(D.save(),D.lineWidth=1,D.beginPath(),D.strokeStyle=g,Y=Math.ceil(B/P)*P;b>=Y;Y+=P)O=Y*e,r(O,W,O,l);for(Y=Math.ceil(G/P)*P;Q>=Y;Y+=P)L=Y*e,r(f,L,N,L);for(D.stroke(),D.beginPath(),D.strokeStyle=t,Y=B;b>=Y;Y++)0!==Y%P&&(O=Y*e,r(O,W,O,l));for(Y=G;Q>=Y;Y++)0!==Y%P&&(L=Y*e,r(f,L,N,L));D.stroke(),D.restore()},Dm.prototype.getAlignmentGuides=function(){var v=this;return{x:v._xAlignmentGuide,y:v._yAlignmentGuide}},Dm.prototype.addAlignmentGuide=function(O,i,A){var p=this,s="x"===O?p._xAlignmentGuide:p._yAlignmentGuide,A=A?A:++p._alignmentGuideId,w={p:i,id:A};if(s.length){var H=p._findClosestAlignmentGuide(w.p,s);H.dis<0?s.splice(H.index+1,0,w):s.splice(H.index,0,w)}else s.push(w);return p._interactor._42(),A},Dm.prototype.findClosest=function(p,C,S){var Q=this,M=Q._interactor,I=M.gv;S&&(p=Nl.toWorldPosition(I,p));var f,D,E,g=1/0,T=1/0,L=p.x,c=p.y;if(Q.gridEnabled){var e=Q.gridBlockSize,z=Q.makeMatrix(),_=z.applyInverse(p);_=z.apply({x:Math.round(_.x/e)*e,y:Math.round(_.y/e)*e}),g=_.x-L,T=_.y-c,E=!0}if(M.alignmentGuideEnabled&&(f=Q._findClosestAlignmentGuide(L,Q._xAlignmentGuide).dis,D=Q._findClosestAlignmentGuide(c,Q._yAlignmentGuide).dis,Math.abs(f)<Math.abs(g)&&(g=f,E=!0),Math.abs(D)<Math.abs(T)&&(T=D,E=!0)),E){E=!1;var V=I._zoom,N=M.getStyle("smartGuideSensitivity")/V,K={};if(Math.abs(g)<N&&"y"!==C&&(K.x=S?g*V:g,E=!0),Math.abs(T)<N&&"x"!==C&&(K.y=S?T*V:T,E=!0),E)return K}},Dm.prototype._findClosestAlignmentGuide=function(d,T){if(!T.length)return{dis:1/0};for(var V,l=0,b=T.length-1;b-l>1;)V=Math.floor((l+b)/2),T[V].p<d?l=V:b=V;var I=T[l].p-d,Z=T[b].p-d;return Math.abs(I)<=Math.abs(Z)?{line:T[l],dis:I,index:l}:{line:T[b],dis:Z,index:b}},Dm.prototype.removeAllAlignmentGuide=function(E){var Y=this;"y"!==E&&(Y._xAlignmentGuide=[]),"x"!==E&&(Y._yAlignmentGuide=[]),Y._interactor._42()},Dm.prototype.removeAlignmentGuide=function(s){for(var E,Z,i,x=this,X=x._xAlignmentGuide,l=0;2>l;l++)for(X=0===l?x._xAlignmentGuide:x._yAlignmentGuide,E=0,Z=X.length;Z>E;E++)if(i=X[E],i.id===s)return X.splice(E,1),x._interactor._42(),{axis:0===l?"x":"y",position:i.p};return!1},Dm.prototype.adjustAlignmentGuide=function(J,Y){var U=this,b=U.removeAlignmentGuide(J);return b?(U.addAlignmentGuide(b.axis,Y,J),!0):!1};var $g=Nl.Guide.Rect=function(n){var J=this;J._interactor=n};$g.prototype={},$g.prototype.constructor=$g,$g.prototype.gatherRects=function(){var h,B,i,f,E=this,X=E._interactor.gv,v=[],m=[],M={x:v,y:m},J={},d=X.getDataModel(),s=d.a("width"),g=d.a("height");
s&&g&&(h=0,B=0,i=s,f=g,v.push({node:d,type:0,p:h},{node:d,type:1,p:h+i/2},{node:d,type:2,p:h+i}),m.push({node:d,type:0,p:B},{node:d,type:1,p:B+f/2},{node:d,type:2,p:B+f}),J[d._id||0]={x:h,y:B,width:i,height:f}),d.each(function(j){if(vs(j)&&!X.isSelected(j)&&X.isVisible(j)){var U=!1;if(X.sm().getSelection().each(function(J){U||(j.isHostOn(J)?U=!0:j.isDescendantOf(J)&&(U=!0))}),!U){var Y=j.getRect();h=Y.x,B=Y.y,i=Y.width,f=Y.height,v.push({node:j,type:0,p:h},{node:j,type:1,p:h+i/2},{node:j,type:2,p:h+i}),m.push({node:j,type:0,p:B},{node:j,type:1,p:B+f/2},{node:j,type:2,p:B+f}),J[j._id]=Y}}}),v.sort(function(Z,e){return Z.p-e.p}),m.sort(function(z,l){return z.p-l.p}),E._grid=M,E._87I=J},$g.prototype.gatherLines=function(w,A,H){var L,v,x,k,i,g,S,T,c,f,b,R,Q=this,M=[Q.findClosest({x:w.x,y:w.y},A),Q.findClosest({x:w.x+w.w/2,y:w.y+w.h/2},A),Q.findClosest({x:w.x+w.w,y:w.y+w.h},A)],y={},t=Q._87I;H=H||255;var B,Y;for(Q._guideLine=[],L=0;2>L;L++)for(y={},0===L?(k="y",T=w.x,c=T+w.w):(k="x",T=w.y,c=T+w.h),v=0;3>v;v++)i=M[v],i&&isFinite(i[k])&&(B=1<<3*L+v,H&B&&(g=i[k+"Line"],S=g.node,Y=S._id||0,y[Y]||(y[Y]=!0,R=t[Y],"y"===k?(f=R.x,b=R.x+R.width):(f=R.y,b=R.y+R.height),x=g.p,Q._guideLine.push({type:k,a:T,b:c,c:f,d:b,p:x,center:1===g.type}))))},$g.prototype._binarySearchClosest=function(z,m){if(!m.length)return{dis:1/0};for(var C,B=0,y=m.length-1;y-B>1;)C=Math.floor((B+y)/2),m[C].p<z?B=C:y=C;var g=m[B].p-z,f=m[y].p-z;return Math.abs(g)<=Math.abs(f)?{line:m[B],dis:g}:{line:m[y],dis:f}},$g.prototype.findClosest=function(v,e,Z){var P=this,I=P._interactor,Y=I.gv,$=P._grid;Z&&(v=Nl.toWorldPosition(Y,v));var F,W=P._binarySearchClosest(v.x,$.x),d=P._binarySearchClosest(v.y,$.y),w=W.dis,h=d.dis,M=Y._zoom,o=I.getStyle("smartGuideSensitivity")/M,f={};return Math.abs(w)<o&&"y"!==e&&(f.x=Z?w*M:w,f.xLine=W.line,F=!0),Math.abs(h)<o&&"x"!==e&&(f.y=Z?h*M:h,f.yLine=d.line,F=!0),F?f:void 0},$g.prototype._42=function(){var W=this,O=W._guideLine;if(O&&!k.Default.isCtrlDown()){var w,H,C,g,b,B,p,v,Q,f,i,S,G,T,q,N,K,V=W._interactor,l=V.gv,Y=V._context,z=l.tx(),L=l.ty(),F=l._zoom,E=V.getStyle("guideLineTextSpacing");for(w=0,H=O.length;H>w;w++)C=O[w],v=C.type,Q=C.p,f=C.a,i=C.b,S=C.c,G=C.d,T=Math.min(f,S),q=Math.max(i,G),"x"===v?(g=Q*F+z,b=T*F+L,B=g,p=q*F+L):(g=T*F+z,b=Q*F+L,B=q*F+z,p=b),Nl.Icons.DrawIcon(V,Y,Nl.Icons.MoveLineGuide,{rect:[g,b,B,p],center:C.center}),G>=f&&i>=S||(T=f>G?G:i,q=f>G?f:S,K=q-T,"x"===v?(C.center2center||(g-=E,B=g),b=T*F+L,p=q*F+L,N=Nl.Icons.MoveLineGuideDistanceV):"y"===v&&(C.center2center||(b-=E,p=b),g=T*F+z,B=q*F+z,N=Nl.Icons.MoveLineGuideDistanceH),Nl.Icons.DrawIcon(V,Y,N,{x0:g,y0:b,x1:B,y1:p,dis:K}))}},$g.prototype.clear=function(){this._guideLine=null},Nl.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var ye=Nl.Icons={},vc=1e4,Tq=null,hs="rgb(51,153,255)",ss="rgb(183,232,135)",_h="rgb(255,204,153)",ig=6;k.Default.setImage("Icons.RectPoint",{width:ig,height:ig,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:hs,rect:[0,0,ig,ig]}]});var Gg="#e000e0";ye.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var v=ye.GroupSubEntityRect.data;if(!v)return[];var V=v.min,d=v.max;return[V.x,V.y,V.x,d.y,d.x,d.y,d.x,V.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return ye.GroupSubEntityRect.data.isKeyOb?Gg:"#666666"}}}]},ye.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[ye.Line.data.P1.x,ye.Line.data.P1.y],ig,ig]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[ye.Line.data.P2.x,ye.Line.data.P2.y],ig,ig]}}}]},ye.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return ye.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},ye.Rect={comps:[{type:"shape",points:{func:function(){var w=ye.Rect.data;if(!w)return[];var _=w.LT,l=w.LB,s=w.RB,L=w.RT;return[_.x,_.y,l.x,l.y,s.x,s.y,L.x,L.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:hs},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ye.Rect.data.rotation}},rect:{func:function(){return[[ye.Rect.data.LT.x,ye.Rect.data.LT.y],ig,ig]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ye.Rect.data.rotation}},rect:{func:function(){return[[ye.Rect.data.LB.x,ye.Rect.data.LB.y],ig,ig]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ye.Rect.data.rotation}},rect:{func:function(){return[[ye.Rect.data.RB.x,ye.Rect.data.RB.y],ig,ig]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ye.Rect.data.rotation}},rect:{func:function(){return[[ye.Rect.data.RT.x,ye.Rect.data.RT.y],ig,ig]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ye.Rect.data.rotation}},visible:{func:function(){return ye.Rect.data.L?!0:!1}},rect:{func:function(){return[[ye.Rect.data.L.x,ye.Rect.data.L.y],ig,ig]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ye.Rect.data.rotation}},visible:{func:function(){return ye.Rect.data.R?!0:!1}},rect:{func:function(){return[[ye.Rect.data.R.x,ye.Rect.data.R.y],ig,ig]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ye.Rect.data.rotation}},visible:{func:function(){return ye.Rect.data.T?!0:!1}},rect:{func:function(){return[[ye.Rect.data.T.x,ye.Rect.data.T.y],ig,ig]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ye.Rect.data.rotation}},visible:{func:function(){return ye.Rect.data.B?!0:!1}},rect:{func:function(){return[[ye.Rect.data.B.x,ye.Rect.data.B.y],ig,ig]}}}]};var pi=16;k.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:hs,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:hs,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),ye.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[ye.Anchor.data.POS.x,ye.Anchor.data.POS.y],pi,pi]}}}]},ye.TipShiftX=12,ye.TipShiftY=12;var Tb=[8,28];ye.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[ye.TipHelper.data.helperPos.x,ye.TipHelper.data.helperPos.y,Tb[0]*ye.TipHelper.data.size,Tb[1]]}},background:{func:function(){return Tq.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return ye.TipHelper.data.text}},rect:{func:function(){return[ye.TipHelper.data.helperPos.x,ye.TipHelper.data.helperPos.y,Tb[0]*ye.TipHelper.data.size,Tb[1]]}},color:{func:function(){return Tq.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var sq=7;ye.ShapePoint={comps:[{type:"circle",rect:{func:function(){var L=ye.ShapePoint.data.point;return[L,sq,sq]}},background:{func:function(){var M=ye.ShapePoint.data.isEnd;return M?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:hs}]},ye.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return ye.ShapeBgCurve.data.P}},segments:{func:function(){return ye.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:hs}]};var Ip=8;ye.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var W=ye.ShapeHighlighPoint.data;return[[W.x,W.y],Ip,Ip]}},background:{func:function(){return Tq.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var ym=10;ye.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var M=ye.ShapeHighlighRealPoint.data;return[[M.x,M.y],ym,ym]}},background:"#ffffff",borderWidth:2,borderColor:hs}]};var Cr=8;ye.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var _=ye.ShapeHighlighCtrlPoint.data,k=_.x,y=_.y,Z=Cr/2;return[k-Z,y-Z,k-Z,y+Z,k+Z,y+Z,k+Z,y-Z]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Tq.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Tq.getStyle("shapeCtrlPointBorderColor")||hs}}}]};var Pd=3;ye.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return ye.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Pd,borderColor:{func:function(){return Tq.getStyle("curveHighlightColor")}}}]},ye.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return ye.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},ye.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return ye.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return ye.MoveLineGuide.data.center?ss:_h}}}]};var wc=5;ye.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var B=ye.MoveLineGuideDistanceH.data,D=B.x0,b=B.y0;return[D,b-wc,D,b+wc]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:_h},{type:"shape",points:{func:function(){var O=ye.MoveLineGuideDistanceH.data,f=O.x1,F=O.y1;return[f,F-wc,f,F+wc]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:_h},{type:"text",text:{func:function(){return Math.round(ye.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var h=ye.MoveLineGuideDistanceH.data;return[[(h.x0+h.x1)/2,h.y0-10],20,20]}},color:_h,font:"12px Arial",align:"center"}]},ye.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var o=ye.MoveLineGuideDistanceV.data,x=o.x0,j=o.y0;return[x-wc,j,x+wc,j]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:_h},{type:"shape",points:{func:function(){var J=ye.MoveLineGuideDistanceV.data,v=J.x1,y=J.y1;return[v-wc,y,v+wc,y]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:_h},{type:"text",text:{func:function(){return Math.round(ye.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var a=ye.MoveLineGuideDistanceV.data;return[[a.x0-10,(a.y0+a.y1)/2],20,20]}},color:_h,font:"12px Arial",align:"center"}]},k.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),ye.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var t=ye.EdgeElevationGuide.data,h=t.x,L=t.y,i=Tq.getStyle("curveElevationIntersectSize"),w=Tq.getStyle("curveElevationGuideShift");return h+=w[0],L+=w[1],[h-i,L-i,2*i,2*i]}}}]},k.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),k.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),ye.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return ye.ConnectGuide.data.rotation}},rect:{func:function(){var D=ye.ConnectGuide.data.connect;D.x,D.y;var i=Tq.getStyle("connectGuideIntersectSize");return[[D.x,D.y],2*i,2*i]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var d=ye.ConnectGuide.data.cursorPos||ye.ConnectGuide.data.connect,y=Tq.getStyle("connectGuideIntersectSize");return[[d.x,d.y],2*y-2,2*y-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var B=ye.ConnectGuide.data.connect,_=ye.ConnectGuide.data.cursorPos||B;return[B.x,B.y,B.x+.5*(_.x-B.x),B.y,_.x+.5*(B.x-_.x),_.y,_.x,_.y]}}}]},k.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),k.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),ye.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var M=ye.ConnectGuideGarbage.data.hover;return M?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var _=ye.ConnectGuideGarbage.data,P=Tq.getStyle("connectGuideGarbageIntersectsize");return _.hover&&(P+=5),[[_.x,_.y],2*P,2*P]}}}]};var Wj=6;ye.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return ye.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var V=ye.ShapeActivingCtrl.data;return[V.point.x,V.point.y,V.c1.x,V.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:hs},{type:"shape",visible:{func:function(){return ye.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var s=ye.ShapeActivingCtrl.data;return[s.point.x,s.point.y,s.c2.x,s.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:hs},{type:"shape",visible:{func:function(){return ye.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var w=ye.ShapeActivingCtrl.data.c1,q=w.x,r=w.y,l=Wj/2;return"c1"===ye.ShapeActivingCtrl.data.hl&&(l+=.5),[q-l,r-l,q-l,r+l,q+l,r+l,q+l,r-l]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Tq.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===ye.ShapeActivingCtrl.data.hl?Tq.getStyle("shapeCtrlPointHighlightBorder")||hs:Tq.getStyle("shapeCtrlPointBorderColor")||hs}}},{type:"shape",visible:{func:function(){return ye.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var o=ye.ShapeActivingCtrl.data.c2,H=o.x,K=o.y,D=Wj/2;return"c2"===ye.ShapeActivingCtrl.data.hl&&(D+=.5),[H-D,K-D,H-D,K+D,H+D,K+D,H+D,K-D]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Tq.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===ye.ShapeActivingCtrl.data.hl?Tq.getStyle("shapeCtrlPointHighlightBorder")||hs:Tq.getStyle("shapeCtrlPointBorderColor")||hs}}}]},ye.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:hs,rect:{func:function(){return[[ye.RoundPoint.data.x,ye.RoundPoint.data.y],ig,ig]}}}]},ye.AttachPoint={comps:[{type:"rect",background:{func:function(){return ye.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:hs,rect:{func:function(){var k=ye.AttachPoint.data.isAttach?ig+4:ig;return[[ye.AttachPoint.data.x,ye.AttachPoint.data.y],k,k]}}}]},Nl.Icons.DrawIcon=function(b,s,P,i){P.width=P.height=vc,P.data=i,Tq=b,k.Default.drawImage(s,P,0,0,vc,vc)},Nl.Icons.MapPoints=function(J,F){for(var w=0,I=J.length;I>w;w++)J[w]/=F},Nl.roundTo=function(u,X,z){var f=Math.abs(u%X);return z>f||z>X-f?X*Math.round(u/X):u},Nl.toFixed=function(i){return Math.round(100*i)/100},Nl.getDataMatrix=function(W){if(W instanceof k.Shape){var S=new k.Math.Matrix2d,D=W.getPosition();return S.translate(-D.x,-D.y).scale(W.getScale().x,W.getScale().y).rotate(W.getRotation()).translate(D.x,D.y),S}return W.getMatrix?W.getMatrix():new k.Math.Matrix2d};var Cf=Nl.Math.Curve=function(){this._curves=[]};Cf.prototype={},Cf.prototype.constructor=Cf,Cf.prototype.createFromHtShape=function(I,f,E){f instanceof k.List&&(f=f.toArray());var g,P,D,C,Q,R,B,i=this,X=null,J=null,S=0,x=Nl.Math.Vector2,w=Nl.Math.CubicBezier,F=function(g){return new x(I[g],I[g+1],E?E[g/2]:K)};for(P=0,D=f.length;D>P;P++){switch(C=f[P],Q=null,C){case 1:J=F(S),X=J,S+=2;break;case 2:g=F(S),S+=2,Q=new w(J,J.clone(),g.clone(),g),J=g;break;case 3:R=F(S),g=F(S+2),S+=4,Q=new w(J,R.clone().sub(J).multiplyScalar(2/3).add(J),R.clone().sub(g).multiplyScalar(2/3).add(g),g),J=g;break;case 4:R=F(S),B=F(S+2),g=F(S+4),S+=6,Q=new w(J,R,B,g),J=g;break;case 5:if(!X)break;Q=new w(J,J.clone(),X.clone(),X),J=null,X=null}Q&&(Q._index=i._curves.length,i._curves.push(Q))}},Cf.prototype.checkPoint=function(q,s){var m,R,r,d,k,B=this,j=B._curves;for(m=0,R=j.length;R>m;m++)if(d=j[m],k=d.intersectRect(q,s,s),k.length)return r=0,k.forEach(function(F){r+=F.t}),r/=k.length,q=d.getPointAt(r),q.t=r,{bezier:d,intersection:q}},Cf.prototype.insertKnot=function(d,L){var S=d.insertKnot(L),H=this,O=H._curves;O.splice(d._index,1,S[0],S[1])},Cf.prototype._isCloseEnough=function(J,T){return Math.abs(J.x-T.x)<1e-6&&Math.abs(J.y-T.y)<1e-6},Cf.prototype._isSamePoint=function(l,p){return l===p},Cf.prototype.moveRealPoint=function(o,D){var H=this,b=H._curves,c=D.clone().sub(o);b.forEach(function(r){var N=r._p1;r._p2,r._p3;var f=r._p4;H._isSamePoint(N,o)&&(r._p2.add(c),r._p1=D),H._isSamePoint(f,o)&&(r._p3.add(c),r._p4=D)})},Cf.prototype.moveCtrlDueToRealPointMovement=function(I,U){var s=this,w=s._curves,K=function(k){k.add(U),k.e&&U.e&&(k.e+=U.e)};w.forEach(function(H){var h=H._p1;H._p2,H._p3;var W=H._p4;s._isSamePoint(h,I)&&K(H._p2),s._isSamePoint(W,I)&&K(H._p3)})},Cf.prototype.moveCtrlPoint=function(_,B,q){var o=_[q];if(o){o.e!==K&&(B.e=o.e);var s=this,L=s._curves;B.clone().sub(o),L.forEach(function(l){var Y;"c2"===q?Y="_p2":"c1"===q&&(Y="_p3"),s._isSamePoint(l[Y],o)&&(l[Y]=B)}),_[q]=B}},Cf.prototype.deleteRealPoint=function(u,Q){var U,P,d,j,M,y,D,S=this,T=S._curves,q={},O=[],Z=Nl.Math.CubicBezier;for(P=0,d=T.length;d>P;P++)U=T[P],j=U._p1,M=U._p2,y=U._p3,D=U._p4,(q[P]||!S._isSamePoint(j,u))&&(S._isSamePoint(D,u)?d>P+1&&S._isSamePoint(T[P+1]._p1,u)&&(Q||O.push(new Z(j,M,T[P+1]._p3,T[P+1]._p4))):O.push(U));S._curves=O},Cf.prototype.findPairs=function(q,I){var V,t,k,e,i,j,s,n,M=this,P=M._curves,d={},m=[];for(t=0,k=P.length;k>t;t++)V=P[t],e=V._p1,i=V._p2,j=V._p3,s=V._p4,!d[t]&&M._isSamePoint(e,q)&&(I?m.push({point:e,r2:s}):m.push({point:e,c2:i})),M._isSamePoint(s,q)&&(n=I?{point:s,r1:e}:{point:s,c1:j},k>t+1&&M._isSamePoint(P[t+1]._p1,q)&&(I?n.r2=P[t+1]._p4:n.c2=P[t+1]._p2,d[t+1]=!0),m.push(n));return m},Cf.prototype.toHtShape=function(){var M=this,w=M._curves,B=[],N=[],C={x:1/0,y:1/0};return w.forEach(function(F){var w=F._p1,m=F._p2,b=F._p3,A=F._p4;return M._isCloseEnough(w,C)||(B.push(1),N.push(w.clone())),C=A,M._isCloseEnough(w,m)&&M._isCloseEnough(b,A)?(B.push(2),N.push(A.clone()),void 0):(B.push(4),N.push(m.clone(),b.clone(),A.clone()),void 0)}),{segments:B,points:N}};var Sd=Nl.Math.CubicBezier=function(b,y,V,p){var Q=this;Q._id=Nl.Math.CubicBezier._globalId++,Q._p1=b,Q._p2=y,Q._p3=V,Q._p4=p};Sd._globalId=1,Sd.prototype={},Sd.prototype.constructor=Sd,Sd.prototype.toString=function(){return this._id},Sd.prototype.intersectRect=function(d,U,f){var o=U/2,m=f/2,S=d.x,A=d.y,Y=Nl.Math.Vector2,u=new Y(-o+S,-m+A),P=new Y(o+S,m+A),k=new Y(P.x,u.y),r=new Y(u.x,P.y),v=this,h=v.intersectLine(u,k),i=v.intersectLine(k,P),y=v.intersectLine(P,r),$=v.intersectLine(r,u),t=h.concat(i).concat(y).concat($);return t},Sd.prototype.intersectLine=function(Y,g){var R,N,I,O,a,A,s,z,V,J,T,k,q,l=this,t=Y.clone().min(g),B=Y.clone().max(g);O=l._p1,a=l._p2,A=l._p3,s=l._p4,R=O.clone().multiplyScalar(-1),N=a.clone().multiplyScalar(3),I=A.clone().multiplyScalar(-3),T=R.add(N).add(I).add(s),R=O.clone().multiplyScalar(3),N=a.clone().multiplyScalar(-6),I=A.clone().multiplyScalar(3),J=R.add(N).add(I),R=O.clone().multiplyScalar(-3),N=a.clone().multiplyScalar(3),V=R.add(N),z=O.clone(),q=new Nl.Math.Vector2(Y.y-g.y,g.x-Y.x),k=Y.x*g.y-g.x*Y.y;for(var Z=l.getRoots(q.dot(T),q.dot(J),q.dot(V),q.dot(z)+k),j=new Array,i=0,M=Z.length;M>i;i++){var v=Z[i];if(!(0>v||v>1)){var $=O.clone().lerp(a,v),h=a.clone().lerp(A,v),S=A.clone().lerp(s,v),G=$.lerp(h,v),E=h.lerp(S,v),K=G.lerp(E,v);K.t=v,Y.x==g.x?t.y<=K.y&&K.y<=B.y&&j.push(K):Y.y==g.y?t.x<=K.x&&K.x<=B.x&&j.push(K):K.x>=t.x&&K.y>=t.y&&K.x<=B.x&&K.y<=B.y&&j.push(K)}}return j},Sd.prototype.solveTForPoint=function(d){var O,V,$,a,q=this;O=q._p1.x-d.x,V=q._p2.x-d.x,$=q._p3.x-d.x,a=q._p4.x-d.x;for(var R=q.getRoots(a-3*$+3*V-O,3*$-6*V+3*O,3*V-3*O,O),s=K,p=1/0,_=0,c=R.length;c>_;_++){var w=R[_];if(!(0>w||w>1)){var Y=q._p1.clone().lerp(q._p2,w),N=q._p2.clone().lerp(q._p3,w),U=q._p3.clone().lerp(q._p4,w),x=Y.lerp(N,w),f=N.lerp(U,w),j=x.lerp(f,w);j.t=w;var k=Math.abs(j.y-d.y);p>k&&(p=k,s=j)}}return s},Sd.prototype.getPointAt=function(A){var O=this,S=O._p1,E=O._p2,J=O._p3,V=O._p4,B=S.clone().lerp(E,A),z=E.clone().lerp(J,A),r=J.clone().lerp(V,A),C=B.lerp(z,A),T=z.lerp(r,A);return C.lerp(T,A)},Sd.prototype.getRoots=function(V,B,k,A){var s,_,L,t,C,E=new Array;if(Math.abs(V)<1e-6){var s=B,_=k/s,L=A/s,t=_*_-4*L;if(t>0){var C=Math.sqrt(t);E.push(.5*(-_+C)),E.push(.5*(-_-C))}else 0==t&&E.push(.5*-_)}B/=V,k/=V,A/=V,s=(3*k-B*B)/3,_=(2*B*B*B-9*k*B+27*A)/27;var H=B/3,Z=_*_/4+s*s*s/27,u=_/2;if(Math.abs(Z)<=1e-6&&(Z=0),Z>0){var h,e,C=Math.sqrt(Z);h=-u+C,e=h>=0?Math.pow(h,1/3):-Math.pow(-h,1/3),h=-u-C,h>=0?e+=Math.pow(h,1/3):e-=Math.pow(-h,1/3),E.push(e-H)}else if(0>Z){var S=Math.sqrt(-s/3),o=Math.atan2(Math.sqrt(-Z),-u)/3,d=Math.cos(o),g=Math.sin(o),z=Math.sqrt(3);E.push(2*S*d-H),E.push(-S*(d+z*g)-H),E.push(-S*(d-z*g)-H)}else{var h;h=u>=0?-Math.pow(u,1/3):Math.pow(-u,1/3),E.push(2*h-H),E.push(-h-H)}return E},Sd.prototype._70I=function(){var j=this;return j._p1.distanceToSquared(j._p2)<1e-10&&j._p3.distanceToSquared(j._p4)<1e-10},Sd.prototype.insertKnot=function(M){var L=this,E=L._p1,v=L._p2,U=L._p3,X=L._p4,b=E.clone().lerp(v,M),F=v.clone().lerp(U,M),P=U.clone().lerp(X,M),l=b.clone().lerp(F,M),T=F.clone().lerp(P,M),z=l.clone().lerp(T,M);return L._70I()?(E.clone().lerp(X,M),[new Nl.Math.CubicBezier(E,E.clone(),z.clone(),z),new Nl.Math.CubicBezier(z,z.clone(),X.clone(),X)]):[new Nl.Math.CubicBezier(E,b,l,z),new Nl.Math.CubicBezier(z,T,P,X)]};var xj=k.Default.getInternal().ui().EdgeUI,lp={_47O:function(s){var e=this,G=lp.getBackups()._47O;Nl.inEdit(e.gv)||G.call(e,s)}};Nl.Inject.registAsModule(lp,xj);var Me=k.Default.getInternal().ui().NodeUI,me={_47O:function(i){var z=this,O=me.getBackups()._47O;Nl.inEdit(z.gv)||O.call(z,i)},getSelectWidth:function(){var U=this,o=U.gv,k=U._data;if(o.isEditable(k)&&Nl.inEdit(o))return 0;var J=me.getBackup("getSelectWidth");return J.call(U)}};Nl.Inject.registAsModule(me,Me);var Hi=k.graph.GraphView,dj={_editPointSize:function(){var J=k.Default.isTouchable,f=Nl.getStyle("pointSize");return f[J?0:1]}(),isPointEditable:function($){var X=this;if(Nl.inEdit(X))return X._pointEditableFunc?X._pointEditableFunc($):!0;var J=dj.getBackup("isPointEditable");J.call(X,$)},isEditable:function(P){var t,X=this,C=dj.getBackup("isEditable");if(t=P instanceof Nl.Group?!0:C.call(X,P),!Nl.inEdit(X))return t;if(!(P instanceof k.Edge))return t;if(!P.s("2d.editable"))return!1;var l=X.getEditableFunc();return l?l(P):!0},_42:function(d,a){var I=this,B=dj.getBackups()._42;if(B.call(I,d,a),Nl.inEdit(I)){var G=I.getEditInteractor();G.drawImpl()}}};Nl.Inject.registAsModule(dj,Hi);var Xk=k.Default.getInternal().ui().ShapeUI,jf={_47O:function(s){var T=this,x=jf.getBackups()._47O;Nl.inEdit(T.gv)||x.call(T,s)}};Nl.Inject.registAsModule(jf,Xk);var So=k.graph.DefaultInteractor,pp={handle_mousewheel:function(d){var u=this,z=pp.getBackup("handle_mousewheel");Nl.inEdit(u.gv)||z.call(u,d)}};Nl.Inject.registAsModule(pp,So);var Eo=k.graph.MoveInteractor,Ml={_calcShift:function(Q,E){var R=this,d=Ml.getBackup("_calcShift"),J=R.gv;if(!Nl.inEdit(J))return d.call(R,Q,E);var w=J.getEditInteractor(),m=w.getSubModule("Move").calcShift(Q,E,R);return m||d.call(R,Q,E)},clear:function(g){var p=this,L=Ml.getBackup("clear");L.call(p,g);var d=p.gv;if(Nl.inEdit(d)){var r=d.getEditInteractor();r.getSubModule("Move").clear(g)}}};Nl.Inject.registAsModule(Ml,Eo);var $g=Nl.Rect=function(K){this.catalog="Rect",this._interactor=K};$g.prototype={},$g.prototype.constructor=$g,$g.prototype.gatherInfo=function(o,Z){var D=this;if(1===Z.length){var t=Z[0];return t instanceof k.Shape&&t._70I()?D.gatherLine(o,t):Oc(t,o)?!1:D.gatherSingleTarget(o,t)}return Z.length>1?D.gatherMultiTargets(o,Z):!1},$g.prototype.gatherSingleTarget=function(W,p){if(p.getCorners){var h,S=this,f=S.info;S.target=p,h=S.screenInfo={};var r=p.getCorners();f.LT=new Nl.Math.Vector2(r[0]),f.LB=new Nl.Math.Vector2(r[1]),f.RB=new Nl.Math.Vector2(r[2]),f.RT=new Nl.Math.Vector2(r[3]),f.T=f.LT.clone().add(f.RT).divideScalar(2),f.B=f.LB.clone().add(f.RB).divideScalar(2),f.L=f.LT.clone().add(f.LB).divideScalar(2),f.R=f.RT.clone().add(f.RB).divideScalar(2);for(var P in f)h[P]=Nl.toScreenPosition(W,f[P]);var n=S._interactor,a=n.getStyle("checkSize"),s=function(Q,W,b){var y=W.clone().sub(Q).setLength(-a),x=b.clone().sub(Q).setLength(-a),f=y.add(x).add(Q);return f};return h.rotLT=s(h.LT,h.RT,h.LB),h.rotLB=s(h.LB,h.LT,h.RB),h.rotRB=s(h.RB,h.LB,h.RT),h.rotRT=s(h.RT,h.LT,h.RB),h.rotT=h.rotLT.clone().add(h.rotRT).divideScalar(2),h.rotB=h.rotLB.clone().add(h.rotRB).divideScalar(2),h.rotL=h.rotLT.clone().add(h.rotLB).divideScalar(2),h.rotR=h.rotRT.clone().add(h.rotRB).divideScalar(2),h.rotation=p.getRotation(),S.gatherConnectInfo(),!0}},$g.prototype.gatherConnectInfo=function(){var G=this,O=G.target,j=G._interactor,s=G.screenInfo,T=j.gv;if(T.isConnectActionVisible(O)&&j.getStyle("connectGuideVisible")){var e;O.s&&(e=O.s("connectGuideShift")),e||(e=j.getStyle("connectGuideShift"));var I=O.getAnchor(),H=O.getSize(),i=O.toGlobal({x:H.width*(e[0]-I.x),y:H.height*(e[1]-I.y)});i=Nl.toScreenPosition(T,i),s.P1?i.add(s.P2.clone().sub(s.P1).setLength(e[2])):(i.add(s.RT.clone().sub(s.LT).setLength(e[2])),i.add(s.LB.clone().sub(s.LT).setLength(e[3]))),s.connect=i}},$g.prototype.gatherMultiTargets=function(M,q){var H=Nl.Group.findOrCreateGroup(q);if(!H)return!1;var j=this;return j.editing&&"rotate"!==j.editing.mode||H.calcInfo(),j.gatherSingleTarget(M,H)},$g.prototype.gatherLine=function($,s){this.target=s;var u=this.screenInfo={},g=s.getPoints(),E=Nl.getDataMatrix(s);return u.P1=Nl.toScreenPosition($,E.apply(g.get(0))),u.P2=Nl.toScreenPosition($,E.apply(g.get(1))),this.gatherConnectInfo(),!0},$g.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],$g.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],$g.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],$g.prototype.check=function(p,Y,d){if(k.Default.isLeftButton(Y)){var i=this;if(i.editing=null,i.tipInfo=null,i.screenInfo){var O=i.target,y=p.isEditable(O),h=i.screenInfo;if(y&&h.connect){var I=i._checkConnect(d);if(I)return I}if(h.P1)return i._checkLine(d);var Z,w,D,b=null,z=i._interactor,P=z.getStyle("checkSize");if(y&&p.isRectEditable(O))for(w=0;w<Nl.Rect.ResizeKeys.length;w++)if(D=Nl.Rect.ResizeKeys[w],Nl.checkHit(d,h[D],P)){b=D,Z="resize";break}if(!b&&y&&p.isRotationEditable(O)&&!z.getStyle("rotateAsClock")){var K=z.getStyle("rotateCheckSize");for(w=0;w<Nl.Rect.RotateKeys.length;w++)if(D=Nl.Rect.RotateKeys[w],Nl.checkHit(d,h[D],K)){b=D,Z="rotate";break}}if(!b)return z.setCursor("default"),void 0;if("rotate"===Z){var v,B=p.lp(Y);if(O instanceof Nl.Group){var t=z.getStyle("groupRotateModeKey");"string"==typeof t&&(t=[t]);for(var H=!1,V=0,A=t.length;A>V;V++)if(Y[t[V]]){H=!0;break}var U=z.getStyle("groupRotateModeDefault");v=H?"batch"===U?"block":"batch":U}var R="batch"===v?O.getAnchor2():O.getPosition(),l=Math.atan2(B.y-R.y,B.x-R.x);z._setRotateCursor(l),i.editing={mode:Z,key:b,pos:R,flipY:O.getScale().y<0,rotation:O.getRotation(),hitRot:l},v&&(i.editing.groupRotateMode=v)}else{var j=Nl.Rect.ResizeKeys.indexOf(b),x=Nl.Rect.ResizeDirection[j],N=Math.cos(O.getRotation()),n=Math.sin(O.getRotation()),s=x.x*Math.sign(O.getScale().x),F=x.y*Math.sign(O.getScale().y),r=Math.atan2(-n*s-N*F,N*s-n*F),E=(Math.round(r/(Math.PI/4))+8)%8,S=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][E];this._interactor.setCursor(S);var f=O.getWidth(),L=O.getHeight(),W=O.getAnchor();i.editing={mode:Z,key:b,rect:{x:-f*W.x,y:-L*W.y,width:f,height:L},anchor:W,matrix:O.getMatrix()}}return b}}},$g.prototype._checkLine=function(J){var D=this;D.screenInfo;var $,v=D._interactor.getStyle("checkSize");if(Nl.checkHit(J,D.screenInfo.P1,v))$="P1";else{if(!Nl.checkHit(J,D.screenInfo.P2,v))return this._interactor.setCursor("default"),void 0;$="P2"}return D.editing={mode:"line",key:$},$},$g.prototype._checkConnect=function(K){var l=this,z=l.screenInfo,S=l._interactor,o=S.getStyle("connectGuideIntersectSize"),i=z.connect,F=K.x,N=i.x;if(N>F&&o>N-F&&Math.abs(i.y-K.y)<o||F>=N&&Nl.checkHit(K,i,o)){var $="connect",Y=M.getConnectAction(S.gv);if(l.editing={mode:$},Y&&Y.delete)if(l.target instanceof Nl.Group){var B=!0;S.gv.sm().getSelection().each(function(O){Y.delete.visible.call(null,S.gv,O)||(B=!1)}),l.editing.hasDeleteAction=B}else Y.delete.visible.call(null,S.gv,l.target)&&(l.editing.hasDeleteAction=!0);return S.setCursor("default"),$}},$g.prototype._fireEditEvent=function(v,g){var k=this._interactor,t=this.editing;if(t){var H=t.mode;H="rotate"===H?"Rotation":"connect"===H?"Connection":H[0].toUpperCase()+H.slice(1),k.fi({kind:v+"Edit"+H,event:g})}},$g.prototype.startEdit=function(z,q){z.startDragging(q);var c=this;c._interactor.fi({kind:"prepareEdit",event:q});var F=c.editing,I=c.target;if(F){if(c._fireEditEvent("begin",q),"rotate"===F.mode)return F.groupRotateMode&&I.beginRotate(F),void 0;if("connect"!==F.mode)("line"===F.mode||I&&0===I.getRotation())&&(c._inSmartGuide=!0,c._interactor.rectGuide.gatherRects());
else if(F.hasDeleteAction){var Y=z.gv,u=c._interactor.getStyle("connectGuideGarbageShift");F.garbageInfo={x:Y.getWidth()*u[0]+u[2],y:Y.getHeight()*u[1]+u[3],size:c._interactor.getStyle("connectGuideGarbageIntersectsize")},z._42()}}},$g.prototype._46O=function(q){var G,g,D=this,e=D.editing,W=D.target;if(e){if("connect"===e.mode&&!e.canceled&&!e.deleted)try{e.garbageInfo&&e.garbageInfo.hover?M.doDeleteConnectionAction(D._interactor.gv,W):M.doConnectAction(D._interactor.gv,W,e.target)}catch(j){console.error(j)}g=e.freezeFlag,G=D.editing.groupRotateMode,D._fireEditEvent("end",q),D.editing=null}D.tipInfo=null,D._inSmartGuide&&(D._interactor.rectGuide.clear(),D._inSmartGuide=!1),G&&W&&W.endRotate(),W instanceof k.Block&&(g===K?delete W._freezeSyncFromChildren:W._freezeSyncFromChildren=g,W.updateFromChildren())},$g.prototype.handleNormalStateDelete=function(){var l=this,Z=l.editing;if(Z&&"connect"===Z.mode&&!Z.canceled&&!Z.deleted){if(Z.garbageInfo){try{M.doDeleteConnectionAction(l._interactor.gv,l.target)}catch(m){console.error(m)}Z.garbageInfo=null}return Z.cursorPos=null,Z.targetCorners=null,Z.deleted=!0,l._interactor._42(),!0}},$g.prototype.handleNormalStateKeyDown=function(d){var H=this,T=H.editing;return!T||"connect"!==T.mode||T.canceled||T.deleted?void 0:k.Default.isEsc(d)?(T.cursorPos=null,T.targetCorners=null,T.canceled=!0,H._interactor._42(),!0):void 0},$g.prototype.handleEdit=function(X,w){var p=this,B=p.editing;if(B){var P,N,A,M,d,G=p.target,Z=B.key,D=B.mode,I=X.lp(w),H=p._interactor;if("connect"===D){if(B.canceled)return;if(B.deleted)return;B.cursorPos=H._getLogicalPoint(w);var v=B.garbageInfo;return v&&Nl.checkHit(B.cursorPos,v,v.size)?(v.hover=!0,B.target=null,B.targetCorners=null):(v&&(v.hover=!1),B.target=X.getDataAt(I,function(U){return X.isSelectable(U)?vs(U)?!0:!1:!1})||null,B.targetCorners=Nl.getTargetCornersOnScreen(X,B.target)),H._42(),void 0}if("rotate"===D){var R,r,c=B.pos,i=Math.atan2(I.y-c.y,I.x-c.x);if(B.groupRotateMode?r=i-B.hitRot:(R=i-B.hitRot,r=B.rotation+R),r%=2*Math.PI,0>r&&(r+=2*Math.PI),!k.Default.isCtrlDown(w)){var j,x;Cd(w)?(j=H.getStyle("shiftRotateRound"),x=j/2):(j=H.getStyle("rotateRound"),x=H.getStyle("rotateSensitivity")),r=Nl.roundTo(r,j,x)}B.groupRotateMode?(R=r-(B.lastRotation||0),0!==R&&(G.addRotation(R,B.groupRotateMode),B.lastRotation=r)):G.setRotation(r),H._setRotateCursor(i),r>Math.PI&&(r-=2*Math.PI);var f=180*(r/Math.PI);f=f.toFixed(2),P=""+f+"°"}else if("resize"===D){var g=B.rect;A=g.x,M=g.y;var t,z=g.width,e=g.height,h=B.anchor,$=B.matrix,Q=G.s&&G.s("keepAspectRatio")||H.getStyle("keepAspectRatio");Cd(w)&&(Q=!Q);var C=p._unionPointMode1,o=p._unionPointMode2;if(p._inSmartGuide&&!k.Default.isCtrlDown(w)&&!Q){var S;"L"===Z||"R"===Z?S="x":("T"===Z||"B"===Z)&&(S="y"),p._adsorbedToClosest(I,S),d=!0}t=$.tfi(I);var V;"LT"===Z?(g=C(t,{x:A+z,y:M+e},z,e,Q),V=9):"T"===Z?(g=o({x:A,y:t.y},{x:A+z,y:M+e},z,e,Q,"v"),V=1):"RT"===Z?(g=C(t,{x:A,y:M+e},z,e,Q),V=33):"L"===Z?(g=o({x:t.x,y:M},{x:A+z,y:M+e},z,e,Q,"h"),V=8):"R"===Z?(g=o({x:A,y:M},{x:t.x,y:M+e},z,e,Q,"h"),V=32):"LB"===Z?(g=C(t,{x:A+z,y:M},z,e,Q),V=12):"B"===Z?(g=o({x:A,y:M},{x:A+z,y:t.y},z,e,Q,"v"),V=4):"RB"===Z&&(g=C(t,{x:A,y:M},z,e,Q),V=36);var s=$.tf(g.x+g.width*h.x,g.y+g.height*h.y);G instanceof k.Block&&(B.hasOwnProperty("freezeFlag")||(B.freezeFlag=G._freezeSyncFromChildren,G._freezeSyncFromChildren=!0)),G.setPosition(s),G.setSize(g.width,g.height),d&&(N=G.getRect(),H.rectGuide.gatherLines({node:G,x:N.x,y:N.y,w:N.width,h:N.height},S,V)),P=""+Math.round(g.width)+" * "+Math.round(g.height)}else if("line"===D){if(Cd(w)){var Y=G.getPoints(),n="P1"===Z?Y.get(1):Y.get(0),T={x:I.x-n.x,y:I.y-n.y},W=H.getStyle("shiftLineRotateRound"),O=p._shiftDirList;if(!O||p._shiftRotateRound!==W){p._shiftRotateRound=W,p._shiftDirList=O=[];for(var U=0;U<Math.PI;U+=W)O.push({x:J(U),y:y(U)})}for(var a,L=0,l=0,E=O.length;E>l;l++){var u=O[l],F=u.x*T.x+u.y*T.y;Math.abs(F)>Math.abs(L)&&(L=F,a=u)}I={x:n.x+a.x*L,y:n.y+a.y*L},H.rectGuide.clear()}else p._inSmartGuide&&!k.Default.isCtrlDown(w)&&(p._adsorbedToClosest(I),d=!0);var m=Nl.getDataMatrix(G).applyInverse(I);G.setPoint("P1"===Z?0:1,m,!0);var q=G.getPoints(),b=q.get(0),K=q.get(1);A=b.x-K.x,M=b.y-K.y,P=" "+Math.round(Math.sqrt(A*A+M*M))+" ",d&&(N=G.getRect(),H.rectGuide.gatherLines({node:G,x:N.x,y:N.y,w:N.width,h:N.height}))}if(P){var _=k.Default.getLogicalPoint(w,H._canvas);_.x+=Nl.Icons.TipShiftX,_.y+=Nl.Icons.TipShiftY,p.tipInfo={helperPos:_,text:P,size:P.length}}p._fireEditEvent("between",w)}},$g.prototype._unionPointMode1=function(B,R,Z,X,K){if(K&&Z&&X){var T=B.x-R.x,f=B.y-R.y;Math.abs(T*X)<Math.abs(f*Z)?(f=Math.sign(f)*Math.abs(T*X/Z),B.y=R.y+f):(T=Math.sign(T)*Math.abs(f*Z/X),B.x=R.x+T)}return k.Default.unionPoint(B,R)},$g.prototype._unionPointMode2=function(H,W,t,S,O,w){var $=k.Default.unionPoint(H,W);if(O&&t&&S){var i;"v"===w?(i=$.x+$.width/2,$.width=t*$.height/S,$.x=i-$.width/2):(i=$.y+$.height/2,$.height=S*$.width/t,$.y=i-$.height/2)}return $},$g.prototype._adsorbedToClosest=function(T,W){var g=this,Q=g._interactor,I=Q.rectGuide.findClosest(T,W),z=Q.gridGuide.findClosest(T,W),m=1/0,_=1/0;I&&(isFinite(I.x)&&(m=I.x),isFinite(I.y)&&(_=I.y)),z&&(isFinite(z.x)&&Math.abs(z.x)<Math.abs(m)&&(m=z.x),isFinite(z.y)&&Math.abs(z.y)<Math.abs(_)&&(_=z.y)),isFinite(m)&&(T.x+=m),isFinite(_)&&(T.y+=_)},$g.prototype._42=function(N,d,z){var w=this;w.info={},w.screenInfo=null;var f=w._interactor;if(!f.editDetail&&w.gatherInfo(d,z)){var G=w.editing,n=G?G.groupRotateMode:null,b=w.screenInfo;"block"!==n&&(b.P1?Nl.Icons.DrawIcon(f,N,Nl.Icons.Line,b):Nl.Icons.DrawIcon(f,N,Nl.Icons.Rect,b),b.connect&&(Nl.Icons.DrawIcon(f,N,Nl.Icons.ConnectGuide,{rotation:b.rotation,connect:b.connect,cursorPos:G?G.cursorPos:null}),G&&(G.targetCorners&&Nl.Icons.DrawIcon(f,N,Nl.Icons.NodeHoverGuide,G.targetCorners),G.garbageInfo&&Nl.Icons.DrawIcon(f,N,Nl.Icons.ConnectGuideGarbage,G.garbageInfo))),w.tipInfo&&Nl.Icons.DrawIcon(f,N,Nl.Icons.TipHelper,w.tipInfo)),w.target instanceof Nl.Group&&w.target._42(f,N,d)}};var jr=Nl.Anchor=function(A){this.catalog="Anchor",this._interactor=A};jr.prototype={},jr.prototype.constructor=jr,jr.prototype.gatherInfo=function($,L){var s=this;if(1===L.length){var b=L[0];if(!b.getAnchor)return;if(b instanceof k.Shape&&b._70I())return;if(Oc(b,$))return;return s.gatherSingleTarget($,L[0])}return L.length>1?s.gatherMultiTargets($,L):!1},jr.prototype.gatherSingleTarget=function(G,k){var w=this;return w.info.POS=k.getPosition(),w.screenInfo.POS=Nl.toScreenPosition(G,w.info.POS),w.target=k,!0},jr.prototype.gatherMultiTargets=function(I,l){var W=this,o=Nl.Group.findOrCreateGroup(l);return o?(W.screenInfo.POS=Nl.toScreenPosition(I,o.getAnchor2()),W.target=o,!0):!1},jr.prototype.isVisible=function(){var F=this,n=F._interactor;if(n.getStyle("anchorVisible")===!1)return!1;var j=F.target;if(j){if(this.editing)return!0;var e=j.getAnchor(),M=n.getStyle("anchorOutsideVisibleThreshold");if(e.x<-M||e.x>1+M||e.y<-M||e.y>1+M)return!0;var p=j.getSize(),X=j.getScale(),s=Math.min(Math.abs(p.width*X.x),Math.abs(p.height*X.y));if(s*n.gv._zoom<n.getStyle("anchorHideThreshold"))return!1}return!0},jr.prototype.check=function(Q,B,u){if(k.Default.isLeftButton(B)){var R=this,e=R._interactor;if(R.isVisible()&&e.getStyle("anchorMovable")!==!1){R.editing=null,R.tipInfo=null;var M=R.target;if(M&&Q.isAnchorEditable(M)&&Q.isEditable(M)){var x;if(R.screenInfo&&(x=R.screenInfo.POS)&&Nl.checkHit(u,new Nl.Math.Vector2(x),e.getStyle("checkSize"))){if(M instanceof Nl.Group)return R.editing={},!0;var E=M.getWidth(),I=M.getHeight(),S=M.getAnchor();return R.editing={rect:{x:-E*S.x,y:-I*S.y,width:E,height:I},anchor:S,matrix:M.getMatrix()},!0}}}}},jr.prototype.startEdit=function(U,t){U.startDragging(t),U.fi({kind:"beginEditAnchor",event:t})},jr.prototype._46O=function(F){var t=this;t.editing&&(t.editing=null,t._interactor.fi({kind:"endEditAnchor",event:F})),t.tipInfo=null},jr.prototype.handleEdit=function(u,U){var M=this,n=M.target;if(n){var b=M.editing;if(b){var C=u.lp(U),r=M._interactor;if(n instanceof Nl.Group)return n.setAnchor2(C),r._42(),void 0;var A=b.matrix,a=A.tfi(C),f=b.rect,J=(a.x-f.x)/f.width,B=(a.y-f.y)/f.height;if(!k.Default.isCtrlDown(U)){var h=r.getStyle("anchorRound"),o=r.getStyle("anchorSensitivity");J=Nl.roundTo(J,h,o),B=Nl.roundTo(B,h,o)}n.setAnchor(J,B,!0);var N=k.Default.getLogicalPoint(U,r._canvas);N.x+=Nl.Icons.TipShiftX,N.y+=Nl.Icons.TipShiftY;var Y=""+J.toFixed(2)+", "+B.toFixed(2);M.tipInfo={helperPos:N,text:Y,size:Y.length},r.fi({kind:"betweenEditAnchor",event:U})}}},jr.prototype._42=function(g,v,N){var t=this;t.info={},t.screenInfo={};var z=t._interactor;z.editDetail||t.gatherInfo(v,N)&&t.isVisible()&&(Nl.Icons.DrawIcon(z,g,Nl.Icons.Anchor,t.screenInfo),t.tipInfo&&Nl.Icons.DrawIcon(z,g,Nl.Icons.TipHelper,t.tipInfo))};var lg=Nl.RotateX=function(d){this.catalog="RotateX",this._interactor=d};lg.prototype={},lg.prototype.constructor=lg,lg.prototype.gatherInfo=function(D,g){var $=this;if(1===g.length){var u=g[0];return u instanceof k.Shape&&u._70I()||Oc(u,D)?!1:$.gatherSingleTarget(D,u)}return g.length>1?$.gatherMultiTargets(D,g):!1},lg.prototype.gatherSingleTarget=function(){var Z=new k.Math.Vector2,m=new k.Math.Vector2,b=new k.Math.Vector2,a=new k.Math.Vector2,P=function(O,o){var C=O.x-o.x,Z=O.y-o.y;return C*C+Z*Z};return function(v,t){if(t.getCorners){var X=this,C=t.getCorners(),w=15,e=t.getPosition();Z.copy(C[0]),b.copy(C[1]),a.copy(C[3]),m.copy(Z).add(a).divideScalar(2).add(Z.sub(b).setLength(w/v.getZoom()));var f=Math.max(P(e,C[0]),P(e,C[1]),P(e,C[2]),P(e,C[3]));return X.info.POS=m.clone(),X.screenInfo.POS=Nl.toScreenPosition(v,X.info.POS),X.screenInfo.LEN=Math.sqrt(f)*v.getZoom()+w,X.screenInfo.CENTER=Nl.toScreenPosition(v,e),X.target=t,!0}}}(),lg.prototype.gatherMultiTargets=function(z,_){var v=this,O=Nl.Group.findOrCreateGroup(_);if(!O)return!1;var v=this;return v.gatherSingleTarget(z,O)},lg.prototype.isVisible=function(){var _=this._interactor;if(!_.getStyle("rotateAsClock"))return!1;var R=this.target;if(!R)return!0;var b=_.gv;return b.isEditable(R)&&b.isRotationEditable(R)?!0:!1},lg.prototype.check=function(K,V,W){var h=this,F=h._checkImpl(K,V,W);return(F||h._clockPainted)&&h._interactor._42(),F},lg.prototype._checkImpl=function(s,l,X){if(k.Default.isLeftButton(l)){var g=this;g.editing=null,g.tipInfo=null;var x;if(g.screenInfo&&(x=g.screenInfo.POS)&&g.isVisible()){var r=g._interactor;if(Nl.checkHit(X,x,r.getStyle("checkSize"))){var b=g.target,C=s.lp(l),Z=b.getPosition(),I=Math.atan2(C.y-Z.y,C.x-Z.x);return r._setRotateCursor(I),g.editing={pos:Z,rotation:b.getRotation(),hitRot:I,groupRotateMode:"block",screenInfo:{CENTER:g.screenInfo.CENTER,LEN:g.screenInfo.LEN}},!0}}}},lg.prototype.startEdit=function(f,U){f.startDragging(U),f.fi({kind:"beginEditRotation",event:U}),this.target instanceof Nl.Group&&this.target.beginRotate(this.editing)},lg.prototype._46O=function(T){var l=this;l.editing&&(l.editing=null,l._interactor.fi({kind:"endEditRotation",event:T})),l.target instanceof Nl.Group&&l.target.endRotate(),l.tipInfo=null},lg.prototype.handleEdit=function(J,E){var l=this,X=l.editing;if(X){var t,o,B=l.target,D=J.lp(E),x=l._interactor,K=X.pos,$=Math.atan2(D.y-K.y,D.x-K.x),y=B instanceof Nl.Group;if(y?o=$-X.hitRot:(t=$-X.hitRot,o=X.rotation+t),o%=2*Math.PI,0>o&&(o+=2*Math.PI),!k.Default.isCtrlDown(E)){var v,d;Cd(E)?(v=x.getStyle("shiftRotateRound"),d=v/2):(v=x.getStyle("rotateRound"),d=x.getStyle("rotateSensitivity")),o=Nl.roundTo(o,v,d)}y?(t=o-(X.lastRotation||0),0!==t&&(B.addRotation(t,X.groupRotateMode),X.lastRotation=o)):B.setRotation(o),x._setRotateCursor($),o>Math.PI&&(o-=2*Math.PI);var c=180*(o/Math.PI),m=""+c.toFixed(2)+"°",U=k.Default.getLogicalPoint(E,x._canvas);U.x+=Nl.Icons.TipShiftX,U.y+=Nl.Icons.TipShiftY,l.tipInfo={helperPos:U,text:m,size:m.length},x.fi({kind:"betweenEditRotation",event:E})}},lg.prototype._42=function(P,M,c){var s=this;s._clockPainted=!1,s.info={},s.screenInfo={};var Z=s._interactor;Z.editDetail||s.gatherInfo(M,c)&&s.isVisible()&&(Nl.Icons.DrawIcon(Z,P,Nl.Icons.RoundPoint,s.screenInfo.POS),s.tipInfo&&Nl.Icons.DrawIcon(Z,P,Nl.Icons.TipHelper,s.tipInfo),s.editing&&s.drawClock(P))},lg.prototype.drawClock=function(f){f.save();var h=this;h._clockPainted=!0;var o=h.editing||{},z=o.screenInfo||h.screenInfo,n=z.LEN,Q=n+8,V=n+18;f.save(),f.translate(z.CENTER.x,z.CENTER.y),f.beginPath(),f.strokeStyle="rgb(150, 150, 150)";for(var A,r,i,S,W,j=0;360>j;j++)A=j*Math.PI/180,0===j%5&&(r=y(A)*n,i=J(A)*n,S=y(A)*Q,W=J(A)*Q,f.moveTo(r,i),f.lineTo(S,W)),0===j%45&&(r=y(A)*n,i=J(A)*n,S=y(A)*V,W=J(A)*V,f.moveTo(r,i),f.lineTo(S,W));f.stroke(),f.rotate(-I);var p=o.lastRotation||h.target.getRotation();f.beginPath(),f.fillStyle="rgba(255, 0, 0, 0.1)",f.strokeStyle="rgb(157, 157, 157)",f.moveTo(0,0),f.arc(0,0,V,0,p,!1),f.fill(),f.beginPath(),f.moveTo(0+V,0),f.arc(0,0,V,0,p,!1),f.stroke(),f.restore()};var Cf=Nl.Curve=function(I){this.catalog="Curve",this._interactor=I};Cf.prototype={},Cf.prototype.constructor=Cf,C.defineProperties(Cf.prototype,{activing:{get:function(){return this._activing},set:function(m){var D=this;if(m)D._activing=new Nl.CurveActiving(this,m);else{var e=D._activing;e&&e.dispose(),D._activing=null}}}}),Cf.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Cf.prototype.setUp=function(){var c=this,A=c._interactor;A&&A.gv.mp(c._onGraphviewPropertyChanged,c)},Cf.prototype._onGraphviewPropertyChanged=function(E){("zoom"===E.property||"translateX"===E.property||"translateY"===E.property)&&this._handleDataChanged()},Cf.prototype.tearDown=function(){var D=this,v=D._interactor;v&&v.gv.ump(D._onGraphviewPropertyChanged,D)},Cf.prototype.canEnterEditDetailMode=function(){var c=this,R=c._interactor,G=R._getValidSelection();if(1===G.length){var P=G[0],W=P instanceof k.Edge;if(P instanceof k.Shape||W){if(W){var s=P.s("edge.type");if(s&&"points"!==s)return}var H=R.gv;if(H.isPointEditable(P)&&H.isEditable(P))return c.target=P,!0}}},Cf.prototype.preHandleScroll=function(){var t=this.editing;return t&&t.inEdit?!0:void 0},Cf.prototype.getCurrentSelectintStatus=function(){var n=this;if(n.activing&&!n.activing.selections){if(n.activing.status!=K)return n.activing.status;var S=function(_){var z=n.activing.status;n.activing.status=_,n._interactor.fp("shapePointStatus",z,_)},V=Nl.Curve.PointType,f=n.activing.point,s=n.activing.pairs;if(!s||1!==s.length)return S(V.Mirrored);var r=s[0],U=r.c1&&r.c1.isNearEnough(f),t=r.c2&&r.c2.isNearEnough(f);if(!r.c1||!r.c2)return U||t?S(V.Straight):S(V.Disconnected);if(U&&t)return S(V.Straight);if(U||t)return S(V.Asymmetric);var H=r.c1.clone().sub(f),Y=r.c2.clone().sub(f);return Math.abs(H.x*Y.y-H.y*Y.x)>1e-5||H.x*Y.x>0?S(V.Disconnected):Math.abs(H.length()-Y.length())>1e-5?S(V.Asymmetric):S(V.Mirrored)}},Cf.prototype.handle_keydown=function(w){var y=this;if(y._interactor.editDetail){var f=Nl.Curve.PointType;"1"===w.key?y._setCurrentSelectionStatus(f.Straight):"2"===w.key?y._setCurrentSelectionStatus(f.Mirrored):"3"===w.key?y._setCurrentSelectionStatus(f.Disconnected):"4"===w.key&&y._setCurrentSelectionStatus(f.Asymmetric)}},Cf.prototype.setCurrentSelectionStatus=function(k){var z=this,m=z._interactor;if(m){var b=m.gv;b.dm().beginTransaction(),this._setCurrentSelectionStatus(k),b.dm().endTransaction()}},Cf.prototype._setCurrentSelectionStatus=function(_){var v=this,d=v.activing;if(d){var H=v.getCurrentSelectintStatus();if(null!==H&&H!==_){d.status=_;var V=v.activing.point,F=v.activing.pairs;if(F&&1===F.length){var h=F[0],T=v.screenInfo.curve,E=Nl.Curve.PointType,j=function(){v._writeToHt(),v._interactor.fp("shapePointStatus",H,_)};if(_===E.Straight)return T.moveCtrlPoint(h,V,"c1"),T.moveCtrlPoint(h,V,"c2"),j(),void 0;if(H===E.Straight){var f=T.findPairs(V,!0),W=f[0],S=W.r1||V,M=W.r2||V,n=M.clone().sub(S).multiplyScalar(.25);return T.moveCtrlPoint(h,V.clone().sub(n),"c1"),T.moveCtrlPoint(h,V.clone().add(n),"c2"),j(),void 0}var J=h.c1,K=h.c2;if(J&&K){if(_===E.Mirrored)return T.moveCtrlPoint(h,V.clone().multiplyScalar(2).sub(K),"c1"),j(),void 0;if(_===E.Asymmetric&&H===E.Disconnected){var m=J.clone().sub(V).length(),n=V.clone().sub(K).setLength(m).add(V);return T.moveCtrlPoint(h,n,"c1"),j(),void 0}}d._firePointChange(),v._interactor.fp("shapePointStatus",H,_)}}}},Cf.prototype._handleDataChanged=function(y){var Z=this;if(Z.screenInfo&&Z.target){var K=Z._interactor;Z.gatherSingleTarget(K.gv,Z.target,!0),Z.check(K.gv,null,y?K._getLogicalPoint(y):new Nl.Math.Vector2(K._lastClientPoint)),K._42()}},Cf.prototype.gatherSingleTarget=function(q,t,T){var m,a,w=this;w.screenInfo&&w.screenInfo.curve&&(a=w.screenInfo.curve._curves);var B=w.editing;m=B?w.screenInfo:w.screenInfo={};var s,i,D=t instanceof k.Edge;D?(s=t.s("edge.segments"),i=t.s("edge.points")||new k.List):(s=t._58O,i=t._59O),m.S=s;var I,x=m.P=[],d=Nl.getDataMatrix(t);if(t instanceof k.Polyline&&(I=t.getElevation()||0,m.E=[]),i.each(function(K){m.E&&m.E.push(K.e||I),K=d.apply(K);var o=Nl.toScreenPosition(q,K);x.push(o.x,o.y)}),D){var Q=Nl.toScreenPosition(q,t._lastSourcePoint),P=Nl.toScreenPosition(q,t._lastTargetPoint);x.splice(0,0,Q.x,Q.y),x.push(P.x,P.y)}if(!m.S||!m.S.size()){m.S=new k.List,m.S.add(1);for(var E=0;E<x.length/2-1;E++)m.S.add(2)}if((!B||T)&&w.convertToCubicBezier(a),w.activing&&(T||!w.editing||"realPoint"===w.editing.type)){var M=m.curve.findPairs(w.activing.point);w.activing.pairs=M}D&&"points"!==t.s("edge.type")&&w._writeToHt()},Cf.prototype._convertToNewPoint=function(F,Z,H){var D,$,w;for(D=0,$=Z.length;$>D;D++){if(w=Z[D],w._p1.isNearEnough(F))return w._p1;if(w._p4.isNearEnough(F))return w._p4}if(H)for(D=0,$=Math.min(H.length,$);$>D;D++){if(w=H[D],w._p1===F)return Z[D]._p1;if(w._p4===F)return Z[D]._p4}},Cf.prototype.convertToCubicBezier=function(g){var W,K,w=this,q=new Nl.Math.Curve,i=w.screenInfo;if(q.createFromHtShape(i.P,i.S,i.E),i.curve=q,w.activing){var F=q._curves;if(W=w.activing.point,K=w._convertToNewPoint(W,F,g),K&&(w.activing.point=K),w.activing.selections){var h=-1,o=w.activing.selections;o.forEach(function(R){h++,K=w._convertToNewPoint(R,F,g),K&&(o[h]=K)})}}},Cf.prototype.check=function(S,B,T){if(!B||k.Default.isLeftButton(B)){var s=this;if(s._interactor.setCursor("default"),s.editing=null,s.highlight=null,s.tipInfo=null,s.screenInfo){if(_f())return s._interactor._42(),!0;if(s._checkEditCtrlPoint(T))return s._interactor._42(),!0;if(s._checkEditRealPoint(T))return s._interactor._42(),!0;if(s._checkEditElevation(T))return s._interactor._42(),!0;var L=s.screenInfo.curve,O=L.checkPoint(T,s._interactor.getStyle("curveIntersectSize"));if(O){var x=s.highlight={};x.type="insertKnot",x.bezier=O.bezier,x.point=O.intersection}return s._interactor._42(),!0}}},Cf.prototype._checkEditRealPoint=function(F){var R,j,U,n,a,Q,y=this,A=y.screenInfo.curve._curves,p=y._interactor.getStyle("curvePointIntersectSize"),Z=1/0;for(p*=p,U=0,n=A.length;n>U;U++)R=A[U],a=R._p1,Q=F.distanceToSquared(a),Z>Q&&(Z=Q,j=a),a=R._p4,Q=F.distanceToSquared(a),Z>Q&&(Z=Q,j=a);if(Z>p)return!1;var f=y.highlight={};return f.type="changeRealPoint",f.point=j,y.editing={type:"realPoint",point:j,shiftGuide:{point:j.clone(),dir:"x",limit:0}},y._interactor.setCursor("crosshair"),!0},Cf.prototype._checkEditElevation=function(w){var z=this;if(!z._interactor.getStyle("curveElevationVisible"))return!1;var k=z.activing;if(!k)return!1;var b=k.getCurrentEditingPoint();if(!b)return!1;var Z=z._interactor,K=Z.getStyle("curveElevationGuideShift"),u=Z.getStyle("curveElevationIntersectSize"),o=w.distanceToSquared({x:b.x+K[0],y:b.y+K[1]});if(!(o>u*u)){var i=z.highlight={};i.type="elevation";var P=new Nl.Math.Vector2(w.x,w.y,b.e);return z.editing={type:"elevation",startPoint:P},z._interactor.setCursor("crosshair"),!0}},Cf.prototype._checkEditCtrlPoint=function(A){var q=this;if(q.activing&&!q.activing.selections){var w=q.getCurrentSelectintStatus();if(w!==Nl.Curve.PointType.Straight){var m=q.activing.pairs;if(m){var R=q._interactor.getStyle("curvePointIntersectSize");R*=R;var p,c,W,F,Z,i,X,u,S,k=1/0;for(X=0,S=m.length;S>X;X++)for(F=m[X],u=0;2>u;u++)Z=0===u?"c1":"c2",F[Z]&&(i=A.distanceToSquared(F[Z]),k>i&&(k=i,p=F,c=X,W=Z));if(k>R)return!1;q.activing.hlpair=p,q.activing.hltype=W;var K=q.highlight={};return K.type="changeCtrlPoint",K.point=p[W],q.editing={type:"ctrlPoint",pair:p,pairId:c,ctrlType:W,direction:p[W].clone().sub(q.activing.point).normalize()},q._interactor.setCursor("crosshair"),!0}}}},Cf.prototype.startEdit=function(j,s){j.startDragging(s);var Q=this;Q.highlight&&"insertKnot"===Q.highlight.type&&(Q.insertKnot(),Q.gatherSingleTarget(Q._interactor.gv,Q.target),Q.activing=null,Q._checkEditRealPoint(Q._interactor._getLogicalPoint(s)));var x=Q._activing;if(x){var L=Q.editing?Q.editing.type:null;"ctrlPoint"===L?x.editingCtrl={pairId:Q.editing.pairId,type:x.hltype}:"realPoint"===L&&(x.editingCtrl=!1)}var i=Q.highlight,N=k.Default.isCtrlDown(s);if(!i||_f()){var Z=Q._interactor.gv;if(!Z.setFocus(s)||Z._scrolling)return;return Z.isPannable()&&em(s)&&!N&&(Q._pan={tx:Z.tx(),ty:Z.ty()},j.fi({kind:"beginPan",event:s})),void 0}if("changeRealPoint"===i.type){var O,M=Q.activing?Q.activing.point:null,H=Q.activing?Q.activing.selections:null;if(N&&Q.activing)M===i.point?(H?(Q.activing={point:H[0]},H.length>1&&(H.splice(0,1),Q.activing.selections=H)):Q.activing=null,Q.editing=null):H&&(O=H.indexOf(i.point))>=0?(H.length>1?H.splice(O,1):delete Q.activing.selections,Q.editing=null):H?(H.push(M),Q.activing={point:i.point,selections:H}):Q.activing={point:i.point,selections:[M]};else if(H)M===i.point||((O=H.indexOf(i.point))>=0?(H.splice(O,1,M),Q.activing={point:i.point,selections:H}):Q.activing={point:i.point});else{var R;M===i.point&&(R=Q.activing.status),Q.activing={point:i.point},R&&(Q.activing.status=R)}j.fi({kind:"beginEditPoint",event:s})}},Cf.prototype.insertKnot=function(){var w=this,h=w.highlight,t=w.screenInfo.curve;t.insertKnot(h.bezier,h.point.t),w._writeToHt()},Cf.prototype._writeToHt=function(){var U,j,M,u,b=this,r=b.screenInfo.curve,m=r.toHtShape(),S=m.points,F=[],V=m.segments,e=b._interactor.gv,t=b.target,E=t instanceof k.Edge,n=Nl.getDataMatrix(t).invert();u=t instanceof k.Polyline,u&&(M=t.getElevation());for(var I=0,W=S.length;W>I;I++)U=S[I],j=Nl.toWorldPosition(e,U),j=n.apply(j),U.e!=K&&U.e!==M&&(j.e=U.e),F.push(j);if(t._writing=!0,E){t.s("edge.type","points"),t.setStyle("edge.segments",V),t.setStyle("edge.points",F.slice(1,F.length-1)),t.setStyle("edge.source.offset.x",0),t.setStyle("edge.source.offset.y",0),t.setStyle("edge.target.offset.x",0),t.setStyle("edge.target.offset.y",0);var H=b._nextChangeEdgeHost;delete b._nextChangeEdgeHost,H&&("source"===H.type?t.setSource(H.host):t.setTarget(H.host)),b._writeEdgeHostAnchor("source",F[0]),b._writeEdgeHostAnchor("target",F[F.length-1])}else F.length?(t.setSegments(V),t.setPoints(F,!0)):t.removeFromDataModel();delete t._writing},Cf.prototype._writeEdgeHostAnchor=function(z,F){var c=this,x=c.target,y=c._calcHostAnchor(x,z,F);x.s("edge."+z+".anchor.x",y.x),x.s("edge."+z+".anchor.y",y.y),y.offsetX||y.offsetY?(x.s("edge."+z+".offset.x",y.offsetX),x.s("edge."+z+".offset.y",y.offsetY)):(x.s("edge."+z+".offset.x",0),x.s("edge."+z+".offset.y",0))},Cf.prototype._calcHostAnchor=function(v,o,A,W){W||(W="source"===o?v.getSource():v.getTarget());var s=this._interactor.gv,c=s.calculateAttachPoint(W,A);if(c)return c.info;var k=W.getRotation(),a=W.getAnchor();if(Oc(W,s)&&(k=0),k){var Q=W.getMatrix(),X=Q.tfi(A),J=W.getSize();return{x:X.x/J.width+a.x,y:X.y/J.height+a.y}}var x=vm(s,W),S={x:(A.x-x.x)/x.width,y:(A.y-x.y)/x.height};return S},Cf.prototype._handlePanning=function(N){var e=this,p=e._pan;if(p){p.started=!0;var k=e._interactor,J=k.gv,o=k._lastClientPoint,y=bk(N);J.setTranslate(p.tx+y.x-o.x,p.ty+y.y-o.y),e.gatherSingleTarget(k.gv,e.target),k._42(),k.fi({kind:"betweenPan",event:N})}},Cf.prototype.handleEdit=function(u,V){var a=this,e=a.editing;if(a._pan)return a._handlePanning(V),void 0;if(e){e.inEdit=!0;var o,H,Q,z=a._interactor._getLogicalPoint(V),S=k.Default.isCtrlDown(V),t=k.Default.isShiftDown(V),L=e.type,A=a.activing;if(a._guideInfo=null,"ctrlPoint"===L&&t){var d=a.editing.direction.clone();o=A.point;var R=d.dot(z.clone().sub(o));z=d.setLength(R).add(o)}else if("ctrlPoint"===L||"realPoint"===L){var d;if("realPoint"===L&&t){var j=a.editing.shiftGuide;H=j.point;var U=Math.abs(z.x-H.x),y=Math.abs(z.y-H.y);U>y&&U>j.limit&&"y"===j.dir&&(j.dir="x"),y>U&&y>j.limit&&"x"===j.dir&&(j.dir="y"),d=j.dir,"x"===d?(z.y=H.y,j.limit=Math.max(j.limit,U)):"y"===d&&(z.x=H.x,j.limit=Math.max(j.limit,y))}var w=a._isEditEdgeSourceTarget();if(w){var B=a._editEdgeSourceTarget(w,z,S);B&&(Q=B.tipText)}else if(!S){var p=a._guidingToEdit(z,d),x="realPoint"===L?a._interactor.gridGuide.findClosest(z,d,!0):null,s=1/0,v=1/0;x&&(x.x&&(s=x.x),x.y&&(v=x.y));var G=!1;p&&(p.xList&&(Math.abs(p.x)<=Math.abs(s)?(G=!0,s=p.x):delete p.xList),p.yList&&(Math.abs(p.y)<=Math.abs(v)?(G=!0,v=p.y):delete p.yList),G&&(a._guideInfo=p)),isFinite(s)&&(z.x+=s),isFinite(v)&&(z.y+=v),G&&(p.v=z)}}var Z=a.screenInfo.curve;if("realPoint"===e.type){o=e.point,o.e!==K&&(z.e=o.e),Z.moveRealPoint(o,z),e.point=z,a.highlight.point=z;var i=A.status,P=A.selections;if(a.activing={point:z,status:i},P){var m=z.clone().sub(o),D=0;P.forEach(function(t){var z=t.clone().add(m);Z.moveRealPoint(t,z),P[D++]=z}),a.activing.selections=P}}else if("ctrlPoint"===e.type){var X=A.pairs,I=X[e.pairId];Z.moveCtrlPoint(I,z,e.ctrlType);var g=A.status,E=Nl.Curve.PointType;if((g===E.Mirrored||g===E.Asymmetric)&&I.c1&&I.c2){var o=new Nl.Math.Vector2(A.point),c="c1"===e.ctrlType?"c2":"c1";if(g===Nl.Curve.PointType.Mirrored)Z.moveCtrlPoint(I,o.clone().multiplyScalar(2).sub(z),c);else if(g===E.Asymmetric){var R=I[c].clone().sub(o).length(),M=o.clone().sub(I[e.ctrlType]).setLength(R).add(o);isNaN(M.x)||Z.moveCtrlPoint(I,M,c)}}A._firePointChange()}else if("elevation"===e.type){H=e.startPoint;var F=H.e+(H.y-z.y)/u._zoom;a._setCurrentPointImpl("e",F),A._firePointChange(),Q="E: "+Nl.toFixed(F)}var f=k.Default.getLogicalPoint(V,a._interactor._canvas);if(f.x+=Nl.Icons.TipShiftX,f.y+=Nl.Icons.TipShiftY,!Q){var r=Nl.toWorldPosition(u,z);Q=""+Nl.toFixed(r.x)+", "+Nl.toFixed(r.y)}a.tipInfo={helperPos:f,text:Q,size:Q.length},a._writeToHt(),a._interactor.fi({kind:"betweenEditPoint",event:V})}},Cf.prototype._setCurrentPointImpl=function(B,U){var s=this,I=s._activing;if(!I)return!1;var G=s.target;if(!G)return!1;var Y=I.getCurrentEditingPoint();if(!Y)return!1;var C=I.editingCtrl;if(!C)var J=Y.clone();if("e"===B)Y.e=U;else{var T;if("x"===B||"y"===B){var M=I._lastFirePoint;T="x"===B?{x:U,y:M?M.y:0}:{x:M?M.x:0,y:U}}else"object"==typeof B?(T=B,B.e!==K&&(Y.e=B.e)):(T={x:arguments[0],y:arguments[1]},arguments[2]!==K&&(Y.e=arguments[2]));var $=Nl.getDataMatrix(G);T=Nl.toScreenPosition(s._interactor.gv,$.apply(T)),Y.x=T.x,Y.y=T.y}if(!C){var D=J.multiplyScalar(-1).add(Y);Y.e&&J.e&&(D.e=Y.e-J.e),s.screenInfo.curve.moveCtrlDueToRealPointMovement(Y,D)}return!0},Cf.prototype.setCurrentPoint=function(r,P){return this._setCurrentPointImpl(r,P)?(this._writeToHt(),!0):!1},Cf.prototype._isEditEdgeSourceTarget=function(){var Z=this,Q=Z.target;if(!(Q instanceof k.Edge))return!1;var W=Z.editing.point,$=Z.screenInfo.curve._curves;return W===$[0]._p1?"source":W===$[$.length-1]._p4?"target":!1},Cf.prototype._editEdgeSourceTarget=function(K,w,y){var H,X=this,b=X.target;if(H="source"===K?b.getSource():b.getTarget()){var t=X._interactor.gv,P=Nl.toWorldPosition(t,w),c=X._calcHostAnchor(b,K,P,H);if(X._interactor.getStyle("edgeHostDetectPerFrame")||c.x<0||c.x>1||c.y<0||c.y>1){var O=t.getDataAt(P,function(I){return t.isSelectable(I)?vs(I)?!0:!1:!1});if(O){var z=X._calcHostAnchor(b,K,P,O);H=O,X._nextChangeEdgeHost={type:K,host:O},c=z}}var R;if(!y){var I=X._interactor.getStyle("anchorRound"),F=X._interactor.getStyle("anchorSensitivity");R=t.calculateAttachPoint(H,P),R?c=R.info:(c.x=Nl.roundTo(c.x,I,F),c.y=Nl.roundTo(c.y,I,F))}if(!y){var l=H.getAttachPosition(c.x,c.y,c.offsetX,c.offsetY),V=Nl.toScreenPosition(t,l);w.x=V.x,w.y=V.y}X._edgeHostGuideInfo={corners:Nl.getTargetCornersOnScreen(t,H),attach:R?R.index:-1,host:H};var i=""+c.x.toFixed(2)+", "+c.y.toFixed(2);return(c.offsetX||c.offsetY)&&(i+=" offset: "+c.offsetX.toFixed(2)+", "+c.offsetY.toFixed(2)),{host:H,anchor:c,tipText:i}}},Cf.prototype._guidingToEdit=function(H,U){var n,z,l=this;if(n=l.screenInfo.curve){z=n._curves;var I,V,t,k,J,$,w,Q,F=1/0,r=1/0,K=[];for(l.editing&&"realPoint"===l.editing.type&&(Q=l.editing.point),J=0,$=2*z.length;$>J;J++)w=z[Math.floor(J/2)][J%2?"_p4":"_p1"],K.indexOf(w)>=0||(K.push(w),Q&&Q===w||(t=w.x-H.x,k=w.y-H.y,Math.abs(t)<Math.abs(F)?(F=t,I=[w]):t===F&&I.push(w),Math.abs(k)<Math.abs(r)?(r=k,V=[w]):k===r&&V.push(w)));var i=l._interactor.getStyle("smartGuideSensitivity");if((Math.abs(F)>i||"y"===U)&&(I=null),(Math.abs(r)>i||"x"===U)&&(V=null),I||V){var x=!1,Z={};if(I&&(x=!0,Z.xList=I,Z.x=F),V&&(x=!0,Z.yList=V,Z.y=r),x)return Z}}},Cf.prototype._46O=function(Q){var q=this;q.editing&&(q.editing=null,q._interactor.fi({kind:"endEditPoint",event:Q})),q._guideInfo=null,q._edgeHostGuideInfo=null,q._pan&&(q._pan=null,q._interactor.fi({kind:"endPan",event:Q})),q.tipInfo=null},Cf.prototype._canDeletePoint=function(I,d){var R=this.target;if(!(R instanceof k.Edge))return!0;var z=I._curves[0],G=I._curves[I._curves.length-1];return z._p1===d||G._p4===d?!1:!0},Cf.prototype.handleDelete=function(){var X=this;if(X.activing&&X.screenInfo){var p=k.Default.isShiftDown(),n=X.screenInfo.curve;X._canDeletePoint(n,X.activing.point)&&n.deleteRealPoint(X.activing.point,p),X.activing.selections&&X.activing.selections.forEach(function(u){X._canDeletePoint(n,u)&&n.deleteRealPoint(u,p)}),X.activing=null,delete X.editing,delete X.tipInfo,delete X._pan,X._writeToHt(),X._interactor.fp("deleteShapePoint",!1,!0)}},Cf.prototype.handleDoubleClick=function(i){var g=this,Z=g._interactor._getLogicalPoint(i);if(g.screenInfo&&g._checkEditRealPoint(Z)){var c=g.getCurrentSelectintStatus(),j=Nl.Curve.PointType;return c=c===j.Mirrored?j.Straight:j.Mirrored,g._setCurrentSelectionStatus(c),g._interactor._42(),!0}},Cf.prototype._drawHighlight=function(d){var Z=this,N=Z.highlight;if(N){var I=N.bezier,b=Z._interactor;I&&Nl.Icons.DrawIcon(b,d,Nl.Icons.ShapeHighlightCurve,[I._p1.x,I._p1.y,I._p2.x,I._p2.y,I._p3.x,I._p3.y,I._p4.x,I._p4.y]);var j=N.point;j&&"insertKnot"===N.type&&Nl.Icons.DrawIcon(b,d,Nl.Icons.ShapeHighlighPoint,j)}},Cf.prototype._drawGuide=function(Q){var s=this,A=s._guideInfo;if(A){var S,d,K,B,i=A.v;for(S=0;2>S;S++)if(B=0===S?A.xList:A.yList)for(d=0,K=B.length;K>d;d++)Nl.Icons.DrawIcon(s._interactor,Q,Nl.Icons.ShapeGuideLine,[i.x,i.y,B[d].x,B[d].y])}},Cf.prototype._drawCurrentPoint=function(d){var J=this;if(J.activing){var P=J.activing,e=J.getCurrentSelectintStatus(),j=J._interactor;if(e!==Nl.Curve.PointType.Straight){var M=P.pairs;P.hlpair,P.hltype;var K=P.selections,L=P.editingCtrl;if(M&&!K){var f,l,O;for(l=0,O=M.length;O>l;l++)f=M[l],L&&l===L.pairId&&f[L.type]?Nl.Icons.DrawIcon(j,d,Nl.Icons.ShapeActivingCtrl,{point:f.point,c1:f.c1,c2:f.c2,hl:L.type}):Nl.Icons.DrawIcon(j,d,Nl.Icons.ShapeActivingCtrl,f)}}Nl.Icons.DrawIcon(j,d,Nl.Icons.ShapeHighlighRealPoint,J.activing.point),K&&K.forEach(function(S){Nl.Icons.DrawIcon(j,d,Nl.Icons.ShapeHighlighRealPoint,S)})}},Cf.prototype.clear=function(){var L=this;L.editing=null,L._guideInfo=null,L.activing=null,L.highlight=null},Cf.prototype._42=function(C){var V=this;V.info={},V.editing||(V.screenInfo=null);var v=V._interactor;if(!v.editDetail)return V.clear(),void 0;var n=v.gv;if(!V.target||!n.isSelected(V.target)||!n.isVisible(V.target))return v.editDetail=!1,V.clear(),void 0;if(V.gatherSingleTarget(n,V.target),Nl.Icons.DrawIcon(v,C,Nl.Icons.ShapeBgCurve,V.screenInfo),V._drawHighlight(C),V._drawCurrentPoint(C),V._getRealPoint().forEach(function(H){Nl.Icons.DrawIcon(v,C,Nl.Icons.ShapePoint,H)}),V._drawGuide(C),V.tipInfo&&Nl.Icons.DrawIcon(v,C,Nl.Icons.TipHelper,V.tipInfo),V._edgeHostGuideInfo){Nl.Icons.DrawIcon(v,C,Nl.Icons.NodeHoverGuide,V._edgeHostGuideInfo.corners);var Q=V._edgeHostGuideInfo.host;if(Q){var h=n.getAttachPoints(Q);if(h&&h.length)for(var F=0,G=h.length;G>F;F++){var Z=h[F],J=Q.getAttachPosition(Z.x,Z.y,Z.offsetX,Z.offsetY);
J=Nl.toScreenPosition(n,J),J.isAttach=V._edgeHostGuideInfo.attach===F,Nl.Icons.DrawIcon(v,C,Nl.Icons.AttachPoint,J)}}}if(V._interactor.getStyle("curveElevationVisible")&&V.target instanceof k.Polyline&&V.activing){var O=V.activing.getCurrentEditingPoint();O&&Nl.Icons.DrawIcon(v,C,Nl.Icons.EdgeElevationGuide,O)}},Cf.prototype._getRealPoint=function(){var V,F=this.screenInfo,R=F.P,x=F.S,h=-1,c=[],e=-1,K=x.length;return x.each(function(H){e++;var q=1;if(3===H)q=2;else if(4===H)q=3;else if(5===H)return;h+=q,V=e+1>=K?!0:1===x.get(e+1)?!0:!1,c.push({point:{x:R[2*h],y:R[2*h+1]},segmentIndex:e,pointIndex:h,isEnd:V})}),c},Cf.prototype.getEditingPointsInfo=function(M){var _=this,C=_.activing;if(!C)return!1;var Y=C.point;if(!Y)return!1;var D=this._getRealPoint(),U=[{screen:Y}];C.selections&&C.selections.forEach(function($){U.push({screen:$})});var j,i,F=D.length;return U.forEach(function(W){for(j=0;F>j;j++)if(i=D[j],W.screen.isNearEnough(i.point)){W.segmentIndex=i.segmentIndex,W.pointIndex=i.pointIndex,W.point=_.target.getPoints().get(i.pointIndex);break}}),M&&U.sort(function(E,y){return E.segmentIndex-y.segmentIndex}),U};var cj=Nl.MoveHelper=function(N){var Y=this;Y.catalog="Move",Y._interactor=N};cj.prototype={},cj.prototype.constructor=cj,cj.prototype.calcShift=function(c,H,f){var B,Q,x=this,Y=x._interactor.gv,e=Y.lp(H);if("beginMove"===c&&x._gatherGridInfo(f._lastLogicalPoint||e),B=x._target){var v=B.downPosition;if(v){var p=x._interactor.getStyle("moveSensitivity")/Y._zoom;if(v.distanceTo(e)<p)return{x:0,y:0};delete B.downPosition}var E;Q=k.Default.isShiftDown(H),Q&&(e=x._dealShiftDown(e),E=B.shiftGuide.dir);var r,u=B.rawPos={x:B.pos.x+e.x-B.lp.x,y:B.pos.y+e.y-B.lp.y};if(k.Default.isCtrlDown(H)){if(r=x._calcShiftByAddon(),x._target.node instanceof Nl.Group){var q=x._target.node;q._position.x+=r.x,q._position.y+=r.y}return r}for(var d,J=B.x+u.x,a=B.y+u.y,G={x:J,y:a},t={x:J+B.w/2,y:a+B.h/2},R={x:J+B.w,y:a+B.h},h=x._interactor.rectGuide,W=x._interactor.gridGuide,l=[h.findClosest(G,E),h.findClosest(t,E),h.findClosest(R,E),W.findClosest(G,E),W.findClosest(t,E),W.findClosest(R,E)],O=1/0,o=1/0,_=0,L=l.length;L>_;_++)d=l[_],d&&(J=d.x,a=d.y,isFinite(J)&&Math.abs(J)<Math.abs(O)&&(O=J),isFinite(a)&&Math.abs(a)<Math.abs(o)&&(o=a));if(isFinite(O)||(O=0),isFinite(o)||(o=0),r=x._calcShiftByAddon(O,o),x._target.node instanceof Nl.Group){var q=x._target.node;q._position.x+=r.x,q._position.y+=r.y}var M=B.node;if(!Oc(M,Y)){var y=u.x+O,X=u.y+o;x._interactor.rectGuide.gatherLines({node:M,x:B.x+y,y:B.y+X,w:B.w,h:B.h},E)}return r}},cj.prototype._calcShiftByAddon=function(F,v){var d=this._target,Q=d.rawPos,r=d.node.getPosition();return F=F||0,v=v||0,{x:Q.x-r.x+F,y:Q.y-r.y+v}},cj.prototype._dealShiftDown=function(G){var X=this,I=X._target.shiftGuide,A=X._target.lp,p=Math.abs(G.x-A.x),n=Math.abs(G.y-A.y);p>n&&p>I.limit&&"y"===I.dir&&(I.dir="x"),n>p&&n>I.limit&&"x"===I.dir&&(I.dir="y");var o=I.dir;return"x"===o?(G.y=A.y,I.limit=Math.max(I.limit,p)):"y"===o&&(G.x=A.x,I.limit=Math.max(I.limit,n)),G},cj.prototype._gatherGridInfo=function(Q){var h,i=this,K=i._interactor,N=K._getValidSelection();if(N.length){if(1===N.length){if(h=N[0],!h.getRect)return i._target=null,void 0}else if(h=Nl.Group.findOrCreateGroup(N),!h)return i._target=null,void 0}else{var N=K.gv.sm().getSelection();if(N.length&&(h=N.get(0),!h.getRect))return i._target=null,void 0}var W=h.getPosition(),G=h.getRect();i._target={node:h,x:G.x-W.x,y:G.y-W.y,w:G.width,h:G.height,lp:{x:Q.x,y:Q.y},pos:{x:W.x,y:W.y},shiftGuide:{dir:"x",limit:0},downPosition:new Nl.Math.Vector2(Q)},K.rectGuide.gatherRects()},cj.prototype.clear=function(){var U=this;U._interactor.rectGuide.clear(),U._interactor._42()};var ij="directional",Pm="point",Cl="spot",Gb="light.color",ts=function(N,T){Gk(T)&&wb.test(T)?Yq(N,T):Eq(T)&&T.modelType?Rg(N,T):rs[N]=T},pm=function(a){if(Eq(a))return a.modelType?a.uuid?rs[a.uuid]:(a.uuid=k.Math.generateUUID(),Rg(a.uuid,a),K):a;var o=rs[a];return a&&o===K&&wb.test(a)&&(nq&&nq[a]||Yq(a,a)),o};Bm(M,{graph3dViewAttributes:Z,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:B/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Xg,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:B/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:ts,getShape3dModel:pm,createMatrix:function(Q,c){Sp(Q)||(Q=[Q]);for(var h=Q.length-1;h>=0;h--){var z=Q[h];c=Jh(z.mat,z.s3,z.r3,z.rotationMode,z.t3,c)}return c},transformVec:function(P,C){return jq(P,C)},createBoxModel:function(){return{vs:xm,ns:wj,uv:sh,is:Tp}},createRoundRectModel:function(E,m){return Qh.roundRect(E,m)},createStarModel:function(Q,v){return Qh.star(Q,v)},createRectModel:function(f,D){return Qh.rect(f,D)},createTriangleModel:function($,G){return Qh.triangle($,G)},createRightTriangleModel:function(O,S){return Qh.rightTriangle(O,S)},createParallelogramModel:function(O,T){return Qh.parallelogram(O,T)},createTrapezoidModel:function(J,r){return Qh.trapezoid(J,r)},createSmoothSphereModel:function(i,Y,X,H,_,f,r){return _l(new pl(i,Y,X,H,_,f,r))},createSphereModel:function(C,J,R,t,B,q){return C?ie(C,J,R,t,B,q):M.createSmoothSphereModel()},createSmoothConeModel:function(e,f,$,p,h){return be(e,f,$,p,h)},createConeModel:function(x,W,O,t,G,v){return x?hk(x,W,O,t,G,v):be(v)},createSmoothCylinderModel:function(C,r,P,c,B,b,w,N){return _l(new Nr(C,r,P,c,B,b,w,N))},createCylinderModel:function(F,W,M,v,e,A,i){return F?Hk(F,W,M,v,e,A,i):ae(A,i)},createSmoothTorusModel:function(m,C,V,J,o,R){return _l(new Rd(m,C,V,J,o,R))},createTorusModel:function(A,f,B,t,w,h,c){return A?Fr(A,f,B,t,w,h,c):Sr(h,c)},createExtrusionModel:function(r,h,V,F,z,l,D,n){return dk(r,h,V,F,z,l,D,n)},createSmoothRingModel:function(z,x,$,K,V,c){for(var X=[],F=0;F<z.length-1;F+=2)X.push({x:z[F],y:z[F+1]});for(z=Ch(X,x,$)[0],X=[],F=0;F<z.length;F++){var f=z[F];X.push(new sc(f.x,0,f.y))}return _l(new Am(X,c,K,V))},createTextGeometry:function(j,$){return _l(new Mn(j,$))},loadFontFace:function(f,t){M.xhrLoad(f,function(m){if(!m)return t();var e;try{e=JSON.parse(m)}catch(b){e=JSON.parse(m.substring(65,m.length-2))}Mh.loadFace(e),t&&t(e.familyName.toLowerCase())},t?null:{sync:!0})},createRingModel:function(t,j,A,L,z,l,K,P,d,_){for(var E=[],h=0;h<t.length-1;h+=2)E.push({x:t[h],y:t[h+1]});l=l||M.shapeSide,K=K||0,P=P||l;var s,H,R,V,o,g,m,Y,O,U,h,Q,k,S,C,u,r,w,n=[],e=[],a=d?[]:Z,G=d?[]:Z,N=_?[]:Z,f=_?[]:Z,X=L?[]:Z,W=L?[]:Z,I=z?[]:Z,F=z?[]:Z,t=Ch(E,j,A),x=qh(t),c=0,i=2*Math.PI/l;return t.forEach(function(M){if(R=M.length,R>1){if(V=M[0],L)for(g=V.x,Y=V.y,h=K;P>h;h++)Q=h+1,k=h*i,S=Q*i,C=y(k),u=J(k),r=y(S),w=J(S),X.push(C*g,Y,-u*g,r*g,Y,-w*g,0,Y,0),W.push(.5-.5*C,.5-.5*u,.5-.5*r,.5-.5*w,.5,.5);for(U=0;R>U;U++){for(o=M[U],g=V.x,m=o.x,Y=V.y,O=o.y,s=c/x,c+=Qn(V,o),H=c/x,h=K;P>h;h++)Q=h+1,k=h*i,S=Q*i,C=y(k),u=J(k),r=y(S),w=J(S),n.push(C*m,O,-u*m,r*m,O,-w*m,C*g,Y,-u*g,r*m,O,-w*m,r*g,Y,-w*g,C*g,Y,-u*g),e.push(h/l,H,Q/l,H,h/l,s,Q/l,H,Q/l,s,h/l,s),d&&h===K&&(a.push(0,Y,0,0,O,0,C*m,O,-u*m,C*m,O,-u*m,C*g,Y,-u*g,0,Y,0),G.push(0,.5-Y,0,.5-O,2*m,.5-O,2*m,.5-O,2*g,.5-Y,0,.5-Y)),_&&Q===P&&(N.push(0,Y,0,r*m,O,-w*m,0,O,0,r*m,O,-w*m,0,Y,0,r*g,Y,-w*g),f.push(1,.5-Y,1-2*m,.5-O,1,.5-O,1-2*m,.5-O,1,.5-Y,1-2*g,.5-Y));V=o}if(z)for(g=V.x,Y=V.y,h=K;P>h;h++)Q=h+1,k=h*i,S=Q*i,C=y(k),u=J(k),r=y(S),w=J(S),I.push(r*g,Y,-w*g,C*g,Y,-u*g,0,Y,0),F.push(.5-.5*r,.5+.5*w,.5-.5*C,.5+.5*u,.5,.5)}}),{vs:n,uv:e,bottom_vs:I,bottom_uv:F,top_vs:X,top_uv:W,from_vs:a,from_uv:G,to_vs:N,to_uv:f}}},!0),Bm(S,{"3d.move.mode":K,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":K,"edge.gradient.color":K,"edge.source.t3":K,"edge.target.t3":K,"light.type":Pm,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":B/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":_d,"wf.short":!1,"wf.mat":K,"wf.geometry":!1,batch:K,"transparent.mask":!1,brightness:K,"select.brightness":.7,"repeat.uv.length":K,alphaTest:.4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":Nm,"label.t3":K,"label.r3":K,"label.texture.scale":2,"label.rotationMode":ik,"label.light":!1,"label.blend":K,"label.reverse.flip":!1,"label.reverse.color":bi,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Nm,"label2.t3":K,"label2.r3":K,"label2.texture.scale":2,"label2.rotationMode":ik,"label2.light":!1,"label2.blend":K,"label2.reverse.flip":!1,"label2.reverse.color":bi,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Nm,"note.t3":K,"note.r3":K,"note.texture.scale":2,"note.rotationMode":ik,"note.light":!1,"note.blend":K,"note.reverse.flip":!1,"note.reverse.color":bi,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Nm,"note2.t3":K,"note2.r3":K,"note2.texture.scale":2,"note2.rotationMode":ik,"note2.light":!1,"note2.blend":K,"note2.reverse.flip":!1,"note2.reverse.color":bi,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:K,"shape3d.color":wn,"shape3d.top.color":K,"shape3d.bottom.color":K,"shape3d.from.color":K,"shape3d.to.color":K,"shape3d.image":K,"shape3d.top.image":K,"shape3d.bottom.image":K,"shape3d.from.image":K,"shape3d.to.image":K,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":K,"shape3d.side.to":K,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":K,"shape3d.opacity":K,"shape3d.reverse.flip":!1,"shape3d.reverse.color":bi,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":K,"shape3d.uv.scale":K,"shape3d.top.uv.offset":K,"shape3d.top.uv.scale":K,"shape3d.bottom.uv.offset":K,"shape3d.bottom.uv.scale":K,"shape3d.from.uv.offset":K,"shape3d.from.uv.scale":K,"shape3d.to.uv.offset":K,"shape3d.to.uv.scale":K,"shape3d.top.cap":K,"shape3d.bottom.cap":K,"shape3d.start.angle":0,"shape3d.sweep.angle":G,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":K,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":wn,"all.image":K,"all.blend":K,"all.opacity":K,"all.reverse.flip":!1,"all.reverse.color":bi,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":K,"all.uv.offset":K,"all.uv.scale":K,"all.discard.selectable":!0,mat:K,"left.mat":K,"right.mat":K,"top.mat":K,"bottom.mat":K,"front.mat":K,"back.mat":K},!0);var ag,Jn=!1,zm=[0,0,0,0],Ir={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Wf,2:qb,3:uc,4:Ul,5:Nm,6:Fd}},Ue=function(W,m,U,g){if(m.getFaceVisible(W,U)){Mm(m,go(W,m.getFaceMat(W,U)||m.getMat(W)));var M=m._26I;m.getFaceReverseCull(W,U)?M.enable(M.CULL_FACE):M.disable(M.CULL_FACE),rf(M,m._prg.uFixPickReverseColor,Ir[U]),tj(M),Dc(M,g,6),Ze(M),Go(m)}},Se=function(L){return L instanceof im},Cs=function(j){return[j.x,j.e||0,j.y]},Vp=function(p,j,t){for(var j=Tj(j),H=j[0],r=j[1],B=j[2];t--;)p.push(H,r,B)},Nc=function(R,$,s){for(var $=Tj($),O=$[0],l=$[1],J=$[2],r=$[3];s--;)R.push(O,l,J,r)},Yn=function(c,n,W){if(n)for(var A,$,z,l=n[0],w=n[1],s=n[2],b=n[4],a=n[5],k=n[6],y=n[8],e=n[9],V=n[10],q=n[12],R=n[13],K=n[14],N=W.length,h=0,h=0;N>h;h+=3)A=W[h],$=W[h+1],z=W[h+2],c.push(l*A+b*$+y*z+q,w*A+a*$+e*z+R,s*A+k*$+V*z+K);else mf(c,W)},Uk=function(U,k){var K=k.s("light.intensity"),P=Tj(k.s(Gb)),Y=P[0],f=P[1],S=P[2];1!==K&&(Y*=K,f*=K,S*=K),U.push(Y,f,S,k.s("light.disabled")?1:0)},Ce=function(n,Y,Q){rf(Y,Q.uHeadlightRange,n._headlightRange);var H=n._headlightIntensity,t=Tj(n._headlightColor);1!==H&&(t=[t[0]*H,t[1]*H,t[2]*H]),rf(Y,Q.uHeadlightColor,[t[0],t[1],t[2],n._headlightDisabled?1:0]);var u=n._59O,j=n._spots,B=n._dirs;if(u.length){var R=[],C=[],U=[];u.forEach(function(E){Uk(R,E),mf(C,n._transformPointToViewSpace(E.p3())),U.push(E.s("light.range"))}),Y.uniform4fv(Q.uPointColor,R),Y.uniform1fv(Q.uPointRange,U),Y.uniform3fv(Q.uPointPosition,C)}if(j.length){var q=[],i=[],k=[],m=[],K=[],M=[];j.forEach(function(R){Uk(q,R),mf(i,n._transformPointToViewSpace(R.p3())),mf(K,n._transformDirectionToViewSpace(R.p3(),R.s("light.center"))),k.push(R.s("light.range")),m.push(y(R.s("light.angle")/2)),M.push(R.s("light.exponent"))}),Y.uniform4fv(Q.uSpotColor,q),Y.uniform1fv(Q.uSpotRange,k),Y.uniform1fv(Q.uSpotAngle,m),Y.uniform1fv(Q.uSpotExponent,M),Y.uniform3fv(Q.uSpotPosition,i),Y.uniform3fv(Q.uSpotDirection,K)}if(B.length){var g=[],e=[];B.forEach(function(s){Uk(g,s),mf(e,n._transformDirectionToViewSpace(s.p3()))}),Y.uniform4fv(Q.uDirColor,g),Y.uniform3fv(Q.uDirDirection,e)}},jn=function(E){return E>0&&0===(E-1&E)},Je=function(d){return d=E(0,z(B,d)),d=E(ns,z(B-ns,d))},ro=function(){return.05+w()/2},ps=function(O,R,D,W){var p,e=O.getEye();return O.isOrtho()?(p=xo(O.getCenter(),e),p[0]+=W[0],p[1]+=W[1],p[2]+=W[2]):p=e,Ff(R,D,W,p)},Ff=function(h,m,K,q){var w=Zo(h,m),a=xo(q,K,!0),t=Zo(a,m);if(s(t)<ns)return Z;var C=(w-Zo(K,m))/t;return[K[0]+a[0]*C,K[1]+a[1]*C,K[2]+a[2]*C]},ql=function(D,O){return{x:2*D.x-O.x,y:2*D.y-O.y}},Qd=function(l,j,O,o){var U,B;if(!l)return U=g(j.y-O.y,O.x-j.x),{x:j.x+o*J(U),y:j.y+o*y(U)};if(!O)return U=g(l.y-j.y,j.x-l.x),{x:j.x+o*J(U),y:j.y+o*y(U)};var t=xo([l.x,l.y,0],[j.x,j.y,0],!0),G=xo([O.x,O.y,0],[j.x,j.y,0],!0),A=-(t[0]+G[0])/2,Y=-(t[1]+G[1])/2,s=T(A*A+Y*Y);if(ns>s)return U=g(l.y-j.y,j.x-l.x),{x:j.x+o*J(U),y:j.y+o*y(U)};var e=l.x-j.x,K=l.y-j.y,N=O.x-j.x,r=O.y-j.y,Z=T(e*e+K*K),v=T(N*N+r*r);U=V(Zo(t,G))/2,B=t[1]*G[0]-t[0]*G[1]>0?-1:1,A/=s,Y/=s;var x=o/J(U),b=E(Z,v)/y(U);s=Math.min(x,b);var F={x:j.x+B*s*A,y:j.y+B*s*Y};return O.b&&x>v/y(U)&&(F.adjust=!0),F},Yi=function(O){var U=O[1],z=O[2],V=O[3],N=O[6],D=O[7],x=O[11];O[1]=O[4],O[2]=O[8],O[3]=O[12],O[4]=U,O[6]=O[9],O[7]=O[13],O[8]=z,O[9]=N,O[11]=O[14],O[12]=V,O[13]=D,O[14]=x},sl=function(E){var I=E[0],Y=E[1],$=E[2],U=E[3],C=E[4],S=E[5],o=E[6],v=E[7],x=E[8],k=E[9],s=E[10],t=E[11],u=E[12],f=E[13],h=E[14],A=E[15],l=I*S-Y*C,M=I*o-$*C,c=I*v-U*C,W=Y*o-$*S,R=Y*v-U*S,F=$*v-U*o,w=x*f-k*u,y=x*h-s*u,a=x*A-t*u,i=k*h-s*f,m=k*A-t*f,K=s*A-t*h,r=l*K-M*m+c*i+W*a-R*y+F*w;return r?(r=1/r,E[0]=(S*K-o*m+v*i)*r,E[1]=($*m-Y*K-U*i)*r,E[2]=(f*F-h*R+A*W)*r,E[3]=(s*R-k*F-t*W)*r,E[4]=(o*a-C*K-v*y)*r,E[5]=(I*K-$*a+U*y)*r,E[6]=(h*c-u*F-A*M)*r,E[7]=(x*F-s*c+t*M)*r,E[8]=(C*m-S*a+v*w)*r,E[9]=(Y*a-I*m-U*w)*r,E[10]=(u*R-f*c+A*l)*r,E[11]=(k*c-x*R-t*l)*r,E[12]=(S*y-C*i-o*w)*r,E[13]=(I*i-Y*y+$*w)*r,E[14]=(f*M-u*W-h*l)*r,E[15]=(x*W-k*M+s*l)*r,void 0):Z},Ql=function(c,_){if(_){var j=_[0],Z=_[1],U=_[2];c[12]=c[0]*j+c[4]*Z+c[8]*U+c[12],c[13]=c[1]*j+c[5]*Z+c[9]*U+c[13],c[14]=c[2]*j+c[6]*Z+c[10]*U+c[14],c[15]=c[3]*j+c[7]*Z+c[11]*U+c[15]}},vb=function(P,p){if(p){var u=p[0],F=p[1],I=p[2];P[0]=P[0]*u,P[1]=P[1]*u,P[2]=P[2]*u,P[3]=P[3]*u,P[4]=P[4]*F,P[5]=P[5]*F,P[6]=P[6]*F,P[7]=P[7]*F,P[8]=P[8]*I,P[9]=P[9]*I,P[10]=P[10]*I,P[11]=P[11]*I}},bn=function(h,E,U){var t=E[0],W=E[1],_=E[2],y=E[3],d=E[4],Y=E[5],S=E[6],T=E[7],b=E[8],l=E[9],$=E[10],r=E[11],j=E[12],R=E[13],O=E[14],v=E[15],H=U[0],G=U[1],s=U[2],C=U[3];return h[0]=H*t+G*d+s*b+C*j,h[1]=H*W+G*Y+s*l+C*R,h[2]=H*_+G*S+s*$+C*O,h[3]=H*y+G*T+s*r+C*v,H=U[4],G=U[5],s=U[6],C=U[7],h[4]=H*t+G*d+s*b+C*j,h[5]=H*W+G*Y+s*l+C*R,h[6]=H*_+G*S+s*$+C*O,h[7]=H*y+G*T+s*r+C*v,H=U[8],G=U[9],s=U[10],C=U[11],h[8]=H*t+G*d+s*b+C*j,h[9]=H*W+G*Y+s*l+C*R,h[10]=H*_+G*S+s*$+C*O,h[11]=H*y+G*T+s*r+C*v,H=U[12],G=U[13],s=U[14],C=U[15],h[12]=H*t+G*d+s*b+C*j,h[13]=H*W+G*Y+s*l+C*R,h[14]=H*_+G*S+s*$+C*O,h[15]=H*y+G*T+s*r+C*v,h},Rh=function(u,e,h,E){var Y,R,j,K,C,A,F,k,O,r,f=e[0],S=e[1],H=e[2],g=E[0],V=E[1],X=E[2],G=h[0],Q=h[1],q=h[2];return s(f-G)<ns&&s(S-Q)<ns&&s(H-q)<ns?$q(u):(F=f-G,k=S-Q,O=H-q,r=1/T(F*F+k*k+O*O),F*=r,k*=r,O*=r,Y=V*O-X*k,R=X*F-g*O,j=g*k-V*F,r=T(Y*Y+R*R+j*j),r?(r=1/r,Y*=r,R*=r,j*=r):(Y=0,R=0,j=0),K=k*j-O*R,C=O*Y-F*j,A=F*R-k*Y,r=T(K*K+C*C+A*A),r?(r=1/r,K*=r,C*=r,A*=r):(K=0,C=0,A=0),u[0]=Y,u[1]=K,u[2]=F,u[3]=0,u[4]=R,u[5]=C,u[6]=k,u[7]=0,u[8]=j,u[9]=A,u[10]=O,u[11]=0,u[12]=-(Y*f+R*S+j*H),u[13]=-(K*f+C*S+A*H),u[14]=-(F*f+k*S+O*H),u[15]=1,u)},Qk=function(P,b,B,K,v){var c=1/q(b/2),R=1/(K-v);return P[0]=c/B,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=c,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=(v+K)*R,P[11]=-1,P[12]=0,P[13]=0,P[14]=2*v*K*R,P[15]=0,P},dp=function(L,M,R,r,u,s,T){var Q=1/(M-R),A=1/(r-u),m=1/(s-T);return L[0]=-2*Q,L[1]=0,L[2]=0,L[3]=0,L[4]=0,L[5]=-2*A,L[6]=0,L[7]=0,L[8]=0,L[9]=0,L[10]=2*m,L[11]=0,L[12]=(M+R)*Q,L[13]=(u+r)*A,L[14]=(T+s)*m,L[15]=1,L},Mo=function(w,C){var u=C[0],v=C[1],b=C[2],n=C[3],Y=u*u+v*v+b*b+n*n,p=Y?1/Y:0;return w[0]=-u*p,w[1]=-v*p,w[2]=-b*p,w[3]=n*p,w},Ro=function(k,Q){var m=Q[0]+Q[5]+Q[10],d=0;return m>0?(d=2*Math.sqrt(m+1),k[3]=.25*d,k[0]=(Q[6]-Q[9])/d,k[1]=(Q[8]-Q[2])/d,k[2]=(Q[1]-Q[4])/d):Q[0]>Q[5]&Q[0]>Q[10]?(d=2*Math.sqrt(1+Q[0]-Q[5]-Q[10]),k[3]=(Q[6]-Q[9])/d,k[0]=.25*d,k[1]=(Q[1]+Q[4])/d,k[2]=(Q[8]+Q[2])/d):Q[5]>Q[10]?(d=2*Math.sqrt(1+Q[5]-Q[0]-Q[10]),k[3]=(Q[8]-Q[2])/d,k[0]=(Q[1]+Q[4])/d,k[1]=.25*d,k[2]=(Q[6]+Q[9])/d):(d=2*Math.sqrt(1+Q[10]-Q[0]-Q[5]),k[3]=(Q[1]-Q[4])/d,k[0]=(Q[8]+Q[2])/d,k[1]=(Q[6]+Q[9])/d,k[2]=.25*d),k},Ii=function(v,F,H){var $=F[0],K=F[1],q=F[2],V=F[3],w=$+$,O=K+K,k=q+q,L=$*w,A=$*O,E=$*k,a=K*O,Z=K*k,T=q*k,y=V*w,W=V*O,I=V*k;return v[0]=1-(a+T),v[1]=A+I,v[2]=E-W,v[3]=0,v[4]=A-I,v[5]=1-(L+T),v[6]=Z+y,v[7]=0,v[8]=E+W,v[9]=Z-y,v[10]=1-(L+a),v[11]=0,v[12]=H[0],v[13]=H[1],v[14]=H[2],v[15]=1,v},af=function(){var X=[0,0,0],y=[0,0,0],K=[0,0,0],v=function($,p,d){$[0]=p[1]*d[2]-p[2]*d[1],$[1]=p[2]*d[0]-p[0]*d[2],$[2]=p[0]*d[1]-p[1]*d[0]},h=function(Q){return Q[0]*Q[0]+Q[1]*Q[1]+Q[2]*Q[2]},c=function(k){var Y=Math.sqrt(h(k));k[0]/=Y,k[1]/=Y,k[2]/=Y},$=function(p,F,r){p[0]=F[0]-r[0],p[1]=F[1]-r[1],p[2]=F[2]-r[2]};return function(U,m,W){var b=Zg();return $(K,U,m),0===h(K)&&(K[2]=1),c(K),v(X,W,K),0===h(X)&&(1===Math.abs(W[2])?K[0]+=1e-4:K[2]+=1e-4,c(K),v(X,W,K)),c(X),v(y,K,X),b[0]=X[0],b[4]=y[0],b[8]=K[0],b[1]=X[1],b[5]=y[1],b[9]=K[1],b[2]=X[2],b[6]=y[2],b[10]=K[2],b}}(),bh=function(k,c){if(k.vr.enable){var U=k.vr.getViewMatrix(c);if(U)return U}return Rh(c?c:Zg(),k._eye,k._center,k._up)},fc=function(m){if(m.vr.enable){var U=m.vr.getProjectMatrix();if(U)return U}var x=m.getAspect(),H=m._near,P=m._far,_=Zg();if(m._ortho){var h=m._orthoWidth/2,l=h/x;dp(_,-h,h,-l,l,H,P)}else Qk(_,m._fovy,x,H,P);return _},Gc=function(i,u){if(!i)return Z;var D=0,r=1,A=2,U=[],z=0,H=i.length,x=H/3;if(u){for(;H>z;z++)U[z]=0;for(z=0;z<u.length;z+=3){var O=[],$=[],K=[];O[D]=i[3*u[z+1]+D]-i[3*u[z]+D],O[r]=i[3*u[z+1]+r]-i[3*u[z]+r],O[A]=i[3*u[z+1]+A]-i[3*u[z]+A],$[D]=i[3*u[z+2]+D]-i[3*u[z+1]+D],$[r]=i[3*u[z+2]+r]-i[3*u[z+1]+r],$[A]=i[3*u[z+2]+A]-i[3*u[z+1]+A],K[D]=O[r]*$[A]-O[A]*$[r],K[r]=O[A]*$[D]-O[D]*$[A],K[A]=O[D]*$[r]-O[r]*$[D];for(var e=0;3>e;e++)U[3*u[z+e]+D]+=K[D],U[3*u[z+e]+r]+=K[r],U[3*u[z+e]+A]+=K[A]}}else for(z=0;x>z;z+=3){var O=[],$=[],K=[];O[D]=i[3*(z+1)+D]-i[3*z+D],O[r]=i[3*(z+1)+r]-i[3*z+r],O[A]=i[3*(z+1)+A]-i[3*z+A],$[D]=i[3*(z+2)+D]-i[3*(z+1)+D],$[r]=i[3*(z+2)+r]-i[3*(z+1)+r],$[A]=i[3*(z+2)+A]-i[3*(z+1)+A],K[D]=O[r]*$[A]-O[A]*$[r],K[r]=O[A]*$[D]-O[D]*$[A],K[A]=O[D]*$[r]-O[r]*$[D];for(var e=0;3>e;e++)U[3*(z+e)+D]=K[D],U[3*(z+e)+r]=K[r],U[3*(z+e)+A]=K[A]}for(z=0;H>z;z+=3){var c=[];c[D]=U[z+D],c[r]=U[z+r],c[A]=U[z+A];var X=T(c[D]*c[D]+c[r]*c[r]+c[A]*c[A]);0===X&&(X=ns),c[D]=c[D]/X,c[r]=c[r]/X,c[A]=c[A]/X,U[z+D]=c[D],U[z+r]=c[r],U[z+A]=c[A]}return new Wp(U)},Ei=function(z,Y,Q,C){if(Q||(Q=z.createTexture()),Y){var q=z.TEXTURE_2D,H=z.REPEAT,c=z.CLAMP_TO_EDGE,X=z.TEXTURE_MIN_FILTER;C!==z.NEAREST&&(C=z.LINEAR),Un(z,Q),z.texImage2D(q,0,z.RGBA,z.RGBA,z.UNSIGNED_BYTE,Y),kk(z,z.TEXTURE_MAG_FILTER,C);var L=Y.naturalWidth||Y.width,I=Y.naturalHeight||Y.height;jn(L)&&jn(I)&&!Y.clampToEdge?(kk(z,z.TEXTURE_WRAP_S,H),kk(z,z.TEXTURE_WRAP_T,H),kk(z,X,z.LINEAR_MIPMAP_LINEAR),z.generateMipmap(q)):(kk(z,z.TEXTURE_WRAP_S,c),kk(z,z.TEXTURE_WRAP_T,c),kk(z,X,C)),Un(z,Z)}return Q},cg=function(N,R){var u=new Uint8Array(3);return R=R||N.createTexture(),Un(N,R),kk(N,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texImage2D(N.TEXTURE_2D,0,N.RGB,1,1,0,N.RGB,N.UNSIGNED_BYTE,u),R},tk=function(v){v._26I&&v._prg&&(v._26I.deleteProgram(v._prg),v._prg=Z)},Qb=function(W,h,b,e){var K=W.createShader(b);return W.shaderSource(K,e),W.compileShader(K),W.attachShader(h,K),K},Hj=function(p){return p.createBuffer()},Un=function(g,S){g.bindTexture(g.TEXTURE_2D,S)},Oj=function(J,C){J.frameStack?J.frameStack.push(C):J.frameStack=[C],J.bindFramebuffer(J.FRAMEBUFFER,C)},nr=function(F){var o=F.frameStack;if(o){if(o.pop(),o.length)return F.bindFramebuffer(F.FRAMEBUFFER,o[o.length-1]),void 0;F.frameStack=null}F.bindFramebuffer(F.FRAMEBUFFER,null)},kk=function(j,i,q){j.texParameteri(j.TEXTURE_2D,i,q)},Vd=function(N,t){N.enable(N.POLYGON_OFFSET_FILL),N.polygonOffset(t[0],t[1])},Zk=function(Y){Y.disable(Y.POLYGON_OFFSET_FILL)},Dq=function(I,N){if(N){var N=Tj(N);I.clearColor(N[0],N[1],N[2],N[3])}},Zl=function(b,f){rf(b,f.uFix,!0),hi(b,f.aNormal)},hm=function(m,d){rf(m,d.uFix,!1),Kj(m,d.aNormal)},pq=function(_,J,b,H,I,N,g,q){_._picking||(b?(rf(_,J.uBlend,!0),rf(_,J.uBlendColor,b)):rf(_,J.uBlend,!1),rf(_,J.uLight,H==Z?!0:H),Zi(I)&&1!==I&&rf(_,J.uPartOpacity,I),rf(_,J.uReverseFlip,N==Z?!1:N),rf(_,J.uFixPickReverseColor,g||bi)),q?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE)},Tk=function(z,E){z._picking||rf(z,E.uPartOpacity,1)},tj=function(s,q,L,M,W,j,X,J,T){if(!L)return s.activeTexture(s.TEXTURE0),Un(s,s._emptyTexture),s.activeTexture(s.TEXTURE1),Un(s,s._emptyBlendTexture),void 0;rf(s,q.uTexture,!0),rf(s,q.uDiscardSelectable,hf(M)?M:!0),Kj(s,q.aUv),vh(s,W,j,q.aUv,2),T?(rf(s,q.uBlendTexture,!0),s.activeTexture(s.TEXTURE1),Un(s,T),s.uniform1i(q.uBlendSampler,1)):(rf(s,q.uBlendTexture,!1),s.activeTexture(s.TEXTURE1),Un(s,s._emptyBlendTexture)),s.activeTexture(s.TEXTURE0),Un(s,L),s.uniform1i(q.uSampler,0);var S=[0,0,1,1];X&&(S[0]=X[0],S[1]=X[1]),J&&(S[2]=J[0],S[3]=J[1]),rf(s,q.uOffsetScale,S)},Ze=function(e,p,V){e.activeTexture(e.TEXTURE0),Un(e,Z),e.activeTexture(e.TEXTURE1),Un(e,Z),V&&(hi(e,p.aUv),rf(e,p.uTexture,!1),rf(e,p.uBlendTexture,!1))},jl=function(p,s,P,a,Z,O){!P||Y||Uh||p.lineWidth(P),a&&!p._picking&&rf(p,s.uFixPickReverseColor,a),Z&&vh(p,Z,O,s.aPosition)},yk=function(I,i,g,Y){ag&&(Y=I[ag]),I.drawArrays(Y==Z?I.TRIANGLES:Y,i,g);var E=I._renderInfo;E&&(E.calls++,E.vertices+=g,(Y==Z||Y===I.TRIANGLES)&&(E.faces+=g/3),Y===I.LINES&&(E.lines+=g/2))},Dc=function(g,L,Q,k){ag&&(k=g[ag]),g.drawElements(k==Z?g.TRIANGLES:k,Q,g.UNSIGNED_SHORT,L==Z?0:2*L);var x=g._renderInfo;x&&(x.calls++,x.vertices+=Q,(k==Z||k===g.TRIANGLES)&&(x.faces+=Q/3),k===g.LINES&&(x.lines+=Q/2))},js=function(I,O,j,P,y){var H=I.ARRAY_BUFFER;I.bindBuffer(H,O),j&&I.bufferData(H,j,I.STATIC_DRAW),P!=Z&&I.vertexAttribPointer(P,y?y:3,I.FLOAT,!1,0,0)},vh=function(O,u,F,m,S){return F?(td(O,O.ARRAY_BUFFER,u,F),m!=Z&&O.vertexAttribPointer(m,S?S:3,O.FLOAT,!1,0,0),void 0):js(O,u,F,m,S)},vd=function(N,M,b){var r=N.ELEMENT_ARRAY_BUFFER;N.bindBuffer(r,M),b&&N.bufferData(r,b,N.STATIC_DRAW)},Lc=function(r,m,H){td(r,r.ELEMENT_ARRAY_BUFFER,m,H)},td=function(W,y,M,w){var m=w._bufId;m||(m=w._bufId=k.Math.generateIncreasingID());var M,U=W._bufPool;(M=U[m])&&M._buf?W.bindBuffer(y,M._buf):(M=U[m]={_buf:Hj(W)},W.bindBuffer(y,M._buf),W.bufferData(y,w,W.STATIC_DRAW)),M._fid=W._renderInfo.frame},rf=function(m,y,N){if(N!=Z&&y!=Z){N=Tj(N);var v=N.length;3===v?m.uniform3fv(y,N):4===v?m.uniform4fv(y,N):16===v?m.uniformMatrix4fv(y,!1,N):hf(N)?m.uniform1i(y,N?1:0):2===v?m.uniform2fv(y,N):m.uniform1f(y,N)}},Kj=function(v,o){o!=Z&&o>=0&&v.enableVertexAttribArray(o)},hi=function($,r){r!=Z&&r>=0&&$.disableVertexAttribArray(r)},Go=function(g,t){var l=g.getGL(),I=g._prg;g._7O=g._8O.pop(),t&&(rf(l,I.uMVMatrix,g._7O),g._6O=t,rf(l,I.uNMatrix,t))},qk=function(y,P){return P||(P=Zg()),jd(P,y),sl(P),Yi(P),P},Mm=function(K,u){var B=K.getGL(),q=K._prg,Q=K._7O;u&&(K._8O.push(uo(Q)),rf(B,q.uMMatrix,u),bn(Q,Q,u),K._7O=Q),rf(B,q.uMVMatrix,Q),rf(B,q.uNMatrix,qk(Q,K._6O))},Tn=function(u,W,O,v,M,b){if(O){if(v){var m=O.value++,s=2147483648|m,h=[(255&s>>16)/255,(255&s>>8)/255,(255&s)/255,(255&s>>24)/255];O[m]={data:M,part:b}}else h=zm;return rf(u,W.uFixPickReverseColor,h),h}},qr=function(){var z={center:function(v,y,$,j,S){var z=-y[1]/2,u={x:-y[0]/2,y:z,width:y[0],height:y[1]},s=vk(v,u,$);return[s.x+j,-s.y-S,ro()]},front:function(S,g,$,f,e){var Z=-g[1]/2,J={x:-g[0]/2,y:Z,width:g[0],height:g[1]},b=vk(S,J,$);return[b.x+f,-b.y-e,g[2]/2+ro()]},back:function(M,x,z,W,c){var $=-x[0]/2,Z=-x[1]/2,T={x:$,y:Z,width:x[0],height:x[1]},r=vk(M,T,z);return[-r.x-W,-r.y-c,-x[2]/2-ro()]},left:function(Z,I,i,E,w){var x=-I[1]/2,n={x:-I[2]/2,y:x,width:I[2],height:I[1]},L=vk(Z,n,i);return[-I[0]/2-ro(),-L.y-w,L.x+E]},right:function(l,Q,r,A,s){var q=-Q[2]/2,W=-Q[1]/2,S={x:q,y:W,width:Q[2],height:Q[1]},v=vk(l,S,r);return[Q[0]/2+ro(),-v.y-s,-v.x-A]},top:function(j,H,N,Q,C){var o={x:-H[0]/2,y:-H[2]/2,width:H[0],height:H[2]},q=vk(j,o,N);return[q.x+Q,H[1]/2+ro(),q.y+C]},bottom:function(d,b,q,r,m){var U=-b[2]/2,M={x:-b[0]/2,y:U,width:b[0],height:b[2]},x=vk(d,M,q);return[x.x+r,-b[1]/2-ro(),-x.y-m]}};return function(P,s,i,V,_,U){return z[V](P,s,i,_||0,U||0)}}(),hp=function(W,d,A,k,z,U,h,T,X,y){if(z&&(d[0]+=z[0],d[1]+=z[1],d[2]+=z[2]),Ql(W,A),T){var f=Zg();if(Dh(f,X,y),jq(d,f),Ql(W,d),W.auto=T,W.pos=jq([0,0,0],W),U){var q=W.mat2=Zg();Dh(q,U,h)}}else Dh(W,X,y),Ql(W,d),k===Wf?Rk(W,-I):k===qb?Rk(W,I):k===uc?Ih(W,-I):k===Ul?Ih(W,I):k===Fd&&Rk(W,B),Dh(W,U,h);return W},zp=function(J,S){var n=S.auto,d=S.mat2,T=J.gv;if(n){var f,V=Zg(),A=[0,0,0,0];f="string"==typeof n?[n.indexOf("x")<0?T._eye[0]:T._center[0],n.indexOf("y")<0?T._eye[1]:T._center[1],n.indexOf("z")<0?T._eye[2]:T._center[2]]:T._eye,Ro(A,Rh(Zg(),f,T._center,T._up)),Ii(V,Mo(A,A),S.pos),d&&bn(V,V,d),Mm(T,V)}else Mm(T,S)},vq=function(G,z,o,p,N){var e=G.s,c=G.gv,b=c.getGL(),k=c._prg,R=c._buffer,t=c._1O;Ei(b,Yp,t),zp(G,o),pq(b,k,e(z+".blend"),e(z+".light"),e(z+".opacity"),e(z+".reverse.flip"),e(z+".reverse.color"),e(z+".reverse.cull")),tj(b,k,t,N,R.uv,sd),vh(b,R.vs,p,k.aPosition),vh(b,R.ns,ir,k.aNormal),Lc(b,R.is,Ap),Dc(b,0,Ap.length),Ze(b,k,t),Tk(b,k),Go(c)},ei=function(g,f,m){var l=g.gv,V=g.data,I=g[f]={blend:l.getBodyColor(V)||l.getFaceBlend(V,f),light:l.getFaceLight(V,f),color:l.getFaceColor(V,f),opacity:l.getFaceOpacity(V,f),transparent:l.getFaceTransparent(V,f),reverseFlip:l.getFaceReverseFlip(V,f),reverseColor:l.getFaceReverseColor(V,f),reverseCull:l.getFaceReverseCull(V,f),texture:l.getFaceImage(V,f),blendTexture:l.getFaceBlendImage(V,f),discardSelectable:l.getFaceDiscardSelectable(V,f)};if("csg"!==f){I.uv=l.getFaceUv(V,f)||m&&m[f+"Uv"],I.uvScale=l.getFaceUvScale(V,f)||m&&m[f+"UvScale"],I.uvOffset=l.getFaceUvOffset(V,f)||m&&m[f+"UvOffset"];var $=l.getFaceMat(V,f);$&&(I.mat=go(V,$))}return I},os=function(A,T,I,d,$){if(d){if(!$(d.transparent))return;var H=A.data,e=A.gv,L=e._buffer,f=e.getTexture(d.texture,H),V=e.getTexture(d.blendTexture,H);tj(T,I,f,d.discardSelectable,L.uv,d.tuv,d.uvOffset,d.uvScale,V),pq(T,I,d.blend,d.light,d.opacity,d.reverseFlip,d.reverseColor,d.reverseCull),rf(T,I.uDiffuse,d.color||S["color.empty"]),vh(T,L.vs,d.vs,I.aPosition),vh(T,L.ns,d.ns,I.aNormal),yk(T,0,d.vs.length/3),Tk(T,I),Ze(T,I,f)}},Qe=function(t,P,z,F,R,X){var K,E,Q,r,U,p,N,y,V,H,k,w=[F-P,R-z],u=t?t.length:0;for(Q=0;u>Q;Q++){for(r=2,K=t[Q],U=K[0],p=K[1];r+1<K.length;){if(N=K[r],y=K[r+1],E=fj(P,z,F,R,U,p,N,y,!0)){V=[N-U,y-p],H=Qn(V),V[0]/=H,V[1]/=H,H=Zo(w,V),H=H>0?X:-X,k=[V[0]*H,V[1]*H];break}U=N,p=y,r+=2}if(k)break}if(k)for(F=P+k[0],R=z+k[1],Q=0;u>Q;Q++)for(r=2,K=t[Q],U=K[0],p=K[1];r+1<K.length;){if(N=K[r],y=K[r+1],E=fj(P,z,F,R,U,p,N,y,!0))return[0,0];U=N,p=y,r+=2}return k?k:[F-P,R-z]},xb=k.graph3d={},Te=function(j,R,F){_p(o+".graph3d."+j,R,F)},qn="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",sb="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
Bm(M,{setBatchInfo:function(a,I){Gj[a]=I},getBatchInfo:function(l){return Gj[l]}},!0);var bp=[1,1,1],Nf=[1,0,0,0,0,1,0,1,1,1,1,0],Lr=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],ib=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Ik=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Rp=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],mm=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Ac=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],kq=function(J,s){Ec(J,s,"_batchModelMap","_batchIndexMap"),kf(J,s,"_wireframeModelMap","_wireframeIndexMap"),kf(J,s,"_polylineModelMap","_polylineIndexMap"),kf(J,s,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),kf(J,s,"_polylineModelMapSwap","_polylineIndexMapSwap")},Ec=function(f,U,X,Z){if(!U)return f[X]={},f[Z]={},void 0;var e=U._id,t=f[Z],z=t[e];if(z){var E=f[X],l=z.batch,$=E[l],p=$.ds,I=z.index;if($.invalidate=!0,delete t[e],p.splice(I,1),wk(p))return delete E[l],void 0;for(var o=z.begin,y=z.size,v=3*o,k=3*y,_=4*o,L=4*y,W=$.vs,j=$.ps,h=$.uv,d=$.cs,J=$.bs,b=$.rs,P=$.ns,m=$.ls;I<p.length;I++)z=t[p[I]._id],z.index--,z.begin-=y;W.splice(v,k),j.splice(_,L),h&&h.splice(2*o,2*y),d&&d.splice(_,L),J&&J.splice(v,k),b&&b.splice(o,y),P&&P.splice(v,k),m&&m.splice(o,y)}},kf=Ec,Gq=function(u,P,F,l){if(!l)return Z;var D=P[l];if(!D){var I=Gj[l]||kl,_=I.image?[]:Z;D=P[l]={vs:[],ns:[],uv:_,cs:_?Z:I.color?Z:[],bs:I.blend?[]:Z,ps:[],rs:I.brightness?[]:Z,ds:[]}}return D.invalidate=!0,u[F._id]={index:D.ds.length,begin:D.vs.length/3,batch:l},D.ds.push(F),D},Oh=function(Y,K){return K!=Z&&1!==K?[Y[0]*K,Y[1]*K,Y[2]*K,Y[3]]:Y},ab=function(k,c,Y){var J=k.getBrightness(c),x=Tj(Y.color||"white"),M=x[3]<1,m=Math.ceil(Y.width)||1,y=(M?"T":"O")+m,S=k._wireframeIndexMap,e=k._wireframeModelMap,n=e[y];n||(n=e[y]={vs:[],cs:[],ps:[],ds:[],T:M,W:m});var E,W=k.getData3dUI(c),v=kb(W);if(Y.geometry){if(!v)return;if(E=io(v),!E)return}else E=Y.short?am:yl;n.invalidate=!0;var Z=n.vs,G=n.cs,V=n.ds,B=S[c._id]={index:V.length,begin:Z.length/3,batch:y};V.push(c);var s=go(c,Y.mat),f=W._calcAnchorMat(c);f&&bn(s,s,f),Yn(Z,s,E);var K=B.size=Z.length/3-B.begin;Nc(G,Oh(x,J),K)},yh=function(O,F,l,H,R,i,L,j,C){var r=O.getBrightness(F);r==Z&&(r=1);var a=Oh(Tj(H),r),o=a[3]<1;i=Math.ceil(i)||1;var P=(o?"T":"O")+i;if(L){var K=L[0],d=(L[1]||K)+K;P+="-"+K+"-"+d,C&&(P+="-"+re(C)+"-"+r,C=Oh(Tj(C),r))}var s=O._polylineIndexMap,X=O._polylineModelMap,u=X[P];u||(u=X[P]={vs:[],cs:[],ps:[],ds:[],ls:L?[]:Z,T:o,W:i},L&&(u.D=K,u.G=d,u.A=C)),u.invalidate=!0;var S,n=u.vs,G=u.cs,W=u.ds,f=u.ls,E=s[F._id]={index:W.length,begin:n.length/3,batch:P};W.push(F),mf(n,l);var A,N=E.size=n.length/3-E.begin,e=l.length,c=0,y=[];if(L||R)for(S=0;e>S;S+=6)A=Qn([l[S],l[S+1],l[S+2]],[l[S+3],l[S+4],l[S+5]]),y.push(A),c+=A;if(c&&R){var b,M=Oh(Tj(R),r),$=[M[0]-a[0],M[1]-a[1],M[2]-a[2],M[3]-a[3]],_=0;for(S=0;e>S;S+=6)b=_/c,Nc(G,[a[0]+$[0]*b,a[1]+$[1]*b,a[2]+$[2]*b,a[3]+$[3]*b],1),_+=y[S/6],b=_/c,Nc(G,[a[0]+$[0]*b,a[1]+$[1]*b,a[2]+$[2]*b,a[3]+$[3]*b],1)}else Nc(G,a,N);if(L)for(_=j||0,S=0;e>S;S+=6)f.push(_),_+=y[S/6],f.push(_)},pe=function(z,R,M){if(R)for(var y=4*R.begin,Q=M[R.batch].ps,Y=0;Y<R.size;Y++)Q[y++]=z[0],Q[y++]=z[1],Q[y++]=z[2],Q[y++]=z[3]},Lg=function(p,q){var L=q+["32"],D=p[q],P=p[L];D?P&&P.length===D.length?(P.set(D),P._bufId=null):p[L]=new Wp(D):delete p[L]},Cm=function(J,B,k,O,T,l,g,R,M){if(Sp(k))k.forEach(function(K){Cm(J,B,K,O,T,l,g,R,M)});else if(Gk(k))Cm(J,B,kb(O,k),O,T,l,g,R,M);else if(Eq(k)){var H,x=Vc(k.mat,B,J),S=Vc(k.s3,B,J),q=Vc(k.t3,B,J),E=Vc(k.r3,B,J);if((S||E||q||x)&&(H=Jh(x,S,E,Vc(k.rotationMode,B,J),q),l.push(H)),k.shape3d)Cm(J,B,k.shape3d,O,T,l,g,R,k);else{var Z=O.s;M=M||kl;var F=l[0],r=l.length,N=Z("shape3d.color",k.color,M.color);if(T||(T=Z("shape3d.blend",k.blend,M.blend)),r>1){F=uo(F);for(var j=1;r>j;j++)bn(F,F,l[j])}k.vs&&Z(ee,k.visible,M.visible)&&Bh(F,g,R,k.vs,k.uv,k.is,T,N),k.top_vs&&Z(Wq,k.topVisible,M.topVisible)&&Bh(F,g,R,k.top_vs,k.top_uv,k.top_is,T,Z("shape3d.top.color",k.topColor,M.topColor)||N),k.bottom_vs&&Z(Bg,k.bottomVisible,M.bottomVisible)&&Bh(F,g,R,k.bottom_vs,k.bottom_uv,k.bottom_is,T,Z("shape3d.bottom.color",k.bottomColor,M.bottomColor)||N),k.from_vs&&Z(Nb,k.fromVisible,M.fromVisible)&&Bh(F,g,R,k.from_vs,k.from_uv,k.from_is,T,Z("shape3d.from.color",k.fromColor,M.fromColor)||N),k.to_vs&&Z(zg,k.toVisible,M.toVisible)&&Bh(F,g,R,k.to_vs,k.to_uv,k.to_is,T,Z("shape3d.to.color",k.toColor,M.toColor)||N)}H&&l.pop()}},Bh=function(m,F,Q,_,n,f,L,Z){var q,t=F.cs,c=F.uv,V=F.bs;if(f){q=f.length;for(var u=0;q>u;u++){var g=f[u];Yn(Q,m,[_[3*g],_[3*g+1],_[3*g+2]]),c&&mf(c,[n[2*g],n[2*g+1]])}}else q=_.length/3,Yn(Q,m,_),c&&mf(c,n);t&&Nc(t,Z,q),V&&(L?Vp(V,L,q):mf(V,bp,q))},Rm=function(T,J,g,A){var G=[];A?Cm(T.gv,T.data,A,T,T.getBodyColor(),[J],g,G):(Ig(T,Wf,J,g,G),Ig(T,qb,J,g,G),Ig(T,Nm,J,g,G),Ig(T,Fd,J,g,G),Ig(T,uc,J,g,G),Ig(T,Ul,J,g,G),Ig(T,"csg",J,g,G)),G.length&&(mf(g.vs,G),mf(g.ns,Gc(G)))},Ig=function(M,u,O,D,k){var r=M[u];if(r){var I=r.tuv;if(I){var N,b,J,l,G=r.uvScale,o=r.uvOffset;if(G)for(N=I.length,b=G[0],J=G[1],l=0;N>l;l+=2)I[l]*=b,I[l+1]*=J;if(o)for(N=I.length,b=o[0],J=o[1],l=0;N>l;l+=2)I[l]+=b,I[l+1]+=J}Bh(O,D,k,r.vs,I,Z,r.blend,r.color)}},lb=function(k,E,p,W,G,d,I,b){var o,h=p.cs,j=p.uv,H=p.bs;if(k.getFaceVisible(E,d)){var g=k.getFaceMat(E,d);if(g&&(G=go(E,g)),Yn(I,G,b),h&&Nc(h,k.getFaceColor(E,d),6),j){var B=k.getFaceUv(E,d)||W[d+"Uv"],U=k.getFaceUvScale(E,d)||W[d+"UvScale"],i=k.getFaceUvOffset(E,d)||W[d+"UvOffset"];B=B?[B[6],B[7],B[0],B[1],B[2],B[3],B[2],B[3],B[4],B[5],B[6],B[7]]:Nf;var l=B[0],M=B[1],z=B[2],e=B[3],F=B[4],y=B[5],O=B[6],N=B[7],X=B[8],T=B[9],w=B[10],C=B[11];if(U){var n=U[0],V=U[1];l*=n,M*=V,z*=n,e*=V,F*=n,y*=V,O*=n,N*=V,X*=n,T*=V,w*=n,C*=V}if(i){var s=i[0],v=i[1];l+=s,M+=v,z+=s,e+=v,F+=s,y+=v,O+=s,N+=v,X+=s,T+=v,w+=s,C+=v}j.push(l,M,z,e,F,y,O,N,X,T,w,C)}H&&(o=k.getBodyColor(E)||k.getFaceBlend(E,d),o?Vp(H,o,6):mf(H,bp,6))}},cr=function(P,x,k,W){var r=P.getGL(),f=P._prg,d=P._buffer;if(!P.drawFilter&&!us(x)){Mm(P),Zl(r,f);for(var L in x){var G=x[L];if(!(W&&!G.T||!W&&G.T)){G.invalidate?(G.invalidate=!1,Lg(G,"vs"),Lg(G,"cs"),Lg(G,"ls"),Lg(G,"ps")):k&&Lg(G,"ps");var y=G.vs32,t=k?G.ps32:G.cs32;jl(r,f,G.W,Z,d.vs,y);var V=G.D,N=!P._dashDisabled&&V;rf(r,f.uAlphaTest,S.alphaTest),N&&(rf(r,f.uDash,!0),rf(r,f.uDashDistance,V),rf(r,f.uDashGapDistance,G.G),Kj(r,f.aLineDistance),vh(r,d.lineDistance,G.ls32,f.aLineDistance,1),rf(r,f.uDiffuse,G.A||S["color.empty"]));var M=!P._batchColorDisabled;M&&(rf(r,f.uBatchColor,!0),Kj(r,f.aBatchColor),vh(r,d.batchColor,t,f.aBatchColor,4)),tj(r),yk(r,0,y.length/3,r.LINES),Ze(r),M&&(rf(r,f.uBatchColor,!1),hi(r,f.aBatchColor)),N&&(rf(r,f.uDash,!1),hi(r,f.aLineDistance))}}hm(r,f)}},Lb=function(k,$,P){var v,E,e,m,b,l,c,s,d,J,I,B=k.getGL(),u=k._prg,G=k._buffer,h=k._batchModelMap;if(!us(h)){Mm(k);for(v in h)if(E=Gj[v]||kl,!(P&&!E.transparent||!P&&E.transparent)&&(e=h[v],$||!E.transparentMask)){var t=P&&E.autoSort!==!1&&(k._33Q||e.invalidate);if(e.invalidate?(e.invalidate=!1,Lg(e,"vs"),Lg(e,"ns"),Lg(e,"cs"),Lg(e,"rs"),Lg(e,"ps"),Lg(e,"bs"),Lg(e,"uv")):$&&Lg(e,"ps"),b=e.vs32,l=$?e.ps32:e.cs32,d=e.uv32,c=e.bs32,s=e.rs32,I=b.length/3,t&&(e.is=Og(b,k.getEye())),I){m=E.light,J=k.getTexture(E.image),pq(B,u,Z,E.light,E.opacity,E.reverseFlip,E.reverseColor,E.reverseCull),l?k._batchColorDisabled||(rf(B,u.uBatchColor,!0),Kj(B,u.aBatchColor),vh(B,G.batchColor,l,u.aBatchColor,4)):rf(B,u.uDiffuse,E.color||S["color.empty"]);var Q=E.alphaTest;rf(B,u.uAlphaTest,Q===K?S.alphaTest:Q);var T=c&&!k._batchBlendDisabled;T&&(rf(B,u.uBatchBlend,!0),Kj(B,u.aBatchBlend),vh(B,G.batchBlend,c,u.aBatchBlend));var j=s&&!k._batchBrightnessDisabled;j&&(rf(B,u.uBatchBrightness,!0),Kj(B,u.aBatchBrightness),vh(B,G.batchBrightness,s,u.aBatchBrightness,1)),d?tj(B,u,J,E.discardSelectable,G.uv,d,E.uvOffset,E.uvScale):tj(B),vh(B,G.vs,b,u.aPosition),vh(B,G.ns,e.ns32,u.aNormal),e.is?(vd(B,G.is,e.is),Dc(B,0,I)):yk(B,0,I),d?Ze(B,u,J):Ze(B),l&&!k._batchColorDisabled&&(rf(B,u.uBatchColor,!1),hi(B,u.aBatchColor)),T&&(rf(B,u.uBatchBlend,!1),hi(B,u.aBatchBlend)),j&&(rf(B,u.uBatchBrightness,!1),hi(B,u.aBatchBrightness)),Tk(B,u)}}}},Og=function(C,h){for(var k=C.length/3,Z=new Array(k),x=k/3,T=new Array(x),N=0;x>N;N++)T[N]=N;T.sort(function(x,I){var f=9*x,d=[(C[f]+C[f+3]+2*C[f+6])/4,(C[f+1]+C[f+4]+2*C[f+7])/4,(C[f+2]+C[f+5]+2*C[f+8])/4];f=9*I;var t=[(C[f]+C[f+3]+2*C[f+6])/4,(C[f+1]+C[f+4]+2*C[f+7])/4,(C[f+2]+C[f+5]+2*C[f+8])/4],s=Qn(h,d)-Qn(h,t);return s>0?-1:0>s?1:0});for(var N=0;x>N;N++){var U=3*N,t=3*T[N];Z[U]=t,Z[U+1]=t+1,Z[U+2]=t+2}return new pb(Z)},We={obj:function($,W){var Q={mat:$.mat,s3:$.s3,r3:$.r3,rotationMode:$.rotationMode,t3:$.t3,cube:$.cube==Z?!0:$.cube,center:$.center==Z?!0:$.center,ignoreMtls:$.ignoreMtls,ignoreTransparent:$.ignoreTransparent,ignoreColor:$.ignoreColor,ignoreImage:$.ignoreImage,ignoreNormal:$.ignoreNormal,prefix:$.prefix,flipY:$.flipY,flipFace:$.flipFace,reverseFlipMtls:$.reverseFlipMtls,finishFunc:function(c,I){if(c){var I=[];for(var A in c){var S=c[A];I.rawS3=S.rawS3,I.push(S),$.eachModel&&$.eachModel(A,S)}I.json=$,W(I)}else W()}};M.loadObj($.obj,$.mtl,Q)}};M.getModelTypeHandlers=function(){return We},M.setModelTypeHandler=function(h,N){We[h]=N},M.getModelTypeHandler=function(H){return We[H]},M.handleModelLoaded=function(){},M.handleUnfoundModel=function(){};var nq=Z,Ui=Z,zb=function(j){nq&&!j._loadingModelView_&&(Ui||(Ui={}),Ui[j._loadingModelView_=rh()]=j)},Yq=function(w,b){nq||(nq={});var P=nq[w];if(P){if(P.url===b)return;P.request.onload=mb,P.request.onerror=mb}var a=new Lo;if(nq[w]={request:a,url:b},b=M.beforeLoadURL(b),b.data){var $=M.parse(b.data);Rg(w,$,b)}else{a.onload=function(C){if(200===this.status||0===this.status){delete nq[w];var f=M.parse(C.target.response||C.target.responseText);Rg(w,f,b)}else Tf(w,M.handleUnfoundModel(w,b)||Z)},a.onerror=function(){Tf(w,M.handleUnfoundModel(w,b)||Z)};var C={};C.url=encodeURI(b),C.sync=!1,a.send(C)}},Rg=function(i,c,v){var _=c.modelType;if(!_)return Tf(i,c),M.handleModelLoaded(i,c),void 0;var w=M.getModelTypeHandler(_);if(w){if(nq||(nq={}),nq[i])return;nq[i]=!0;var I=function(p){p?(Tf(i,p),M.handleModelLoaded(i,p)):Tf(i,M.handleUnfoundModel(i,v)||Z)};w(c,I)}else Tf(i,M.handleUnfoundModel(i,v)||Z)},Tf=function(U,q){if(rs[U]=q,delete nq[U],us(nq)&&(nq=Z,Ui)){for(var L in Ui){var D=Ui[L];D._2O&&(D._2O={}),D.invalidateAll&&D.invalidateAll(K,"modelLoaded",U),D.redraw&&D.redraw(),D.iv(),delete D._loadingModelView_}Ui=Z}if(q&&Ui)for(var L in Ui){var D=Ui[L];D.invalidateAll&&D.invalidateAll(K,"modelLoading",U),D.redraw&&D.redraw(),D.iv()}},sd=new Wp([0,0,0,1,1,1,1,0]),ir=new Wp([0,0,1,0,0,1,0,0,1,0,0,1]),Ap=new pb([0,1,2,2,3,0]),xm=new Wp([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Tp=new pb([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),sh=new Wp([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),wj=Gc(xm,Tp),Of=(new Wp([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new pb([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Wf,Nm,qb,Fd,uc,Ul]),yl=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],am=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],ie=function(k,f,Q,D,P,i){i=i||16,k=k||16,f=f||0,Q=Q||k;var o,V,h,v,q,z,K,r,S=.5,e=[],m=[],C=G/k,j=B/i;for(o=0;i>o;o++)for(q=o+1,v=o*j,r=q*j,V=f;Q>V;V++)z=V+1,h=V*C,K=z*C,e.push(S*J(v)*y(h),S*y(v),-S*J(v)*J(h),S*J(r)*y(K),S*y(r),-S*J(r)*J(K),S*J(v)*y(K),S*y(v),-S*J(v)*J(K),S*J(v)*y(h),S*y(v),-S*J(v)*J(h),S*J(r)*y(h),S*y(r),-S*J(r)*J(h),S*J(r)*y(K),S*y(r),-S*J(r)*J(K)),m.push(V/k,o/i,z/k,q/i,z/k,o/i,V/k,o/i,V/k,q/i,z/k,q/i);if(D){var b=[],F=[];for(h=f*C,o=0;i>o;o++)q=o+1,v=o*j,r=q*j,b.push(0,0,0,S*J(r)*y(h),S*y(r),-S*J(r)*J(h),S*J(v)*y(h),S*y(v),-S*J(v)*J(h)),F.push(0,.5,f/k,q/i,f/k,o/i)}if(P){var L=[],M=[];for(h=Q*C,o=0;i>o;o++)q=o+1,v=o*j,r=q*j,L.push(0,0,0,S*J(v)*y(h),S*y(v),-S*J(v)*J(h),S*J(r)*y(h),S*y(r),-S*J(r)*J(h)),M.push(1,.5,Q/k,o/i,Q/k,q/i)}return{vs:e,uv:m,from_vs:b,from_uv:F,to_vs:L,to_uv:M}},Sr=function(b,K,$){b=b||.17,K=K||12,$=$||18,0>b?b=0:b>.25&&(b=.25);var h,E,A,t,n,w,R,Q=.5,_=[],l=[],N=[],e=G/$,X=G/K,O=Q-b;for(E=0;K>=E;E++)for(t=-B+E*X,w=y(t),n=J(t),h=0;$>=h;h++)A=h*e,R=O+b*w,_.push(y(A)*R,n*b,-J(A)*R),l.push(h/$,1-E/K);for(E=0;K>E;E++){var Y=E*($+1),r=(E+1)*($+1);for(h=0;$>h;h++)N.push(Y+h,r+h+1,r+h,Y+h,Y+h+1,r+h+1)}return{vs:_,uv:l,is:N}},Fr=function(I,n,g,_,o,D,t){t=t||12,I=I||18,n=n||0,g=g||I,D=D||.17,0>D?D=0:D>.25&&(D=.25);var O,m,T,C,j,E,Y,M,$,b,P=.5,F=[],d=[],U=G/I,h=G/t,H=P-D;for(T=0;t>T;T++)for(C=T+1,Y=-B+T*h,M=-B+C*h,O=n;g>O;O++)m=O+1,j=O*U,E=m*U,$=H+D*y(Y),b=H+D*y(M),F.push(y(j)*$,J(Y)*D,-J(j)*$,y(E)*$,J(Y)*D,-J(E)*$,y(E)*b,J(M)*D,-J(E)*b,y(j)*$,J(Y)*D,-J(j)*$,y(E)*b,J(M)*D,-J(E)*b,y(j)*b,J(M)*D,-J(j)*b),d.push(O/I,1-T/t,m/I,1-T/t,m/I,1-C/t,O/I,1-T/t,m/I,1-C/t,O/I,1-C/t);if(_){var v=[],s=[];for(T=0;t>T;T++)C=T+1,Y=-B+T*h,M=-B+C*h,j=n*U,$=H+D*y(Y),b=H+D*y(M),v.push(y(j)*$,J(Y)*D,-J(j)*$,y(j)*b,J(M)*D,-J(j)*b,y(j)*H,0,-J(j)*H),s.push(.5+.5*y(Y),.5-.5*J(Y),.5+.5*y(M),.5-.5*J(M),.5,.5)}if(o){var f=[],p=[];for(T=0;t>T;T++)C=T+1,Y=-B+T*h,M=-B+C*h,j=g*U,$=H+D*y(Y),b=H+D*y(M),f.push(y(j)*$,J(Y)*D,-J(j)*$,y(j)*H,0,-J(j)*H,y(j)*b,J(M)*D,-J(j)*b),p.push(.5-.5*y(Y),.5-.5*J(Y),.5,.5,.5-.5*y(M),.5-.5*J(M))}return{vs:F,uv:d,from_vs:v,from_uv:s,to_vs:f,to_uv:p}},ae=function(t,V){for(var Z,g,K,f=.5,N=16,U=[],d=[],B=[],Y=G/N,q=0;N>=q;q++)Z=q*Y,g=y(Z)*f,K=J(Z)*f,U.push(g,-f,K,g,f,K),d.push(1-q/N,1,1-q/N,0);for(q=0;N>q;q++)B.push(2*q,2*q+1,2*q+3,2*q,2*q+3,2*q+2);if(V){var Q=[],a=[],w=[];for(Q.push(0,-f,0),a.push(.5,.5),q=0;N>=q;q++)Z=q*Y,g=y(Z),K=J(Z),Q.push(g*f,-f,-K*f),a.push(.5+.5*g,.5+.5*K);for(q=0;N>q;q++)w.push(0,q+2,q+1)}if(t){var b=[],X=[],c=[];for(b.push(0,f,0),X.push(.5,.5),q=0;N>=q;q++)Z=q*Y,g=y(Z),K=J(Z),b.push(g*f,f,-K*f),X.push(.5+.5*g,.5-.5*K);for(q=0;N>q;q++)c.push(0,q+1,q+2)}return{vs:U,uv:d,is:B,bottom_vs:Q,bottom_uv:a,bottom_is:w,top_vs:b,top_uv:X,top_is:c}},Hk=function(j,z,c,H,S,e,W){j=j||12,z=z||0,c=c||j;for(var n,i,t,Y,X,_,b,V,A=.5,P=[],I=[],w=G/j,m=z;c>m;m++)n=m+1,i=m*w,t=n*w,Y=y(i)*A,X=J(i)*A,_=y(t)*A,b=J(t)*A,P.push(Y,-A,-X,_,-A,-b,Y,A,-X,_,-A,-b,_,A,-b,Y,A,-X),I.push(m/j,1,n/j,1,m/j,0,n/j,1,n/j,0,m/j,0);if(W){var M=[],u=[];for(m=z;c>m;m++)i=w*m,t=w*(m+1),Y=y(i),X=J(i),_=y(t),b=J(t),M.push(Y*A,-A,-X*A,0,-A,0,_*A,-A,-b*A),u.push(.5+.5*Y,.5+.5*X,.5,.5,.5+.5*_,.5+.5*b)}if(e){var B=[],k=[];for(m=z;c>m;m++)i=w*m,t=w*(m+1),Y=y(i),X=J(i),_=y(t),b=J(t),B.push(Y*A,A,-X*A,_*A,A,-b*A,0,A,0),k.push(.5+.5*Y,.5-.5*X,.5+.5*_,.5-.5*b,.5,.5)}if(H){var v=[],o=[];i=w*z,Y=y(i)*A,X=J(i)*A,V=z/j,v.push(0,A,0,0,-A,0,Y,-A,-X,Y,-A,-X,Y,A,-X,0,A,0),o.push(0,0,0,1,V,1,V,1,V,0,0,0)}if(S){var U=[],x=[];i=w*c,Y=y(i)*A,X=J(i)*A,V=c/j,U.push(0,-A,0,0,A,0,Y,A,-X,Y,A,-X,Y,-A,-X,0,-A,0),x.push(1,1,1,0,V,0,V,0,V,1,1,1)}return{vs:P,uv:I,bottom_vs:M,bottom_uv:u,top_vs:B,top_uv:k,from_vs:v,from_uv:o,to_vs:U,to_uv:x}},be=function(W,n,e,j,a){n=n||18,e=e||0,j=j==Z?G:j,a=a==Z?.5:a;for(var v,d,N,K,O,U,f=[0,.5,.75,.875,.9375],g=[],w=[],D=[],l=j/n,B=0;B<f.length;B++){var c=0===B%2?0:.5;for(v=0;n>=v;v++)d=(v+c)*l+e,N=1-f[B],g.push(y(d)*a*N,-a+2*f[B]*a,-J(d)*a*N),w.push((v+c)/n,N)}for(B=0;B<f.length-1;B++){var q=B*(n+1),V=(B+1)*(n+1);for(v=0;n>v;v++)D.push(q+v,V+v+1,V+v,q+v,q+v+1,V+v+1)}for(U=g.length/3-(n+1),v=0;n>v;v++)g.push(0,a,0),w.push((v+.5)/n,0);for(v=0;n>v;v++)D.push(U+v,U+v+1,U+(n+1)+v);if(W){var T=[],C=[],z=[];for(T.push(0,-a,0),C.push(.5,.5),v=0;n>=v;v++)d=v*l+e,K=y(d),O=J(d),T.push(K*a,-a,-O*a),C.push(.5+.5*K,.5+.5*O);for(v=0;n>v;v++)z.push(0,v+2,v+1)}return{vs:g,uv:w,is:D,bottom_vs:T,bottom_uv:C,bottom_is:z}},hk=function(p,c,D,d,f,w){p=p||16,c=c||0,D=D||p;for(var X=.5,h=[],m=[],O=G/p,i=c;D>i;i++){var V=i+1,r=O*i,W=O*V;h.push(y(r)*X,-X,-J(r)*X,y(W)*X,-X,-J(W)*X,0,X,0),m.push(i/p,1,V/p,1,(i+V)/2/p,0)}if(w){var K=[],s=[];for(i=c;D>i;i++){r=O*i,W=O*(i+1);var g=y(r),E=J(r),l=y(W),S=J(W);K.push(g*X,-X,-E*X,0,-X,0,l*X,-X,-S*X),s.push(.5+.5*g,.5+.5*E,.5,.5,.5+.5*l,.5+.5*S)}}if(d){var a=[],Z=[];r=O*c,a.push(0,X,0,0,-X,0,y(r)*X,-X,-J(r)*X),Z.push(0,0,0,1,c/p,1)}if(f){var L=[],t=[];r=O*D,L.push(0,-X,0,0,X,0,y(r)*X,-X,-J(r)*X),t.push(1,1,1,0,D/p,1)}return{vs:h,uv:m,bottom_vs:K,bottom_uv:s,from_vs:a,from_uv:Z,to_vs:L,to_uv:t}},dk=function(V,p,W,R,Q,o,X,M){for(var N=[],E=0;E<V.length-1;E+=2)N.push({x:V[E],y:V[E+1]});return ko(N,p,W,R,Q,o,X,M,!1)},Qh={roundRect:function(f,d){return dk([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],f,d,3)},star:function(x,w){return dk([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],x,w)},rect:function(D,O){return dk([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],D,O)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(Y,W){return dk([0,-.5,.5,.5,-.5,.5],[1,2,2,5],Y,W)},rightTriangle:function(L,t){return dk([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],L,t)},parallelogram:function(r,S){return dk([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],r,S)},trapezoid:function(V,J){return dk([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],V,J)}},Dj={sphere:1,cylinder:1,cone:1,torus:1},yi={torus:1,sphere:1},No=Bm(nh(Qh),{cylinder:1}),Jm=Bm(nh(Qh),{cylinder:1,cone:1}),Bp=function(u,C,k){var I,G=Vc(u.anchor3d,k,C),n=Vc(u.mat,k,C),j=Vc(u.s3,k,C),P=Vc(u.t3,k,C),r=Vc(u.r3,k,C),E=j||r||P||n;if(G||E){I=uo(C._6O);var a=E?Jh(n,j,r,Vc(u.rotationMode,k,C),P):Zg();G&&Ql(a,[.5-G[0],.5-G[1],.5-G[2]]),Mm(C,a)}return I},di=function(R,C,M,B,h,S,Y){if(Sp(M))M.forEach(function(o){di(R,C,o,B,h,S,Y)});else if(Gk(M))di(R,C,kb(B,M),B,h,S,Y);else if(Eq(M))if(M.shape3d){var F=Bp(M,R,C);di(R,C,M.shape3d,B,h,S,M),F&&Go(R,F)}else kr(R,C,M,B.s,h,S,Y)},kr=function(m,X,z,W,F,f,E){if(E=E||kl,!f||f(W("shape3d.transparent",z.transparent,E.transparent))){var I=Bp(z,m,X);Ok(z);var J=m._26I,t=m._prg,S=m._buffer,x=W("shape3d.color",z.color,E.color);F||(F=W("shape3d.blend",z.blend,E.blend));var U,w=z.opacity==Z?E.opacity:z.opacity,L=W("shape3d.opacity");U=L!=Z&&w!=Z?w*L:w!=Z?w:L,pq(J,t,F,W("shape3d.light",z.light,E.light),U,W("shape3d.reverse.flip",z.reverseFlip,E.reverseFlip),W("shape3d.reverse.color",z.reverseColor,E.reverseColor),W("shape3d.reverse.cull",z.reverseCull,E.reverseCull));var s=W("polygonOffset",z.polygonOffset,E.polygonOffset);z.vs&&W(ee,z.visible,E.visible)&&fn(J,t,S,x,m.getTexture(W("shape3d.image",z.image,E.image),X),W("shape3d.discard.selectable",z.discardSelectable,E.discardSelectable),z.vs,z.uv,z.ns,z.is,W("shape3d.uv.offset",z.uvOffset,E.uvOffset),W("shape3d.uv.scale",z.uvScale,E.uvScale),s),z.top_vs&&W(Wq,z.topVisible,E.topVisible)&&fn(J,t,S,W("shape3d.top.color",z.topColor,E.topColor)||x,m.getTexture(W("shape3d.top.image",z.topImage,E.topImage),X),W("shape3d.top.discard.selectable",z.topDiscardSelectable,E.topDiscardSelectable),z.top_vs,z.top_uv,z.top_ns,z.top_is,W("shape3d.top.uv.offset",z.topUvOffset,E.topUvOffset),W("shape3d.top.uv.scale",z.topUvScale,E.topUvScale),s),z.bottom_vs&&W(Bg,z.bottomVisible,E.bottomVisible)&&fn(J,t,S,W("shape3d.bottom.color",z.bottomColor,E.bottomColor)||x,m.getTexture(W("shape3d.bottom.image",z.bottomImage,E.bottomImage),X),W("shape3d.bottom.discard.selectable",z.bottomDiscardSelectable,E.bottomDiscardSelectable),z.bottom_vs,z.bottom_uv,z.bottom_ns,z.bottom_is,W("shape3d.bottom.uv.offset",z.bottomUvOffset,E.bottomUvOffset),W("shape3d.bottom.uv.scale",z.bottomUvScale,E.bottomUvScale),s),z.from_vs&&W(Nb,z.fromVisible,E.fromVisible)&&fn(J,t,S,W("shape3d.from.color",z.fromColor,E.fromColor)||x,m.getTexture(W("shape3d.from.image",z.fromImage,E.fromImage),X),W("shape3d.from.discard.selectable",z.fromDiscardSelectable,E.fromDiscardSelectable),z.from_vs,z.from_uv,z.from_ns,z.from_is,W("shape3d.from.uv.offset",z.fromUvOffset,E.fromUvOffset),W("shape3d.from.uv.scale",z.fromUvScale,E.fromUvScale),s),z.to_vs&&W(zg,z.toVisible,E.toVisible)&&fn(J,t,S,W("shape3d.to.color",z.toColor,E.toColor)||x,m.getTexture(W("shape3d.to.image",z.toImage,E.toImage),X),W("shape3d.to.discard.selectable",z.toDiscardSelectable,E.toDiscardSelectable),z.to_vs,z.to_uv,z.to_ns,z.to_is,W("shape3d.to.uv.offset",z.toUvOffset,E.toUvOffset),W("shape3d.to.uv.scale",z.toUvScale,E.toUvScale),s),Tk(J,t),I&&Go(m,I)}},fn=function(u,c,$,z,V,h,I,x,H,q,l,X,v){I&&(v&&Vd(u,v),rf(u,c.uDiffuse,z||S["color.empty"]),x?tj(u,c,V,h,$.uv,x,l,X):tj(u),vh(u,$.vs,I,c.aPosition),vh(u,$.ns,H,c.aNormal),q?(Lc(u,$.is,q),Dc(u,0,q.length)):yk(u,0,I.length/3),x?Ze(u,c,V):Ze(u),v&&Zk(u))},kb=function(U,z){var F=U.s;if(z||(z=F(yg)),!z)return Z;var w=pm(z);if(w)return w;if("text"===z){var q={amount:F("shape3d.text.amount"),size:F("shape3d.text.size"),font:F("shape3d.text.font"),style:F("shape3d.text.style"),weight:F("shape3d.text.weight"),fill:F("shape3d.text.fill"),curveSegments:F("shape3d.text.curveSegments"),spacing:F("shape3d.text.spacing")},h=U.gv.getShape3dText(U.data),u=h;for(var O in q)u+="_"+(q[O]===K?"U":q[O]);return U._cachedTextKey===u?U._cachedTextGeometry:(U._cachedTextKey=u,U._cachedTextGeometry=M.createTextGeometry(h,q))}var O=z;if(Dj[z]){var m=F("shape3d.side"),j=F("shape3d.side.from"),g=F("shape3d.side.to"),W=F(Nb),A=F(zg);3>m?(m=0,j=0,g=0,W=!1,A=!1):((j==Z||0>j)&&(j=0),(g==Z||g>m)&&(g=m),0===j&&g===m&&(W=!1,A=!1)),O+="-"+m+"-"+j+"-"+g+"-"+W+"-"+A}if(No[z]){var X=F(Wq);O+="-"+X}if(Jm[z]){var S=F(Bg);O+="-"+S}if("torus"===z){var t=F("shape3d.torus.radius");0>t?t=0:t>.25&&(t=.25),O+="-"+t}if(yi[z]){var p=F(Fb);O+="-"+p}return w=Xc[O],w||("box"===z?w=M.createBoxModel():Qh[z]?w=Qh[z](X,S):"sphere"===z?w=M.createSphereModel(m,j,g,W,A,p):z===kp?w=M.createCylinderModel(m,j,g,W,A,X,S):"cone"===z?w=M.createConeModel(m,j,g,W,A,S):"torus"===z&&(w=M.createTorusModel(m,j,g,W,A,t,p)),Xc[O]=w),w},Ok=function(){var f=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],B=["is","top_is","bottom_is","from_is","to_is"];return P=ls(qn.substr(qn.indexOf("^#")+2)),rl(M[$d(_i+f[15]+"n"+f[16])]())&&cm()?function(v){v&&!v._complete_&&(v._complete_=!0,v.vs&&wk(v.ns)&&(v.ns=Gc(v.vs,v.is)),v.top_vs&&wk(v.top_ns)&&(v.top_ns=Gc(v.top_vs,v.top_is)),v.bottom_vs&&wk(v.bottom_ns)&&(v.bottom_ns=Gc(v.bottom_vs,v.bottom_is)),v.from_vs&&wk(v.from_ns)&&(v.from_ns=Gc(v.from_vs,v.from_is)),v.to_vs&&wk(v.to_ns)&&(v.to_ns=Gc(v.to_vs,v.to_is)),f.forEach(function(c){var e=v[c];Sp(e)&&(v[c]=new Wp(e))}),B.forEach(function(N){var M=v[N];Sp(M)&&(v[N]=new pb(M))}))}:void 0}(),bo=function(t,$){var G=t[$];Sp(G)&&(t[$]=new Wp(G))};Bm(gi,{_25Q:function(V){V._16O=function(f,N,c,X,P,i,J,D,C){var x=this.info;if(x){var T,F,G,U,h,$,A=Zg();if(ur[N]?(T=x.p3,F=x.c1,G=x.c2):Yc[N]?(F=x.s1||x.c1,G=x.s2||x.c2):(F=x.t1||x.c1,G=x.t2||x.c2),T)$=qr(N,ue,c,X,D,C);else{var j=xo(G,F),Z=Qn(F,G);U=[0,-g(j[2],j[0]),m(j[1]/Z)],h="zyx",T=[(F[0]+G[0])/2,(F[1]+G[1])/2,(F[2]+G[2])/2],$=qr(N,[Z,0,0],c,X,D,C)}return hp(A,$,T,X,P,i,J,f,U,h)}return _e},V._80o=function(L,E,C){var H=this,r=H.shapeModel;if(r){var h=H.gv;Mm(h),di(h,H.data,r,H,H.getBodyColor(),C)}},V.createLineModel=function(I,Q,D,F,K){for(var o=this,d=o.s,e=gd(I,Q,d(Fb)),P=[],q=0;q<e.length;q++){var N=e[q],c=N.length;if(c>1){var v=N[0];P.push(v.x,v.y,v.z);for(var p=1;c-1>p;p++)v=N[p],P.push(v.x,v.y,v.z),P.push(v.x,v.y,v.z);v=N[c-1],P.push(v.x,v.y,v.z)}}var V,l,u,h=d(F+".color"),O=d(K),n=0;return O&&(l=d(K+".color"),V=d(K+".pattern"),n=d(K+".offset"),u=h),yh(o.gv,o.data,P,l||h,u?Z:d(F+".gradient.color"),D,V||d(F+".pattern"),n,u),e},V.createTubeModel=function(j,s,T,L){for(var y=this,O=y.s,Y=O("shape3d.side")||Ho,d=O("shape3d.start.angle"),m=O("shape3d.sweep.angle"),g=O(Wq)?O("shape3d.top.cap"):Z,b=O(Bg)?O("shape3d.bottom.cap"):Z,f="flat"===g,I="flat"===b,n=f&&(L?L.uv:O("shape3d.top.image")),r=I&&(L?L.uv:O("shape3d.bottom.image")),H=L?L.uv:O("shape3d.image"),A={vs:[],uv:H?[]:Z,top_vs:f?[]:Z,top_uv:n?[]:Z,bottom_vs:I?[]:Z,bottom_uv:r?[]:Z},N=gd(j,s,O(Fb),T),a=0,M=N.length;M>a;a++)ap(A,N[a],O(Bf),T,Y,d,m,g,b);if(L){var v=[];Cm(y.gv,y.data,A,y,y.getBodyColor(),[],L,v),v.length&&(mf(L.vs,v),mf(L.ns,Gc(v)))}else y.shapeModel=A;return N},V.getCache=function(){var D=this.info;if(D){var h=D.list;if(h){var N=D.cache;return N||(N=D.cache=ji(h)),N}}return Z}}});var hd=function(k,n){for(var y,J=0,g=k.length,w=0,o=g-1;o>=w;)if(J=v(w+(o-w)/2),y=k[J].length-n,0>y)w=J+1;else{if(!(y>0)){o=J;break}o=J-1}J=o;var d=k[J],N=d.point;return J===g-1||d.length===n||(N=(new sc).subVectors(k[J+1].point,N).normalize().multiplyScalar(n-d.length).add(N)),{point:N,tangent:d.tangent}},ji=function(N){for(var P,Z,U=[],r=0,W=0;W<N.length;W++){for(var O=N[W],I=0;I<O.length;I++){P=O[I],Z&&(r+=Z.distanceTo(P));var S=new sc,T=O[I+1];T?S.subVectors(T,P):Z?S.subVectors(P,Z):S.x=1,S.normalize(),U.push({point:P,length:r,tangent:S}),Z=P}Z=null}return U},gd=function(r,K,c,U){c=c||pj;for(var o=[],l=0,X=r.size();X>l;l++){var x=r.get(l);o.push(new sc(x.x,x.e||0,x.y))}K&&(ff(K)&&(K=K._as),K.length||(K=null));for(var W,C,T,J,L,H=[],i=0,y=0,V=K?K.length:X;V>y;y++)if(L=K?K[y]:0===y?1:2,1===L)H.push(T=[]),T.push(o[i++]);else if(2===L||5===L)if(J=2===L?o[i++]:T[0],U){var t=K?K[y+1]:V>y+1?2:Z;if(2===t||5===t){var n=T[T.length-1],D=2===t?o[i]:T[0],p=(new sc).subVectors(n,J),e=(new sc).subVectors(D,J),S=p.length(),s=e.length();if(S&&s)if(U>S/2&&U>s/2)T.push(J);else for(p.multiplyScalar(z(U,S/2)/S).add(J),e.multiplyScalar(z(U,s/2)/s).add(J),W=new fs(p,J,e).getPoints(c),C=0;c>=C;C++)T.push(W[C])}else T.push(J)}else T.push(J);else if(3===L)for(W=new fs(T[T.length-1],o[i++],o[i++]).getPoints(c),C=1;c>=C;C++)T.push(W[C]);else if(4===L)for(W=new bl(T[T.length-1],o[i++],o[i++],o[i++]).getPoints(c),C=1;c>=C;C++)T.push(W[C]);return H},ge=function(l){for(var x,K,R=new sc,M=[],k=[],Q=[],b=0,u=l.length;u>b;b++)x=l[b],K=l[b+1],K?R.subVectors(K,x):R.subVectors(x,l[b-1]),M.push(R.normalize().clone());var A,q,G,n,C=new sc,$=new sc,H=new lr,D=1e-4,O=Number.MAX_VALUE,m=M[0],o=k[0]=new sc,L=Q[0]=new sc;for(q=s(m.x),G=s(m.y),n=s(m.z),O>=q&&(O=q,C.set(1,0,0)),O>=G&&(O=G,C.set(0,1,0)),O>=n&&C.set(0,0,1),$.crossVectors(m,C).normalize(),o.crossVectors(m,$),L.crossVectors(m,o),b=1;u>b;b++)k[b]=k[b-1].clone(),Q[b]=Q[b-1].clone(),$.crossVectors(M[b-1],M[b]),$.length()>D&&($.normalize(),A=V(qi(M[b-1].dot(M[b]),-1,1)),k[b].applyMatrix4(H.makeRotationAxis($,A))),Q[b].crossVectors(M[b],k[b]);return{B:Q,T:M,N:k}},ap=function(){var h=function(Q){for(var c=1;c<arguments.length;c++){var t=arguments[c];Q.push(t.x,t.y,t.z)}},O=function(e){for(var C=1;C<arguments.length;C++){var M=arguments[C].uv;e.push(M[0],M[1])}},b=function(z,B,I,n,R){var o=-n*y(R),C=n*J(R);return new sc(z.x+o*I.x+C*B.x,z.y+o*I.y+C*B.y,z.z+o*I.z+C*B.z)},A=function(U,$,B,C,h,V,_,O){_=_||G;for(var L=[],r=_/h,X=0;h>=X;X++){var x=b(U,$,B,C,X*r+V);L.push(x),O!=Z&&(x.uv=[O,X/h])}return L},D=function(T,z,d,D,E,H,r,P,m){m=m||G;var A=z?T.top_vs:T.bottom_vs;if(A)for(var M=z?T.top_uv:T.bottom_uv,K=m/r,x=0;r>x;x++){var t,l;z?(t=x*K+P,l=(x+1)*K+P):(l=x*K+P,t=(x+1)*K+P),h(A,b(d,D,E,H,t),b(d,D,E,H,l),d),M&&M.push(.5-.5*y(t),.5-.5*J(t),.5-.5*y(l),.5-.5*J(l),.5,.5)}};return function(U,B,Y,X,d,G,f,w,M){var b=B.length;if(b>1){var j,F,l,V,x,k,L,Q=ge(B),e=Q.T,C=Q.N,u=Q.B;"flat"===w&&D(U,!0,B[0],u[0],C[0],X,d,G,f),"flat"===M&&D(U,!1,B[b-1],u[b-1],C[b-1],X,d,G,f);var m,g,W=[],y=r(d/2),E="round"===w,n="round"===M,s=B[0],p=e[0],q=u[0],J=C[0],R=B[b-1],I=e[b-1],o=u[b-1],S=C[b-1];if(E){for(l=1;y>=l;l++)C.splice(0,0,J),u.splice(0,0,q),e.splice(0,0,p),g=-l/y*X,B.splice(0,0,p.clone().multiplyScalar(g).add(s)),W[y-l]=T(X*X-g*g);b+=y}if(n){for(l=1;y>=l;l++)C.push(S),u.push(o),e.push(I),g=l/y*X,B.push(I.clone().multiplyScalar(g).add(R)),W[B.length-1]=T(X*X-g*g);b+=y}if(U.uv){var a=0,P=0,N=[];for(Y&&(a=Y),x=B[0],N[0]=0,l=1;b>l;l++)V=B[l],N[l]=x.distanceTo(V),x=V,Y||(a+=N[l]);for(m=[],l=0;b>l;l++)P+=N[l],m[l]=a?P/a:0}for(l=0;b>l;l++){if(V=B[l],k=u[l],L=C[l],j=A(V,k,L,W[l]===K?X:W[l],d,G,f,m?m[l]:Z),F)for(var $=0;d>$;$++){var t=F[$],c=F[$+1]||F[0],i=j[$],H=j[$+1]||j[0];h(U.vs,c,t,i,i,H,c),U.uv&&O(U.uv,c,t,i,i,H,c)}F=j}}}}();Bm(M,{getLineLength:function(Y){return Y[Y.length-1].length},getLineOffset:function(V,p){return hd(V,p)},getLineCacheInfo:function(W,H,U,R){return ji(gd(W,H,U,R))}});var Ph=k.graph3d.RenderLite={},Zc=new ArrayBuffer(0),$h=Ph.Buffer=function(R,k,u,K){this.gl=R,this.buffer=R.createBuffer(),this.type=k||R.ARRAY_BUFFER,this.drawType=K||R.STATIC_DRAW,this.data=Zc,u&&this.upload(u)};$h.prototype.upload=function(t,K,d){d||this.bind();var T=this.gl;t=t||this.data,K=K||0,this.data.byteLength>=t.byteLength?T.bufferSubData(this.type,K,t):T.bufferData(this.type,t,this.drawType),this.data=t},$h.prototype.bind=function(){var e=this.gl;e.bindBuffer(this.type,this.buffer)},$h.createVertexBuffer=function(N,d,c){return new $h(N,N.ARRAY_BUFFER,d,c)},$h.createIndexBuffer=function(P,Q,K){return new $h(P,P.ELEMENT_ARRAY_BUFFER,Q,K)},$h.create=function(S,r,h,X){return new $h(S,r,X)},$h.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Pn=Ph.Shader=function(j,W,G){this.gl=j,this.program=Ld(j,W,G),this.attributes=Wr(j,this.program);var v=Rb(j,this.program);this.uniforms=gf(j,v)};Pn.prototype.bind=function(){this.gl.useProgram(this.program)},Pn.prototype.destroy=function(){this.gl};var Ld=function(Q,f,U){var J=Yf(Q,Q.VERTEX_SHADER,f),o=Yf(Q,Q.FRAGMENT_SHADER,U);Q.getShaderParameter(o,Q.COMPILE_STATUS)||console.error(Q.getError());var F=Q.createProgram();return Q.attachShader(F,J),Q.attachShader(F,o),Q.linkProgram(F),Q.getProgramParameter(F,Q.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",Q.getProgramParameter(F,Q.VALIDATE_STATUS)),console.error("gl.getError()",Q.getError()),""!==Q.getProgramInfoLog(F)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",Q.getProgramInfoLog(F)),Q.deleteProgram(F),F=null),Q.deleteShader(J),Q.deleteShader(o),F},Yf=function(J,C,p){var q=J.createShader(C);return J.shaderSource(q,p),J.compileShader(q),J.getShaderParameter(q,J.COMPILE_STATUS)?q:(console.log(J.getShaderInfoLog(q)),null)},Rb=function(u,x){for(var h={},R=u.getProgramParameter(x,u.ACTIVE_UNIFORMS),y=0;R>y;y++){var i=u.getActiveUniform(x,y),D=i.name.replace(/\[.*?\]/,""),o=Pp(u,i.type);h[D]={type:o,size:i.size,location:u.getUniformLocation(x,D),value:fb(o,i.size)}}return h},Wr=function(S,j){for(var s={},a=S.getProgramParameter(j,S.ACTIVE_ATTRIBUTES),n=0;a>n;n++){var r=S.getActiveAttrib(j,n),u=Pp(S,r.type);s[r.name]={type:u,size:om(u),gl:S,location:S.getAttribLocation(j,r.name),pointer:mq}}return s},mq=function(Q,e,n,k,t){var H=this.gl;H.enableVertexAttribArray(this.location),H.bindBuffer(Q.type,Q.buffer),H.vertexAttribPointer(this.location,this.size,e||H.FLOAT,n||!1,k||0,t||0)},om=function(F){return Pe[F]},Pe={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Pp=function(z,R){if(!$m){var Z=C.keys(Ej);
$m={};for(var s=0;s<Z.length;++s){var M=Z[s];$m[z[M]]=Ej[M]}}return $m[R]},$m=null,Ej={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},fb=function(y,u){switch(y){case"float":return 0;case"vec2":return new Float32Array(2*u);case"vec3":return new Float32Array(3*u);case"vec4":return new Float32Array(4*u);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*u);case"ivec3":return new Int32Array(3*u);case"ivec4":return new Int32Array(4*u);case"bool":return!1;case"bvec2":return Wb(2*u);case"bvec3":return Wb(3*u);case"bvec4":return Wb(4*u);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Wb=function(T){for(var U=new Array(T),R=0;R<U.length;R++)U[R]=!1;return U},gf=function(a,r){var $={data:{}};$.gl=a;for(var j=C.keys(r),A=0;A<j.length;A++){var n=j[A],d=n.split("."),q=d[d.length-1],x=Gh(d,$),l=r[n];x.data[q]=l,x.gl=a,C.defineProperty(x,q,{get:lk(q),set:Cn(q,l)})}return $},lk=function(L){var H=Ve.replace("%%",L);return new Function(H)},Cn=function(M,a){var D,I=km.replace(/%%/g,M);return D=1===a.size?tp[a.type]:Bi[a.type],D&&(I+="\nthis.gl."+D+";"),new Function("value",I)},Gh=function(D,O){for(var w=O,V=0;V<D.length-1;V++){var N=w[D[V]]||{data:{}};w[D[V]]=N,w=N}return w},Ve=["return this.data.%%.value;"].join("\n"),km=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),tp={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Bi={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},im=k.Light=function(){up(im,this),this.s(Gb,S[Gb]),this.s(yg,"sphere"),this.s3(20,20,20)};to("Light",Vq,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(D,s,j){im.superClass.onStyleChanged.apply(this,arguments),D===Gb&&this.s("shape3d.color",j)}});var Kq=xb.Graph3dView=function(I,v){var S=this;S._attributes=v||M.graph3dViewAttributes,S._25I={},S._view=nn(1,S);var $=S._canvas=Od(S._view);$.addEventListener("webglcontextlost",function(c){c.preventDefault(),tk(S),S._26I&&S._doBufferGC(S._26I,!0),S._26I=Z,S._1o.texture=Z,S._35O=!0},R),$.addEventListener("webglcontextrestored",function(){S._35O=!1,S.iv()},R),S._batchIndexMap={},S._batchModelMap={},S._wireframeIndexMap={},S._wireframeModelMap={},S._wireframeIndexMapSwap={},S._wireframeModelMapSwap={},S._polylineIndexMap={},S._polylineIndexMap={},S._polylineIndexMapSwap={},S._polylineIndexMapSwap={},S._8O=[],S._7O=Zg(),S._6O=Zg(),S._1o=new he(S),S._30O=new hq(S),S._31O=new ob(S),S._32O=new hg(S),S._raycaster=new Hh(S),S._highlightHelper=new Cp(S),S._postProcessing=new $k(S),S.vr=new Ef(S),S._33Q=!0,S._eye=nh(M.graph3dViewEye),S._center=nh(M.graph3dViewCenter),S._up=nh(M.graph3dViewUp),S._lightChanged=!1,S._59O=[],S._spots=[],S._dirs=[],S._frameId=0,S.overlappingBox=new Lj(S),S.dm(I?I:new Sn),S._coreInteractor=new tf(this),S.setInteractors([new pd(S)])},fg={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},tc=0;Te("Graph3dView",C,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Nj,yf,"firstPersonMode",Ug,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",og,Lh,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:M.graph3dViewEditHelperDisabled,_devicePixelRatio:K,_boundaries:K,_moveStep:M.graph3dViewMoveStep,_rotateStep:M.graph3dViewRotateStep,_pannable:M.graph3dViewPannable,_rotatable:M.graph3dViewRotatable,_walkable:M.graph3dViewWalkable,_resettable:M.graph3dViewResettable,_zoomable:M.graph3dViewZoomable,_firstPersonMode:M.graph3dViewFirstPersonMode,_mouseRoamable:M.graph3dViewMouseRoamable,_gridVisible:M.graph3dViewGridVisible,_gridSize:M.graph3dViewGridSize,_gridGap:M.graph3dViewGridGap,_gridColor:M.graph3dViewGridColor,_originAxisVisible:M.graph3dViewOriginAxisVisible,_centerAxisVisible:M.graph3dViewCenterAxisVisible,_axisXColor:M.graph3dViewAxisXColor,_axisYColor:M.graph3dViewAxisYColor,_axisZColor:M.graph3dViewAxisZColor,_ortho:M.graph3dViewOrtho,_orthoWidth:M.graph3dViewOrthoWidth,_fovy:M.graph3dViewFovy,_near:M.graph3dViewNear,_far:M.graph3dViewFar,_headlightColor:M.graph3dViewHeadlightColor,_headlightIntensity:M.graph3dViewHeadlightIntensity,_headlightRange:M.graph3dViewHeadlightRange,_headlightDisabled:M.graph3dViewHeadlightDisabled,_rectSelectable:M.graph3dViewRectSelectable,_rectSelectBackground:M.graph3dViewRectSelectBackground,_editSizeColor:M.graph3dViewEditSizeColor,_autoMakeVisible:mo,_fogDisabled:M.graph3dViewFogDisabled,_fogColor:M.graph3dViewFogColor,_fogNear:M.graph3dViewFogNear,_fogFar:M.graph3dViewFogFar,_dashDisabled:M.graph3dViewDashDisabled,_batchColorDisabled:M.graph3dViewBatchColorDisabled,_batchBlendDisabled:M.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:M.graph3dViewBatchBrightnessDisabled,setEye:function(y,M,X){1===arguments.length&&(M=y[1],X=y[2],y=y[0]);var C=this._eye;C[0]=y,C[1]=M,C[2]=X,this.fp(og,Z,C)},setCenter:function(w,t,K){1===arguments.length&&(t=w[1],K=w[2],w=w[0]);var T=this._center;T[0]=w,T[1]=t,T[2]=K,this.fp(Lh,Z,T)},setUp:function(E,o,S){1===arguments.length&&(o=E[1],S=E[2],E=E[0]);var h=this._up;h[0]=E,h[1]=o,h[2]=S,this.fp("up",Z,h)},getDevicePixelRatio:function(){return this._devicePixelRatio||vn},isTransparentMask:function(m){return m.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var f=this,j=f._aspect;return j?j:(j=f.getWidth()/f.getHeight(),j||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(T){var G=this,e=G._dataModel,Z=G._selectionModel;e!==T&&(e&&(e.ump(G.handleDataModelPropertyChange,G),e.umm(G.handleDataModelChange,G),e.umd(G.handleDataPropertyChange,G),Z||e.sm().ums(G.handleSelectionChange,G)),G._dataModel=T,T.mp(G.handleDataModelPropertyChange,G),T.mm(G.handleDataModelChange,G),T.md(G.handleDataPropertyChange,G),Z?Z._21I(T):T.sm().ms(G.handleSelectionChange,G),G._postProcessing.handleDataModleChange(e,T),G.invalidateAll(!0),G.invalidateLight(),G.fp(Xd,e,T),G._canvas.style.background=T.getBackground()||"")},handleDataModelPropertyChange:function(O){if("background"===O.property){var k=this._canvas.style.background,$=O.newValue||"";this._canvas.style.background=$,this.fp("canvasBackground",k,$)}else"envmap"===O.property&&this.iv()},handleDataPropertyChange:function(W){var f=W.data;this.invalidateData(f),Se(f)&&"s:light.type"===W.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(e){var U=this,d=e.property;U.iv(),U._18Q=Z,"eye"===d?U._33Q=!0:"devicePixelRatio"===d?U._42(Z,U.getDevicePixelRatio()):fg[d]&&tk(U)},_5O:function(T){var $=T._22Q();return $?new $(this,T):Z},getData3dUI:function(v){var H=this._25I[v._id];return H===K&&(H=this._5O(v),this._25I[v._id]=H),H},invalidateAll:function(V){var F=this;if(V){for(var b in F._25I){var Z=F._25I[b];Z&&Z.dispose()}F._25I={},F.iv(),kq(F)}else kq(F),F.dm().each(function(v){F.invalidateData(v)})},invalidateSelection:function(){var K=this;K.sm().each(function(x){K.invalidateData(x)})},invalidateData:function(s){var v=this,R=v.getData3dUI(s);R&&(R.iv(),v.iv()),kq(v,s)},getShape3dText:function(d){return d.getStyle("shape3d.text")||this.getLabel(d)},invalidateBatch:function(c){var f=this,u=f._batchModelMap,P=u[c],l=[],D={};if(P){P.ds.forEach(function(Z){var T=f.getData3dUI(Z);T&&T.iv(),delete f._batchIndexMap[Z._id],l.push(Z._id)}),delete u[c];for(var H,B,k,I,d,C,S,Y,o,v=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],E=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],X=0;X<v.length;X++){var w=f[v[X]],g=f[E[X]];for(D={},Y=0;Y<l.length;Y++){var p=g[l[Y]];if(p){delete g[l[Y]],o=p.batch,H=w[o];var M=p.begin,O=p.size,x=3*M,Z=3*O,A=4*M,s=4*O;for(B=H.ds,k=H.vs,I=H.cs,d=H.ps,C=H.ls,S=p.index,H.invalidate=!0,B[S]=K,S=x;x+Z>S;S++)k[S]=K;for(S=A;A+s>S;S++)I[S]=K;for(S=A;A+s>S;S++)d[S]=K;if(C)for(S=x;x+Z>S;S++)C[S]=K;D[o]=!0}}for(o in D){H=w[o],B=H.ds,k=H.vs,I=H.cs,d=H.ps,C=H.ls;var $=[];for(S=0;S<B.length;S++)B[S]!==K&&$.push(B[S]);if(0===$.length)delete w[o];else{for(H.ds=$,$=[],S=0;S<k.length;S++)k[S]!==K&&$.push(k[S]);for(H.vs=$,$=[],S=0;S<I.length;S++)I[S]!==K&&$.push(I[S]);for(H.cs=$,$=[],S=0;S<d.length;S++)d[S]!==K&&$.push(d[S]);if(H.ps=$,C){for($=[],S=0;S<C.length;S++)C[S]!==K&&$.push(C[S]);H.ls=$}}}}f.iv()}},handleDataModelChange:function(Y){var P=this,z=Y.kind,M=Y.data;if("add"===z)P.invalidateData(M),el(M)&&M.getEdgeGroup()&&M.getEdgeGroup().eachSiblingEdge(P.invalidateData,P),Se(M)&&P.invalidateLight();else if(z===tr){var X=M._id,E=P._25I[X];E&&(E.dispose(),delete P._25I[X],P.iv()),M===P._currentSubGraph&&P.setCurrentSubGraph(Z),kq(P,M),Se(M)&&P.invalidateLight()}else z===Dk&&(P.invalidateAll(!0),P.setCurrentSubGraph(Z),kq(P),P.invalidateLight())},toCanvas:function(c,G,Q){var q=this,p=q.getGL();if(q.validate(),c){var K=p.getParameter(p.COLOR_CLEAR_VALUE);Dq(p,c)}q._42(Z,1);var d=q.getWidth(),N=q.getHeight(),s=new Uint8Array(4*d*N),a=Od(),V=a.getContext("2d");p.readPixels(0,0,d,N,p.RGBA,p.UNSIGNED_BYTE,s),Aq(a,d,N,1);for(var r=V.getImageData(0,0,d,N),W=r.data,S=0;S<W.length;S+=4){var P=S/4,n=v(P/d),i=P-n*d;P=4*((N-1-n)*d+i),W[P]=s[S],W[P+1]=s[S+1],W[P+2]=s[S+2],W[P+3]=s[S+3]}if(V.putImageData(r,0,0),c&&Dq(p,K),q._42(Z,q.getDevicePixelRatio()),G&&Q){var o=Od(),O=o.getContext("2d");return G=G,Q=Q,Aq(o,G,Q,1),M.drawImage(O,a,0,0,G,Q),o}return a},toDataURL:function(B,f){var I=this,P=I.getGL();if(I.validate(),B){var t=P.getParameter(P.COLOR_CLEAR_VALUE);Dq(P,B)}I._42(Z,1);var X=I._canvas.toDataURL(f||"image/png",1);return B&&Dq(P,t),I._42(Z,I.getDevicePixelRatio()),X},getGL:function(){var H=this,e=H._26I;if(H._prg,!e)try{H._2O={},e=H._26I=H._canvas.getContext("webgl",H._attributes)||H._canvas.getContext("experimental-webgl",H._attributes),e._emptyTexture=cg(e),e._emptyBlendTexture=cg(e),e._bufPool={},e._id=++tc,H._buffer={vs:Hj(e),ns:Hj(e),is:Hj(e),uv:Hj(e),batchColor:Hj(e),batchBlend:Hj(e),batchBrightness:Hj(e),lineDistance:Hj(e)},H._1O=Ei(e);var s=H._cube={vs:Hj(e),ns:Hj(e),is:Hj(e),uv:Hj(e)};js(e,s.vs,xm),js(e,s.ns,wj),js(e,s.uv,sh),vd(e,s.is,Tp)}catch(Q){}return H.acquireProgram(),e},acquireProgram:function(){var J=this,h=J._26I;if(h){var z=k.Default.getImage(J.dm().getEnvmap())?!0:!1,x=J._prg&&J._prg.envMapFlag?!0:!1;if(!J._prg||z!==x){var I=J._prg=h.createProgram();if(!I)return Z;I.envMapFlag=z;var $=J._dirs.length,e=J._spots.length,W=J._59O.length,v=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];$&&v.push("uDirColor","uDirDirection"),e&&v.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),W&&v.push("uPointColor","uPointRange","uPointPosition"),Dq(h,[0,0,0,0]),h.clearDepth(1),h.enable(h.DEPTH_TEST),h.depthFunc(h.LEQUAL),h.enable(h.BLEND),h.blendFuncSeparate(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA),Jn||(qn=ls(qn.substring(0,qn.indexOf("^#"))),sb=ls(sb),Jn=!0);var o=["#define MAX_DIR "+$,"#define MAX_SPOT "+e,"#define MAX_POINT "+W,J._fogDisabled?"":"#define FOG",J._dashDisabled?"":"#define DASH",z?"#define USE_ENVMAP":"",J._batchColorDisabled?"":"#define BATCHCOLOR",J._batchBlendDisabled?"":"#define BATCHBLEND",J._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),q=Qb(h,I,h.VERTEX_SHADER,qn.replace("PREFIX",o));h.getShaderParameter(q,h.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",h.getShaderInfoLog(q));var u=Qb(h,I,h.FRAGMENT_SHADER,sb.replace("PREFIX",o));h.getShaderParameter(u,h.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",h.getShaderInfoLog(u)),Y?v.push("aPosition"):(I.aPosition=0,h.bindAttribLocation(I,0,"aPosition")),h.linkProgram(I),v.forEach(function(i){I[i]=/^u/.test(i)?h.getUniformLocation(I,i):h.getAttribLocation(I,i)}),h.useProgram(I),h.deleteShader(q),h.deleteShader(u)}}},getBrightness:function(s){var k=s.s("brightness"),F=this.isSelected(s)?s.s("select.brightness"):Z;return k==Z?F:F==Z?k:k*F},setHighlightMode:function(Z){var O;O="selection"===Z?Cp.Mode.Selection:"mouseover"===Z?Cp.Mode.MouseOver:Cp.Mode.Disable,this._highlightHelper.mode=O},getHighlightMode:function(){var S=this._highlightHelper.mode;return S===Cp.Mode.Selection?"selection":S===Cp.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(_){var C=this,n=C._prg,r=5,q=C.dm().getEnvmap(),m=k.Default.getImage(q);if(m){if(q!==C._lastEnvMap){C._envMapTexture&&_.deleteTexture(C._envMapTexture);var b=C._envMapTexture=_.createTexture();_.bindTexture(_.TEXTURE_CUBE_MAP,b),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,m),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,m),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,m),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,m),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,m),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,m),_.bindTexture(_.TEXTURE_CUBE_MAP,null),C._lastEnvMap=q}_.activeTexture(_.TEXTURE0+r),_.bindTexture(_.TEXTURE_CUBE_MAP,C._envMapTexture),_.uniform1i(n.uEnvMap,r)}},getWireframe:function(z){var T=z.s("wf.visible"),P=z.s("wf.width");return T===!0||P>0&&"selected"===T&&this.isSelected(z)?{color:z.s("wf.color"),width:P,"short":z.s("wf.short"),mat:z.s("wf.mat")}:void 0},_transformPointToViewSpace:function(Z){var i=[Z[0],Z[1],Z[2]];return jq(i,this._viewMatrix),i},_transformDirectionToViewSpace:function(w,W){var r=[w[0],w[1],w[2]];jq(r,this._viewMatrix);var S=W?[W[0],W[1],W[2]]:[0,0,0];jq(S,this._viewMatrix);var n=S[0]-r[0],u=S[1]-r[1],B=S[2]-r[2],J=Math.sqrt(n*n+u*u+B*B);return J?[n/J,u/J,B/J]:[n,u,B]},getWireframeGeometry:function(b){return b.s("wf.geometry")?{color:b.s("wf.color"),width:b.s("wf.width"),mat:b.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(s){return s.s("body.color")},getMat:function(K){return K.getMat?K.getMat():K.s("mat")},getFaceMat:function(V,W){return V.getFaceMat?V.getFaceMat(W):V.s(W+".mat")},getFaceBlend:function(x,H){return x.s(H+".blend")||x.s("all.blend")},getFaceColor:function(d,x){return d.s(x+".color")||d.s("all.color")},getFaceImage:function(i,c){return i.s(c+".image")||i.s("all.image")},getFaceBlendImage:function(z,E){return z.s(E+".blend.image")||z.s("all.blend.image")},getFaceDiscardSelectable:function(y,C){var S=y.s(C+".discard.selectable");return S==Z?y.s("all.discard.selectable"):S},getFaceUv:function(x,m){return x.s(m+".uv")||x.s("all.uv")},getFaceUvOffset:function(T,j){return T.s(j+".uv.offset")||T.s("all.uv.offset")},getFaceUvScale:function(d,v){return d.s(v+".uv.scale")||d.s("all.uv.scale")},getFaceLight:function(M,f){var c=M.s(f+".light");return c==Z?M.s("all.light"):c},getFaceVisible:function(c,o){var b=c.s(o+".visible");return b==Z?c.s("all.visible"):b},getFaceOpacity:function(m,J){var w=m.s(J+".opacity");return w==Z?m.s("all.opacity"):w},getFaceTransparent:function(I,L){var M=I.s(L+".transparent");return M==Z?I.s("all.transparent"):M},getFaceReverseColor:function(N,B){return N.s(B+".reverse.color")||N.s("all.reverse.color")},getFaceReverseFlip:function(Y,A){var o=Y.s(A+".reverse.flip");return o==Z?Y.s("all.reverse.flip"):o},getFaceReverseCull:function(K,g){var U=K.s(g+".reverse.cull");return U==Z?K.s("all.reverse.cull"):U},getTextureMap:function(){return this._2O},deleteTexture:function($){var J=this,C=J._2O[$];C&&(delete J._2O[$],J.getGL().deleteTexture(C))},invalidateShape3dCachedImage:function(p){var h=this.getData3dUI(p);h.invalidateCachedTexture(this.getGL())},isInteractive:function($){return $.s("interactive")},getTexture:function(C,X){if(!C)return Z;var M=this,q=M.getGL(),U=M._2O[C];if(!U){var J=Mk(C);if(J)if(J.tagName){if(J.dynamic)return Ei(q,J,M._1O);U=M._2O[C]=Ei(q,J)}else{var T,p=X&&X.s("shape3d.image.cache")&&!M.isInteractive(X),L=M.vr.isPresenting();L&&(X._textureUpdateFrame===q._renderInfo.frame?p=!0:X._textureUpdateFrame=q._renderInfo.frame),p&&(T=M.getData3dUI(X),U=T.getCachedTexture());var F;if(!U){var A=X&&X.s("shape3d.fixSizeOnScreen"),c=A?q.NEAREST:q.LINEAR;A||X&&X.s("shape3d.vector.dynamic")&&(T||(T=M.getData3dUI(X)),A=T.getVectorDynamicSize(),A&&(F=M.getDevicePixelRatio(),A[0]*=F,A[1]*=F));var g,$,H=X&&X.s("shape3d.texture.scale")||1;if(A?(F||(F=M.getDevicePixelRatio()),g=A[0]>0?A[0]:H*pr(J,X)*F,$=A[1]>0?A[1]:H*Ne(J,X)*F):(g=H*pr(J,X),$=H*Ne(J,X)),g>=1&&$>=1){var N=Zj(g,$);if(!T&&X&&(T=M.getData3dUI(X)),T&&T.interactiveInfo){var e=C;"object"==typeof e&&(e=e.uuid||(e.uuid=k.Math.generateUUID()));var j=T.interactiveInfo[e]={};N.interactiveInfo=j.bodyInfo={compInfos:[],matrix:new yp,rect:{x:0,y:0,width:g,height:$}}}mc(N,J,0,0,g,$,X,M),N.interactiveInfo&&(N.interactiveInfo=null),N.restore(),(p||L)&&ln(J,X)?(U=Ei(q,Yp,null,c),T.setCachedTexture(U),Yp=null):U=Ei(q,Yp,M._1O,c)}}}}return U},redraw:function(){this.iv()},validateImpl:function(){var m=this;if(m._lightChanged){m._lightChanged=!1;var r=[],w=[],c=[];m.dm().each(function(E){if(Se(E)){var Z=E.s("light.type");Z===Pm?r.push(E):Z===Cl?w.push(E):Z===ij&&c.push(E)}}),(r.length!==m._59O.length||w.length!==m._spots.length||c.length!==m._dirs.length)&&tk(m),m._59O=r,m._spots=w,m._dirs=c}m._42(),m._1o.iv()},getRenderInfo:function(){var X=this.getGL();return X?X._renderInfo:void 0},showDebugTip:function(){var G=this,H=G._debugDiv;if(!H){H=G._debugDiv=D.createElement("div"),H.style.position="absolute",H.style.overflow="hidden",H.style.backgroundColor="white",H.style.color="black";var o=G.getView();G._79O?o.insertBefore(H,G._79O):o.appendChild(H),G._debugTipTimerId=setInterval(function(){var T=G.getRenderInfo();if(T){var z=G.getGL()._validBufCount||0,h="Draw Calls: "+T.calls+"<br/>"+"Vertices: "+T.vertices+"<br/>"+"Faces: "+T.faces+"<br/>"+"Lines: "+T.lines+"<br/>"+"Buffer Count: "+z;G.vr.isPresenting()&&(h+="<br/>VR fps: "+G.vr.getFps()),H.innerHTML=h}},10)}},hideDebugTip:function(){var s=this,m=s._debugDiv;m&&(delete s._debugDiv,cancelAnimationFrame(s._debugTipTimerId),delete s._debugTipTimerId,s.getView().removeChild(m))},_42:function(s,h){var Y=this;if(!Y._35O&&(!$c||Oe($c))){var F,z;s&&(s instanceof Vq?z=s:F=s);var H=Y._canvas,e=Y.getGL(),f=Y._prg;if(e){var W=Y.getWidth(),K=Y.getHeight();h?s||Aq(H,W,K,h):(h=Y.getDevicePixelRatio(),s||W===H.clientWidth&&K===H.clientHeight||Aq(H,W,K,h)),e.clear(e.COLOR_BUFFER_BIT),e._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:s?Y._frameId:++Y._frameId};var n=function(){if(Y.overlappingBox.clear(),Y._81O=Z,e.clear(e.DEPTH_BUFFER_BIT),rf(e,f.uBrightness,1),rf(e,f.uOpacity,1),rf(e,f.uPartOpacity,1),e._picking=!!s,rf(e,f.uPick,!!s),rf(e,f.uTexture,!1),rf(e,f.uBlendTexture,!1),rf(e,f.uAlphaTest,S.alphaTest),rf(e,f.uTransparent,!1),rf(e,f.uFix,!1),rf(e,f.uBatchColor,!1),rf(e,f.uBatchBlend,!1),rf(e,f.uBatchBrightness,!1),rf(e,f.uReflectivity,Y._envmapReflectivity||.5),rf(e,f.uCameraPosition,Y.getEye()),rf(e,f.uPMatrix,Y._projectMatrix=fc(Y)),rf(e,f.uViewMatrix,bh(Y,Y._7O)),Y.bindEnvMap(e),Y._viewMatrix=uo(Y._7O),s||(Ce(Y,e,f),Y._fogDisabled||(rf(e,f.uFogColor,Y._fogColor),rf(e,f.uFogNear,Y._fogNear),rf(e,f.uFogFar,Y._fogFar))),Kj(e,f.aPosition),Kj(e,f.aNormal),hi(e,f.aUv),hi(e,f.aBatchColor),hi(e,f.aBatchBlend),hi(e,f.aBatchBrightness),hi(e,f.aLineDistance),z){var J=e.getParameter(e.COLOR_CLEAR_VALUE);e.clearColor(0,0,0,0),e.disable(e.BLEND),hi(e,f.aNormal),js(e,Y._cube.vs,Z,f.aPosition),vd(e,Y._cube.is),Ue(z,Y,Wf,0),Ue(z,Y,Nm,6),Ue(z,Y,qb,12),Ue(z,Y,Fd,18),Ue(z,Y,uc,24),Ue(z,Y,Ul,30),Kj(e,f.aNormal),Dq(e,J)}else if(F){F.value=2;var J=e.getParameter(e.COLOR_CLEAR_VALUE);e.clearColor(0,0,0,0),e.disable(e.BLEND),Y._95I(e,f,F),Lb(Y,F),cr(Y,Y._polylineModelMap,F),cr(Y,Y._wireframeModelMap,F),rf(e,f.uTransparent,!0),Y._95I(e,f,F,!0),Lb(Y,F,!0),cr(Y,Y._polylineModelMap,F,!0),cr(Y,Y._wireframeModelMap,F,!0),rf(e,f.uTransparent,!1),e.clear(e.DEPTH_BUFFER_BIT),Y._swapLineMap(),Y._95I(e,f,F,!1,!0),cr(Y,Y._polylineModelMap,F),cr(Y,Y._wireframeModelMap,F),Y._swapLineMap(),Y._swapLineMap(),Y._95I(e,f,F,!1,!0),cr(Y,Y._polylineModelMap,F),cr(Y,Y._wireframeModelMap,F),rf(e,f.uTransparent,!0),Y._95I(e,f,F,!0,!0),cr(Y,Y._polylineModelMap,F,!0),cr(Y,Y._wireframeModelMap,F,!0),rf(e,f.uTransparent,!1),Y._swapLineMap(),e.disable(e.DEPTH_TEST),Y.drawFilter||Y._30O._42(e,f,F),e.enable(e.DEPTH_TEST),Dq(e,J)}else e.disable(e.BLEND),Y.drawSky(e,f),Y._31O._42(e,f),Y._95I(e,f),Lb(Y),cr(Y,Y._polylineModelMap),cr(Y,Y._wireframeModelMap),e.enable(e.BLEND),rf(e,f.uTransparent,!0),e.depthMask(!1),Y._95I(e,f,Z,!0),Lb(Y,Z,!0),cr(Y,Y._polylineModelMap,Z,!0),cr(Y,Y._wireframeModelMap,Z,!0),e.depthMask(!0),rf(e,f.uTransparent,!1),e.clear(e.DEPTH_BUFFER_BIT),Y._swapLineMap(),e.disable(e.BLEND),Y._95I(e,f,Z,!1,!0),cr(Y,Y._polylineModelMap),cr(Y,Y._wireframeModelMap),e.enable(e.BLEND),rf(e,f.uTransparent,!0),e.depthMask(!1),Y._95I(e,f,Z,!0,!0),cr(Y,Y._polylineModelMap,Z,!0),cr(Y,Y._wireframeModelMap,Z,!0),e.depthMask(!0),rf(e,f.uTransparent,!1),Y._swapLineMap(),e.disable(e.DEPTH_TEST),e.disable(e.BLEND),Y._32O._42(e,f),Y._30O._42(e,f),Y._highlightHelper._42(e,f),e.enable(e.DEPTH_TEST);js(e,Z),vd(e,Z)},d=!1,w=W*h,X=K*h,O=Y.vr;O.enable&&O._42(e,w,X,n)&&(d=!0);var u=Y.envRenderer;u&&u.enable&&u._42(e,w,X,n)&&(d=!0);var $=Y._postProcessing;$._42(e,w,X,n,s)&&(d=!0),d||(Y.setViewport(e,0,0,W*h,K*h),n()),Y._33Q=!1,Y._doBufferGC(e)}}},enablePostProcessing:function(y,K){return this._postProcessing.enableModule(y,K)},getPostProcessingModule:function(o){return this._postProcessing.getModule(o)},setViewport:function(G,j,V,l,U){this._viewport=[j,V,l,U],G.viewport(j,V,l,U)},getViewport:function(){return this._viewport},setBufferGCInterval:function(Y){this._bufferGCInterval=Y},_doBufferGC:function(O,M){var C,z,l=O._bufPool,U=0,H=0,p=O._renderInfo.frame,R=this._bufferGCInterval||10;for(C in l)U++,z=l[C],z&&(M||p-z._fid>R?(O.deleteBuffer(z._buf),z._buf=null,l[C]=null):H++);if(U/2>H&&U>128){var A={};for(C in l)l[C]&&(A[C]=l[C]);O._bufPool=A}O._validBufCount=H},_swapLineMap:function(){var T=this;n=T._polylineModelMap,T._polylineModelMap=T._polylineModelMapSwap,T._polylineModelMapSwap=n,n=T._wireframeModelMap,T._wireframeModelMap=T._wireframeModelMapSwap,T._wireframeModelMapSwap=n,n=T._polylineIndexMap,T._polylineIndexMap=T._polylineIndexMapSwap,T._polylineIndexMapSwap=n,n=T._wireframeIndexMap,T._wireframeIndexMap=T._wireframeIndexMapSwap,T._wireframeIndexMapSwap=n},_updateSkyBox:function(W){if(this._skyBox&&W){var l=W.property,g=!1,q=this._skyBox;if("eye"===l||"forceUpdate"===l){var u=this._eye;q.p3(u[0],u[1],u[2]),g=!0}if("near"===l||"far"===l||"forceUpdate"===l){var I=this._near,P=this._far,N=q.getFinalScale3d();if(N[0]/=2,N[1]/=2,N[2]/=2,N[0]<=I||N[0]>=P||N[1]<=I||N[1]>=P||N[2]<=I||N[2]>=P){var T=2*I*P/(I+P),k=Math.min(N[0],N[1],N[2]),Y=T/k,m=q.getScale3d();q.setScale3d(m[0]*Y,m[1]*Y,m[2]*Y),g=!0}}g&&this.invalidateData(q)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(d){var F=this._skyBox;F&&(this._skyBoxStyleMap&&F.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&F.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&F.p3(this._skyBoxP3),this._skyBoxP3=0),this._skyBox=d,this.ump(this._updateSkyBox,this),d&&(d.dm()&&d.dm().remove(d),this._skyBoxStyleMap=k.Default.clone(d.getStyleMap()),this._skyBoxAnchor3d=d.getAnchor3d(),d.setAnchor3d(.5,.5,.5),this._skyBoxP3=d.p3().slice(0),d.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",F,d)},drawSky:function(G,N,u){var b=this,$=b._skyBox;if($){var E=b._headlightIntensity,g=Tj(b._headlightColor),N=b._prg;1!==E&&(g=[g[0]*E,g[1]*E,g[2]*E]),rf(G,N.uHeadlightColor,[g[0],g[1],g[2],1]);var Q=b.getData3dUI($);Q&&Q._42(G,N,u,function(){return!0}),G.clear(G.DEPTH_BUFFER_BIT),rf(G,N.uHeadlightColor,[g[0],g[1],g[2],b._headlightDisabled?1:0])}},_95I:function(m,D,q,j,c){function X(G){if(!!G.s("shape3d.alwaysOnTop")==!!c&&I.isVisible(G)&&(!e||U)){if(!q&&I.isTransparentMask(G))return;var r=I.getData3dUI(G);r&&r._42(m,D,q,R)}}var I=this,R=function(Q){return j?Q:!Q};I.sky&&m.clear(m.DEPTH_BUFFER_BIT);var $=I.drawFilter;$?I.dm().each(function(r){$(r)||X(r)}):I.dm().each(function(F){X(F)})},getLogicalPoint:function(Q){return il(Q,this._canvas)},isRectOverlapping:function(k){var g=this.getData3dUI(k);return g._rectOverlapping},getHitFaceInfo:function(J){J.target&&(J=this.lp(J));var N=this.getDataInfoAt(J);if(N){var K=this._1o.face(N.data,ml(J.x,J.y));if(K)return{data:N.data,face:K}}return Z},unproject:function(j,c){var d=this,O=d.getWidth(),m=d.getHeight(),V=j.target?d.lp(j):j,u=V.x-O/2,T=V.y-m/2,p=2*(u/O),b=2*(-1*T/m);c=c||0;var f=Zg(),J=fc(d),g=bh(d);bn(f,J,g),sl(f);var E=Xb([p,b,c,1],f);return[E[0]/E[3],E[1]/E[3],E[2]/E[3]]},getDataAt:function(O){var J=this.getDataInfoAt(O);return J?J.data:Z},getDataInfoAt:function(g,G){return g.target&&(g=this.lp(g)),this._1o.get(ml(g.x,g.y,G),!0)},getDatasInRect:function(t){return this._1o.get(t)},setEditable:function(_){var c=this,Y=c._editable;c._editable=_,this.fp(jh,Y,_)},isEditable:function($){var Z=this;return Z._editable?vs($)?$.s("3d.editable")?Z._editableFunc?Z._editableFunc($):!0:!1:!1:!1},isSelectable:function(T){return T.s("3d.selectable")&&this.sm().isSelectable(T)},isMovable:function(S){var b=this;return el(S)&&S.getStyle(qq)!==li?!1:S.s("3d.movable")?b._movableFunc?b._movableFunc(S):!0:!1},isSizeEditable:function(U){return vs(U)?this._sizeEditableFunc?this._sizeEditableFunc(U):!0:!1},isRotationEditable:function(u){return vs(u)&&u.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(u):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(F){this.setZoom(od,F)},zoomOut:function(f){this.setZoom(1/od,f)},setZoom:function(X,O){if(1!==X){var N=this;if(N._ortho)return N.setOrthoZoom(X,O),void 0;N._14o&&N._14o.stop(!0);var V=1/X,H=N._eye,o=N._center,K=o[0]+(H[0]-o[0])*V-H[0],b=o[1]+(H[1]-o[1])*V-H[1],f=o[2]+(H[2]-o[2])*V-H[2];if(!(Qn(H,o)<N._moveStep&&1>V)){if(O=is(O)){var D=nh(H);return O.action=function(t){N.fi({kind:N._zooming?"betweenZoom":"beginZoom"}),N._zooming=1,H[0]=D[0]+K*t,H[1]=D[1]+b*t,H[2]=D[2]+f*t,N.fp(og,Z,H)},O._37o=function(){delete N._14o,delete N._zooming,N.fi({kind:"endZoom"}),N.onZoomEnded()},N._14o=Ep(O)}H[0]+=K,H[1]+=b,H[2]+=f,N.fp(og,Z,H)}}},setOrthoZoom:function(R,H){if(1!==R){var E=this;E._14o&&E._14o.stop(!0);var $=E._orthoWidth,V=$/R-$;if(!($<E._moveStep&&R>1))return(H=is(H))?(H.action=function(D){E.fi({kind:E._zooming?"betweenZoom":"beginZoom"}),E._zooming=1,E.setOrthoWidth($+V*D)},H._37o=function(){delete E._14o,delete E._zooming,E.fi({kind:"endZoom"}),E.onZoomEnded()},E._14o=Ep(H)):(E.setOrthoWidth($/R),void 0)}},getPositionInfo:function(Y){var C=this,l=C._eye,k=C._center,G=C.getAspect(),u=Y?Zo(xo(k,l,!0),xo(Y,l)):Qn(l,k);if(C._ortho){var g=C._orthoWidth;return{length:u,height:g/G,width:g}}var D=2*q(C._fovy/2)*u;return{length:u,height:D,width:D*G}},getCenterInfo:function(){var x=this;return x._81O||(x._81O=x.getPositionInfo()),nh(x._81O)},rotate:function(W,L,_,B){var d=this;if(W||L){B==Z&&(B=d._firstPersonMode),d._88O&&d._88O.stop(!0);var v=d._center,C=d._eye,H=d.getCenterInfo().length,K=B?v:C,M=B?C:v,n=xo(K,M),f=g(n[0],n[2]),X=g(T(n[0]*n[0]+n[2]*n[2]),n[1]),s=B?Lh:og;return B&&(L=-L),(_=is(_))?(_.action=function(z){d.fi({kind:d._rotating?"betweenRotate":"beginRotate"}),d._rotating=1;var u=f+W*z,g=X+L*z;g=Je(g),n[0]=H*J(g)*J(u),n[1]=H*y(g),n[2]=H*J(g)*y(u),K[0]=M[0]+n[0],K[1]=M[1]+n[1],K[2]=M[2]+n[2],d.fp(s,Z,K)},_._37o=function(){delete d._88O,delete d._rotating,d.fi({kind:"endRotate"}),d.onRotateEnded()},d._88O=Ep(_)):(f+=W,X+=L,X=Je(X),n[0]=H*J(X)*J(f),n[1]=H*y(X),n[2]=H*J(X)*y(f),K[0]=M[0]+n[0],K[1]=M[1]+n[1],K[2]=M[2]+n[2],d.fp(s,Z,K),void 0)}},pan:function(h,K,Y,w){if(h||K){var s=this;w==Z&&(w=s._firstPersonMode),s._89O&&s._89O.stop(!0);var n=bh(s),S=[n[0]*h,n[4]*h,n[8]*h],q=[n[1]*K,n[5]*K,n[9]*K],L=S[0]+q[0],F=S[1]+q[1],d=S[2]+q[2],m=s._center,y=s._eye;if(w){var t=Qe(s.getBoundaries(),y[0],y[2],y[0]+L,y[2]+d,T(L*L+d*d));L=t[0],d=t[1]}if(Y=is(Y)){var G=nh(y),e=nh(m);return Y.action=function(v){s.fi({kind:s._panning?"betweenPan":"beginPan"}),s._panning=1,m[0]=e[0]+L*v,m[1]=e[1]+F*v,m[2]=e[2]+d*v,y[0]=G[0]+L*v,y[1]=G[1]+F*v,y[2]=G[2]+d*v,s.fp(og,Z,y),s.fp(Lh,Z,m)},Y._37o=function(){delete s._89O,delete s._panning,s.fi({kind:"endPan"}),s.onPanEnded()},s._89O=Ep(Y)}m[0]+=L,m[1]+=F,m[2]+=d,y[0]+=L,y[1]+=F,y[2]+=d,s.fp(og,Z,y),s.fp(Lh,Z,m)}},walk:function(y,_,w){if(y){var D=this;w==Z&&(w=D._firstPersonMode),D._90O&&D._90O.stop(!0);var G=D._center,f=D._eye,n=xo(G,f,!0);if(w){var L=Qe(D.getBoundaries(),f[0],f[2],f[0]+n[0]*y,f[2]+n[2]*y,s(y));if(y=Qn(L),!y)return;n=[L[0]/y,0,L[1]/y]}if(_=is(_)){var b=nh(f),V=nh(G);return _.action=function(x){D.fi({kind:D._walking?"betweenWalk":"beginWalk"}),D._walking=1;var v=y*x;f[0]=b[0]+n[0]*v,f[1]=b[1]+n[1]*v,f[2]=b[2]+n[2]*v,G[0]=V[0]+n[0]*v,G[1]=V[1]+n[1]*v,G[2]=V[2]+n[2]*v,D.fp(og,Z,f),D.fp(Lh,Z,G)
},_._37o=function(){delete D._90O,delete D._walking,D.fi({kind:"endWalk"}),D.onWalkEnded()},D._90O=Ep(_)}f[0]+=n[0]*y,f[1]+=n[1]*y,f[2]+=n[2]*y,G[0]+=n[0]*y,G[1]+=n[1]*y,G[2]+=n[2]*y,D.fp(og,Z,f),D.fp(Lh,Z,G)}},handleScroll:function(n,r){n.preventDefault();var h=this,L=h._moveStep,z=h.getDataInfoAt(n);if(z){var F=z.data,M=h.intersectObject(n,F);if(M){var A=M.part,V=Mk(F.s(A+".image")||F.s("shape3d."+A+".image")||F.s("all.image")||F.s("shape3d.image"));if(V&&Vc(V.scrollable,F,h))return}}h.isFirstPersonMode()?h.isPannable()&&h.pan(0,r>0?L:-L):h.isZoomable()&&h.setZoom(0>r?1/Rc:Rc)},handlePinch:function(S,m){this.isZoomable()&&this.setZoom(m>S?1/eq:eq)},reset:function(){this.setCenter(M.graph3dViewCenter),this.setEye(M.graph3dViewEye),this.setUp(M.graph3dViewUp)},moveSelection:function(D,M,i){var H=this;H.dm().beginTransaction(),$e(this.sm().toSelection(this.isMovable,this),D,M,i),H.dm().endTransaction()},getMoveMode:function(j,p){var L=p.s("3d.move.mode");if(L)return L;var I="88",B="89",H="90";return Cd(j)||te[I]&&te[B]&&te[H]?"xyz":te[I]&&te[B]?"xy":te[I]&&te[H]?"xz":te[B]&&te[H]?"yz":te[I]?"x":te[B]?"y":te[H]?"z":"xz"},handleTick:function(){var o=this,d=!1,N=o._moveStep,B=N,x=!1,e=!0,I=o._rotateStep*(e?-1:1);if(o.isWalkable()||(B=0),o.isPannable()||(N=0),o.isRotatable()||(I=0),o._32Q){var b=(Li()-o._32Q)/50;B*=b,N*=b,I*=b}o._31Q&&(nj(o._31Q),delete o._31Q,delete o._32Q),_m()&&(d=!0,o.pan(-N,0,x,e)),xg()&&(d=!0,o.pan(N,0,x,e)),Qi()&&(d=!0,Cd()?o.pan(0,N,x,e):o.walk(B,x,e)),Si()&&(d=!0,Cd()?o.pan(0,-N,x,e):o.walk(-B,x,e)),Th()&&(d=!0,o.rotate(-I,0,x,e)),Xf()&&(d=!0,o.rotate(I,0,x,e)),Sc()&&(d=!0,o.rotate(0,-I/2,x,e)),cc()&&(d=!0,o.rotate(0,I/2,x,e)),d&&(o._32Q=Li(),o._31Q=zj(o.handleTick,o))},handleKeyDown:function(_){var P=this;!Ah(_)&&yc[_.keyCode]?P.handleTick():hj(_)?P.selectAll():bm(_)?P.handleDelete(_):_f(_)&&this.isResettable()&&P.reset()},checkDoubleClickOnNote:function(Q,E,z){var c=this;if(z===xk){if(E.s("note.toggleable"))return E.s(tq,!E.s(tq)),c.fi({kind:"toggleNote",event:Q,data:E,part:z}),!0}else if(z===Hq&&E.s("note2.toggleable"))return E.s(Ki,!E.s(Ki)),c.fi({kind:"toggleNote2",event:Q,data:E,part:z}),!0;return!1},checkDoubleClickOnRotation:function(b,Y,v){return v===Wn?(Y.setRotationX(0),!0):v===Oq?(Y.setRotationY(0),!0):v===Ni?(Y.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(k){var j=this;if(j.isOrtho())return j.getWidth()/j.getOrthoWidth();var A=j.getCenter(),M=j.getHeight(),I=j.getEye(),s=[A[0]-I[0],A[1]-I[1],A[2]-I[2]],a=[k[0]-I[0],k[1]-I[1],k[2]-I[2]],S=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]),N=1/Math.tan(j.getFovy()/2);return M*S*N/(a[0]*s[0]+a[1]*s[1]+a[2]*s[2])},inViewSpace:function(h){var F,m=this,Z=m._transformPointToViewSpace(h),k=m.getAspect(),w=m.getNear(),b=m.getFar();return-Z[2]<w||-Z[2]>b?!1:m.isOrtho()?(F=m.getOrthoWidth()/2,Math.abs(Z[0])<=F&&Math.abs(Z[1]*k)<=F):(F=Math.sqrt(Z[0]*Z[0]+Z[1]*Z[1]+Z[2]*Z[2])*Math.tan(m.getFovy()/2),Math.abs(Z[1]<=F)&&Math.abs(Z[0])<=F*k)},toViewPosition:function(K){var r=this,f=r.getWidth()/2,d=r.getHeight()/2,Z=r._18Q;return Z&&Z._wh===f/d||(Z=fc(r),r._18Q=bn(Z,Z,bh(r)),r._18Q._wh=f/d),K=Xb([K[0],K[1],K[2],1],Z),{x:f+f*K[0]/K[3],y:d-d*K[1]/K[3]}},getHitPosition:function(p,q,n){var c=this,J=c.getWidth(),S=c.getHeight(),D=p.target?c.lp(p):p,I=D.x-J/2,A=D.y-S/2,h=c.getCenterInfo(),i=bh(c);q=q?q:[0,0,0],n=n?n:[0,1,0],I=I/J*h.width,A=-1*A/S*h.height;var O=[i[0]*I,i[4]*I,i[8]*I],g=[i[1]*A,i[5]*A,i[9]*A],d=[O[0]+g[0],O[1]+g[1],O[2]+g[2]],j=c.getCenter(),E=ps(c,q,n,[d[0]+j[0],d[1]+j[1],d[2]+j[2]]);return E?E:[0,0,0]},intersectObject:function(V,Z){return this._raycaster.intersectObject(V,Z)},intersectObjects:function(K,D,T){return this._raycaster.intersectObjects(K,D,T)},getLineLength:function(S){this.validate();var j=this.getData3dUI(S);if(j&&j.getCache){var O=j.getCache();if(O)return O[O.length-1].length}return 0},getLineOffset:function(m,J){var P=this.getData3dUI(m);if(P&&P.getCache){var u=P.getCache();if(u)return hd(u,J)}return Z},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(g,C,d){var M=this,O=M.getEye();O=[O[0],O[1],O[2]];var j=M.getCenter();if(j=[j[0],j[1],j[2]],g||(g=O),C||(C=j),M._flyAnim&&M._flyAnim.stop(!0),d=is(d),!d)return M.setEye(g[0],g[1],g[2]),M.setCenter(C[0],C[1],C[2]),delete M._flyAnim,!0;var k=[g[0]-O[0],g[1]-O[1],g[2]-O[2]],B=[C[0]-j[0],C[1]-j[1],C[2]-j[2]];return d.action=function(V){M.setCenter(j[0]+B[0]*V,j[1]+B[1]*V,j[2]+B[2]*V),M.setEye(O[0]+k[0]*V,O[1]+k[1]*V,O[2]+k[2]*V)},d._37o=function(){delete M._flyAnim},M._flyAnim=Ep(d)},flyTo:function(){function l(o,S,O){if(O instanceof k.Node){h.fromArray(go(O,S.getMat(O)));var H=O.getAnchor3d();o.push((new Lp).set(0-H.x,0-H.y,0-H.z).applyMatrix4(h)),o.push((new Lp).set(0-H.x,0-H.y,1-H.z).applyMatrix4(h)),o.push((new Lp).set(0-H.x,1-H.y,0-H.z).applyMatrix4(h)),o.push((new Lp).set(0-H.x,1-H.y,1-H.z).applyMatrix4(h)),o.push((new Lp).set(1-H.x,0-H.y,0-H.z).applyMatrix4(h)),o.push((new Lp).set(1-H.x,0-H.y,1-H.z).applyMatrix4(h)),o.push((new Lp).set(1-H.x,1-H.y,0-H.z).applyMatrix4(h)),o.push((new Lp).set(1-H.x,1-H.y,1-H.z).applyMatrix4(h))}}var n=new Lp,w=new Lp,d=new Lp,S=new Lp,h=new Ln,C=new k.Math.Quaternion,p=new Sh;return function(h,T,P){var N=this;if(P!==K)T={animation:T,ratio:P};else{var F=typeof T;("boolean"===F||"object"===F&&T.duration)&&(T={animation:T})}T=T||{},n.fromArray(N.getEye()),w.fromArray(N.getCenter());var x,R,H=[],y=T.center,A=T.distance===K;if(y&&d.fromArray(y),h instanceof k.Node)y||d.fromArray(h.p3()),A&&(l(H,N,h),x=H.length);else{if(h||(h=N.dm().getDatas()),!h.length)return;if((A||!y)&&(H=[],h.forEach(function(j){l(H,N,j)}),x=H.length),!x)return;if(!y){for(d.set(0,0,0),R=0;x>R;R++)d.add(H[R]);d.multiplyScalar(1/x)}}if(N.setCenter(d.x,d.y,d.z),S.subVectors(n,w),T.direction||T.worldDirection){!T.worldDirection&&h instanceof k.Node?C.setFromEuler(p.set(h.r3(),h.getRotationMode(),!0)):C.set(0,0,0,1);var s=S.length();S.fromArray(T.worldDirection||T.direction).applyQuaternion(C).setLength(s)}if(A){for(var r,i,X,$,V,b=N.getNear(),L=10,P=T.ratio||.8;L--;){for(N._eye[0]=S.x+d.x,N._eye[1]=S.y+d.y,N._eye[2]=S.z+d.z,r=fc(N),bn(r,r,bh(N)),$=!0,V=-1/0,R=0;x>R;R++){if(X=H[R],i=Xb([X.x,X.y,X.z,1],r),i[3]<b&&L){S.multiplyScalar(2),$=!1;break}V=Math.max(V,Math.max(Math.abs(i[0]),Math.abs(i[1]))/P-i[3])}if($)break}S.setLength(V+S.length()).add(d)}else S.setLength(T.distance).add(d);N._flyAnim&&N._flyAnim.stop(!0);var f=is(T.animation);if(f){N.setEye(n.x,n.y,n.z),N.setCenter(w.x,w.y,w.z);var I=(new Lp).subVectors(S,n),t=(new Lp).subVectors(d,w),v=new Lp,g=new Lp;return f.action=function(p){v.copy(n).addScaledVector(I,p),g.copy(w).addScaledVector(t,p),N.setCenter(g.x,g.y,g.z),N.setEye(v.x,v.y,v.z)},f._37o=function(){delete N._flyAnim},{lastEye:n,lastCenter:w,eye:S,center:d,animation:N._flyAnim=Ep(f)}}return N.setEye(S.x,S.y,S.z),delete N._flyAnim,{lastEye:n,lastCenter:w,eye:S,center:d}}}(),getBoundingBox:function(){function b(F,S,t){X.fromArray(go(t,S.getMat(t)));var b=t.getAnchor3d();F.push((new Lp).set(0-b.x,0-b.y,0-b.z).applyMatrix4(X)),F.push((new Lp).set(0-b.x,0-b.y,1-b.z).applyMatrix4(X)),F.push((new Lp).set(0-b.x,1-b.y,0-b.z).applyMatrix4(X)),F.push((new Lp).set(0-b.x,1-b.y,1-b.z).applyMatrix4(X)),F.push((new Lp).set(1-b.x,0-b.y,0-b.z).applyMatrix4(X)),F.push((new Lp).set(1-b.x,0-b.y,1-b.z).applyMatrix4(X)),F.push((new Lp).set(1-b.x,1-b.y,0-b.z).applyMatrix4(X)),F.push((new Lp).set(1-b.x,1-b.y,1-b.z).applyMatrix4(X))}var X=new Ln;return function(V){if(V=V||this.sm().getSelection(),V instanceof k.Node&&(V=[V]),0===V.length)return Z;var j=[];V.forEach(function(K){b(j,this,K)},this);var m=[1/0,1/0,1/0],w=[-1/0,-1/0,-1/0];return j.forEach(function(y){m[0]=Math.min(y.x,m[0]),m[1]=Math.min(y.y,m[1]),m[2]=Math.min(y.z,m[2]),w[0]=Math.max(y.x,w[0]),w[1]=Math.max(y.y,w[1]),w[2]=Math.max(y.z,w[2])}),{min:m,max:w}}}()}),xb.RenderEnv=function(d){this.gv=d,this.enable=!1},C.defineProperties(xb.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(t){this._debugOn=t,this.capture&&this.capture()}}}),C.assign(xb.RenderEnv.prototype,{renderEnvToCube:function(P,_,r,c){var N=this,S=N.gv;if(!P||!_||!r)return N.enable=!1,N._42=null,void 0;N.enable=!0;var q=Math.floor(c/P*_),M=S.getGL(),i=N._renderTargets;i?i.length<r&&(i=N._renderTargets=i.concat(new Array(r-i.length))):i=N._renderTargets=new Array(r);for(var a=0;r>a;a++)i[a]?i[a].setSize(M,c,q):i[a]=new xb.RenderTarget(S,M,c,q);var I=!1;N.capture=function(){I=!0,S._42(),I=!1};var F=new Lp,g=new Lp,U=new Lp,x=new Lp,e=(new Lp).setY(0),j=2*Math.PI/r,V=P/2/Math.tan(Math.PI/r),Z=2*Math.atan2(_/2,V),Q=P/_;N._42=function(b,u,t,O){var A=N._debugOn;if(!I&&!A)return!1;F.copy(S.getEye()),x.copy(S.getCenter()).sub(F);var E=Math.atan2(x.z,x.x),d=S.getNear(),n=S.getFovy(),q=S.getAspect();g.copy(S.getCenter());for(var c,$=0;r>$;$++)if(c=i[$],e.setZ(Math.cos(E)).setX(Math.sin(E)).multiplyScalar(V),E-=j,U.addVectors(F,e),S.setNear(V),S.setCenter([U.x,U.y,U.z]),S.setFovy(Z),S.setAspect(Q),A){var s=Math.round(u/r);b.viewport(s*$,0,s,t),O()}else Oj(b,c.frame),b.viewport(0,0,c.width,c.height),b.clear(b.COLOR_BUFFER_BIT),O(),nr(b),c.assureTexture();return S.setNear(d),S.setCenter([g.x,g.y,g.z]),S.setFovy(n),S.setAspect(q),!0},N.capture()},getTextureInfo:function(B){var q=this._renderTargets;if(!q)return null;var K=this._renderTargets[B];return K?{index:B,texture:K.texture,textureName:K.uuid}:null}}),C.assign(xb.Graph3dView.prototype,{renderEnvToCube:function(Z,R,w,u){var q=this;q.envRenderer||(q.envRenderer=new xb.RenderEnv(q)),q.envRenderer.renderEnvToCube(Z,R,w,u)}}),xb.RenderTarget=function(w,s,U,X,z){var l=this;z=z||{},l.uuid=k.Math.generateUUID(),l.gv=w,l.init(w,s,z),l.setSize(s,U,X)},C.assign(xb.RenderTarget.prototype,{init:function(G,$,s){var y=this,C=y.texture=$.createTexture();$.activeTexture($.TEXTURE0),$.bindTexture($.TEXTURE_2D,C),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,s.minFilter||$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MAG_FILTER,s.magFilter||$.LINEAR),$.bindTexture($.TEXTURE_2D,null),y.render=$.createRenderbuffer(),y.frame=$.createFramebuffer(),G._2O[y.uuid]=C},assureTexture:function(){var g=this,E=g.uuid,W=g.gv._2O;W[E]||(W[E]=g.texture)},setSize:function(G,$,L){var C=this;if(C.width!==$||C.height!==L){var r=G.RGBA,O=G.TEXTURE_2D,I=G.RENDERBUFFER,m=G.FRAMEBUFFER;Un(G,C.texture),G.texImage2D(O,0,r,$,L,0,r,G.UNSIGNED_BYTE,Z),G.bindRenderbuffer(I,C.render),G.renderbufferStorage(I,G.DEPTH_COMPONENT16,$,L),Oj(G,C.frame),G.framebufferTexture2D(m,G.COLOR_ATTACHMENT0,O,C.texture,0),G.framebufferRenderbuffer(m,G.DEPTH_ATTACHMENT,I,C.render),Un(G,Z),G.bindRenderbuffer(I,Z),nr(G),C.width=$,C.height=L}},toCanvas:function(){var d=this,K=d.gv.getGL();Oj(K,d.frame);var U=d.width,w=d.height,G=new Uint8Array(4*U*w);K.readPixels(0,0,U,w,K.RGBA,K.UNSIGNED_BYTE,G),nr(K);var L=D.createElement("canvas");L.width=U,L.height=w;var o=L.getContext("2d"),I=o.createImageData(U,w);return I.data.set(G),o.putImageData(I,0,0),L}});var Uc=xb.Interactor=function(K){this.gv=K};Te("Interactor",C,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var pd=xb.DefaultInteractor=function(u){up(pd,this,[u])};Te("DefaultInteractor",Uc,{handle_contextmenu:function(j){xf(j)},handle_mousewheel:function(T){this.gv.handleScroll(T,T.wheelDelta/40)},handle_DOMMouseScroll:function(O){2===O.axis&&this.gv.handleScroll(O,-O.detail)},handle_keydown:function(E){this.gv.handleKeyDown(E)},handle_mousedown:function(G){this.handle_touchstart(G)},handle_touchstart:function(M){xf(M);var H=this,b=H.gv,A=em(M),l=b.getDataInfoAt(M),U=l?l.data:Z,$=l?l.part:Z,T=b.sm(),w=zs(M),j=Tm(M);b.setFocus(M)&&(H._62O=Z,H._57I=Z,U?Ah(M)?T.co(U)?T.rs(U):T.as(U):T.co(U)||T.ss(U):A&&(Ah(M)?b.isRectSelectable()&&(H._62O=hb):H._57I=bk(M)),H._31Q&&(nj(H._31Q),delete H._31Q,delete H._32Q),H._62O||(b.isFirstPersonMode()&&(Cd(M)||j>2?H._62O="pan":b.isMouseRoamable()||Jq?(H._62O="roaming",H.foward=w&&em(M),H._32Q=Li(),H._31Q=zj(H.tick,H)):A||(H._62O="roaming")),H._62O||(A&&w&&Pr[$]?(H._62O=$,H.p3=U.p3()):A&&w&&vs(U)&&b.isSelected(U)?b.isMovable(U)?(H._62O="move",H.p3=U.p3(),H.movedata=U):b.isInteractive(U)&&(H._62O="none"):Jq&&(j>2?H._62O="pan":2===j&&(H.dist=dc(M),H._62O="pinch")))),H.point=b.lp(M),nf(H,M),yn(M)?b.handleDoubleClick(M,U,$):b.handleClick(M,U,$))},tick:function(){var A=this,s=A.gv,k=s._moveStep;A.point&&s.isWalkable()&&(A._32Q&&(k*=(Li()-A._32Q)/50),s.walk(A.foward?k:-k),A._32Q=Li(),A._31Q=zj(A.tick,A))},handle_mouseup:function(R){this.handle_touchend(R)},handle_touchend:function(I){var Y=this._57I;Y&&(Qn(Y,bk(I))<=1&&this.gv.sm().cs(),this._57I=Z)},handleWindowMouseMove:function(O){this.handleWindowTouchMove(O)},handleWindowTouchMove:function(S){var d,L,O=this,U=O.gv,u=O._62O,o=O.point,N=U.dm(),i=U.lp(S),w=i.x-o.x,p=i.y-o.y,h=U.getWidth(),q=U.getHeight();if(h&&q){var n=-G*w/h,_=-G*p/q;if("roaming"===u)O.rotate(S,n/2,_/2);else if(u===Wn||u===Oq||u===Ni)U._86O||N.beginTransaction(),U.fi({kind:U._86O?"betweenEditRotation":"beginEditRotation",event:S}),U._86O=1,U.sm().each(function(O){if(vs(O)&&U.isRotationEditable(O)){var X=s(n)>s(_)?n:_;u===Wn?O.setRotationX(O.getRotationX()+X):u===Oq?O.setRotationY(O.getRotationY()+X):u===Ni&&O.setRotationZ(O.getRotationZ()+X)}});else if("move"===u||Pr[u]){u===qo||u===ze||u===Pi?(U._87O||N.beginTransaction(),U.fi({kind:U._87O?"betweenEditScale":"beginEditScale",event:S}),U._87O=1):(U._moving||N.beginTransaction(),U.fi({kind:U._moving?"betweenMove":"beginMove",event:S}),U._moving=1);var y,Y=O.p3,r=U.getPositionInfo(Y),C=bh(U);y=u===qm?"x":u===hc?"y":u===Pg?"z":u===qo?"sx":u===ze?"sy":u===Pi?"sz":U.getMoveMode(S,O.movedata),w=w/h*r.width,p=-1*p/q*r.height;var t,F,R=[C[0]*w,C[4]*w,C[8]*w],Q=[C[1]*p,C[5]*p,C[9]*p],A=R[0]+Q[0],e=R[1]+Q[1],I=R[2]+Q[2],J=[Y[0]+A,Y[1]+e,Y[2]+I],P=xo(U.getEye(),J,!0);if("xyz"===y?(t=J,U.moveSelection(A,e,I)):"xz"===y?(t=ps(U,Y,[0,1,0],J),t&&U.moveSelection(t[0]-Y[0],0,t[2]-Y[2])):"xy"===y?(t=ps(U,Y,[0,0,1],J),t&&U.moveSelection(t[0]-Y[0],t[1]-Y[1],0)):"yz"===y?(t=ps(U,Y,[1,0,0],J),t&&U.moveSelection(0,t[1]-Y[1],t[2]-Y[2])):"x"===y||"sx"===y?(P[0]=0,t=ps(U,Y,P,J),t&&(F=t[0]-Y[0],"x"===y?U.moveSelection(F,0,0):U.sm().each(function(f){vs(f)&&U.isSizeEditable(f)&&(d=f.getScaleX()+F/100,L=d/f.getScaleX(),f.setScaleX(d),Cd(S)&&(f.setScaleY(f.getScaleY()*L),f.setScaleTall(f.getScaleTall()*L)))}))):"y"===y||"sy"===y?(P[1]=0,t=ps(U,Y,P,J),t&&(F=t[1]-Y[1],"y"===y?U.moveSelection(0,F,0):U.sm().each(function(A){vs(A)&&U.isSizeEditable(A)&&(d=A.getScaleTall()+F/100,L=d/A.getScaleTall(),A.setScaleTall(d),Cd(S)&&(A.setScaleY(A.getScaleY()*L),A.setScaleX(A.getScaleX()*L)))}))):("z"===y||"sz"===y)&&(P[2]=0,t=ps(U,Y,P,J),t&&(F=t[2]-Y[2],"z"===y?U.moveSelection(0,0,F):U.sm().each(function(s){vs(s)&&U.isSizeEditable(s)&&(d=s.getScaleY()+F/100,L=d/s.getScaleY(),s.setScaleY(d),Cd(S)&&(s.setScaleX(s.getScaleX()*L),s.setScaleTall(s.getScaleTall()*L)))}))),!t)return;O.p3=t}else if(u===hb){var f=O.div;f||(f=O.div=Ti(),Xh(O.getView(),f),f.op=o,f.style.background=U.getRectSelectBackground()),U.fi({kind:U._rectSelecting?"betweenRectSelect":"beginRectSelect",event:S}),U._rectSelecting=1,f.rect=Fp(f.op,i),ef(f,f.rect)}else if("pinch"===u&&2===Tm(S)){U.fi({kind:U._pinching?"betweenPinch":"beginPinch",event:S}),U._pinching=1;var F=dc(S);U.handlePinch(F,O.dist),O.dist=F}else"pan"===u||Cd(S)?O.pan(S,w,p):"none"===u||U.isFirstPersonMode()||(em(S)?O.rotate(S,n,_):(O.pan(S,w,0),U.isWalkable()&&(U.fi({kind:U._walking?"betweenWalk":"beginWalk",event:S}),U._walking=1,U.walk(p/U.getHeight()*U.getCenterInfo().height))));O.point=i}},pan:function(V,k,T){var W=this.gv;if(W.isPannable()){var v=W.getWidth(),R=W.getHeight();if(!v||!R)return;var j=W.getCenterInfo(),d=k/v*j.width,Y=-1*T/R*j.height;W.fi({kind:W._panning?"betweenPan":"beginPan",event:V}),W._panning=1,W.pan(-d,-Y)}},rotate:function(b,h,R){var t=this.gv;t.isRotatable()&&(t.fi({kind:t._rotating?"betweenRotate":"beginRotate",event:b}),t._rotating=1,t.rotate(h,R))},handleWindowMouseUp:function(w){this.handleWindowTouchEnd(w)},handleWindowTouchEnd:function(x){var W=this,r=W.gv,c=r.dm(),N=W.div;if(N){var z=r.getDatasInRect(N.rect);if(!z.isEmpty()){var d=r.sm(),v=d.toSelection();z.each(function(G){d.co(G)?v.remove(G):v.add(G)}),d.ss(v)}Xq(N)}r._moving&&(delete r._moving,r.fi({kind:"endMove",event:x}),r.onMoveEnded(),c.endTransaction()),r._panning&&(delete r._panning,r.fi({kind:"endPan",event:x}),r.onPanEnded()),r._rotating&&(delete r._rotating,r.fi({kind:"endRotate",event:x}),r.onRotateEnded()),r._86O&&(delete r._86O,r.fi({kind:"endEditRotation",event:x}),c.endTransaction()),r._87O&&(delete r._87O,r.fi({kind:"endEditScale",event:x}),c.endTransaction()),r._pinching&&(delete r._pinching,r.fi({kind:"endPinch",event:x}),r.onPinchEnded()),r._rectSelecting&&(delete r._rectSelecting,r.fi({kind:"endRectSelect",event:x}),r.onRectSelectEnded()),r._walking&&(delete r._walking,r.fi({kind:"endWalk",event:x}),r.onWalkEnded()),W.dist=W.point=W._62O=W.p3=W.movedata=W.div=W._57I=W._32Q=W._31Q=W.foward=Z}});var Vr=xb.MapInteractor=function(J){up(Vr,this,[J]),this._minPhi=0,this._maxPhi=5*B/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};Te("MapInteractor",Uc,{handle_contextmenu:function(J){xf(J)},handle_mousewheel:function(F){this.gv.handleScroll(F,F.wheelDelta/40)},handle_DOMMouseScroll:function(F){2===F.axis&&this.gv.handleScroll(F,-F.detail)},handle_keydown:function(d){this.gv.handleKeyDown(d)},handle_mousedown:function(I){this.handle_touchstart(I)},handle_touchstart:function(N){xf(N);var j=this,A=j.gv;if(A.setFocus(N)){A.lp(N);var P=A.getDataInfoAt(N),J=P?P.data:Z,z=P?P.part:Z;if(!J||!A.isInteractive(J)){var g=j.editing={point:A.lp(N)};Jq?g.touch=!0:(g.touch=!1,g.pan=em(N)),nf(j,N)}yn(N)?A.handleDoubleClick(N,J,z):A.handleClick(N,J,z)}},handle_mouseup:function(_){this.handle_touchend(_)},handle_touchend:function(){},handleWindowMouseMove:function(A){this.handleWindowTouchMove(A)},handleWindowTouchMove:function(F){var y=this,I=y.gv,i=y.editing;if(i){var N=I.lp(F),S=i.point,z=N.x-S.x,t=N.y-S.y;if(!i.moved){if(Math.abs(z)<y.threshold&&Math.abs(t)<y.threshold&&!(F.touches&&F.touches.length>1))return;i.moved=!0}if(i.point=N,i.touch){var q=F.touches.length;if(2!==q)y.pan(F,z,t);else{if(1>=q)return;var J=F.touches,v={x:J[0].clientX,y:J[0].clientY},d={x:J[1].clientX,y:J[1].clientY},w={x:d.x-v.x,y:d.y-v.y},o=i.lastCenter,Q=Math.atan2(w.y,w.x),Y=i.theta,c=0;Y==Z?Y=i.theta=Q:(c=Q-Y,i.thetaStarted||Math.abs(c)>y.touchRotateThreshold?(i.thetaStarted=!0,i.theta=Q):c=0);var V=B*(v.y+d.y)/2/I.getHeight(),M=i.phi,A=0;M==Z?M=i.phi=V:(A=V-M,i.phiStarted||Math.abs(A)>y.touchRotateThreshold?(i.phiStarted=!0,i.phi=V):A=0);var m,R=Math.sqrt(w.x*w.x+w.y*w.y),K=i.vlen;if(K){var L=v.x-o.x,e=v.y-o.y,D=d.x-o.x,E=d.y-o.y,X=Math.sqrt(L*L+e*e),u=Math.sqrt(D*D+E*E),H=K/2,P=y._sign2(X-H),C=y._sign2(u-H);0>P*C||0===P&&0===C?(m=1,i.vlen=R):(m||(m=R/K),i.scaleStarted||Math.abs(m-1)>y.touchScaleThreshold?(i.vlen=R,i.scaleStarted=!0):m=1)}else K=i.vlen=R,m=1;1!==m&&I.setZoom(m),(A||c)&&y.rotate(F,c,-A),i.lastCenter={x:(d.x+v.x)/2,y:(d.y+v.y)/2}}}else if(i.pan)y.pan(F,z,t);else{var x=I.getWidth(),W=I.getHeight();if(!x||!W)return;var j=-G*z/x,f=-G*t/W;y.rotate(F,j,f)}}},_sign2:function(E){return Math.abs(E)<this._touchScaleCheckAccuracy?0:E>0?1:-1},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},handleWindowTouchEnd:function(_){var W=this,t=W.editing;if(W.editing=null,t){var n=W.gv;if(!t.moved&&t.pan){var F=n.getDataAt(_);F?n.sm().setSelection([F]):n.sm().clearSelection()}else n._panning=null,n._rotating=null,n.fi({kind:t.pan?"endPan":"endRotate",event:_})}},pan:function(T,J,Q){var M=this,$=M.gv;if($.isPannable()){var f=$.getWidth(),n=$.getHeight();if(f&&n){var z=$.getCenterInfo(),O=-J/f*z.width,w=1*Q/n*z.height;$.fi({kind:$._panning?"betweenPan":"beginPan",event:T}),$._panning=1;var v=M.keepHorizon,k=M.editing.touch;if((k&&T.touches&&T.touches.length>1||!k&&Cd(T))&&(v=!v),!v)return $.pan(O,w);if(O||w){var b=bh($),o=[b[0]*O,b[4]*O,b[8]*O],h=[b[1],0,b[9]],N=Math.sqrt(h[0]*h[0]+h[2]*h[2]);N&&(h=[h[0]/N*w,0,h[2]/N*w]);var a=o[0]+h[0],G=o[1]+h[1],P=o[2]+h[2],s=$._center,H=$._eye;s[0]+=a,s[1]+=G,s[2]+=P,H[0]+=a,H[1]+=G,H[2]+=P,$.fp(og,Z,H),$.fp(Lh,Z,s)}}}},rotate:function(L,v,m){var H=this,o=H.gv;if(o.isRotatable()){var n=o._center,C=o._eye,z=xo(C,n),i=g(T(z[0]*z[0]+z[2]*z[2]),z[1]),G=i+m;G=Math.max(H.minPhi,Math.min(H.maxPhi,G)),m=G-i,o.fi({kind:o._rotating?"betweenRotate":"beginRotate",event:L}),o._rotating=1,o.rotate(v,m)}}}),C.defineProperties(Vr.prototype,{minPhi:{get:function(){return this._minPhi},set:function(R){this._minPhi=R}},maxPhi:{get:function(){return this._maxPhi},set:function(h){this._maxPhi=h}},keepHorizon:{get:function(){return this._keepHorizon},set:function(M){this._keepHorizon=M}},threshold:{get:function(){return this._threshold},set:function(O){this._threshold=O}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(m){this._touchScaleThreshold=m}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(c){this._touchRotateThreshold=c}}});var he=function(O){this.gv=O};_p(he,C,{_iv:!0,iv:function(){this._iv=!0},face:function(L,K){var V=this,B=V.gv.getGL();if(!B||!vs(L))return Z;var j=K.x,s=K.width,Q=K.height,q=V.height-K.y-Q,e=v(s/2),m=new Uint8Array(4*s*Q),R=0;for(V.iv(),V.validate(L),Oj(B,V.frame),B.readPixels(j,q,s,Q,B.RGBA,B.UNSIGNED_BYTE,m),nr(B),V.iv();e>=R;R++)for(var X=e-R,l=e+R,M=X;l>=M;M++)for(var n=X;l>=n;n++)if(M===X||M===l||n===X||n===l){var i=Ir.m[m[4*(M*s+n)]];if(i)return i}},get:function(W,f){this.validate();var d=this,P=d.gv.getGL();if(!P)return Z;var T,a,Y=W.x,B=W.width,i=W.height,J=d.height-W.y-i,e=v(B/2),l=new Uint8Array(4*B*i),A=0,Q=l.length,y=f?Z:new $p,_=f?Z:{};if(Oj(P,d.frame),P.readPixels(Y,J,B,i,P.RGBA,P.UNSIGNED_BYTE,l),nr(P),f){for(;e>=A;A++)for(var w=e-A,L=e+A,o=w;L>=o;o++)for(var j=w;L>=j;j++)if((o===w||o===L||j===w||j===L)&&(T=d.info(l,4*(o*B+j))))return T}else for(;Q>A;A+=4)T=d.info(l,A),T&&(a=T.data,_[a._id]||(y.add(a),_[a._id]=a));return y},info:function(L,i){return this.colorMap[(L[i]<<16)+(L[i+1]<<8)+L[i+2]+((127&L[i+3])<<24)]},validate:function(S){var s=this,o=s.gv,D=o.getGL();if(D){var b=o.getWidth(),z=o.getHeight(),h=D.RGBA,L=D.TEXTURE_2D,q=D.RENDERBUFFER,u=D.FRAMEBUFFER;s.texture||(s.texture=Ei(D),s.render=D.createRenderbuffer(),s.frame=D.createFramebuffer()),(s.width!==b||s.height!==z)&&(Un(D,s.texture),D.texImage2D(L,0,h,b,z,0,h,D.UNSIGNED_BYTE,Z),kk(D,D.TEXTURE_MIN_FILTER,D.LINEAR),D.bindRenderbuffer(q,s.render),D.renderbufferStorage(q,D.DEPTH_COMPONENT16,b,z),Oj(D,s.frame),D.framebufferTexture2D(u,D.COLOR_ATTACHMENT0,L,s.texture,0),D.framebufferRenderbuffer(u,D.DEPTH_ATTACHMENT,q,s.render),Un(D,Z),D.bindRenderbuffer(q,Z),nr(D),s.width=b,s.height=z),s._iv&&(s._iv=!1,Oj(D,s.frame),o._42(S||(s.colorMap={}),1),nr(D))}}});var ob=function(J){this.gv=J};_p(ob,C,{gap:0,size:0,_42:function(v,k){var e=this,t=e.gv,j=t._gridGap,w=t._gridSize;if(t._gridVisible){if(e.gap!==j||e.size!==w){for(var B=[],y=t._gridSize/2,C=j*y,r=0;2*y+1>r;r++){var m=6*r,s=6*(2*y+1)+m;B[m]=-C,B[m+1]=0,B[m+2]=-C+r*j,B[m+3]=C,B[m+4]=0,B[m+5]=-C+r*j,B[s]=-C+r*j,B[s+1]=0,B[s+2]=-C,B[s+3]=-C+r*j,B[s+4]=0,B[s+5]=C}e.vs=new Wp(B),e.gap=j,e.size=w}Mm(t),Zl(v,k),tj(v),jl(v,k,1,t._gridColor,t._buffer.vs,e.vs),yk(v,0,e.vs.length/3,v.LINES),Ze(v),hm(v,k)}else e.vs=e.gap=e.size=Z}});var hg=function(R){this.gv=R};_p(hg,C,{_42:function(l,R){var F=this.gv,m=F._buffer.vs,B=F._axisXColor,P=F._axisYColor,x=F._axisZColor,N=F._originAxisVisible,h=F._centerAxisVisible;if(N||h){var W=Y?l.TRIANGLES:l.TRIANGLE_FAN,K=l.LINES;if(Mm(F),Zl(l,R),tj(l),N){var v=F.getCenterInfo(),E=z(v.width,v.height)/5,d=.8*E,D=.05*E;jl(l,R,1.5,B,m,new Wp([0,0,0,E,0,0,d,D,0,d,0,D,d,-D,0,d,0,-D,d,D,0,0,0,0,0,E,0,D,d,0,0,d,D,-D,d,0,0,d,-D,D,d,0,0,0,0,0,0,E,D,0,d,0,D,d,-D,0,d,0,-D,d,D,0,d])),yk(l,0,2,K),yk(l,1,6,W),jl(l,R,Z,P),yk(l,7,2,K),yk(l,8,6,W),jl(l,R,Z,x),yk(l,14,2,K),yk(l,15,6,W)}if(h){var X=F._center,s=X[0],i=X[1],V=X[2],v=F.getPositionInfo(X);E=z(v.width,v.height)/20,jl(l,R,1.5,B,m,new Wp([s,i,V,s+E,i,V,s,i,V,s,i+E,V,s,i,V,s,i,V+E])),yk(l,0,2,K),jl(l,R,Z,P),yk(l,2,2,K),jl(l,R,Z,x),yk(l,4,2,K)}Ze(l),hm(l,R)}}});var Cp=function(R){this.gv=R,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Cp.Mode.MouseOver};Cp.Mode={Disable:0,Selection:1,MouseOver:2},_p(Cp,C,{onMouseOver:function(r){M.preventDefault(r);var D=this.gv.getDataAt(r);D!==this.mouseOverData&&(this.mouseOverData=D,this.gv.iv())},setFetchTargetFunc:function(l){this.fetchTargetFunc=l},_42:function(p,I){var G,m=this,O=m._mode;if(O!==Cp.Mode.Disable&&(O===Cp.Mode.Selection?G=m.gv.sm().getSelection().toArray(function(W){return W.s("highlight.visible")}):O===Cp.Mode.MouseOver&&m.mouseOverData&&m.mouseOverData.s("highlight.visible")&&(G=[m.mouseOverData]),m.fetchTargetFunc&&(G=m.fetchTargetFunc(G)),G&&G.length)){var E=m.gv,A=E.vr.isPresenting(),M=E.getWidth();if(A){var Y=E.getWidth;M/=2,E.getWidth=function(){return M};var $=E.getViewport()}var H,V=E.getDevicePixelRatio(),L=M*V,z=E.getHeight()*V;(H=m._renderTarget)?H.setSize(p,L,z):m._renderTarget=H=new xb.RenderTarget(E,p,L,z),Oj(p,H.frame),E.drawFilter=function($){return G.indexOf($)<0?!0:void 0},E._42({}),E.drawFilter=null,nr(p),A&&(E.getWidth=Y,E.setViewport(p,$[0],$[1],$[2],$[3])),m.shader||(m.shader=new Ph.Shader(p,qd.vs,qd.fs));var i=m.shader;if(m.shader.bind(),p.enable(p.BLEND),p.activeTexture(p.TEXTURE0+0),p.bindTexture(p.TEXTURE_2D,H.texture),i.uniforms.image=0,i.uniforms.textureSize=[L,z],i.uniforms.edgeWidth=S["highlight.width"],m.highlightColor!==S["highlight.color"]){var w=re(m.highlightColor=S["highlight.color"]);m.highlightColorData=[w[0]/255,w[1]/255,w[2]/255,w[3]/255]}i.uniforms.edgeColor=m.highlightColorData,m.ibuffer?(m.ibuffer.upload(),m.vbuffer.upload()):(m.ibuffer=Ph.Buffer.createIndexBuffer(p,new Uint16Array([0,2,1,1,2,3])),m.vbuffer=Ph.Buffer.createVertexBuffer(p,new Float32Array([0,0,1,0,0,1,1,1]))),i.attributes.pos.pointer(m.vbuffer),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),p.disable(p.BLEND),p.bindTexture(p.TEXTURE_2D,null),p.useProgram(I)}}}),C.defineProperties(Cp.prototype,{mode:{get:function(){return this._mode},set:function(K){var H=this._mode;K!==H&&(this._mode=K,K===Cp.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):H===Cp.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var qd={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},hq=function(J){this.gv=J},qm="edit_tx",hc="edit_ty",Pg="edit_tz",Wn="edit_rx",Oq="edit_ry",Ni="edit_rz",qo="edit_sx",ze="edit_sy",Pi="edit_sz",Pr={};Pr[qm]=1,Pr[hc]=1,Pr[Pg]=1,Pr[Wn]=1,Pr[Oq]=1,Pr[Ni]=1,Pr[qo]=1,Pr[ze]=1,Pr[Pi]=1,_p(hq,C,{_42:function(u,w,D){var E=this,e=E.gv,y=e.sm().ld();if(y&&e.isEditable(y)&&!e.isEditHelperDisabled()&&vs(y)&&(!e.isFirstPersonMode()||!e.isMouseRoamable()&&!Jq)){Mm(e);var p,H,x=e.isMovable(y),K=e.isRotationEditable(y),C=e.isSizeEditable(y),N=e._axisXColor,s=e._axisYColor,q=e._axisZColor,h=e._editSizeColor,i=y.p3(),a=Qn(e.getEye(),i)/10,n=a/(D?5:10),l=.7*a,g=.4*l,F=i[0],V=i[1],r=i[2];p=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],x&&E._17O(u,w,y,D,qm,N,p,[F,V-n,r,F+l,V-n,r,F+l,V,r,F+l,V,r,F,V,r,F,V-n,r,F,V-n,r+n,F+l,V-n,r+n,F+l,V-n,r,F+l,V-n,r,F,V-n,r,F,V-n,r+n]),H=F+l,C&&E._17O(u,w,y,D,qo,h,p,[H,V-n,r,H+g,V-n,r,H+g,V,r,H+g,V,r,H,V,r,H,V-n,r,H,V-n,r+n,H+g,V-n,r+n,H+g,V-n,r,H+g,V-n,r,H,V-n,r,H,V-n,r+n]),H+=g,K&&E._17O(u,w,y,D,Wn,N,p,[H,V-n,r,H+g,V-n,r,H+g,V,r,H+g,V,r,H,V,r,H,V-n,r,H,V-n,r+n,H+g,V-n,r+n,H+g,V-n,r,H+g,V-n,r,H,V-n,r,H,V-n,r+n]),p=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],x&&E._17O(u,w,y,D,hc,s,p,[F,V,r,F,V+l,r,F-n,V+l,r,F-n,V+l,r,F-n,V,r,F,V,r,F,V,r,F,V,r-n,F,V+l,r-n,F,V+l,r-n,F,V+l,r,F,V,r]),H=V+l,C&&E._17O(u,w,y,D,ze,h,p,[F,H,r,F,H+g,r,F-n,H+g,r,F-n,H+g,r,F-n,H,r,F,H,r,F,H,r,F,H,r-n,F,H+g,r-n,F,H+g,r-n,F,H+g,r,F,H,r]),H+=g,K&&E._17O(u,w,y,D,Oq,s,p,[F,H,r,F,H+g,r,F-n,H+g,r,F-n,H+g,r,F-n,H,r,F,H,r,F,H,r,F,H,r-n,F,H+g,r-n,F,H+g,r-n,F,H+g,r,F,H,r]),p=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],x&&E._17O(u,w,y,D,Pg,q,p,[F,V,r,F,V,r+l,F,V-n,r+l,F,V-n,r+l,F,V-n,r,F,V,r,F,V-n,r,F-n,V-n,r,F-n,V-n,r+l,F-n,V-n,r+l,F,V-n,r+l,F,V-n,r]),H=r+l,C&&E._17O(u,w,y,D,Pi,h,p,[F,V,H,F,V,H+g,F,V-n,H+g,F,V-n,H+g,F,V-n,H,F,V,H,F,V-n,H,F-n,V-n,H,F-n,V-n,H+g,F-n,V-n,H+g,F,V-n,H+g,F,V-n,H]),H+=g,K&&E._17O(u,w,y,D,Ni,q,p,[F,V,H,F,V,H+g,F,V-n,H+g,F,V-n,H+g,F,V-n,H,F,V,H,F,V-n,H,F-n,V-n,H,F-n,V-n,H+g,F-n,V-n,H+g,F,V-n,H+g,F,V-n,H])}},_17O:function(o,Q,T,z,k,M,x,W){var F=this.gv._buffer;Tn(o,Q,z,!0,T,k),pq(o,Q,Z,!0,Z,!0,Z,!1),rf(o,Q.uDiffuse,M),js(o,F.vs,new Wp(W),Q.aPosition),js(o,F.ns,new Wp(x),Q.aNormal),tj(o),yk(o,0,12),Ze(o),Tk(o,Q)}});var Hh=k.Raycaster=function(o){this.gv=o,this.maxTriangleTest=1/0};to("Raycaster",C,{intersect:function(d){var x=this,c=x.gv,G=c.getDataAt(d);return G?x.intersectObject(d,G):null},intersectObjects:function(l,P,H){var T,V,n,D,v=this,N=1/0,a=l.origin||(new Lp).fromArray(v.gv.getEye()),d=v.maxTriangleTest,I=[];return P.forEach(function(v){H&&H(v)===!1||v.s("intersect")!==!1&&I.push(v)}),I.sort(function(j,n){return a.distanceToSquared2(j.p3())-a.distanceToSquared2(n.p3())}),v.countTriangles=0,I.forEach(function(z){v.countTriangles>d||(T=v.intersectObject(l,z),T&&(V=a.distanceToSquared(T.world),N>V&&(n=z,D=T,N=V)))}),v.countTriangles=0,{data:n,intersect:D}},intersectObject:function(a,y){if(a instanceof Rq)return this._intersectObjectImpl(a,y);var I,x,B=this,c=B.gv;x=c.unproject(a);var r=c.getEye();c.isOrtho()?(I=xo(c.getCenter(),r),I[0]+=I[0],I[1]+=I[1],I[2]+=I[2]):I=r,I=new Lp(I);var H=new Lp(x).sub(I).normalize(),T=new k.Math.Ray(I,H);return B._intersectObjectImpl(T,y)},_intersectObjectImpl:function(){function n(){var v=new Lp;return v.subVectors(G,y),H.subVectors(_,y),v.cross(H).normalize(),v}function s(J,z,o,E,p,W,q){return Yj.barycoordFromPoint(J,z,o,E,u),p.multiplyScalar(u.x),W.multiplyScalar(u.y),q.multiplyScalar(u.z),p.add(W).add(q),p.clone()}var N=new Ln,j=new Ln,P=new Rq,x=new Lp,a=new Lp,I=new Lp,E=new Lp,K=new Lp,_=new Lp,y=new Lp,G=new Lp,e=new Rj,i=new Rj,v=new Rj,H=new Lp,Z={vs:xm,is:Tp,uv:sh},u=new Lp;return function(d,X){var f=this.gv.getData3dUI(X),b=X.mat||f.mat;if(b){N.fromArray(b),j.getInverse(N),P.copy(d).applyMatrix4(j);var T,V,z="body",o=f.shapeModel;if(o||(o=kb(f)),o||(X instanceof k.Node&&!(X instanceof k.Shape)?(T=!0,o=Z):(V=!0,o=[f.left,f.front,f.right,f.back,f.top,f.bottom])),!o)return console.log("Can not find shape model."),null;
Sp(o)||(o=[o]);var Y,S,H,r,U,J,t,g,C,W,R,B,l,L,c,q,O=1/0,D=["","top_","bottom_"],w=!1;for(Y=0,S=o.length;S>Y;Y++)if(l=o[Y])for(H=0,r=D.length;r>H;H++)if(L=D[H],t=l[L+"vs"],g=l[L+"is"],C=l[L+"uv"]||l[L+"tuv"],t){if(c=l[L+"boundingBox"]){var R=P.intersectBox(c);if(!R)continue;if(P.origin.distanceTo(R)>O)continue;q=!1}else l[L+"boundingBox"]=c=new k.Math.Box3,q=!0;for(U=0,J=g?g.length:t.length/3;J>U;U+=3)this.countTriangles++,g?(a.fromArray(t,3*g[U]),I.fromArray(t,3*g[U+1]),E.fromArray(t,3*g[U+2])):(a.fromArray(t,3*U),I.fromArray(t,3*(U+1)),E.fromArray(t,3*(U+2))),q&&(c.expandByPoint(a),c.expandByPoint(I),c.expandByPoint(E)),W=P.intersectTriangle(a,I,E,!0,x),W&&(B=P.origin.distanceTo(W),O>B&&(O=B,K.copy(W),_.copy(a),y.copy(I),G.copy(E),""!==L?z=L.slice(0,-1):T?z=Of[Math.floor(U/6)]:V&&(z=Of[Y]),C&&(w=!0,g?(e.fromArray(C,2*g[U]),i.fromArray(C,2*g[U+1]),v.fromArray(C,2*g[U+2])):(e.fromArray(C,2*U),i.fromArray(C,2*(U+1)),v.fromArray(C,2*(U+2))))))}if(!isFinite(O))return null;var p,F=K.clone().applyMatrix4(N);w&&(p=s(K,_,y,G,e,i,v));var $=n(_,y,G),u=n(_.applyMatrix4(N),y.applyMatrix4(N),G.applyMatrix4(N)),A=P.direction.dot($);return A>0&&($.multiplyScalar(-1),u.multiplyScalar(-1)),{world:F,local:K.clone(),worldNormal:u,normal:$,uv:p,part:z}}}}()});var lh=function(z,l){this.gv=z,this.s=function($,h,D){return h==Z&&(h=D),h==Z?l.getStyle($):Vc(h,l,z)},this.data=l};_p(lh,C,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(u,C,t,V){var $=this,h=$.data;if(!(h instanceof Gl)){var R,g,U,y,B,P,j,m=$.gv,r=h._id,S=$.s("shape3d.alwaysOnTop")?null:$.s("batch"),d=m._batchIndexMap,l=m._batchModelMap,f=m.isSelectable(h),D=m.getBrightness(h),T=D!=Z&&1!==D;if($.needValidate(u)){if(U=Gq(d,l,h,S),$.validate(U,S?Gj[S]||kl:Z),U&&(y=d[r],B=y.size=U.vs.length/3-y.begin,j=U.rs))for(D=T?D:1,P=0;B>P;P++)j.push(D);if(vs(h)){var o=m.getWireframeGeometry(h);if(o)ab(m,h,o);else{var O=m.getWireframe(h);O&&ab(m,h,O)}}$.labelInfo=$.label2Info=$.noteInfo=$.note2Info=$._38o=Z,$._24O(Fe,"getLabel"),$._24O(Zh,"getLabel2"),$._26O(xk,"getNote"),$._26O(Hq,"getNote2"),$._15O(),$.interactiveInfo=m.isInteractive(h)?{}:Z,$._iv=!1}T&&rf(u,C.uBrightness,D),rf(u,C.uAlphaTest,$.s("alphaTest")),rf(u,C.uUseEnvMap,h.s("envmap")?!0:!1),rf(u,C.uReflectivity,h.s("envmap")||.01),g=Tn(u,C,t,f,h,Jp),g&&(pe(g,d[r],l),pe(g,m._polylineIndexMap[r],m._polylineModelMap),pe(g,m._wireframeIndexMap[r],m._wireframeModelMap)),d[r]||$._80o(u,C,V),m.isLabelVisible(h)&&((R=$.labelInfo)&&(Tn(u,C,t,f,h,Fe),$._28O(R,Fe,V)),(R=$.label2Info)&&(Tn(u,C,t,f,h,Zh),$._28O(R,Zh,V))),m.isNoteVisible(h)&&((R=$.noteInfo)&&(Tn(u,C,t,f,h,xk),$._29O(R,xk,V)),(R=$.note2Info)&&(Tn(u,C,t,f,h,Hq),$._29O(R,Hq,V))),(R=$._38o)&&$._99O(u,C,R,t,f,V),T&&rf(u,C.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return _e},_80o:function(){},dispose:function(){},_calcAnchorMat:function(b){if(b.hasOwnProperty("_anchor")||b.hasOwnProperty("_anchorElevation")){var U=b.getAnchor3d(),z={x:U.x-.5,y:U.y-.5,z:U.z-.5},G=Zg();return Ql(G,[-z.x,-z.y,-z.z]),G}},getBodyColor:function(x){var T=this.data,Y=this.gv.getBodyColor(T);return Y?Y:x?T.getStyle(x):Z},_24O:function(f,O){var q=this,t=q.data,g=q.gv,j=q.s,S=g[O](t);if(S!=Z){var B=j(f+".scale"),W=j(f+".max"),J=q[f+"Info"]={label:S,textureScale:j(f+".texture.scale"),color:g[O+"Color"](t),font:j(f+".font"),align:j(f+".align"),background:g[O+"Background"](t)},U=J.rect=Vo(J,S);W>0&&W<U.width&&(J.labelWidth=U.width,U.width=W),U.x=U.y=0,U.width*=B,U.height*=B,J.mat=q._16O(j(f+".autorotate"),j(f+".position"),U,j(f+".face"),j(f+".t3"),j(f+".r3"),j(f+".rotationMode"));var F=U.width/2,I=U.height/2;J.vs=new Wp([-F,I,0,-F,-I,0,F,-I,0,F,I,0]),U.width/=B,U.height/=B}},_26O:function(C,J){var v=this,K=v.data,m=v.gv,T=v.s,H=m[J](K);if(H!=Z){var j=T(C+".scale"),U=this[C+"Info"]={note:H,textureScale:T(C+".texture.scale"),expanded:T(C+".expanded"),font:T(C+".font"),color:T(C+".color"),align:T(C+".align"),borderWidth:T(C+".border.width"),borderColor:T(C+".border.color"),background:m[J+"Background"](K)};if(U.expanded){var k=T(C+".max"),i=Vo(U,H);i.width+=6,i.height+=2,k>0&&k<i.width&&(U.labelWidth=i.width,i.width=k);var P={x:-i.width/2,y:-8-i.height,width:i.width,height:i.height+8}}else P={x:-6,y:-18,width:12,height:18};U.mat=v._16O(T(C+".autorotate"),T(C+".position"),Z,T(C+".face"),T(C+".t3"),T(C+".r3"),T(C+".rotationMode")),U.rect=P,1!==j&&(P=nh(P),P.x*=j,P.height*=j,P.y=-P.height,P.width*=j);var E=P.x,u=P.y,l=P.width,z=P.height;U.vs=new Wp([E,-u,0,E,-u-z,0,E+l,-u-z,0,E+l,-u,0])}},_28O:function(E,s,L){if(L(this.s(s+".transparent"))){var x=E.rect,q=E.textureScale,$=x.width*q,X=x.height*q;if($>=1&&X>=1){var y=Zj($,X);1!==q&&(y.translate(y,x.x,x.y),y.scale(q,q),y.translate(y,-x.x,-x.y)),xp(y,E),y.restore(),vq(this,s,E.mat,E.vs,!0)}}},_29O:function(U,Z,V){if(V(this.s(Z+".transparent"))){var H=U.rect,x=U.textureScale,z=H.x,N=H.y,d=H.width*x,i=H.height*x;if(d>=1&&i>=1){H.x=H.y=0;var Q=Zj(d,i);1!==x&&Q.scale(x,x),Jf(Q,U),Q.restore(),H.x=z,H.y=N,vq(this,Z,U.mat,U.vs,!1)}}},_99O:function(b,P,w,_,s,K){if(w){var h=this,t=h.gv,g=h.data,d=t._buffer,u=t._1O,L=w.icons;for(var l in L){var o=L[l],m=w.rects[l];if(m&&K(Vc(o.transparent,g,t))){Tn(b,P,_,s,g,l);var j=Vc(o.shape3d,g,t),f=j?[j]:Vc(o.names,g,t),v=f?f.length:0,V=Vc(o.textureScale,g,t)||1,$=Vc(o.light,g,t);$==Z&&($=j?!0:!1),pq(b,P,Vc(o.blend,g,t),$,Vc(o.opacity,g,t),Vc(o.reverseFlip,g,t),Vc(o.reverseColor,g,t),Vc(o.reverseCull,g,t));for(var H=0;v>H;H++){var I=f[H],y=m[H];if(zp(h,y.mat),j)di(t,g,kb(h,j),h);else{var i=Mk(I);if(i){var A=y.width*V,Y=y.height*V;if(A>=1&&Y>=1){var N=Zj(A,Y);Ri(N,i,Vc(o.stretch,g,t),0,0,A,Y,g,t),N.restore(),Ei(b,Yp,u),tj(b,P,u,Vc(o.discardSelectable,g,t),d.uv,sd),js(b,d.vs,y.vs,P.aPosition),vh(b,d.ns,ir,P.aNormal),Lc(b,d.is,Ap),Dc(b,0,Ap.length),Ze(b,P,u)}}}Go(t)}Tk(b,P)}}}}});var vj=function(O,d){up(vj,this,[O,d])};_p(vj,lh,{_16O:function(M,E,i,T,J,N,K,m,f){var V=this.data,a=V.getFinalScale3d(),p=qr(E,a,i,T,m,f);if(V.hasOwnProperty("_anchor")||V.hasOwnProperty("_anchorElevation")){var s=V.getAnchor3d();p[0]-=(s.x-.5)*a[0],p[1]-=(s.y-.5)*a[1],p[2]-=(s.z-.5)*a[2]}return hp(Zg(),p,V.p3(),T,J,N,K,M,V.getFinalRotation3d(),V.getRotationMode())},clear:function(){var v=this;v.faceMat=v.mat=v.shapeModel=v.left=v.right=v.front=v.back=v.top=v.bottom=v.csg=Z},needValidate:function(E){if(this._iv)return this._validateFrameId=E._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var $=E._renderInfo.frame;if(this._validateFrameId!==$)return this._validateFrameId=$,!0}return!1},validate:function(U,k){var Z=this,N=Z.gv,G=Z.data,a=kb(Z);Z._updateAutoRotation(),Z._updateFixSize2d(),Z._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(kf(N,G,"_wireframeModelMap","_wireframeIndexMap"),kf(N,G,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var X=go(G,N.getMat(G),a?Z.s("shape3d.scaleable"):!0),g=Z._calcAnchorMat(G);if(g&&bn(X,X,g),G.mat=X,Z.clear(),U){var v=[];a?Cm(N,G,a,Z,Z.getBodyColor(),[X],U,v):(lb(N,G,U,k,X,Wf,v,Lr),lb(N,G,U,k,X,qb,v,ib),lb(N,G,U,k,X,uc,v,Ik),lb(N,G,U,k,X,Ul,v,Rp),lb(N,G,U,k,X,Nm,v,mm),lb(N,G,U,k,X,Fd,v,Ac)),v.length&&(mf(U.vs,v),mf(U.ns,Gc(v)))}else Z.mat=X,(Z.shapeModel=a)||(Z._cubeUvs=null,Z.vf(Wf,0),Z.vf(qb,16),Z.vf(Nm,8),Z.vf(Fd,24),Z.vf(uc,32),Z.vf(Ul,40))},_updateAutoRotation:function(){var x=new Sh;return function(){var l=this,O=l.data,K=l.s("shape3d.autorotate");if(!K)return O._dynamicRotation&&delete O._dynamicRotation,void 0;var n,F=l.gv;n="string"==typeof K?[K.indexOf("x")<0?F._eye[0]:F._center[0],K.indexOf("y")<0?F._eye[1]:F._center[1],K.indexOf("z")<0?F._eye[2]:F._center[2]]:F._eye;var G=F._center,E=O.p3(),w=af([E[0]+n[0]-G[0],E[1]+n[1]-G[1],E[2]+n[2]-G[2]],E,F._up),I=O.r3();x.set(0,0,0,O.getRotationMode(),!0).setFromRotationMatrix(w),Math.abs(I[0]-x.x)<1e-5&&Math.abs(I[1]-x.y)<1e-5&&Math.abs(I[2]-x.z)<1e-5||(O._dynamicRotation=[x.x,x.y,x.z])}}(),_updateFixSize2d:function(){var c=this,h=c.data,R=c.s("shape3d.fixSizeOnScreen");if(!R)return h._dynamicScale3d&&delete h._dynamicScale3d,void 0;var d=c.gv;h.getFinalScale3d();var B=go(h,d.getMat(h)),p=jq([0,0,0],B),D=d.toViewPosition(p);if(!isNaN(D.x)&&!isNaN(D.y)){var T=jq([1,0,0],B),L=d.toViewPosition(T),W=jq([0,1,0],B),i=d.toViewPosition(W),M=L.x-D.x,f=i.y-D.y;if(M&&f){var X=h._dynamicScale3d||[1,1,1],e=Mk(h.s("shape3d.image")),G=R[0]>0?R[0]:e?pr(e,c):20,t=R[1]>0?R[1]:e?Ne(e,c):20,F=Math.abs(M/G),I=Math.abs(f/t);Math.abs(F-1)<.001&&Math.abs(I-1)<.001||(h._dynamicScale3d=[X[0]/F,X[1]/I,X[2]])}}},_updateOverlapping:function(){var E=this,r=E.s("hide.overlapping.group");if(!r)return E._rectOverlapping&&(E._rectOverlapping=K),void 0;var e,a,Y,y=E.gv,L=E.data,X=go(L,y.getMat(L)),D=1/0,g=1/0,x=-1/0,Z=-1/0,o=L.getAnchor3d(),A=o.x,W=o.y,I=o.z;for(e=0;8>e;e++){if(a=jq([(e>>2)-A,(1&e>>1)-W,(1&e)-I],X),Y=y.toViewPosition(a),isNaN(Y.x)||isNaN(Y.y))return;D=Math.min(D,Y.x),x=Math.max(x,Y.x),g=Math.min(g,Y.y),Z=Math.max(Z,Y.y)}var V={x:D,y:g,w:x-D,h:Z-g};E._rectOverlapping=y.overlappingBox.isOverlapping(r,V)},getVectorDynamicSize:function(){var i,j=this,X=j.s("shape3d"),m=j.data;if("billboard"===X||"plane"===X||(i=m._currentCubeElementId)!=Z){var _,g,I=j.gv,r=go(m,I.getMat(m)),S=m.getAnchor3d(),P=.5-S.x,J=.5-S.y,E=.5-S.z,c=j.s("shape3d.vector.dynamic.maxsize"),z=function(d,H){d[0]+=P,d[1]+=J,d[2]+=E,H[0]+=P,H[1]+=J,H[2]+=E;var O=I.toViewPosition(jq(d,r)),i=I.toViewPosition(jq(H,r)),p=O.x-i.x,g=O.y-i.y;return Math.min(c,Math.sqrt(p*p+g*g))};if("billboard"===X)_=z([-.5,0,0],[.5,0,0]),g=z([0,-.5,0],[0,.5,0]);else if("plane"===X)_=z([-.5,0,0],[.5,0,0]),g=z([0,0,-.5],[0,0,.5]);else if(m._currentCubeElementId!=Z){var e=3*Tp[i+1],y=3*Tp[i],d=3*Tp[i+2];_=z([xm[e],xm[e+1],xm[e+2]],[xm[d],xm[d+1],xm[d+2]]),g=z([xm[e],xm[e+1],xm[e+2]],[xm[y],xm[y+1],xm[y+2]])}return[_,g]}},getCachedTexture:function(){var F=this,N=F.data,b=N._currentCubeElementId;return b!=Z?F._cubeCachedImage?F._cubeCachedImage[b]:null:F._shape3dCachedImage},setCachedTexture:function($){var K=this,H=K.data,S=H._currentCubeElementId;if(S!=Z){if(!K._cubeCachedImage)return K._cubeCachedImage={};K._cubeCachedImage[S]=$}else K._shape3dCachedImage=$},invalidateCachedTexture:function(i){var x,U,$,v=this;if(($=v._shape3dCachedImage)&&(i.deleteTexture($),v._shape3dCachedImage=null),U=v._cubeCachedImage){for(x in U)i.deleteTexture(U[x]);v._cubeCachedImage=null}},vf:function(a,O){var C=this;if(C.gv.getFaceVisible(C.data,a)){var d=ei(C,a);d.mat&&(C.faceMat=!0);var A=d.uv;if(A){var n=C._cubeUvs;n||(n=C._cubeUvs=new Wp([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var m=0;8>m;m++)n[O+m]=A[m]}return d}},_80o:function(i,S,K){var G=this;if(G._rectOverlapping)return!0;var N=G.gv,d=G.data,k=N._cube,q=G.shapeModel;Mm(N,G.mat),q?di(N,d,q,G,G.getBodyColor(),K):(js(i,k.vs,Z,S.aPosition),js(i,k.ns,Z,S.aNormal),vd(i,k.is),G._18O(i,S,G.left,0,K),G._18O(i,S,G.front,6,K),G._18O(i,S,G.right,12,K),G._18O(i,S,G.back,18,K),G._18O(i,S,G.top,24,K),G._18O(i,S,G.bottom,30,K)),Go(N),G.faceMat&&(G._18O(i,S,G.left,0,K,!0),G._18O(i,S,G.front,6,K,!0),G._18O(i,S,G.right,12,K,!0),G._18O(i,S,G.back,18,K,!0),G._18O(i,S,G.top,24,K,!0),G._18O(i,S,G.bottom,30,K,!0))},_18O:function(u,p,M,o,U,W){if(M){if(!U(M.transparent))return;if(W&&!M.mat||!W&&M.mat)return;var z=this.data.s("polygonOffset");z&&Vd(u,z),W&&Mm(this.gv,M.mat);var H=this,a=H.data;a._currentCubeElementId=o;var F=H.gv,y=F.getTexture(M.texture,a),i=M.uv,L=M.uvScale,l=M.uvOffset,Q=M.discardSelectable;y?i?tj(u,p,y,Q,F._buffer.uv,H._cubeUvs,l,L):tj(u,p,y,Q,F._cube.uv,Z,l,L):tj(u),pq(u,p,M.blend,M.light,M.opacity,M.reverseFlip,M.reverseColor,M.reverseCull),rf(u,p.uDiffuse,M.color||S["color.empty"]),Dc(u,o,6),Tk(u,p),Ze(u,p,y),W&&Go(F),z&&Zk(u),a._currentCubeElementId=null}}});var Wl=function(I,C){up(Wl,this,[I,C])};_p(Wl,lh,{_25Q:1,validate:function(I){var $=this,V=$.gv,f=$.data,D=$.s,E=D("edge.width"),J=f._40I,_=f._41I;if($.shapeModel=$.info=Z,J&&_){var m,B,A,W,H,O,g,b,x,t,T=f.isLooped(),s=D(qq),P=M.getEdgeType(s);if(P){var R=P(f,Bs($,V,f,T,s),V,$._19Q);if(!R.points||R.points.isEmpty())return;O=$.info={},g=R.segments,H=R.points,b=H.size();for(var S=J.getElevation(),N=_.getElevation(),c=0;b>c;c++){var q=H.get(c);q.e==Z&&(q.e=S+(N-S)*c/(b-1))}x=Cs(H.get(0)),t=Cs(H.get(b-1));var i=b%2;0===i?(O.c1=Cs(H.get(b/2-1)),O.c2=Cs(H.get(b/2))):O.p3=Cs(H.get((b-i)/2)),O.s1=x,O.s2=Cs(H.get(1)),O.t1=Cs(H.get(b-2)),O.t2=t}else{H=new $p,O=$.info={};var o=D("edge.offset"),h=D("edge.center"),e=D("edge.source.t3"),l=D("edge.target.t3"),v=J.p3(),K=_.p3();if(e&&(v[0]+=e[0],v[1]+=e[1],v[2]+=e[2]),l&&(K[0]+=l[0],K[1]+=l[1],K[2]+=l[2]),s===li){g=D("edge.segments");var y=O.points=D(wp)||kh;if(b=y.size()){x=Cs(y.get(0)),t=Cs(y.get(b-1)),!h&&o&&(A=xo(x,v,!0),o=z(o,Qn(v,x)),v=[v[0]+A[0]*o,v[1]+A[1]*o,v[2]+A[2]*o],A=xo(K,t,!0),o=z(o,Qn(t,K)),K=[K[0]-A[0]*o,K[1]-A[1]*o,K[2]-A[2]*o]);var i=b%2;0===i?(m=Cs(y.get(b/2-1)),B=Cs(y.get(b/2))):O.p3=Cs(y.get((b-i)/2)),O.s1=v,O.s2=x,O.t1=t,O.t2=K}else!h&&o&&(A=xo(K,v,!0),W=Qn(v,K),o=se(o,W),v=[v[0]+A[0]*o,v[1]+A[1]*o,v[2]+A[2]*o],K=[K[0]-A[0]*o,K[1]-A[1]*o,K[2]-A[2]*o]),m=v,B=K;H.add({x:v[0],y:v[2],e:v[1]}),H.addAll(y),H.add({x:K[0],y:K[2],e:K[1]})}else{var u=Bs($,V,f,T,s);if($._19Q||(u=-u),T){var Y=v[0],w=v[1],j=v[2],L=J.getTall()/2+u;m=[Y-u,w+L,j],B=[Y+u,w+L,j],H.add({x:Y-u,y:j,e:w}),H.add({x:Y-u,y:j,e:w+L}),H.add({x:Y+u,y:j,e:w+L}),H.add({x:Y+u,y:j,e:w})}else{A=xo(K,v,!0),W=Qn(v,K);var n={x:v[0],y:v[2]},U={x:K[0],y:K[2]},Q=Qd(Z,n,U,u),r=Q.x-n.x,F=Q.y-n.y;o=se(o,W),A[0]*=o,A[1]*=o,A[2]*=o,m=[v[0]+A[0]+r,v[1]+A[1],v[2]+A[2]+F],B=[K[0]-A[0]+r,K[1]-A[1],K[2]-A[2]+F],h?(H.add({x:v[0],y:v[2],e:v[1]}),H.add({x:m[0],y:m[2],e:m[1]}),H.add({x:B[0],y:B[2],e:B[1]}),H.add({x:K[0],y:K[2],e:K[1]})):(H.add({x:m[0],y:m[2],e:m[1]}),H.add({x:B[0],y:B[2],e:B[1]}))}}O.c1=m,O.c2=B}O.list=D(yg)===kp?$.createTubeModel(H,g,E/2,I):$.createLineModel(H,g,E,"edge","edge.dash")}}});var Bj=function(W,p){up(Bj,this,[W,p])};_p(Bj,vj,{_80o:function(D,c,$){var S=this,V=S.gv,M=S.shapeModel;Mm(V,S.mat),M?di(V,S.data,M,S,S.getBodyColor(),$):(os(S,D,c,S.left,$),os(S,D,c,S.front,$),os(S,D,c,S.right,$),os(S,D,c,S.back,$),os(S,D,c,S.top,$),os(S,D,c,S.bottom,$)),Go(V)},validate:function(t,s){var E,w,o=this,A=o.s,Q=o.data,S=Q.p3(),B=Q._thickness/2,L=Q.isClosePath(),X=Q.getPoints(),J=Q.getSegments(),K=A(Fb),k=t&&t.uv;if(o.clear(),0>B)w=o.shapeModel=ko(X,J,A(Wq),A(Bg),K,A(Bf),Q.getTall(),Q.getShapeElevation(),L),A(ee)?A("shape3d.image")||delete w.uv:(delete w.vs,delete w.ns,delete w.uv),A("shape3d.top.image")||delete w.top_uv,A("shape3d.bottom.image")||delete w.bottom_uv;else if(A(yg)===kp)E=Ch(X,J,K,L),w=o.shapeModel={vs:[]},A("shape3d.image")&&(w.uv=[],w.sum=A(Bf)||qh(E)||1,w.len=0),A(Wq)&&!L&&(w.top_vs=[],A("shape3d.top.image")&&(w.top_uv=[])),A(Bg)&&!L&&(w.bottom_vs=[],A("shape3d.bottom.image")&&(w.bottom_uv=[])),o._12O(E,B);else{var D,H,z,p,q,y,r,N,G,U;if(E=Ch(X,J,K,L),q=o.vf(Nm,k,!1,s),B&&(y=o.vf(Fd,k,!1,s),r=L?Z:o.vf(Wf,k,!1,s),N=L?Z:o.vf(qb,k,!1,s),G=o.vf(uc,k,!1,s),U=o.vf(Ul,k,!1,s)),B){for(var g=0,M=E.length;M>g;g++)E[g]=o._tryRemoveBezierPoints(E[g],B);o._12O(E,B)}else q&&E.forEach(function(P){if(p=P.length,p>0)for(D=P[0],z=1;p>z;z++)H=P[z],o.addV(q.vs,D,H),D=H});o._20Q(E),t||(q&&(q.ns=Gc(q.vs),bo(q,"vs"),bo(q,Uq)),B&&(y&&(y.ns=Gc(y.vs),bo(y,"vs"),bo(y,Uq)),r&&(r.ns=Gc(r.vs),bo(r,"vs"),bo(r,Uq)),N&&(N.ns=Gc(N.vs),bo(N,"vs"),bo(N,Uq)),G&&(G.ns=Gc(G.vs),bo(G,"vs"),bo(G,Uq)),U&&(U.ns=Gc(U.vs),bo(U,"vs"),bo(U,Uq))))}var h=o.mat=Zg();Ql(h,S),Dh(h,Q.getFinalRotation3d(),Q.getRotationMode());var b=Q.getScale3d(),O=Q._dynamicScale3d;O&&(b[0]*=O[0],b[1]*=O[1],b[2]*=O[2]),vb(h,b),Ql(h,As(S)),t&&(Rm(o,h,t,w),o.clear())},_20Q:function(D){var n,A,C,z,f,H,U,d=this,t=d.front,m=d.back,c=d.top,$=d.bottom,x=t?t.tuv:Z,N=m?m.tuv:Z,o=c?c.tuv:Z,R=$?$.tuv:Z,F=0;(x||N||o||R)&&(n=d.s(Bf)||qh(D)||1,D.forEach(function(K){if(A=K.length,A>0)for(H=K[0],C=1;A>C;C++)U=K[C],z=F/n,F+=Qn(H,U),f=F/n,d._14O(t,z,f),d._14O(m,1-f,1-z),d._14O(c,z,f),d._14O($,z,f),H=U}))},_14O:function(w,q,R){if(w){var x=w.uv,P=w.tuv;if(P){if(x)var Q=x[0]+(x[6]-x[0])*q,o=x[1]+(x[7]-x[1])*q,V=x[2]+(x[4]-x[2])*q,M=x[3]+(x[5]-x[3])*q,Y=x[2]+(x[4]-x[2])*R,D=x[3]+(x[5]-x[3])*R,z=x[0]+(x[6]-x[0])*R,p=x[1]+(x[7]-x[1])*R;else Q=q,o=0,V=q,M=1,Y=R,D=1,z=R,p=0;P.push(V,M,Y,D,z,p,z,p,Q,o,V,M)}}},_13O:function(B){var b=B.uv,c=B.tuv;c&&(b?c.push(b[2],b[3],b[4],b[5],b[6],b[7],b[6],b[7],b[0],b[1],b[2],b[3]):c.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(E,J){var S=E.length;if(4>S)return E;var q,V,b,X,I,$,W=!1,j=function($){return E[$]},C=function(I){return E[S-1-I]};for(I=0;1>=I;I++)for($=I?C:j,V=$(0),b=$(1),q=2;S-1>q;q++)if(X=$(q),!X.remove)if(X.b){var L=Qd(V,b,X,J);L.adjust?(X.remove=!0,W=!0):(V=b,b=X)}else V=b,b=X;if(!W)return E;var K=[];for(q=0;S>q;q++)E[q].remove||K.push(E[q]);return K},_12O:function(I,N){var i,C,h,g,o,y=this;I.forEach(function(W){if(o=W.length,o>0)for(i={p:W[0],n:!0},g=1;o>g;g++)C=W[g],h=o-1>g?W[g+1]:Z,y.addPoint(i,C,h,N,W)})},addPoint:function(e,M,u,X,t){var w,o,l,j,k,K,c,b,F,U=this,Y=e.p,R=e.f,s=e.b,m=U.s("shape3d.side")||Ho,x=U.s("shape3d.start.angle"),P=U.s("shape3d.sweep.angle"),C=U.shapeModel,N=U.data.isClosePath();if(e.n&&(e.n=!1,R=N&&t.length>2?Qd(t[t.length-2],Y,M,X):Qd(Z,Y,M,X),s=ql(Y,R),C?C.top_vs&&U._10O(s,R,m,x,P,C.top_vs,C.top_uv):(w=U.left)&&(U.addV(w.vs,s,R),U._13O(w))),o=u?Qd(Y,M,u,X):N&&t.length>2?Qd(Y,M,t[1],X):Qd(Y,M,Z,X),l=ql(M,o),C){var $,v,r=C.vs,E=C.uv,I=C.sum;for(E&&($=C.len/I,C.len+=Qn(Y,M),v=C.len/I),K=U._9O(s,R,m,x,P),c=U._9O(l,o,m,x,P),b=0;m>b;b++)F=b+1,mf(r,K[F]),mf(r,c[b]),mf(r,K[b]),mf(r,c[b]),mf(r,K[F]),mf(r,c[F]),E&&(j=b/m,k=F/m,E.push($,k,v,j,$,j,v,j,$,k,v,k));!u&&C.bottom_vs&&U._10O(l,o,m,x,P,C.bottom_vs,C.bottom_uv,!0)}else!u&&(w=U.right)&&(U.addV(w.vs,o,l),U._13O(w)),(w=U.front)&&U.addV(w.vs,R,o),(w=U.back)&&U.addV(w.vs,l,s),(w=U.top)&&U.addH(w.vs,R,o,l,s,!0),(w=U.bottom)&&U.addH(w.vs,s,l,o,R);e.p=M,e.f=o,e.b=l},_10O:function(E,Y,H,K,q,B,W,Z){var F,m,d=this,$=d.data,i=d._9O(E,Y,H,K,q),X=(E.x+Y.x)/2,Q=(E.y+Y.y)/2,h=$.getShapeElevation(),C=0;for(C=0;H>C;C++)Z?(mf(B,i[C]),mf(B,i[C+1])):(mf(B,i[C+1]),mf(B,i[C])),mf(B,[X,h,Q]),W&&(Z?(F=G*(C+1)/H+K,m=G*C/H+K):(F=G*C/H+K,m=G*(C+1)/H+K),W.push(.5-.5*y(m),.5-.5*J(m),.5-.5*y(F),.5-.5*J(F),.5,.5))},_9O:function(n,o,Q,c,f){var V,A,B=this,R=B.data,K=[],k=(n.x+o.x)/2,t=(n.y+o.y)/2,Z=R.getTall()/2,u=R.getShapeElevation(),L=0;for(f=f||G;Q>=L;L++)V=f*L/Q+c,A=y(V),K.push([k+(n.x-k)*A,u+Z*J(V),t+(n.y-t)*A]);return K},addV:function(n,J,i){var w=J.x,u=J.y,a=i.x,F=i.y,z=this.data,E=z.getShapeElevation(),Z=z.getTall()/2;n.push(w,E-Z,u,a,E-Z,F,a,E+Z,F,a,E+Z,F,w,E+Z,u,w,E-Z,u)},addH:function(B,r,b,t,F,f){var V=this.data,y=V.getTall()/2,l=V.getShapeElevation()+(f?y:-y);B.push(r.x,l,r.y,b.x,l,b.y,t.x,l,t.y,t.x,l,t.y,F.x,l,F.y,r.x,l,r.y)},vf:function(B,n,U,v){var E,_=this,u=_.gv.getFaceVisible(_.data,B);return(U||u)&&(E=ei(_,B,v),E.vs=[],E.tuv=u&&(E.texture||n)?[]:Z,E.visible=u),E}});var Vf=function(W,b){up(Vf,this,[W,b])};_p(Vf,lh,{_25Q:1,validate:function(w){var e=this,A=e.data,b=e.s,o=A.getPoints(),a=o.size();if(e.shapeModel=e.info=Z,a>1){var K=e.info={},W=A.getSegments(),d=A.getThickness(),n=Cs(o.get(0)),i=Cs(o.get(a-1)),J=a%2;0===J?(K.c1=Cs(o.get(a/2-1)),K.c2=Cs(o.get(a/2))):K.p3=Cs(o.get((a-J)/2)),K.s1=n,K.s2=Cs(o.get(1)),K.t1=Cs(o.get(a-2)),K.t2=i,K.list=b(yg)===kp?e.createTubeModel(o,W,d/2,w):e.createLineModel(o,W,d,"shape.border","shape.dash")}var G=A.p3(),m=e.mat=Zg();Ql(m,G),Dh(m,A.getFinalRotation3d(),A.getRotationMode());var R=A.getScale3d(),c=A._dynamicScale3d;c&&(R[0]*=c[0],R[1]*=c[1],R[2]*=c[2]),vb(m,R),Ql(m,As(G))},_80o:function(y,R,V){var Q=this,a=Q.shapeModel;if(a){var W=Q.gv;Mm(W,Q.mat),di(W,Q.data,a,Q,Q.getBodyColor(),V),Go(W)}}});var Ef=k.graph3d.VR=function(d){var l=this;l.gv=d,l._controllers=[],l.switch=new $n(l),l._enable=!1,l._defaultCallLater=k.Default.callLater,l._defaultCancelLater=nj,"undefined"!=typeof x&&"VRFrameData"in x&&(l._frameData=new x.VRFrameData),l.measureOflength=1,l.eyesOffset=[0,0,0],l._orientation=new k.Math.Quaternion,l._lastHeadPose=[0,0,0],l._offsetToBeAdd=[0,0,0],l._fpsInfo={time:0,fps:0,frames:0}};_p(Ef,C,{ms_fire:!0,_42:function(e,Y,P,f){var W=this,u=W.gv;if(!u.drawFilter&&W._deviceInAction){var o=W._device;if(o){var $=W._measureOflength;o.depthNear=u.getNear()*$,o.depthFar=u.getFar()*$;var E=W._offsetToBeAdd;if(W.eyesOffset[0]+=E[0],W.eyesOffset[1]+=E[1],W.eyesOffset[2]+=E[2],E[0]=0,E[1]=0,E[2]=0,o.isPresenting===!1)return W._controllers.forEach(function(J){J&&J.update()}),u.iv(),!1;var d=W._frameData;o.getFrameData(d);var n=d.pose.position;if(n){var I=W.toViewPosition(n);u.setEye(I),W._orientation.fromArray(d.pose.orientation);var X=new k.Math.Vector3(0,0,-10*W._scaleFactor);X.applyQuaternion(W._orientation),u.setCenter([I[0]+X.x,I[1]+X.y,I[2]+X.z])}W._controllers.forEach(function(E){E&&E.update()}),u.setViewport(e,0,0,Y/2,P),W._viewMatrix=W._copyViewMatrix(d.leftViewMatrix),W._projectMatrix=W._copyProjectMatrix(d.leftProjectionMatrix),f(),u.setViewport(e,Y/2,0,Y/2,P),W._viewMatrix=W._copyViewMatrix(d.rightViewMatrix),W._projectMatrix=W._copyProjectMatrix(d.rightProjectionMatrix),f(),W._lastViewMatrix=W._viewMatrix,W._lastProjectMatrix=W._projectMatrix,W._viewMatrix=null,W._projectMatrix=null,W.submitFrame();var F=Date.now(),R=W._fpsInfo;return F-R.time>1e3?(R.fps=Math.round(1e3*(R.frames+1)/(F-R.time)),R.time=F,R.frames=0):R.frames++,!0}}},onVRDisplayPresentChange:function(){var a=this.isPresenting();this._injectGraphView(a),this.fp("present",!a,a)},getOrientation:function(){return this._orientation},addController:function($){$=$||0;var D=this,K=D.getController($);return K?K:(K=new oc(D,$),D._controllers.push(K),K)},getController:function(F){F=F||0;for(var C=this._controllers,l=0,I=C.length;I>l;l++)if(C[l]&&C[l].id===F)return C[l];return null},removeController:function(F){F=F||0;for(var S=this._controllers,s=0,e=S.length;e>s;s++)if(S[s]&&S[s].id===F)return S.splice(s,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(V,n){var t=this,L=t._scaleFactor,I=t._eyesOffset,k=t._lastHeadPose;return k[0]=V[0]*L,k[1]=V[1]*L,k[2]=V[2]*L,n?(n[0]=k[0]+I[0],n[1]=k[1]+I[1],n[2]=k[2]+I[2],n):[k[0]+I[0],k[1]+I[1],k[2]+I[2]]},addEyesOffset:function(W,U,Z){var P=this._offsetToBeAdd;P[0]+=W,P[1]+=U,P[2]+=Z},_copyViewMatrix:function(K){var z=this.dup(K),g=this._scaleFactor;z[12]*=g,z[13]*=g,z[14]*=g;var j=this._eyesOffset;if(j&&(j[0]||j[1]||j[2])){var h=j[0],s=j[1],H=j[2];z[12]-=z[0]*h+z[4]*s+z[8]*H,z[13]-=z[1]*h+z[5]*s+z[9]*H,z[14]-=z[2]*h+z[6]*s+z[10]*H}return z},shutdown:function(){var Q=this._device;Q&&Q.isPresenting&&Q.exitPresent()},isPresenting:function(){var c=this._device;return c&&c.isPresenting},_copyProjectMatrix:function(D){var M=this.dup(D),p=this._scaleFactor;return M[14]*=p,M},dup:function(z,k){for(var n=z.length,m=k||new Array(n);n--;)m[n]=z[n];return m},getViewMatrix:function(Z){var j=this._viewMatrix;return j?this.dup(j,Z):void 0},getProjectMatrix:function(){var m=this._projectMatrix;return m?this.dup(m):void 0},submitFrame:function(){var l=this;if(l._enable&&l._deviceInAction){var t=l._device;t&&t.isPresenting&&(t.submitFrame(),l.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(I){var G=this.gv;return G.intersectObjects(I,G.dm().getDatas())},setDevice:function(b){var c=this;c._device=b},_injectGraphView:function(){var h,I,k;return function(f){var X=this.gv;if(!f)return h&&(X.getWidth=h,X.getHeight=I,X.getDevicePixelRatio=k),void 0;var o=this._device,_=o.getEyeParameters("left"),t=_.renderWidth,S=_.renderHeight;h=X.getWidth,I=X.getHeight,k=X.getDevicePixelRatio,X.getWidth=function(){return 2*t},X.getHeight=function(){return S},X.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(E){var u=this;if(!E)return zj=k.Default.callLater=u._defaultCallLater,nj=k.Default.cancelLater=u._defaultCancelLater,void 0;var u=this;zj=k.Default.callLater=function(N,E,e,s){var A=u._device;return A&&A.isPresenting?s?H(function(){zj(N,E,e)},s):A.requestAnimationFrame(function(){u._deviceInAction=!0,N.apply(E,e),u._deviceInAction=!1}):u._defaultCallLater(N,E,e,s)},nj=k.Default.cancelLater=function(p,w){var U=u._device;return U&&U.isPresenting?w?W(p):U.cancelAnimationFrame(p):u._defaultCancelLater(p,w)}}}),C.defineProperties(Ef.prototype,{enable:{get:function(){return this._enable},set:function(Q){var C=this;C._enable!==Q&&(C._enable=Q,Q?(C.switch.showButton(),C._injectCallLaterFunc(!0)):(C.shutdown(),C.switch.hideButton(),C._injectCallLaterFunc(!1)),C.fp("enable",!Q,Q))}},measureOflength:{get:function(){return this._measureOflength},set:function(Z){this._measureOflength=Z;var Q=this._scaleFactor=1/Z;this._controllers.forEach(function(y){y&&y._setScaleFactor(Q)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(b){this._eyesOffset=b}},controllerModel:{get:function(){return this._controllerModel},set:function(l){var p;"object"==typeof l?(p=l.mtl,l=l.obj):(p=l+".mtl",l+=".obj");var d=this,c=d._controllerModel;c&&c.obj===l&&c.mtl===p||(c=d._controllerModel={obj:l,mtl:p},M.loadObj(l,p,{finishFunc:function(P,r){d._controllerModel===c&&M.setShape3dModel("vrControllerModel",r)}}))}},interactive:{get:function(){return!!this._interactive},set:function(g){!!g!=!!this._interactive&&(this._interactive=g,g&&this.addController(0),this.gv.getCoreInteractor().enableVR(g))}}});var oc=function(i,Y){function F(l){var J=navigator.getGamepads&&navigator.getGamepads();if(J)for(var K=0,o=0,T=J.length;T>K;K++){var $=J[K];if($){var E=$.id;if("OpenVR Gamepad"===E||"OpenVR Controller"===E||0===E.indexOf("Oculus Touch")||0===E.indexOf("Spatial Controller")){if(o===l)return $;o++}}}}function U(x,E,k){return Math.abs(x[0]-E[0])<k&&Math.abs(x[1]-E[1])<k&&Math.abs(x[2]-E[2])<k?!0:!1}var X=this;X.vr=i,X.id=Y;var J,x,s=[0,0],O=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],j=new Vq;j.s("shape3d","vrControllerModel"),j.isController=!0,j.s("intersect",!1),X.getGamepad=function(){return x},X.isButtonPressed=function(C){for(var J,W=0,w=O.length;w>W;W++)if(J=O[W],J.id===C)return J.pressed;return!1},X.getNode=function(){return j};var D=.003;X.setRotationEpsilon=function(S){D=S};var y=5e-4,e=y;X.setPositionEpsilon=function(J){y=J,e=J*X.vr._scaleFactor},X._setScaleFactor=function(E){j.s3(E,E,E),e=y*E},X._setScaleFactor(X.vr._scaleFactor);var z,l=new kc,C=new Ln,v=[0,0,0],k=[0,0,0],t=new Sh,d=new Lp,h=new Rq;X.getRay=function(){return z?(h.origin.fromArray(v),h.direction.copy(d),z=!1,h):h},X.update=function(){if(J=x,x=F(Y),J!=x&&console.log("gamepad changed",x),!x||x.pose===K)return x=null,j.s("3d.visible",!1),void 0;if(M.getShape3dModel("vrControllerModel")){j.dm()||i.gv.dm().add(j),j.s("3d.visible",!0);var A=x.pose;if(null!==A){A.position&&(X.vr.toViewPosition(A.position,v),U(j.p3(),v,e)||(z=!0,j.p3(v))),A.orientation&&(l.fromArray(A.orientation),d.set(0,0,-1).applyQuaternion(l).normalize(),C.makeRotationFromQuaternion(l),t.set(0,0,0,j.getRotationMode(),!0).setFromRotationMatrix(C),k[0]=t.x,k[1]=t.y,k[2]=t.z,U(j.r3(),k,D)||(z=!0,j.r3(k))),z&&i.fp("gamepad.pose",null,{position:v,rotation:k,id:Y});var P=x.axes;(s[0]!==P[0]||s[1]!==P[1])&&(s=[P[0],P[1]],i.fp("gamepad.axes",null,{id:Y,axes:s}));var Q,c,S,f,N=x.buttons;for(Q=0,c=N.length;c>Q;Q++)if(S=N[Q],f=S.pressed,f!==O[Q].pressed){O[Q].pressed=f;var I={id:Y},h="state";I[h]=I._62O=f?"down":"up",i.fp("gamepad.button."+O[Q].id,null,I)}}}}},$n=function(f){this.vr=f,this._button=null};_p($n,C,{showButton:function(){var r=this.assureButton();if(!r.parentNode){var q=this.vr.gv,t=q.getView();q._79O?t.insertBefore(r,q._79O):t.appendChild(r)}},hideButton:function(){var V=this._button;V&&V.parentNode&&V.parentNode.removeChild(V)},assureButton:function(){var H=this._button;return H?H:this._button=this.createButton(this.vr.gv)},createButton:function(s){function Q(v,Y){v.textContent=Y&&Y.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function J(y){h.style.display="",h.style.cursor="pointer",h.style.left="calc(50% - 50px)",h.style.width="100px",Q(h,y),h.onmouseenter=function(){h.style.opacity="1.0"},h.onmouseleave=function(){h.style.opacity="0.5"},h.onclick=function(){y.isPresenting?y.exitPresent():y.requestPresent([{source:s.getCanvas()}])},s.vr.setDevice(y)}function n(){h.style.display="",h.style.cursor="auto",h.style.left="calc(50% - 75px)",h.style.width="150px",Q(h,null),h.onmouseenter=null,h.onmouseleave=null,h.onclick=null,s.vr.setDevice(null)}function N($){$.style.position="absolute",$.style.bottom="20px",$.style.padding="12px 6px",$.style.border="1px solid #fff",$.style.borderRadius="4px",$.style.color="#000",$.style.font="normal 13px sans-serif",$.style.textAlign="center",$.style.opacity="0.5",$.style.outline="none",$.style.zIndex="999"}if("getVRDisplays"in navigator){var h=this._button=D.createElement("button");return h.style.display="none",N(h),x.addEventListener("vrdisplayconnect",function(i){J(i.display)},R),x.addEventListener("vrdisplaydisconnect",function(){n()},R),x.addEventListener("vrdisplaypresentchange",function(A){Q(h,A.display),s.vr.onVRDisplayPresentChange()},R),navigator.getVRDisplays().then(function(w){w.length>0?J(w[0]):n()}),h}var M=D.createElement("a");return M.href="https://webvr.info",M.innerHTML="当前不支持 webvr",M.style.left="calc(50% - 90px)",M.style.width="180px",M.style.textDecoration="none",N(M),M}}),C.defineProperties($n.prototype,{});var $k=k.graph3d.PostProcessing=function(m){function W(){if(!s){var d=m.getGL();s=new xb.RenderTarget(m,d),k=new Ph.Shader(d,R.vs,R.fs),B=Ph.Buffer.createIndexBuffer(d,new Uint16Array([0,2,1,1,2,3])),D=Ph.Buffer.createVertexBuffer(d,new Float32Array([0,0,1,0,0,1,1,1]))}}var s,k,B,D,x=this,S={},Z=!1;!function(){C.keys($k).forEach(function(D){S[D]=new $k[D](m)})}(),x.getModule=function(x){return x?S[x]:S},x.getModuleList=function(){return C.keys(S)},x.handleDataModleChange=function(H,g){H&&(H.setPostProcessingData(x.serialize()),H.removeSerializeListener(x.onDataModelSerialize,x)),g&&(g.addSerializeListener(x.onDataModelSerialize,x),x.deserialize(g.getPostProcessingData()))},x.onDataModelSerialize=function(Z){"serialize"===Z.type?m.dm()._postProcessingData=x.serialize():"deserialize"===Z.type&&x.deserialize(m.dm().getPostProcessingData())},x.serialize=function(){var W,J,_,u={};for(W in S)J=S[W],u[W]={enable:J.enable},_=J.serializeProperties,_&&_.forEach(function(H){u[W][H]=J[H]});return u},x.deserialize=function(y){if(y){var F,N,Y,H;for(F in y)if(N=S[F]){Y=y[F],x.enableModule(F,Y.enable);for(H in Y)"enable"!==H&&(N[H]=Y[H])}}else{var F,N;for(F in S)N=S[F],N.enable=!1,N.resetProperties&&N.resetProperties()}},x.enableModule=function(C,w){var k,G,b,d=C.split(",");for(k=0,G=d.length;G>k;k++)b=d[k].trim(),S[b]&&(S[b].enable=w);Z=!1;for(b in S)if(S[b].enable){Z=!0;break}Z&&W()};var R={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};x._42=function(o,d,r,W,u){if(Z&&!u){s.setSize(o,d,r),Oj(o,s.frame),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),m.setViewport(o,0,0,d,r),W();var V,w=s;for(V in S)w=S[V]._42(o,w)||w;return nr(o),m.setViewport(o,0,0,d,r),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),k.bind(),o.activeTexture(o.TEXTURE0+0),o.bindTexture(o.TEXTURE_2D,w.texture),k.uniforms.image=0,B.upload(),D.upload(),k.attributes.pos.pointer(D),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0),o.bindTexture(o.TEXTURE_2D,null),o.useProgram(m._prg),!0}}},Pj=k.graph3d.PostProcessing.Bloom=function(r){function z(){var o=r.getWidth(),n=r.getHeight();if(o&&n){V=[o,n],f=!0;var p,L=r.getGL(),v=Math.round(V[0]/2),k=Math.round(V[1]/2);for(e=new xb.RenderTarget(r,L,v,k),p=0;t>p;p++)$.push(new xb.RenderTarget(r,L,v,k)),T.push(new xb.RenderTarget(r,L,v,k)),v=Math.round(v/2),k=Math.round(k/2);
x=new Ph.Shader(L,Pj.highPassShader.vs,Pj.highPassShader.fs);for(var p=0;t>p;p++)d[p]=new Ph.Shader(L,Pj.blurShader.vs,Pj.blurShader.fs.replace(/DEFINE_VALUE/g,Q[p]));i=new Ph.Shader(L,Pj.compositeShader.vs,Pj.compositeShader.fs.replace(/NUM_MIPS/g,t)),J=new Ph.Shader(L,Pj.finalShader.vs,Pj.finalShader.fs),D=Ph.Buffer.createIndexBuffer(L,new Uint16Array([0,2,1,1,2,3])),s=Ph.Buffer.createVertexBuffer(L,new Float32Array([0,0,1,0,0,1,1,1]))}}var P,o,j,D,s,N=this,R=!1,f=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){P=1.5,o=.55,j=.4},C.defineProperties(N,{enable:{get:function(){return R},set:function(P){!!R!=!!P&&(R=P,P&&!f&&z())}},strength:{get:function(){return P},set:function(c){P=c}},threshold:{get:function(){return o},set:function(G){o=G}},radius:{get:function(){return j},set:function(L){j=L}}}),this.resetProperties();var e,x,i,J,V=[256,256],$=[],T=[],t=5,Q=[3,5,7,9,11],d=[];N._42=function(H,g){function S(V,y,t,x){Oj(H,y.frame),r.setViewport(H,0,0,y.width,y.height),x?x(H):H.clear(H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT),L!==V&&V.bind();var g=0;for(var Y in t){var X=t[Y];X instanceof WebGLTexture&&(H.activeTexture(H.TEXTURE0+g),H.bindTexture(H.TEXTURE_2D,X),X=g,g++),V.uniforms[Y]=X}for(L!==V&&(D.upload(),s.upload(),V.attributes.pos.pointer(s),L=V),H.drawElements(H.TRIANGLES,6,H.UNSIGNED_SHORT,0);g--;)H.activeTexture(H.TEXTURE0+g),H.bindTexture(H.TEXTURE_2D,null);nr(H)}if(R){f||z();var L;S(x,e,{smoothWidth:.01,luminosityThreshold:o,tDiffuse:g.texture});var W,M=e,G=Math.round(V[0]/2),q=Math.round(V[1]/2);for(W=0;t>W;W++)S(d[W],$[W],{colorTexture:M.texture,direction:[1,0],texSize:[G,q]}),S(d[W],T[W],{colorTexture:$[W].texture,direction:[0,1],texSize:[G,q]}),G=Math.round(G/2),q=Math.round(q/2),M=T[W];return S(i,$[0],{blurTexture1:T[0].texture,blurTexture2:T[1].texture,blurTexture3:T[2].texture,blurTexture4:T[3].texture,blurTexture5:T[4].texture,bloomStrength:P,bloomRadius:j,bloomTintColor:[1,1,1]}),S(J,g,{image:$[0].texture},function(R){R.enable(R.BLEND),R.blendEquation(R.FUNC_ADD),R.blendFunc(R.SRC_ALPHA,R.ONE)}),H.blendEquationSeparate(H.FUNC_ADD,H.FUNC_ADD),H.blendFuncSeparate(H.SRC_ALPHA,H.ONE_MINUS_SRC_ALPHA,H.ONE,H.ONE_MINUS_SRC_ALPHA),g}}};Pj.highPassShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D tDiffuse;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4(0.0, 0.0, 0.0, 0.0);","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},Pj.blurShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D colorTexture;","uniform vec2 texSize;","uniform vec2 direction;","#define KERNEL_RADIUS DEFINE_VALUE","#define SIGMA DEFINE_VALUE","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float fSigma = float(SIGMA);","float weightSum = gaussianPdf(0.0, fSigma);","vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;","for( int i = 1; i < KERNEL_RADIUS; i ++ ) {","float x = float(i);","float w = gaussianPdf(x, fSigma);","vec2 uvOffset = direction * invSize * x;","vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;","vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;","diffuseSum += (sample1 + sample2) * w;","weightSum += 2.0 * w;","}","gl_FragColor = vec4(diffuseSum/weightSum, 1.0);","}"].join("\n")},Pj.compositeShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D blurTexture1;","uniform sampler2D blurTexture2;","uniform sampler2D blurTexture3;","uniform sampler2D blurTexture4;","uniform sampler2D blurTexture5;","uniform sampler2D dirtTexture;","uniform float bloomStrength;","uniform float bloomRadius;","uniform vec3 bloomTintColor;","float lerpBloomFactor(const in float factor) {","float mirrorFactor = 1.2 - factor;","return mix(factor, mirrorFactor, bloomRadius);","}","void main() {","gl_FragColor = bloomStrength * ( lerpBloomFactor(1.0) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture1, vUv) + ","lerpBloomFactor(0.8) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture2, vUv) + ","lerpBloomFactor(0.6) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture3, vUv) + ","lerpBloomFactor(0.4) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture4, vUv) + ","lerpBloomFactor(0.2) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture5, vUv) );","}"].join("\n")},Pj.finalShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")},Bm(M,{accordionViewExpandIcon:ms(Qj),accordionViewCollapseIcon:ms(Qj,!0),accordionViewLabelColor:xh,accordionViewLabelFont:Hp,accordionViewTitleBackground:ri,accordionViewSelectBackground:_d,accordionViewSelectWidth:3,accordionViewSeparatorColor:K,splitViewDividerSize:1,splitViewDividerBackground:ri,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:bd,rect:[2,2,12,12],background:Qj}]},propertyViewLabelColor:op,propertyViewLabelSelectColor:xh,propertyViewLabelFont:Hp,propertyViewExpandIcon:ms(dh),propertyViewCollapseIcon:ms(dh,!0),propertyViewBackground:vg,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:ub,propertyViewColumnLineColor:ub,propertyViewSelectBackground:_d,listViewLabelColor:op,listViewLabelSelectColor:xh,listViewLabelFont:Hp,listViewRowLineVisible:!1,listViewRowLineColor:ub,listViewSelectBackground:_d,treeViewLabelColor:op,treeViewLabelSelectColor:xh,treeViewLabelFont:Hp,treeViewExpandIcon:ms(gs),treeViewCollapseIcon:ms(gs,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:ub,treeViewSelectBackground:_d,treeViewDoubleClickToToggle:!0,tableViewLabelColor:op,tableViewLabelSelectColor:xh,tableViewLabelFont:Hp,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:ub,tableViewColumnLineColor:ub,tableViewSelectBackground:_d,treeTableViewLabelColor:op,treeTableViewLabelSelectColor:xh,treeTableViewLabelFont:Hp,treeTableViewExpandIcon:ms(gs),treeTableViewCollapseIcon:ms(gs,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:ub,treeTableViewColumnLineColor:ub,treeTableViewSelectBackground:_d,tableHeaderLabelColor:op,tableHeaderLabelFont:Hp,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:rd,tableHeaderBackground:vg,tableHeaderMoveBackground:yr,tableHeaderInsertColor:_d,tableHeaderSortDescIcon:vi(dh,!0),tableHeaderSortAscIcon:vi(dh),tabViewTabGap:1,tabViewLabelColor:xh,tabViewLabelFont:Hp,tabViewTabBackground:ri,tabViewSelectWidth:3,tabViewSelectBackground:_d,tabViewMoveBackground:yr,tabViewInsertColor:_d,toolbarLabelColor:op,toolbarLabelSelectColor:xh,toolbarLabelFont:Hp,toolbarBackground:vg,toolbarSelectBackground:_d,toolbarItemGap:8,toolbarSeparatorColor:ec},!0);var Fn={translateX:1,sortColumn:1},so={sortable:1,sortOrder:1,sortFunc:1},ho={focusData:1},gb={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},ip={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},si=function(a,J){J.add(a),a.hasChildren()&&a.eachChild(function(b){si(b,J)})},Do=function(j,C,x,F,r,n,o,B,q,Y,m){var s,z=x.getValueType(Y),w=x.getAlign(Y);if(x.getEnumValues(Y)){var K=x.toEnumLabel(C,Y),d=ui||0,h=0,T=n,l=M.getTextSize(F,K).width;return s=Mk(x.toEnumIcon(C,Y)),s&&(h=n+ui/2,"center"===w?h+=(B-(d+l))/2:"right"===w&&(h=h+B-(d+l)),gl(j,s,h,o+q/2,Y,m),T=h+ui/2),K!=Z&&(s?np(j,K,F,r,T,o,B-(T-n),q):np(j,K,F,r,n,o,B,q,w)),void 0}return C=x.formatValue(C),C!=Z?z===Mf?(Rf(j,n,o,B,q,C),void 0):z===en||!z&&hf(C)?(s=Mk(C?Tl:wf),gl(j,s,n+B/2,o+q/2,Y,m),void 0):(np(j,C,F,r,n,o,B,q,w),void 0):void 0},ni=function(k,p){var V=p.view,H=or(k),x=p.column||p.property;V.getDataModel().beginTransaction(),p.editor=k,k.info=p,V.setCurrentEditor(k),V.getView().insertBefore(H,V._79O),ef(k,p.editorRect),k.setFocus?k.setFocus():Hl(k),k.commitValue=function(Z,T){k._17Q&&(k=k._17Q),T||V.setValue(p.data,x,k.getValue?k.getValue():k.value),k.close&&k.close(),Xq(H)},x.onEditorCreated&&x.onEditorCreated(p)},Xe=function(x,y,X,e,G){var W=jj(x,X),a=y.value,U=y.view,z=G.getValueType(y.data);return W.onblur=W.onchange=function(){U.endEditing()},"input"===x?(a=G.formatValue(a),a!=Z&&(W.value=a),W.onkeydown=function(P){ve(P)?U.endEditing():_g(P)&&U.endEditing(!0)},(z===_i||z===hn)&&W.addEventListener(Vj,M.numberListener,R)):x===hb&&e.forEach(function(M){var B=D.createElement("option");B.innerHTML=G.toEnumLabel(M),B.value=M,G.isEnumEqual(a,M)&&(B.selected=!0),Xh(W,B)}),ni(W,y),W},dn=k.widget={},Lm=function(v,z,d){_p(o+".widget."+v,z,d)};Bm(gi,{ms_value:function(v){v.getValue=function(S){var f=this.getItemById(S),o=f.element;return Gk(o)?o:o?o.getValue?o.getValue():o.value:f.selected},v.setValue=function(u,G){var g=this.getItemById(u);if(g){var J=g.element;J&&!Gk(J)?J.setValue?J.setValue(G):J.value=G:hf(G)?(g.selected=G,this.iv()):(g.element=G,this.iv())}},v.v=function(U,k){var V=this;if(2===arguments.length)V.setValue(U,k);else{if(!Eq(U))return V.getValue(U);for(var R in U)V.setValue(R,U[R])}return V}},_46o:function(L){L._icon=Z,L._accessType=Z,L._valueType=Z,L._editable=!1,L._batchEditable=!0,L._align=Wf,L._nullable=!0,L._emptiable=!1,L.setParent=pf,L.formatValue=function(F){var E=this,X=E._valueType;return E.getEnumValues()?E.toEnumLabel(F):X===en?!!F:F!=Z&&X===_i?Q(F):F},L.setEnum=function(T,i,b,P,R,W,a){var U=this;T&&!Sp(T)&&T.values&&(P=T.editable,b=T.icons,i=T.labels,R=T.strict,W=T.maxHeight,a=T.dropDownWidth,T=T.values),ff(T)&&(T=T._as),ff(i)&&(i=i._as),ff(b)&&(b=b._as),U._enumValues=T,U._enumLabels=i,U._enumIcons=b,U._enumEditable=P,U._enumStrict=R==Z?!0:R,U._enumMaxHeight=W,U._enumDropDownWidth=a,T&&T.length&&Zi(T[0])&&(U._valueType=hn),U.fp("enum",!1,!0)},L.getEnumDropDownWidth=function(){return this._enumDropDownWidth},L.getEnumMaxHeight=function(){return this._enumMaxHeight},L.isEnumEditable=function(){return this._enumEditable},L.getEnumValues=function(){return this._enumValues},L.getEnumLabels=function(){return this._enumLabels},L.getEnumIcons=function(){return this._enumIcons},L.isEnumStrict=function(){return this._enumStrict},L.isEnumEqual=function(w,A){return this._enumStrict?w===A:w==A},L.toEnumLabel=function(s,G){var z=this,y=z.getEnumValues(G),t=z.getEnumLabels(G);if(y&&t)for(var Q=0;Q<y.length;Q++)if(z.isEnumEqual(s,y[Q]))return t[Q];return s},L.toEnumIcon=function(w,t){var Z=this,l=Z.getEnumValues(t),R=Z.getEnumIcons(t);if(l&&R)for(var X=0;X<l.length;X++)if(Z.isEnumEqual(w,l[X]))return R[X];return K}},_45o:function(E){E._87o=function(r,$,q,p,I,_){if(r){var L=this,P=L._90I,U=Ti(1);L._columnLineVisible&&(I-=1),L._rowLineVisible&&(_-=1),0>=I||0>=_||(L._90I||(P=L._90I={}),P[$]||(P[$]=new $p),ef(U,L.tx()+q,L.ty()+p,I,_),Xh(U,r),L._view.insertBefore(U,L._79O),r.onParentAdded&&r.onParentAdded(U),P[$].add(U))}},E._76o=function(){var S=this,T=S._90I;if(T){for(var _ in T)T[_].each(function(B){Xq(B)});delete S._90I}},E._77o=function(G){var g=this;if(g._90I){var B=g._90I[G];B&&(B.each(function(y){Xq(y)}),delete g._90I[G])}}},_47o:function(u){u.getValue=function(J,n){return n.getValue?n.getValue(J,n,this):Om(J,n.getAccessType(),n.getName())},u.setValue=function(B,Y,V){if(Y.isEmptiable(B)||""!==V||(V=K),Y.isNullable(B)||V!=Z){var T=this,R=Y.getName(B),D=Y.getAccessType(B),I=Y.getValueType(B);I===_i&&Gk(V)?V=l(V):I===hn&&Gk(V)?V=parseFloat(V):I===en&&Gk(V)&&(V="true"===V),T._batchEditable&&Y._batchEditable&&T.isSelected(B)?T.sm().each(function(P){Y.setValue?Y.setValue(P,Y,V,T):Eg(P,D,R,V)}):Y.setValue?Y.setValue(B,Y,V,T):Eg(B,D,R,V)}},u.setCurrentEditor=function(M){this.endEditing(),this._currentEditor=M,this.redraw()},u.isEditing=function(Z,M){var g=this,v=g._currentEditor;if(!v)return!1;if(M){var h=v.info;return h?(h.column||h.property)===M&&h.data===Z:!1}return!0},u.endEditing=function(B){var f=this,k=f._currentEditor;k&&(delete f._currentEditor,k.commitValue&&k.commitValue(k.info,B),f.redraw(),f.getDataModel().endTransaction())},u.beginEditing=function(H){this.endEditing();var v=this,I=H.column||H.property;if(I.beginEditing)I.beginEditing(H);else{var G=H.data,p=H.value,y=v.getSelectBackground(G),t=I.getEnumValues(G),M=I.getSlider(G),O=I.getColorPicker(G);if(M){var F=oh(dn.Slider,M);return F.setValue(p),F.getView().onblur=function(){v.endEditing()},F.isInstant()&&(F.onValueChanged=function(){v.setValue(G,I,F.getValue())}),ni(F,H),void 0}if(O||I.getValueType(G)===Mf){var f=oh(dn.ColorPicker,O);return f.setValue(p),f.onClosed=function(){v.endEditing()},f.isInstant()&&(f.onValueChanged=function(b,w){v.setValue(G,I,w)}),ni(f,H),f.open(),void 0}if(t){if(dn.ComboBox){var T=new dn.ComboBox;T.setValue(p),T.setValues(t),T.setLabels(I.getEnumLabels(G)),T.setIcons(I.getEnumIcons(G)),T.setEditable(I.isEnumEditable(G)),T.setStrict(I.isEnumStrict(G)),T.setMaxHeight(I.getEnumMaxHeight(G)),T.setDropDownWidth(I.getEnumDropDownWidth(G)),T.onClosed=function(){v.endEditing()},ni(T,H),T.open()}else Xe(hb,H,y,t,I);return}var $=I.getValueType(G);if($===en||hf(p))return v.setValue(G,I,!p),void 0;if(I.getItemEditor(G)){var h=jk(I.getItemEditor(G)),n=new h(G,I,v,H),N=n.getView();return N._17Q=n,n.setValue(p),tl(N),ni(N,H),n.editBeginning&&n.editBeginning(),void 0}Xe("input",H,y,Z,I)}}},_44o:function(L){L.init=function(y){var G=this,N=G.th=new xl(y),J=G._view=nn(1,G);G.tv=G._tableView=y,Xh(J,N.getView()),Xh(J,y.getView()),N.mp(function(e){e.property===Yk&&G.iv()}),G.iv()},L.getTableView=function(){return this.tv},L.getTableHeader=function(){return this.th},L.getDataModel=function(){return this.tv.dm()},L.getColumnModel=function(){return this.tv.getColumnModel()},L.setColumns=function(y){this.tv.setColumns(y)},L.addColumns=function(S){this.tv.addColumns(S)},L.endEditing=function(){this.tv.endEditing()},L.validateImpl=function(){var n=this,t=n.th,G=lc(t),U={x:0,y:0,width:n.getWidth(),height:G};ef(t,U),U.y=G,U.height=E(0,n.getHeight()-G),ef(n.tv,U)}},ms_vs:function(r){r._41o=function(){return this._29I.height<this._59I},r._43o=function(){var l=this;l._41o()&&(l._58I||(H(function(){l._94O()},ds),l.iv()),l._58I=new Date)},r._94O=function(){var e=this;if(e._58I){var w=new Date;w.getTime()-e._58I.getTime()>=ds?(delete e._58I,e.iv()):H(function(){e._94O()},ds)}},r._93I=function(){var j=this,c=j._27I;if(j._58I||!j._autoHideScrollBar){c||Xh(j._79O,c=j._27I=Ti());var o=j._29I,R=o.height,T=j._59I,G=j.getScrollBarSize(),s=o.width-G-2,V=R*(-j.ty()/T),P=R*(R/T),U=c.style;T>R?(Nk>P&&(V=V+P/2-Nk/2,0>V&&(V=0),V+Nk>R&&(V=R-Nk),P=Nk),U.visibility=Tr,U.background=j.getScrollBarColor(),U.borderRadius=G/2+rm,ef(c,s,V,G,P)):U.visibility=Xr}else c&&(c.style.visibility=Xr)}},ms_hs:function(h){h._40o=function(){return this._29I.width<this._91I},h._42o=function(){var U=this;U._40o()&&(U._95O||(H(function(){U._94I()},ds),U.iv()),U._95O=new Date)},h._94I=function(){var j=this;if(j._95O){var U=new Date;U.getTime()-j._95O.getTime()>=ds?(delete j._95O,j.iv()):H(function(){j._94I()},ds)}},h._92I=function(){var d=this,Z=d._28I;if(d._95O||!d._autoHideScrollBar){Z||Xh(d._79O,Z=d._28I=Ti());var B=d._29I,$=B.width,D=d._91I,M=d.getScrollBarSize(),U=B.height-M-2,K=$*(-d.tx()/D),h=$*($/D),P=Z.style;D>$?(Nk>h&&(K=K+h/2-Nk/2,0>K&&(K=0),K+Nk>$&&(K=$-Nk),h=Nk),P.visibility=Tr,P.background=d.getScrollBarColor(),P.borderRadius=M/2+rm,ef(Z,K,U,h,M)):P.visibility=Xr}else Z&&(Z.style.visibility=Xr)}}}),ii(Tl,Mc(16,16,[{type:Kb,rect:[1,1,14,14],background:_d},{type:Hg,rect:[1,1,14,14],width:1,color:Zq},{type:Bd,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),ii(wf,Mc(16,16,{type:Hg,rect:[1,1,14,14],width:1,color:Zq})),ii(Km,Mc(16,16,[{type:Ci,rect:[2,2,12,12],borderWidth:1,borderColor:Zq,background:"#FFF"},{type:Ci,rect:[4,4,8,8],background:_d}])),ii(zl,Mc(16,16,{type:Ci,rect:[2,2,12,12],borderWidth:1,borderColor:Zq})),gi._15Q=function(p){p._29I=Xi,p._59I=0,p._91I=0,p._5o=function(J){var b=this;b._30I=new $p,b._rows=new $p,b._rowMap={},b._31I=0,b._14I=0,b._view=nn(1,b),b._canvas=Od(b._view),Xh(b._view,b._79O=Ti()),b.dm(J?J:new Sn)},p.getCheckIcon=function(c){var g=this.sm(),D=g.co(c);return g.sg()?Mk(D?Km:zl):Mk(D?Tl:wf)},p.checkData=function(z){var D=this.sm(),d=D.co(z);D.sg()&&d||(this._32o=1,d?D.rs(z):D.as(z),delete this._32o)},p.getDataAt=function(f){f.target&&(f=this.lp(f));var j=v(f.y/this._rowHeight),P=this._rows;return 0>j||j>=P.size()?Z:P.get(j)},p.onDataDoubleClicked=function(){},p.onDataClicked=function(){},p.adjustTranslateX=function(){return 0},p.adjustTranslateY=function(v){var N=this.getHeight()-this._59I;return N>v&&(v=N),v>0?0:Q(v)},p.onPropertyChanged=function(V){var C=this,Q=V.property;gb[Q]?C.ivm():ho[Q]||C.redraw(),Q===Eb?C._42o():Q===bg&&C._43o()},p.getLabel=function(h){return h.toLabel()},p.getLabelFont=function(){return this._labelFont},p.getLabelColor=function(F){var P=this;if(P.isCheckMode()){if(P._focusData===F)return P._labelSelectColor}else if(P.isSelected(F))return P._labelSelectColor;return P._labelColor},p.getStartRowIndex=function(){return this._31I},p.getEndRowIndex=function(){return this._14I},p.getRowDatas=function(){return this._rows},p.getRowIndex=function(i){return this._rowMap[i._id]},p.getRowSize=function(){return this._rows.size()},p.getViewRect=function(){return nh(this._29I)},p.isVisible=function(d){return this._visibleFunc?this._visibleFunc(d):!0},p.getCurrentSortFunc=function(){return this._sortFunc},p.setDataModel=function(h){var Y=this,I=Y._dataModel,R=Y._selectionModel;I!==h&&(I&&(I.umm(Y.handleDataModelChange,Y),I.umd(Y.handleDataPropertyChange,Y),I.umh(Y.handleHierarchyChange,Y),R||I.sm().ums(Y.handleSelectionChange,Y)),Y._dataModel=h,h.mm(Y.handleDataModelChange,Y),h.md(Y.handleDataPropertyChange,Y),h.mh(Y.handleHierarchyChange,Y),R?R._21I(h):h.sm().ms(Y.handleSelectionChange,Y),Y.fp("dataModel",I,h))},p.validateModel=function(){var s=this;s._rows.clear(),s._rowMap={},s.buildChildren(s._dataModel._roots);var I=s._rows=s._rows.toList(s.isVisible,s),j=0,L=s.getCurrentSortFunc(),N=I.size();for(L&&I.sort(L);N>j;j++)s._rowMap[I.get(j)._id]=j},p.buildChildren=function(n){var y=this;n.each(function(S){y._rows.add(S),y.buildChildren(S._children)})},p.handleDataModelChange=function(){this.ivm()},p.handleDataPropertyChange=function(Z){"parent"===Z.property?this.ivm():this.invalidateData(Z.data)},p.handleHierarchyChange=function(){this.ivm()},p.handleSelectionChange=function(b){b.datas.each(this.invalidateData,this),this.onSelectionChanged(b)},p.onSelectionChanged=function(b){var L=this,s=L.sm();!L.isAutoMakeVisible()||1!==s.size()||"set"!==b.kind&&"append"!==b.kind||L._32o||L.makeVisible(s.ld())},p.handleBackgroundClick=function(K){em(K)&&!this.isCheckMode()&&this.sm().cs()},p.makeVisible=function(T){T&&(this._23I=T,this.iv())},p.scrollToIndex=function(Y){var k=this,x=k._29I,M=x.height,R=k._rowHeight,f=R*Y;Y>=0&&Y<k._rows.size()&&M>0&&(f+R>x.y+M?k.ty(-f+M-R):f<x.y&&k.ty(-f))},p.autoScroll=function(s,f){var L=this,T=L._rowHeight,z=T,P=T/4,O=L._29I,A=L.lp(s),w={x:L.tx(),y:L.ty()};return T>0&&O&&(A.x-O.x<z?L.translate(P,0):O.x+O.width-A.x<z&&L.translate(-P,0),A.y-O.y<z?L.translate(0,P):O.y+O.height-A.y<z&&L.translate(0,-P)),w.x=L.tx()-w.x,w.y=L.ty()-w.y,f&&(f.x+=w.x,f.y+=w.y),w},p.getTopRowOrderSelection=function(){var m=this.sm().getTopSelection(),b={},z=new $p;return m.each(function(P){b[P._id]=P}),this._rows.each(function(T){b[T._id]&&z.add(T)}),z},p.getRowOrderSelection=function(){var m=new $p;return this._rows.each(function(e){this.isSelected(e)&&m.add(e)},this),m},p.ivm=function(){this.invalidateModel()},p.invalidateModel=function(){var B=this;B._96I||(B._96I=1,B._32I=1,delete B._24I),B.iv()},p.redraw=function(){var J=this;J._32I||(J._32I=1,delete J._24I,J.iv())},p.invalidateData=function(f){var M=this;a?M.redraw():M._32I||(M._24I||(M._24I={}),M._24I[f._id]=f,M.iv())},p.getFocusData=function(){return this._focusData},p.setFocusDataById=function(e){this.setFocusData(this.dm().getDataById(e))},p.setFocusData=function(C){var Z=this,d=Z._focusData;d!==C&&(Z._focusData=C,Z.fp("focusData",d,C),d&&Z.invalidateData(d),C&&(Z.invalidateData(C),Z.isAutoMakeVisible()&&Z.makeVisible(C)))},p.drawRowBackground=function(M,h,k,T,q,Q,G){var A=this,w=A.isCheckMode();(h===A._focusData&&w||k&&!w)&&Rf(M,T,q,Q,G,A.getSelectBackground(h))},p.drawData=function(P,V,e){var W=this,j=W._rowHeight,Z=j*e,H=W._29I,u=H.x,D=H.width;P.save(),P.beginPath(),P.rect(u,Z,D,j),P.clip(),W._87o(W.drawRow(P,V,W.isSelected(V),u,Z,D,j),e,u,Z,D,j),P.restore(),W._rowLineVisible&&Rf(P,u,Z+j-1,D,1,W._rowLineColor)},p._12I=function(_){var V=this,k=V._31I,E=V._29I,G=E.x,w=E.y,l=E.width,c=E.height;for(_.beginPath(),_.rect(G,w,l,c),_.clip(),_.clearRect(G,w,l,c),V._76o(),V._93db(_);k<V._14I;k++)V.drawData(_,V._rows.get(k),k);V._92db(_)},p._13I=function($){for(var B,o=this,T=o._rowHeight,p=o._29I,N=p.x,X=p.width,w=o._31I,P=o._30I;w<o._14I;w++)B=o._rows.get(w),o._24I[B._id]&&P.add({data:B,index:w});P.isEmpty()||($.beginPath(),P.each(function(G){$.rect(N,G.index*T,X,T)}),$.clip(),P.each(function(y){$.clearRect(N,y.index*T,X,T)}),P.each(function($){o._77o($.index)}),o._93db($),P.each(function(b){o.drawData($,b.data,b.index)}),o._92db($),P.clear())},p.preValidateModel=function(){this.endEditing&&this.endEditing()},p.validateImpl=function(){var t=this,d=t._canvas,S=t.getWidth(),C=t.getHeight(),N=t._rowHeight,E=t._32I;(S!==d.clientWidth||C!==d.clientHeight)&&(Aq(d,S,C),E=1);var j=e&&!U;t._96I&&!j&&(t.preValidateModel(),t.validateModel());var G=t._29I,T={x:-t.tx(),y:-t.ty(),width:S,height:C},B=t._rows.size(),F=Lf(d),i=t._23I;E||ul(T,G)||(E=1),t._29I=T,t._59I=B*N+t.getScrollBarSize(),t._31I=v(T.y/N),t._14I=r((T.y+T.height)/N),t._31I<0&&(t._31I=0),t._14I>B&&(t._14I=B),t._99I&&E&&t._99I(),Nn(F,t.tx(),t.ty(),1),E?t._12I(F):t._24I&&t._13I(F),t._93I(),t._92I(),F.restore(),t._32I=t._24I=t._96I=Z,i&&(t.scrollToIndex(t.getRowIndex(i)),delete t._23I),t.tx(t.tx()),t.ty(t.ty())}},gi._48o=function(s){s._rootVisible=!0,s._rootData=Z,s._35o=function(){this._expandMap={},this._levelMap={}},s.validateModel=function(){var $=this,b=$._rootData;$._rows.clear(),$._levelMap={},$._rowMap={},$._currentLevel=0,b?$._rootVisible?$.isVisible(b)&&$.buildData(b):$.buildChildren(b):$.buildChildren(),delete $._currentLevel},s.buildData=function(q){var g=this,O=q._id,Y=g._rows;g._rowMap[O]=Y.size(),Y.add(q),g._levelMap[O]=g._currentLevel,g.isExpanded(q)&&(g._currentLevel++,g.buildChildren(q),g._currentLevel--)},s.buildChildren=function(C){var k=this,w=C?C._children:k._dataModel._roots,A=k.getCurrentSortFunc();A&&k.isChildrenSortable(C)?w.toList(k.isVisible,k).sort(A).each(k.buildData,k):w.each(function(U){k.isVisible(U)&&k.buildData(U)})},s.getLevel=function(r){return this._levelMap[r._id]},s.getToggleIcon=function(n){var A=this,a=A._loader,b=A._collapseIcon;return a&&!a.isLoaded(n)?b:n.hasChildren()?A.isExpanded(n)?A._expandIcon:b:Z},s.isCheckMode=function(){return this._checkMode!=Z},s.isChildrenSortable=function(){return!0},s.handleDataModelChange=function(w){var q=this;w.kind===tr?delete q._expandMap[w.data._id]:w.kind===Dk&&(q._expandMap={}),q.ivm()},s.toggle=function(x){var f=this;f.isExpanded(x)?f.collapse(x):f.expand(x)},s.isExpanded=function(F){return 1===this._expandMap[F._id]},s.expand=function(Y){var U=this,M=U._loader;U.isExpanded(Y)||(M&&!M.isLoaded(Y)&&M.load(Y),U._expandMap[Y._id]=1,U.ivm(),U.onExpanded(Y))},s.onExpanded=function(){},s.collapse=function(p){var P=this;P.isExpanded(p)&&(delete P._expandMap[p._id],P.ivm(),P.onCollapsed(p))},s.onCollapsed=function(){},s.expandAll=function(N){if(N)this.expand(N),N.eachChild(function(s){this.expandAll(s)},this);else{var Z=this;Z._dataModel.each(function(K){K.hasChildren()&&(Z._expandMap[K._id]=1)}),Z.ivm()}},s.collapseAll=function(){this._expandMap={},this.ivm()},s.makeVisible=function(E){if(E){var L=this;if(!L._rootData||E.isDescendantOf(L._rootData)){for(var m=E._parent;m;)L.expand(m),m=m._parent;L._23I=E,L.iv()}}},s.checkData=function(t){var e,_=this,R=_._checkMode,k=_.sm(),b=k.co(t);if(!k.sg()||!b){if(_._32o=1,R===rj)b?k.rs(t):k.as(t);else if(R===nb)e=new $p(t),e.addAll(t._children);else if("descendant"===R)e=new $p,si(t,e);else if("all"===R&&(e=new $p,si(t,e),!b))for(var q=t._parent;q;)e.add(q),q=q._parent;e&&(b?k.rs(e):k.as(e)),delete _._32o}},s._97I=function(g,G,N,R,P,i,A){var n=this,m=n._indent,Q=n._levelMap[G._id],z=n.getIconWidth(G),x=Mk(n.getToggleIcon(G));x?(R+=m*Q,gl(g,x,R+m/2,P+A/2,G,n),R+=m):R+=m*(Q+1),n._checkMode&&(gl(g,n.getCheckIcon(G),R+m/2,P+A/2,G,n),R+=m),n.drawIcon(g,G,R,P,z,A),n.drawLabel(g,G,R+z,P,A)}},gi._14Q=function(S){S.getIcon=function(s){return s.getIcon()},S.getIconWidth=function(k){return this.getIcon(k)?this._indent:0},S.drawIcon=function(V,h,v,l,p,y){if(p){var i=this,r=i.getBodyColor(h),H=Mk(i.getIcon(h),r);H&&(y-=i.isRowLineVisible()?1:0,Ri(V,H,Yr,v,l,p,y,h,i,r),Il(V,i.getBorderColor(h),v,l,p,y))}},S.drawLabel=function(O,G,H,F,M){var x=this;np(O,x.getLabel(G),x.getLabelFont(G),x.getLabelColor(G),H,F,0,M)}},gi._50o=function(y){y._98I=function(){var u=this,T=u._39o=new Sn;u._60I=new $p,T.mm(u._17o,u),T.md(u._18o,u),T.mh(u._19o,u)},y.setColumns=function(P){this._39o.clear(),this.addColumns(P)},y.addColumns=function(T){var O=this._39o;T.forEach(function(p){if(!(p instanceof as)){var H=jk(p.className);p=oh(H?H:as,p)}O.add(p)})},y.onColumnClicked=function(){},y.onCheckColumnClicked=function(){},y._3Q=function(T){for(var M,t=0,E=this._60I,N=E.size();N>t;t++)if(M=E.get(t),M.column===T)return M;return Z},y.getColumnAt=function(_){var M=this._4Q(_);return M?M.column:Z},y._4Q=function(D){for(var e=this,R=D.target?e.lp(D).x:D.x,x=e._60I,M=0;M<x.size();M++){var l=x.get(M),P=l.startX;if(R>=P&&R<P+l.column.getWidth())return l}return Z},y.getToolTip=function(o){var v=this,x=v.getDataAt(o),W=v.getColumnAt(o);return x&&W?W.getToolTip(x,v):Z},y.adjustTranslateX=function(J){var E=this.getWidth()-this._91I;return E>J&&(J=E),J>0?0:Q(J)},y._99I=function(){var L=this,I=L._29I,l=L._60I;l.clear(),L._91I=0,L._39o._roots.each(function(c){if(c.isVisible()){var g=L._91I+c.getWidth();L._91I<=I.x+I.width&&g>=I.x&&l.add({column:c,startX:L._91I}),L._91I=g}}),L._91I+=L.getScrollBarSize()},y.drawData=function(l,L,V){var w=this,O=w._rowHeight,N=O*V,n=w.isSelected(L),c=w._29I,m=c.x,e=c.width;w.drawRowBackground(l,L,n,m,N,e,O),w._60I.each(function(P){var E=P.column,F=P.startX,u=E.getWidth();u>0&&!w.isEditing(L,E)&&(l.save(),l.beginPath(),l.rect(F,N,u,O),l.clip(),w._87o(w.drawCell(l,L,n,E,F,N,u,O),V,F,N,u,O),w._columnLineVisible&&Rf(l,F+u-1,N,1,O,w._columnLineColor),l.restore())}),w._rowLineVisible&&Rf(l,m,N+O-1,e,1,w._rowLineColor)},y.drawCell=function(w,C,f,G,T,O,t,E){var N=this;if(G.drawCell)return G.drawCell(w,C,f,G,T,O,t,E,N);var Y=N.getValue(C,G);Do(w,Y,G,N.getLabelFont(C,G,Y),N.getLabelColor(C,G,Y),T,O,t,E,C,N)},y.getColumnModel=function(){return this._39o},y._17o=function(){this.redraw()},y._18o=function(D){var R=this;D.data===R._sortColumn&&so[D.property]?R.ivm():(R._42o(),R.redraw())},y._19o=function(){this.redraw()},y.getCurrentSortFunc=function(){var F=this,K=F._sortColumn;if(K&&K.isSortable()){var d=K.getSortFunc(),q=fd===K.getSortOrder()?1:-1;return d||(d=Uo),function(R,j){return d.call(F,F.getValue(R,K),F.getValue(j,K),R,j)*q}}return F._sortFunc},y.isCellEditable=function(A,Z,h){return Z.isEditable()&&this.isEditable()?Z.isCellEditable?Z.isCellEditable(A,Z,h,this):!0:!1},y._37O=function(k,F){if(em(F))for(var i=this,r=i.lp(F),W=i._60I,h=i._rowHeight,d=i._29I,c=d.x,_=d.y,I=d.width,Q=d.height,p=0;p<W.size();p++){var z=W.get(p),A=z.startX,y=z.column,b=y.getWidth();if(y!==i._31o&&y!==i._4o&&r.x>=A&&r.x<A+b&&i.isCellEditable(k,y,F)){var M={x:A,y:i.getRowIndex(k)*h,width:b,height:h},T={x:M.x+i.tx(),y:M.y+i.ty(),width:M.width,height:M.height},x=0,v=0;return M.x<c?x=M.x-c:M.x+M.width>c+I&&(x=M.x+M.width-c-I),x&&(i.tx(i.tx()-x),T.x-=x),M.y<_?v=M.y-_:M.y+h>_+Q&&(v=M.y+h-_-Q),v&&(i.ty(i.ty()-v),T.y-=v),i.beginEditing({data:k,column:y,value:i.getValue(k,y),event:F,rect:M,editorRect:T,view:i}),void 0}}}},dn.BaseItemEditor=function(J,C,H,Z){this._data=J,this._column=C,this._master=H,this._editInfo=Z},Lm("BaseItemEditor",C,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Yb=k.Tab=function(){up(Yb,this)};to("Tab",Er,{ms_ac:["view","closable","disabled"],_icon:Z,_closable:!1,_disabled:!1,setParent:pf});var as=k.Column=function(){up(as,this)};to("Column",Er,{_46o:1,ms_ac:["accessType","valueType",Tr,jh,Wm,Br,"align",Mf,"sortOrder",zd,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:fd,_sortFunc:Z,_sortable:!0,_clickable:!0,setWidth:function(K){16>K&&(K=16);var M=this._width;this._width=K,this.fp(Br,M,K)},getToolTip:function(o,t){return this.formatValue(t.getValue(o,this))}});var Hn=k.Property=function(){up(Hn,this)};to("Property",Er,{_46o:1,ms_ac:["accessType","valueType",jh,Wm,"categoryName",Mf,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:Z,getToolTip:function(E,n,k){var M=this;return n?M.formatValue(k.getValue(E,M)):k.getPropertyName(M)}}),dn.AccordionView=function(){var Q=this;Q._20o={},Q._21o=new $p,Q._10o=Z,Q._9o=Z,Q._11o=Z,Q._view=nn(0,Q),Q.iv()},Lm("AccordionView",C,{ms_v:1,ms_fire:1,ms_ac:[qe,Up,"titleHeight",Bl,rr,"titleBackground","selectWidth",bb,"orientation","separatorColor"],_expandIcon:M.accordionViewExpandIcon,_collapseIcon:M.accordionViewCollapseIcon,_titleHeight:$r,_labelColor:M.accordionViewLabelColor,_labelFont:M.accordionViewLabelFont,_titleBackground:M.accordionViewTitleBackground,_selectBackground:M.accordionViewSelectBackground,_selectWidth:M.accordionViewSelectWidth,_orientation:"v",_separatorColor:M.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(O,r,f,e){var E=this,V=Ti();if(E._20o[O])throw O+" already exists";V.onmousedown=xf,V.style.cursor=Vh,V.addEventListener(Jq?lm:Rl,function(S){xf(S)},R),V.addEventListener(Jq?Aj:xq,function(P){xf(P),em(P)&&(E._10o===O?E.collapse():E.expand(O))},R),Xh(E._view,V),E._20o[O]={content:r,div:V,canvas:Od(V),icon:e},E._21o.add(O),f&&E.expand(O),E.iv()},remove:function(M){var O=this,r=O._20o[M];r&&(Xq(r.div),delete O._20o[M],O._21o.remove(M),O.iv())},clear:function(){var G=this;G._21o.toArray().forEach(G.remove,G),G._20o={},G._21o.clear(),G.iv()},isExpanded:function(T){return this._10o===T},expand:function(A){var h=this;h._20o[A]&&h._10o!==A&&(h._10o=A,h.onExpanded(A),h.iv())},onExpanded:function(){},collapse:function(){var Y=this;Y._10o&&(Y.onCollapsed(Y._10o),delete Y._10o,Y.iv())},onCollapsed:function(){},initCanvas:function(d,z,E){Aq(d,z,E);var m=Lf(d);return Nn(m,0,0,1),m.clearRect(0,0,z,E),m},drawTitle:function(J,K,V,s,$){var T=this,U=Mk($.icon),A=T.isExpanded(K),k=T._titleHeight,h=T._titleBackground,M=T._selectWidth,_=T._separatorColor,P=Mk(A?T._expandIcon:T._collapseIcon),Q=M+4;Rf(J,0,0,V,s,h),A&&M&&Rf(J,0,0,M,s,T._selectBackground),(A||T._21o.get(T._21o.size()-1)!==K)&&Rf(J,0,s-1,V,1,_?_:um(h)),U&&(gl(J,U,Q+pr(U)/2,k/2),Q+=pr(U)+2),np(J,K,T.getLabelFont(K),T.getLabelColor(K),Q,0,0,k),P&&gl(J,P,V-pr(P)/2-4,k/2)
},validateImpl:function(){var X=this,L=X._view,o=0,h=0,y=X.getWidth(),p=X.getHeight(),n=X._titleHeight,T=X._21o.size()*n,W=X._11o,S=X._9o;delete X._11o,delete X._9o,X._21o.each(function(e){var F,G,_=X._20o[e],M=_.content,z=X._10o===e;Gm(X)?(ef(_.div,o,0,n,p),F=X.initCanvas(_.canvas,n,p),Kn(F,0,p),Tc(F,-I),X.drawTitle(F,e,p,n,_),F.restore(),z?(G=E(0,y-T),M&&(X._11o=M,X._9o=or(M),ef(M,o+n,0,G,p)),o+=n+G):o+=n):(ef(_.div,0,h,y,n),F=X.initCanvas(_.canvas,y,n),X.drawTitle(F,e,y,n,_),F.restore(),z?(G=E(0,p-T),M&&(X._11o=M,X._9o=or(M),ef(M,0,h+n,y,G)),h+=n+G):h+=n)});var G=X._9o;W&&W!==X._11o&&W.endEditing&&W.endEditing(),G&&G!==S&&Xh(L,G),S&&S!==G&&Xq(S)}}),dn.SplitView=function(I,b,$,Y){var i=this,F=i._dividerDiv=Ti(),L=i._60O=Od(),S=i._61O=Od(),K=L.style,p=S.style;i._view=nn(1,i),Xh(i._view,F),K.msTouchAction=kg,K.pointerEvents=kg,K.cursor=Vh,p.msTouchAction=kg,p.pointerEvents=kg,p.cursor=Vh,I&&i.setLeftView(I),b&&i.setRightView(b),$&&i.setOrientation($),Y!=Z&&i.setPosition(Y),i.setStatus(Fj),new _n(i)},Lm("SplitView",C,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:M.splitViewDividerSize,_dividerBackground:M.splitViewDividerBackground,_dragOpacity:M.splitViewDragOpacity,_toggleIcon:M.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(r,S){var B=this,f=B._position;isNaN(r)||(S||(B._82O=0>r?-1:r>1?1:0),B._position=r,B.fp(ed,f,r))},getLeftView:function(){return this._leftView},setLeftView:function(G){var p=this,r=p._leftView,w=p._view;if(p._leftView!==G){if(r&&r!==p._rightView){var K=or(r);K.parentNode===w&&Xq(K)}if(p._leftView=G,G){var D=or(G);D.parentNode!==w&&w.insertBefore(D,p._dividerDiv)}p.fp("leftView",r,G)}},getRightView:function(){return this._rightView},setRightView:function(c){var v=this,D=v._rightView,w=v._view;if(v._rightView!==c){if(D&&D!==v._leftView){var C=or(D);C.parentNode===w&&Xq(C)}if(v._rightView=c,c){var Z=or(c);Z.parentNode!==w&&w.insertBefore(Z,v._dividerDiv)}v.fp("rightView",D,c)}},validateImpl:function(){var W=this,i=W._draggable,f=W._position,P=W.getWidth(),p=W.getHeight(),D=W._dividerSize,u=W._dividerBackground,S=Jq?18:8,$=W._dividerDiv,Z=W._82O,A=W._60O,R=W._61O,y=W._toggleIcon,v=W._status,V=$.style,K=null,e=Jq?20:4,d=y.comps[0];D>=S||0===D?W._coverDiv&&(Xq(W._coverDiv),delete W._coverDiv):W._coverDiv||(W._coverDiv=Ti(),Y&&(W._coverDiv.style.background=ud),Xh($,W._coverDiv)),W._togglable?A.parentNode||(Xh($,A),Xh($,R)):(Xq(A),Xq(R));var r=W._coverDiv,s=W._leftView,O=W._rightView;if(Gm(W)){if(D>P&&(D=P),v===Fj)if(1===Z)var n=z(f,P),h=E(0,P-D-n);else-1===Z?(h=z(-f,P),n=E(0,P-D-h)):(n=Q((P-D)*f),h=E(0,P-D-n));else"cl"===v?(n=0,h=E(0,P-D)):"cr"===v&&(h=0,n=E(0,P-D));s&&ef(s,0,0,n,p),O&&ef(O,n+D,0,h,p),ef($,n,0,D,p),W._22o=n,r&&(ef(r,D/2-S/2,0,S,p),r.style.cursor=i?zi:""),$.style.cursor=i?zi:"";var o=$.clientHeight/2,J=$.clientWidth;Aq(A,J,J),ef(A,0,o-J-e,J,J),K=Lf(A),Nn(K,0,0,1),d.rotation=-I,mc(K,y,0,0,J,J),K.restore(),Aq(R,J,J),ef(R,0,o+e,J,J),K=Lf(R),Nn(K,0,0,1),d.rotation=I,mc(K,y,0,0,J,J),K.restore()}else{if(D>p&&(D=p),v===Fj)if(1===Z)var x=z(f,p),g=E(0,p-D-x);else-1===Z?(g=z(-f,p),x=E(0,p-D-g)):(x=Q((p-D)*f),g=E(0,p-D-x));else"cl"===v?(x=0,g=E(0,p-D)):"cr"===v&&(g=0,x=E(0,p-D));s&&ef(s,0,0,P,x),O&&ef(O,0,x+D,P,g),ef($,0,x,P,D),W._22o=x,r&&(ef(r,0,D/2-S/2,P,S),r.style.cursor=i?no:""),V.cursor=i?no:"";var a=$.clientWidth/2,J=$.clientHeight;Aq(A,J,J),ef(A,a-J-e,0,J,J),K=Lf(A),Nn(K,0,0,1),d.rotation=0,mc(K,y,0,0,J,J),K.restore(),Aq(R,J,J),ef(R,a+e,0,J,J),K=Lf(R),Nn(K,0,0,1),d.rotation=B,mc(K,y,0,0,J,J),K.restore()}V.background=u}});var _n=function(C){this.sv=C,this.addListeners()};_p(_n,C,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(S){var $=this,e=$.sv,y=e._dividerDiv,l=e._60O,p=e._61O,G=e._status,R=S.target;if(R===l)G===Fj?e.setStatus("cl"):"cr"===G&&e.setStatus(Fj);else if(R===p)G===Fj?e.setStatus("cr"):"cl"===G&&e.setStatus(Fj);else if(zs(S)&&(R===y||R===e._coverDiv)&&(xf(S),e.isDraggable())){e.getLeftView(),e.getRightView();var O=$.maskDiv=Ti();if(O.style.left=0,O.style.top=0,O.style.width=e.getWidth()+"px",O.style.height=e.getHeight()+"px",e.getView().appendChild(O),!e.isContinuousLayout()){var C=$.resizeDiv=Ti();C.style.left=y.style.left,C.style.top=y.style.top,C.style.width=y.style.width,C.style.height=y.style.height,C.style.opacity=e.getDragOpacity(),C.style.background=e.getDividerBackground(),Xh($.getView(),C)}$._lastAbsPosition=e._22o,$._86o=Gm(e)?bk(S).x:bk(S).y,nf($,S)}},handleWindowTouchMove:function(j){zs(j)&&this.update(j,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(X){var f=this;f.update(X,!0),f.sv.setStatus(Fj),f.maskDiv&&Xq(f.maskDiv),f.resizeDiv&&Xq(f.resizeDiv),f.maskDiv=f.resizeDiv=Z},handle_mousedown:function(z){em(z)&&this.handle_touchstart(z)},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowMouseUp:function(v){this.handleWindowTouchEnd(v)},update:function(X,W){var P=this,o=P.sv,C=Gm(o)?o.getWidth():o.getHeight(),i=o._dividerSize,p=P._lastAbsPosition-P._86o;Gm(o)?(p+=bk(X).x,p>C-i&&(p=C-i),0>p&&(p=0),P.resizeDiv&&(P.resizeDiv.style.left=p+rm)):(p+=bk(X).y,p>C-i&&(p=C-i),0>p&&(p=0),P.resizeDiv&&(P.resizeDiv.style.top=p+rm)),W&&C!==i&&(1===o._82O?o.setPosition(p,1):-1===o._82O?o.setPosition(p-C+i,1):o.setPosition(p/(C-i),1))}}),dn.TabView=function(){var z=this,v=z._view=nn(1,z),x=z._91O=Ti(1),m=z._tabModel=new Sn,U=m.sm(),q=z.invalidate;z._7o=new $p,z._canvas=Od(x),Xh(v,x),Xh(v,z._92O=Ti(1)),U.setSelectionMode(fe),U.ms(z.handleSelectionChange,z),m.mm(q,z),m.md(q,z),m.mh(q,z),z._interactor=new uh(z),z.iv()},Lm("TabView",C,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Bl,rr,"tabBackground","selectWidth",bb,"moveBackground","insertColor"],_tabPosition:uc,_tabHeight:$r,_tabGap:M.tabViewTabGap,_labelColor:M.tabViewLabelColor,_labelFont:M.tabViewLabelFont,_tabBackground:M.tabViewTabBackground,_selectWidth:M.tabViewSelectWidth,_selectBackground:M.tabViewSelectBackground,_moveBackground:M.tabViewMoveBackground,_insertColor:M.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(P,L,Q){var s,r=this._tabModel;return P instanceof Yb?(s=P,L&&s.setView(L)):(s=new Yb,s.setName(P),s.setView(L)),r.add(s),Q&&r.sm().ss(s),s},getLabel:function(z){return z.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(u){this._23o=u,this.iv()},get:function(a){var $=this,h=$._tabModel;if(Zi(a))return h._roots.get(a);if(Gk(a)){var V;return h.each(function(C){a===$.getLabel(C)&&(V=C)}),V}return a instanceof Yb?a:Z},select:function(Z){this._tabModel.sm().ss(this.get(Z))},remove:function(O){var e=this;if(O=e.get(O)){var j=e._tabModel,q=j._roots.indexOf(O);e._tabModel.remove(O),e.selectByIndex(--q)}},getCurrentTab:function(){return this._8o},hideTabView:function(c,A){A.parentNode===this._92O&&(ce(A)?(A.style.display=Ur,A._tab_=c):Xq(A),sf())},showTabView:function(N,I){ce(I)&&(I.style.display="block",I._tab_=N),I.parentNode!==this._92O&&(Xh(this._92O,I),sf())},_24o:function(){var Y,z=this,T=z._8o,g=z._9o,L=z._tabModel.sm().ld();L&&(Y=or(L.getView())),Y!==g&&(g&&(T.getView()&&T.getView().endEditing&&T.getView().endEditing(),z.hideTabView(T,g)),Y&&z.showTabView(L,Y)),z._8o=L,z._9o=Y,T!==L&&z.onTabChanged(T,L)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(Y,X){this.selectByIndex(--X)},selectByIndex:function(I){var $=this,a=$._tabModel,f=a.size();if(f&&!a.sm().ld()){I==Z&&(I=0),I>=f&&(I=f-1),0>I&&(I=0);for(var O=I;O>=0;O--){var i=$.get(O);if(!i.isDisabled())return $.select(i),i}for(O=I+1;f>O;O++)if(i=$.get(O),!i.isDisabled())return $.select(i),i}},getTabWidth:function(S){var W=4,A=Mk(S.getIcon());A&&(W+=pr(A,S)+4);var g=this.getLabel(S);return g&&(W+=Dn(this.getLabelFont(S),g).width+4),S.isClosable()&&(W+=10),W},drawTab:function(e,o,c,k,$,r,l){var T,d=this,P=d._tabPosition,y=c+4,w=d._selectWidth,f=Mk(o.getIcon()),M=o.isDisabled(),Y=d.getLabelColor(o),j=d.getLabelFont(o),p=d.getLabel(o),O=d._selectBackground,S=P===Wf+"-vertical",U=P===qb+"-vertical";(S||U)&&(y=k+4),M&&(e.globalAlpha=Gn),Rf(e,c,k,$,r,l),o===d._8o&&w&&(P===uc?Rf(e,c,k+r-w,$,w,O):P===Wf?Rf(e,c+$-w,k,w,r,O):P===qb?Rf(e,c,k,w,r,O):S?Rf(e,c+$-w,k,w,r,O):U?Rf(e,c,k,w,r,O):Rf(e,c,k,$,w,O));var x=$/2;if(S&&(Kn(e,x,k+r/2),Tc(e,B),Kn(e,-x,-k-r/2)),f){var z=Ne(f,o),X=pr(f,o);if(S||U){var K=c+$/2,v=y+z/2;Kn(e,K,v),Tc(e,I),Kn(e,-K,-v),gl(e,f,c+$/2,y+z/2,o,d),Kn(e,K,v),Tc(e,-I),Kn(e,-K,-v),y+=z+4}else gl(e,f,y+X/2,k+r/2,o,d),y+=X+4}return S||U?(Kn(e,$/2,y+$/2),Tc(e,I),Kn(e,-$/2,-y-$/2),np(e,p,j,Y,c,y,r,$),Kn(e,$/2,y+$/2),Tc(e,-I),Kn(e,-$/2,-y-$/2)):np(e,p,j,Y,y,k,$,r),S&&(Kn(e,x,k+r/2),Tc(e,-B),Kn(e,-x,-k-r/2)),o.isClosable()&&(T=U?{x:c+$-12,y:k+r-12,width:12,height:12}:{x:c+$-12,y:k+2,width:12,height:12},this.drawCloseIcon(o,e,Y,T)),M&&(e.globalAlpha=1),T},drawCloseIcon:function(E,y,W,k){var t=k.x,K=k.y;y.strokeStyle=W,y.lineWidth=1,y.beginPath(),y.moveTo(t+2,K+8),y.lineTo(t+8,K+2),y.moveTo(t+8,K+8),y.lineTo(t+2,K+2),y.stroke()},getTabAt:function(f){var L=this._interactor._8Q(f);return L?L.tab:null},validateImpl:function(){var N=this;N._24o();var C,l=N._canvas,t=N._tabPosition,v=N._91O,U=N._92O,Z=N._tabModel,m=N.getWidth(),L=N.getHeight(),G=N._tabHeight,g=N._7o,S=N._tabGap,x=t===uc,A=t===Wf,a=t===qb,J=t===Wf+"-vertical",M=t===qb+"-vertical",R=N._23o,u=0;if((A||a)&&Z._roots.each(function(j){u=E(N.getTabWidth(j),u)}),x?(ef(v,0,0,m,G),C={x:0,y:G,width:m,height:E(0,L-G)}):A?(ef(v,0,0,u,L),C={x:u,y:0,width:E(0,m-u),height:L}):a?(ef(v,m-u,0,u,L),C={x:0,y:0,width:E(0,m-u),height:L}):J?(ef(v,0,0,G,L),C={x:G,y:0,width:E(0,m-G),height:L}):M?(ef(v,m-G,0,G,L),C={x:0,y:0,width:E(0,m-G),height:L}):(ef(v,0,L-G,m,G),C={x:0,y:0,width:m,height:E(0,L-G)}),ef(U,C),J||M){N._9o&&(C.x=0,ef(N._8o.getView(),C)),Aq(l,G,L);var r=Lf(l),s=0;if(Nn(r,0,N.ty(),1),r.clearRect(0,0,G,L),g.clear(),Z._roots.each(function(x){var Z,o=N.getTabWidth(x);R&&R.tab===x||(Z=N.drawTab(r,x,0,s,G,o,N._tabBackground)),g.add({_75o:Z,tab:x,startY:s,endY:s+o,height:o}),s+=o+S}),N._23Q=E(0,s-S),R){var O=R.position;N.drawTab(r,R.tab,0,R.startY,G,R.height,N._moveBackground),Rf(r,0,O,G,1,N._insertColor)}if(r.restore(),N._selectionChanged){N._selectionChanged=!1;for(var Q=N.ty(),c=0;c<g.size();c++){var b=g.get(c);if(b.tab===N._8o){if(b.endY+Q<0){N.ty(-b.startY);break}if(b.startY+Q>L){N.ty(L-b.endY);break}}}}N.ty(N.ty())}else if(A||a){N._9o&&(C.x=0,ef(N._8o.getView(),C)),Aq(l,u,L);var r=Lf(l),s=0;if(Nn(r,0,N.ty(),1),r.clearRect(0,0,u,L),g.clear(),Z._roots.each(function(a){var D;R&&R.tab===a||(D=N.drawTab(r,a,0,s,u,G,N._tabBackground)),g.add({_75o:D,tab:a,startY:s,endY:s+G,height:G}),s+=G+S}),N._23Q=E(0,s-S),R){var O=R.position;N.drawTab(r,R.tab,0,R.startY,u,R.height,N._moveBackground),Rf(r,0,O,u,1,N._insertColor)}if(r.restore(),N._selectionChanged){N._selectionChanged=!1;for(var Q=N.ty(),c=0;c<g.size();c++){var b=g.get(c);if(b.tab===N._8o){if(b.endY+Q<0){N.ty(-b.startY);break}if(b.startY+Q>L){N.ty(L-b.endY);break}}}}N.ty(N.ty())}else{N._9o&&(C.y=0,ef(N._8o.getView(),C)),Aq(l,m,G);var r=Lf(l),q=0;if(Nn(r,N.tx(),0,1),r.clearRect(0,0,m,G),g.clear(),Z._roots.each(function(j){var i,f=N.getTabWidth(j);R&&R.tab===j||(i=N.drawTab(r,j,q,0,f,G,N._tabBackground)),g.add({_75o:i,tab:j,startX:q,endX:q+f,width:f}),q+=f+S}),N._64I=E(0,q-S),R){var O=R.position;N.drawTab(r,R.tab,R.startX,0,R.width,G,N._moveBackground),dq(r,N._insertColor,O,0,G)}if(r.restore(),N._selectionChanged){N._selectionChanged=!1;for(var Y=N.tx(),c=0;c<g.size();c++){var b=g.get(c);if(b.tab===N._8o){if(b.endX+Y<0){N.tx(-b.startX);break}if(b.startX+Y>m){N.tx(m-b.endX);break}}}}N.tx(N.tx())}for(var T=[],z=U.children,c=0;c<z.length;c++){var K=z[c],I=K._tab_;I&&!Z.contains(I)&&T.push(K)}T.forEach(function(E){U.removeChild(E)})}});var uh=function(m){this.tv=m,this.addListeners()};_p(uh,C,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(t){this.handleScroll(t,10*(t.wheelDelta/40))},handle_DOMMouseScroll:function(G){this.handleScroll(G,10*-G.detail)},handleScroll:function(p,A){xf(p);var z=this.tv,N=z._tabPosition;!z._40o()||N!==uc&&N!==Ul||z.tx(this.tv.tx()+A),!z._41o()||N!==Wf&&N!==qb&&N!==Wf+"-vertical"&&N!==qb+"-vertical"||z.ty(this.tv.ty()+A)},_8Q:function(F){var l,q,t=this.tv,b=t._tabPosition,g=t._7o;if(b===uc||b===Ul){var s=t.lp(F).x;for(l=0;l<g.size();l++)if(q=g.get(l),q.startX<=s&&s<=q.endX)return q}else if(b===Wf||b===qb||b===Wf+"-vertical"||b===qb+"-vertical"){var j=t.lp(F).y;for(l=0;l<g.size();l++)if(q=g.get(l),q.startY<=j&&j<=q.endY)return q}return Z},isClickable:function($){var X=this.tv,E=X._tabPosition,A=this._73o=this._8Q($);return!X._40o()||E!==uc&&E!==Ul?!X._41o()||E!==Wf&&E!==qb&&E!==Wf+"-vertical"&&E!==qb+"-vertical"?A&&(!A.tab.isDisabled()||X.isMovable()):!0:!0},handle_mousemove:function(k){var l=this;Re?l._74o=l._8Q(k):l.getView().style.cursor=l.isClickable(k)?Vh:""},handle_mousedown:function(_){this.handle_mousemove(_),this.handle_touchstart(_)},handle_touchstart:function(e){var B=this,S=B.tv,r=S._tabPosition;xf(e),em(e)&&B.isClickable(e)&&(r===uc||r===Ul?(B.x=bk(e).x,B.lp=S.lp(e),B.tx=S.tx()):(B.y=bk(e).y,B.lp=S.lp(e),B.ty=S.ty()),nf(B,e))},handleWindowMouseMove:function(c){this.handleWindowTouchMove(c)},handleWindowTouchMove:function(y){var x,w=this,A=w.tv,U=A._tabPosition,t=w._73o;if(U===uc||U===Ul){if(x=bk(y).x-w.x,!w._25o&&!w.moving&&s(x)>2&&(A._40o()&&!Ah(y)?w._25o=1:t&&A.isMovable()&&(w.moving=1)),w._25o)A.tx(w.tx+x);else if(w.moving){var T=w.lp.x+x,f=A._tabGap/2;A._7o.each(function(h){var V=h.endX,q=T-h.startX<V-T;T>=h.startX&&V>=T&&A._7Q({tab:t.tab,startX:t.startX+x,width:t.width,front:q,insertTab:h.tab,position:q?E(0,h.startX-f):z(A._64I,V+f)})})}}else if(x=bk(y).y-w.y,!w._25o&&!w.moving&&s(x)>2&&(A._41o()&&!Ah(y)?w._25o=1:t&&A.isMovable()&&(w.moving=1)),w._25o)A.ty(w.ty+x);else if(w.moving){var _=w.lp.y+x,f=A._tabGap/2;A._7o.each(function(M){var l=M.endY,G=_-M.startY<l-_;_>=M.startY&&l>=_&&A._7Q({tab:t.tab,startY:t.startY+x,height:t.height,front:G,insertTab:M.tab,position:G?E(0,M.startY-f):z(A._23Q,l+f)})})}},handleWindowMouseUp:function(c){this.handleWindowTouchEnd(c)},handleWindowTouchEnd:function(){var p=this,A=p.tv,D=A._tabPosition,U=A.getTabModel(),g=U._roots,_=p._73o;if(p.moving){var z=A._23o;if(z&&z.insertTab!==z.tab){var M=z.tab,d=g.remove(M),O=g.indexOf(z.insertTab);O>=0&&(z.front||O++,O<=g.size()&&(g.add(M,O),U._38I(M,d,O)))}A._7Q(Z),delete p.moving}else if(!p._25o&&_){M=_.tab;var B=p._74o;if(!B||B.tab===M)if(!M.isDisabled()&&Um(_._75o,p.lp)){var b=function(){var X=g.indexOf(M);U.remove(M),A.onTabClosed(M,X)};A.onTabClosing(M,b)&&b()}else M.isDisabled()||A._8o===M||U.sm().ss(M)}p._25o=p._73o=p._74o=D===uc||D===Ul?p.x=p.lp=p.tx=Z:p.y=p.lp=p.ty=Z}}),dn.PropertyView=function(o){var g=this;g._view=nn(1,g),g._canvas=Od(g._view),Xh(g._view,g._79O=Ti()),g._rows=new $p,g._28o=new $p,g._26o={},g._26Q={};var G=g._propertyModel=new Sn,q=g.ivm;G.mm(q,g),G.md(q,g),G.mh(q,g),g.dm(o?o:new Sn),new le(g)},Lm("PropertyView",C,{ms_ac:[Bl,oj,rr,jh,Wm,"categorizable",Lq,zd,Ug,qe,Up,bc,fq,If,"selectRowIndex",bb,"background",nm,Ym,wh,pn,He],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Xi,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:ui,_background:M.propertyViewBackground,_expandIcon:M.propertyViewExpandIcon,_collapseIcon:M.propertyViewCollapseIcon,_scrollBarColor:Zb,_scrollBarSize:fp,_autoHideScrollBar:Ae,_selectBackground:M.propertyViewSelectBackground,_rowHeight:Xl,_rowLineVisible:M.propertyViewRowLineVisible,_rowLineColor:M.propertyViewRowLineColor,_10I:.5,_columnLineVisible:M.propertyViewColumnLineVisible,_columnLineColor:M.propertyViewColumnLineColor,_labelColor:M.propertyViewLabelColor,_labelSelectColor:M.propertyViewLabelSelectColor,_labelFont:M.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(h){0>h&&(h=0),h>1&&(h=1);var e=this,d=e._10I;e._10I=h,e.fp("columnPosition",d,h)},getPropertyName:function(i){return i.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(I,q,T){return T===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(U,X){return X===this._selectRowIndex?this._labelSelectColor:U.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(E){var n=this.getHeight()-this._59I;return n>E&&(E=n),E>0?0:Q(E)},isExpanded:function(j){if(!j)return!0;var u=this._26o[j];return u?u.isExpanded:!(this._26Q[j]===!1)},toggle:function(c){var z=this;z.isExpanded(c)?z.collapse(c):z.expand(c)},expandAll:function(){this.validate();for(var A in this._26o)this.expand(A)},expand:function(v){if(v&&v!==Ur){var j=this,Q=j._26o[v];Q&&!Q.isExpanded&&(Q.isExpanded=!0,j.onExpanded(v),j.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var W in this._26o)this.collapse(W)},collapse:function(K){if(K&&K!==Ur){var n=this,y=n._26o[K];y&&y.isExpanded&&(y.isExpanded=!1,n.onCollapsed(K),n.ivm())}},onCollapsed:function(){},getCategoryName:function(X){if(!this.isCategorizable())return Ur;var D=X.getCategoryName();return D?D:Ur},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(b){var I=this,B=I._dataModel;B!==b&&(B&&(B.umd(I.handlePropertyChange,I),I._selectionModel||B.sm().ums(I.handleSelectionChange,I)),I._dataModel=b,b.md(I.handlePropertyChange,I),I._selectionModel?I._selectionModel._21I(b):b.sm().ms(I.handleSelectionChange,I),I.fp(Xd,B,b))},isVisible:function(c){return this._visibleFunc?this._visibleFunc(c):!0},onPropertyChanged:function(r){var b=this,Y=r.property;ip[Y]?b.ivm():b.iv(),Y===bg&&b._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:kh},handlePropertyChange:function(D){this._27o===D.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var e=this;e._96I||(e.setSelectRowIndex(-1),e._96I=1,e.iv())},redraw:function(){this.iv()},validateModel:function(){var W=this,i=W._rows,c=W._28o,v={},F=new $p,Q=W._27o;W.updateCurrentData(),Q!==W._27o&&W.endEditing(),i.clear(),c.clear(),W.getRawProperties().each(function(d){if(W.isVisible(d)){F.add(d);var T=W.getCategoryName(d);v[T]||(c.add(T,T===Ur?0:K),v[T]={isExpanded:W.isExpanded(T),properties:new $p})}}),W._sortFunc&&F.sort(W._sortFunc);for(var y in W._26o)W._26Q[y]=W.isExpanded(y);W._26o=v,c.each(function(N){N!==Ur&&i.add(N);var z=v[N];z.isExpanded&&F.each(function(b){W.getCategoryName(b)===N&&(z.properties.add(b),i.add({property:b,data:W._27o}))},W)})},validateImpl:function(){var c=this;c._76o(),c._96I&&(c.validateModel(),delete c._96I);var b=c._canvas,o=c.getWidth(),S=c.getHeight(),g=-c.ty(),n=c._rowHeight,D=c._indent,u=o-D,E=c._rows,q=E.size(),h=c._9I=D+u*c._10I,Y=c._59I=q*n;Aq(b,o,S),c._29I={x:0,y:g,width:o,height:S},c._31I=v(g/n),c._14I=r((g+S)/n),c._31I<0&&(c._31I=0),c._14I>q&&(c._14I=q);var N,i=Lf(b),d=c._background;Nn(i,0,-g,1),i.beginPath(),i.rect(0,g,o,S),i.clip(),i.clearRect(0,g,o,S),c._93db(i),d&&Rf(i,0,0,D,Y,d);for(var z=c._31I;z<c._14I;z++){var B=E.get(z),g=n*z;if(Gk(B))d&&Rf(i,D,g,u,n,d),N=Mk(c.isExpanded(B)?c._expandIcon:c._collapseIcon),N&&Ri(i,N,Yr,0,g,D,n),i.save(),i.beginPath(),i.rect(D,g,u,n),i.clip(),c.drawCategoryName(i,B,z,D,g,u,n),i.restore();else{var A=B.property,J=B.data,N=Mk(A.getIcon()),t=c._selectRowIndex===z?c.getSelectBackground():Z;if(N&&Ri(i,N,Yr,0,g,D,n),t&&Rf(i,D,g,u,n,t),i.save(),i.beginPath(),i.rect(D,g,h-D,n),i.clip(),c.drawPropertyName(i,A,z,D,g,h-D,n),i.restore(),!c.isEditing(J,A)){var e=h+1,s=o-h-1;i.save(),i.beginPath(),i.rect(e,g,s,n),i.clip(),c._87o(c.drawPropertyValue(i,A,c.getValue(J,A),z,e,g,s,n,J),z,e,g,s,n),i.restore()}}c._rowLineVisible&&Rf(i,D,g+n-1,u,1,c._rowLineColor)}c._columnLineVisible&&(Rf(i,h,0,1,Y,c._columnLineColor),Rf(i,o-1,0,1,Y)),c._92db(i),c._93I(),i.restore(),c.ty(c.ty())},drawCategoryName:function(t,c,E,R,T,X,Y){np(t,c,this.getCategoryFont(c),this.getCategoryColor(c),R,T,X,Y)},drawPropertyName:function(Q,E,W,O,b,T,C){return E.drawPropertyName?(E.drawPropertyName(Q,E,W,O,b,T,C,this),void 0):(np(Q,this.getPropertyName(E),this.getPropertyFont(E,W),this.getPropertyColor(E,W),O,b,T,C),void 0)},drawPropertyValue:function(z,I,m,N,L,E,W,X,C){return I.drawPropertyValue?I.drawPropertyValue(z,I,m,N,L,E,W,X,C,this):(Do(z,m,I,this.getLabelFont(I,m,N),this.getLabelColor(I,m,N),L,E,W,X,C,this),void 0)},isPropertyEditable:function(E){return E.isEditable()&&this.isEditable()},setProperties:function(F){this._propertyModel.clear(),this.addProperties(F)},addProperties:function(G){if(G){var s=this._propertyModel;G.forEach(function(E){if(!(E instanceof Hn)){var K=jk(E.className);E=oh(K?K:Hn,E)}s.add(E)})}},getRowIndexAt:function(O){var x=this,I=v(x.lp(O).y/x._rowHeight);return I>=0&&I<x._rows.size()?I:-1},getPropertyAt:function(Q){var k=this,z=k.getRowIndexAt(Q);return z>=0?k._rows.get(z).property:Z},getToolTip:function(r){var K=this,C=K.getPropertyAt(r),l=K._27o;return C&&l?C.getToolTip(l,K._9I<K.lp(r).x,K):Z}});var le=function(a){this.pv=a,this.addListeners()};_p(le,C,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(k){this.getView().style.cursor=k},clear:function(){var C=this;C._62O=C.cp=C.ty=C.p=Z,C.setCursor(rj)},handle_mousedown:function(s){this.handle_touchstart(s)},handle_touchstart:function(g){var D=this,v=D.pv;xf(g),v.setFocus(g)&&(em(g)?(D.cp=bk(g),D.ty=v.ty(),D.p=v.getColumnPosition(),D.handle_touchmove(g)):v.setSelectRowIndex(v.getRowIndexAt(g)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(g){this.handle_touchend(g)},handle_touchend:function(q){var I=this;if(I.cp&&!I._62O){var p=I.pv,W=p.lp(q),c=W.x,J=W.y,u=p._indent,H=p.getRowIndexAt(q),n=p._9I;if(H>=0){var f=p._rowHeight,s=f*H,v=p._rows.get(H),A=v.property;if(Gk(v))Mk(p.isExpanded(v)?p._expandIcon:p._collapseIcon)&&c>=0&&u>=c&&J>=s&&s+f>=J?p.toggle(v):yn(q)&&p.toggle(v);else if(c>n&&p.isPropertyEditable(A,q)){var o={x:n+1,y:s,width:p.getWidth()-n-1,height:f},e={x:o.x+p.tx(),y:o.y+p.ty(),width:o.width,height:o.height},M=0,z=p._29I;o.y<z.y?M=o.y-z.y:o.y+f>z.y+z.height&&(M=o.y+f-z.y-z.height),M&&(p.ty(p.ty()-M),e.y-=M),p.beginEditing({data:v.data,property:A,value:p.getValue(v.data,A),event:q,rect:o,editorRect:e,view:p})}}p.setSelectRowIndex(H)}I.clear()},handleWindowMouseMove:function(u){this.handleWindowTouchMove(u)},handleWindowTouchMove:function(v){var t=this,x=t.pv,O=t.ty,i=t.cp,p=bk(v),G=t._62O;if("p"===G)x.setTranslateY(O+p.y-i.y);else if("c"===G){var j=x.getWidth()-x._indent;if(j>16){var w=t.p-(i.x-p.x)/j,k=16/j;k>w&&(w=k),w>1-k&&(w=1-k),x.setColumnPosition(w)}}else"s"===G&&x.setTranslateY(O+(i.y-p.y)*x._59I/x._29I.height)},handle_mousemove:function(N){this.handle_touchmove(N)},handle_touchmove:function(d){if(!Re&&em(d)){var Q=this,$=Q.pv,r=s($.lp(d).x-$._9I)<=(Jq?8:3);Q.cp?Q._62O||(r?(Q._62O="c",nf(Q)):s(bk(d).y-Q.cp.y)>=2&&(Q._62O=Q.isV(d)?"s":"p",nf(Q))):(r?Q.setCursor(zi):Q.setCursor(rj),Q.isV(d)&&$._43o())}},isV:function(t){var Z=this.pv,C=Z._29I;return Z._41o()&&C.x+C.width-Z.lp(t).x<Zn},handle_mousewheel:function(W){this.handleScroll(W,W.wheelDelta/40)},handle_DOMMouseScroll:function(Z){2===Z.axis&&this.handleScroll(Z,-Z.detail)},handleScroll:function(c,k){var G=this.pv;xf(c),G.endEditing(),G.translate(0,k*G.getRowHeight())},handle_keydown:function(k){var Y=this.pv,E=Y._rows.size(),C=Y._selectRowIndex+(Sc(k)?-1:1);(Sc(k)||cc(k))&&(0>C&&(C=0),C>=E&&(C=E-1),Y.setSelectRowIndex(C))}}),dn.ListView=function(h){this._5o(h),new lq(this)},Lm("ListView",C,{ms_ac:[Bl,oj,rr,nm,Lq,Ym,wh,zd,Ug,bc,fq,If,yf,bb],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:ui,_rowHeight:Xl,_rowLineVisible:M.listViewRowLineVisible,_rowLineColor:M.listViewRowLineColor,_scrollBarColor:Zb,_scrollBarSize:fp,_autoMakeVisible:mo,_autoHideScrollBar:Ae,_selectBackground:M.listViewSelectBackground,_labelColor:M.listViewLabelColor,_labelSelectColor:M.listViewLabelSelectColor,_labelFont:M.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(A){var w=this,i=w._checkMode;w._checkMode=A,w.fp(En,i,A)},drawRow:function(o,t,H,B,X,g,Q){var r=this,W=0,M=r._indent,I=r.getIconWidth(t);r.drawRowBackground(o,t,H,B,X,g,Q),r._checkMode&&(gl(o,Mk(r.getCheckIcon(t)),W+M/2,X+Q/2,t,r),W+=M),r.drawIcon(o,t,W,X,I,Q),r.drawLabel(o,t,W+I,X,Q)}});var lq=function(Q){this.list=Q,this._lastSelectDataTime=Li(),this.addListeners()};_p(lq,C,{ms_listener:1,getView:function(){return this.list._view},clear:function(q){var _=this,E=_.list;q&&"d"===_._62O&&!_.dragCancel&&E.handleDragAndDrop(q,"end"),E.draggingData&&(E.draggingData=null,E.redraw()),_.dragCancel=_._62O=_._isV=_._isH=_.cp=_.tx=_.ty=Z},handle_mousedown:function(r){this.handle_touchstart(r)},handle_touchstart:function(e){var u=this,y=u.list;if(xf(e),y.setFocus(e)){var l=y.getDataAt(e);u.cp=bk(e),u.tx=y.tx(),u.ty=y.ty(),em(e)?l&&y.handleDragAndDrop&&!u.isV(e)&&!u.isH(e)&&(y.draggingData=l,y.redraw(),y.handleDragAndDrop(e,"prepare")):(l&&u._33o(e,l),u.clear(e))}},handleWindowMouseUp:function(W){this.clear(W)},handleWindowTouchEnd:function(V){this.clear(V)},handle_mouseup:function(i){this.handle_touchend(i)},handle_touchend:function(t){var F=this,G=F.list;if(!F._isV&&!F._isH&&F.cp&&!F._62O){var N=G.getDataAt(t);N?(G.isCheckMode()?F._34o(t,N):F._33o(t,N),yn(t)?G.onDataDoubleClicked(N,t):G.onDataClicked(N,t)):G.handleBackgroundClick(t)}F.clear(t)},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(j){var E=this,v=E.list,z=E._62O,G=E.tx,m=E.ty,d=E.cp,H=bk(j),L=v._29I;"p"===z?v.setTranslate(G+H.x-d.x,m+H.y-d.y):"v"===z?v.ty(m+(d.y-H.y)*v._59I/L.height):"h"===z?v.tx(G+(d.x-H.x)*v._91I/L.width):"d"===z&&(E.dragCancel||v.handleDragAndDrop(j,"between"))},handle_mousemove:function(R){this.handle_touchmove(R)},handle_touchmove:function(X){if(!Re&&em(X)){var p=this,t=p.list;if(p._isV=p.isV(X),p._isH=p.isH(X),p.cp){if(!p._62O){if(Qn(bk(X),p.cp)<2)return;p._isV?p._62O="v":p._isH?p._62O="h":t.draggingData&&!this.dragCancel?(p._62O="d",t.handleDragAndDrop(X,"begin")):p._62O="p",p._62O&&"d"!==p._62O&&t.draggingData&&(t.draggingData=null,t.redraw()),nf(p)}}else p._isV&&t._43o(),p._isH&&t._42o()}},isV:function(H){var j=this.list,E=j._29I;return j._41o()&&E.x+E.width-j.lp(H).x<Zn},isH:function(n){var z=this.list,e=z._29I;return z._40o()&&e.y+e.height-z.lp(n).y<Zn},handle_mousewheel:function(P){this.handleScroll(P,P.wheelDelta/40,P.wheelDelta!==P.wheelDeltaX)},handle_DOMMouseScroll:function(Q){this.handleScroll(Q,-Q.detail,1)},handleScroll:function(f,_,M){var e=this.list;xf(f),e.endEditing&&e.endEditing(),M&&e._41o()?e.translate(0,_*e.getRowHeight()):e._40o()&&e.translate(10*_,0)},handle_keydown:function(W){if(!M.isInput(W.target)){var X,j=this.list,L=j.sm(),f=j._rows,i=f.size();if(hj(W))j.selectAll();else if(bm(W))j.handleDelete&&j.handleDelete(W);else if(_g(W))"d"!==this._62O||this.dragCancel||(j.handleDragAndDrop(W,"cancel"),this.dragCancel=!0);else if(_f(W))j.isCheckMode()&&(X=j.getFocusData(),X&&j.checkData(X));else if(Sc(W)||cc(W)){var Q=j.isCheckMode();if(X=Q?j.getFocusData():L.ld()){var d=j.getRowIndex(X);d>=0&&(Sc(W)?0!==d&&(X=f.get(d-1),Q?j.setFocusData(X):L.ss(X)):d!==i-1&&(X=f.get(d+1),Q?j.setFocusData(X):L.ss(X)))}else i>0&&(X=f.get(0),Q?j.setFocusData(X):L.ss(X))}}},_34o:function(I,T){var L=this.list,b=L.lp(I).x;return b>=0&&b<=L._indent?(L.checkData(T),void 0):(L.setFocusData(T),void 0)},_33o:function(y,o){var Z=this.list,w=Z.sm(),q=w.ld();if(Ah(y))Z.isSelected(o)?w.rs(o):w.as(o);else if(Cd(y))if(q)for(var G=Z.getRowIndex(q),f=Z.getRowIndex(o);G!==f;)G+=f>G?1:-1,w.as(Z._rows.get(G));else w.ss(o);else if(em(y)){var J=Li();if(w.contains(o)){var i=J-this._lastSelectDataTime;Z.handleDataDoubleSelect&&i>500&&1500>i&&Z.handleDataDoubleSelect(y,o)}w.ss(o),this._lastSelectDataTime=J}else w.contains(o)||w.ss(o)}}),dn.TreeView=function(u){var H=this;H._35o(),H._5o(u),new rb(H)},Lm("TreeView",C,{ms_ac:[Bl,oj,rr,"rootVisible",En,"rootData",zd,Ug,bc,fq,If,Lq,nm,Ym,wh,qe,Up,yf,bb,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:Z,_indent:ui,_rowHeight:Xl,_rowLineVisible:M.treeViewRowLineVisible,_rowLineColor:M.treeViewRowLineColor,_scrollBarColor:Zb,_scrollBarSize:fp,_autoHideScrollBar:Ae,_expandIcon:M.treeViewExpandIcon,_collapseIcon:M.treeViewCollapseIcon,_autoMakeVisible:mo,_selectBackground:M.treeViewSelectBackground,_labelColor:M.treeViewLabelColor,_labelSelectColor:M.treeViewLabelSelectColor,_labelFont:M.treeViewLabelFont,_doubleClickToToggle:M.treeViewDoubleClickToToggle,drawRow:function(n,x,G,K,d,$,y){var L=this;L.drawRowBackground(n,x,G,K,d,$,y),L._97I(n,x,G,0,d,$,y)},isOnToggleIcon:function(X){var k=this.getDataAt(X);if(k){var L=this.getIndent(),p=this.lp(X).x;if(Mk(this.getToggleIcon(k))){var x=L*this.getLevel(k);if(p>=x&&x+L>=p)return!0}}return!1}});var rb=function(e){up(rb,this,[e])};_p(rb,lq,{toggle:function(t,X,w,E){var W=this.list,y=W.lp(t).x;if(Mk(W.getToggleIcon(X))){var b=w*E;if(y>=b&&b+w>=y)return W.toggle(X),!0}return W.isDoubleClickToToggle()&&yn(t)?(W.toggle(X),!0):!1},_34o:function(i,Q){var X=this.list,K=X.lp(i).x,A=X._levelMap[Q._id],I=X._indent,t=I*(A+1);return K>=t&&t+I>=K?(X.checkData(Q),void 0):(this.toggle(i,Q,I,A)||X.setFocusData(Q),void 0)},_33o:function(x,w){var n=this,W=n.list;n.toggle(x,w,W._indent,W.getLevel(w))||rb.superClass._33o.call(n,x,w)},handle_keydown:function(z){if(Th(z)||Xf(z)){var y=this.list,G=y._rows,p=y.isCheckMode(),t=y.sm(),R=p?y.getFocusData():t.ld();R?R.hasChildren()&&(Th(z)?y.collapse(R):y.expand(R)):G.size()>0&&(R=G.get(0),p?y.setFocusData(R):t.ss(R))}else rb.superClass.handle_keydown.call(this,z)}});var fi=dn.TableView=function(M){this._98I(),this._5o(M),new zn(this)};Lm("TableView",C,{ms_ac:[Bl,oj,rr,"sortMode",jh,Wm,nm,Ym,wh,pn,He,"sortColumn",zd,Ug,bc,fq,If,yf,bb],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:ll,_editable:!0,_batchEditable:!1,_rowHeight:Xl,_rowLineVisible:M.tableViewRowLineVisible,_rowLineColor:M.tableViewRowLineColor,_columnLineVisible:M.tableViewColumnLineVisible,_columnLineColor:M.tableViewColumnLineColor,_scrollBarColor:Zb,_scrollBarSize:fp,_autoHideScrollBar:Ae,_autoMakeVisible:mo,_selectBackground:M.tableViewSelectBackground,_labelColor:M.tableViewLabelColor,_labelSelectColor:M.tableViewLabelSelectColor,_labelFont:M.tableViewLabelFont,getCheckColumn:function(){var $=this;if(!$._31o){var x=$._31o=new as;x.setEditable(!0),x.setWidth(40),x.getValue=$.getCheckColumValue,x.drawCell=$.drawCheckColumnCell}return $._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(i){var f=this,j=f._39o,Y=f.getCheckColumn();i!==f.isCheckMode()&&(i?j.add(Y,0):j.remove(Y),f.fp(En,!i,i))},getCheckColumValue:function(p,q,X){return X.isSelected(p)},drawCheckColumnCell:function(y,G,Y,K,x,u,W,k,P){gl(y,P.getCheckIcon(G),x+W/2,u+k/2,G,P)}});var zn=function(_){up(zn,this,[_])};_p(zn,lq,{_34o:function(t,N){var C=this.list,S=C._31o;if(C.isCellEditable(N,S,t)){var D=C._3Q(S),K=C.lp(t).x;
if(D&&K>=D.startX&&K<D.startX+S.getWidth())return C.checkData(N),void 0}C._37O(N,t),C.setFocusData(N)},_33o:function(O,b){this.list._37O(b,O),zn.superClass._33o.apply(this,arguments)}});var aq=dn.TreeTableView=function(K){var T=this,f=T._4o=new as;T._35o(),T._98I(),T._5o(K),f.setDisplayName("Name"),f.setEditable(!0),f.setWidth(180),f.drawCell=mj,f.getValue=Jo,T._39o.add(f),new cd(T)},mj=function(T,M,A,k,Y,t,Q,j,e){e._97I(T,M,A,Y,t,Q,j)},Jo=function(Q,G,f){return f.getLabel(Q)};Lm("TreeTableView",C,{ms_ac:[Bl,oj,rr,"sortMode",jh,Wm,Lq,En,"rootData","rootVisible",zd,Ug,"sortColumn",qe,Up,bc,fq,If,yf,wh,nm,Ym,pn,He,bb,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:ll,_checkMode:Z,_editable:!0,_batchEditable:!1,_indent:ui,_rowHeight:Xl,_rowLineVisible:M.treeTableViewRowLineVisible,_rowLineColor:M.treeTableViewRowLineColor,_columnLineVisible:M.treeTableViewColumnLineVisible,_columnLineColor:M.treeTableViewColumnLineColor,_expandIcon:M.treeTableViewExpandIcon,_collapseIcon:M.treeTableViewCollapseIcon,_scrollBarColor:Zb,_scrollBarSize:fp,_autoHideScrollBar:Ae,_autoMakeVisible:mo,_selectBackground:M.treeTableViewSelectBackground,_labelColor:M.treeTableViewLabelColor,_labelSelectColor:M.treeTableViewLabelSelectColor,_labelFont:M.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var cd=function(H){up(cd,this,[H])};_p(cd,lq,{_34o:function(V,k){var O=this.list,h=O._4o,f=O._3Q(h),s=O.lp(V).x;if(f){var v=O._indent,N=f.startX+v*O.getLevel(k);if(Mk(O.getToggleIcon(k))&&s>=N&&N+v>=s)return O.toggle(k),void 0;if(O.isCellEditable(k,h)&&(N+=v,s>=N&&N+v>=s))return O.checkData(k),void 0}O._37O(k,V),O.setFocusData(k)},_33o:function(y,A){var a=this.list,J=a.lp(y).x;if(Mk(a.getToggleIcon(A))){var W=a._3Q(a._4o);if(W){var o=a._indent,Z=W.startX+o*a.getLevel(A);if(J>=Z&&Z+o>=J)return a.toggle(A),void 0}}a._37O(A,y),cd.superClass._33o.apply(this,arguments)}});var xl=dn.TableHeader=function(x){var Q=this,z=Q._view=nn(1,Q),Z=Q._39o=x.getColumnModel(),u=Q.iv;Q.tv=Q._tableView=x,Q._60I=new $p,Q._canvas=Od(z),z.style.background=M.tableHeaderBackground||"",z.style.height=gn+rm,Z.mm(u,Q),Z.md(u,Q),Z.mh(u,Q),x.mp(function(Z){Fn[Z.property]&&Q.iv()},Q),new Vm(Q),Q.iv()};Lm("TableHeader",C,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Bl,rr,Lq,"moveBackground","insertColor",pn,He,"resizable","movable"],_checkIcon:wf,_movable:!0,_resizable:!0,_labelColor:M.tableHeaderLabelColor,_labelFont:M.tableHeaderLabelFont,_columnLineColor:M.tableHeaderColumnLineColor,_columnLineVisible:M.tableHeaderColumnLineVisible,_sortDescIcon:M.tableHeaderSortDescIcon,_sortAscIcon:M.tableHeaderSortAscIcon,_moveBackground:M.tableHeaderMoveBackground,_insertColor:M.tableHeaderInsertColor,_indent:ui,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(v){return v.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(J){return J.getColor()||this._labelColor},getLabelAlign:function(S){return S._align},onPropertyChanged:function(){this.iv()},_5Q:function(V){this._61I=V,this.iv()},getLogicalPoint:function(d){return il(d,this._canvas,this.tv.tx())},validateImpl:function(){var z=this,f=z._canvas,K=z.getWidth(),Y=z.getHeight(),H=z.tv,O=z._60I,Q=z._61I,x=-H.tx(),X=0;(K!==f.clientWidth||Y!==f.clientHeight)&&Aq(f,K,Y),O.clear(),z._39o._roots.each(function(G){if(G.isVisible()){var W=X+G.getWidth();x+K>=X&&W>=x&&O.add({column:G,startX:X}),X=W}});var A=Lf(f);if(Nn(A,-x,0,1),A.beginPath(),A.rect(x,0,K,Y),A.clip(),A.clearRect(x,0,K,Y),O.each(function(j){var M=j.column,O=j.startX,l=M.getWidth();l>0&&(A.save(),A.beginPath(),A.rect(O,0,l,Y),A.clip(),Q&&Q.column===M||z.drawColumn(A,M,O,0,l,Y),z._columnLineVisible&&Rf(A,O+l-1,0,1,Y,z._columnLineColor),A.restore())}),Q){var a=Q.column,X=Q.startX,V=Q.position,r=a.getWidth();A.save(),A.beginPath(),A.rect(X,0,r,Y),A.clip(),A.fillStyle=z._moveBackground,A.fill(),z.drawColumn(A,a,X,0,r,Y),A.restore(),dq(A,z._insertColor,V,0,Y)}A.restore()},_6Q:function(n){var A=this.tv;return A._31o===n&&A.sm().getSelectionMode()===vp},drawColumn:function(P,h,g,L,f,X){var E=this,i=E.tv,M=Mk(h.getIcon()),x=E.getLabelAlign(h);if(E._6Q(h)){var A=Mk(E._checkIcon);gl(P,A,g+f/2,L+X/2,h,E)}else{var v=E.getLabel(h),u=E.getLabelFont(h),n=E.getLabelColor(h),o=Dn(u,v).width,s=M?E._indent:0;x===Wf?(M&&Ri(P,M,Yr,g,L,s,X),np(P,v,u,n,g+s,L,f,X,Wf)):x===qb?(M&&Ri(P,M,Yr,g+f-o-s,L,s,X),np(P,v,u,n,g,L,f,X,qb)):(M&&Ri(P,M,Yr,g+(f-o-s)/2,L,s,X),np(P,v,u,n,g+(f-o+s)/2,L,0,X,Wf))}if(h.isSortable()&&i.getSortColumn()===h&&(M=Mk(h.getSortOrder()===fd?E._sortAscIcon:E._sortDescIcon))){var l=pr(M,h)/2+2;gl(P,M,x===qb?g+l:g+f-l,L+X/2,h,i)}}});var Vm=function(P){var m=this;m.th=P,m.tv=P._tableView,m.addListeners()};_p(Vm,C,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(c){this.getView().style.cursor=c},handle_mousemove:function(a){if(!Re){var D=this;delete D._29o,D.setCursor(rj);for(var O=D.th,K=O._60I,B=O.lp(a).x,C=K.size()-1;C>=0;C--){var S=K.get(C),N=S.column,x=S.startX+N.getWidth();if(O.isResizable()&&s(x-B)<=(Jq?10:3))return D._29o=S,D.setCursor(zi),void 0;B>S.startX&&x>B&&(D._29o=S),(N.isClickable()||N.isSortable()||O.isMovable()||D.tv.getCheckColumn&&N===D.tv.getCheckColumn())&&B>S.startX&&x>B&&D.setCursor(Vh)}}},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(t){var n=this;xf(t),n.tv.endEditing(),n.handle_mousemove(t),n._29o&&(n.x=bk(t).x,n.lx=n.th.lp(t).x,n.w=n._29o.column.getWidth(),nf(n,t))},handleWindowMouseMove:function(t){this.handleWindowTouchMove(t)},handleWindowTouchMove:function(j){var C=this,L=C.th,M=C.getView().style.cursor,w=C._29o,J=bk(j).x-C.x;if(C.resizing||C.moving||(M===zi?C.resizing=1:L.isMovable()&&M===Vh&&s(J)>2&&(C.moving=1)),C.resizing)w.column.setWidth(C.w+J);else if(C.moving){var f=C.lx+J;L._60I.each(function(M){var G=M.startX,Q=G+M.column.getWidth();if(f>=G&&Q>=f){var b={column:w.column,startX:w.startX+J,front:Q-f>f-G,insertColumn:M.column};b.position=b.front?G:Q,L._5Q(b)}})}},_16Q:function(X,C){var P=this,K=P.tv,G=P.th,W=G._checkIcon;if(G._6Q(X)){var i=Mk(W),q=P.lx,m=X.getWidth(),u=pr(i,X);if(q>=C+m/2-u&&C+m/2+u>=q){G.setCheckIcon(W===Tl?wf:Tl);var e=K.sm(),D=K._rows;return W===Tl?e.rs(D):e.ss(D),K.onCheckColumnClicked(X),!0}}return!1},handleWindowMouseUp:function(n){this.handleWindowTouchEnd(n)},handleWindowTouchEnd:function(q){var _=this,P=_.tv,D=_.th,y=_._29o;if(_.moving){var m=D._61I;if(m&&m.insertColumn!==m.column){var j=m.column,M=P.getColumnModel()._roots,G=M.remove(j),n=M.indexOf(m.insertColumn);n>=0&&(m.front||n++,n<=M.size()&&(M.add(j,n),P.getColumnModel()._38I(j,G,n)))}D._5Q(Z),delete _.moving}else if(!_.resizing&&y){j=y.column;var S=D.lp(q).x,e=y.startX,F=!0;if(D.onColumnClicked){var Y=D.onColumnClicked(j,q,e);Y===!1&&(F=!1)}if(F&&S>=e&&S<=e+j.getWidth()&&!_._16Q(j,e)){if(j.isSortable()){var p=P.getSortMode(),K=j.getSortOrder();p===ll?P.getSortColumn()===j?(K===Db&&P.setSortColumn(Z),j.setSortOrder(K===fd?Db:fd)):P.setSortColumn(j):"bistate"===p&&(P.getSortColumn()===j?j.setSortOrder(K===fd?Db:fd):P.setSortColumn(j))}P.onColumnClicked(j,q,e)}}_._29o=_.resizing=_.x=_.lx=_.w=Z}}),dn.TablePane=function(w){this.init(new fi(w))},Lm("TablePane",C,{ms_v:1,_44o:1}),dn.TreeTablePane=function(p){this.init(new aq(p))},Lm("TreeTablePane",C,{ms_v:1,_44o:1}),dn.Toolbar=function(v){var y=this,a=y._view=nn(1,y),l=a.style;l.background=M.toolbarBackground||"",l.height=$r+rm,y._canvas=Od(a),y._30o=new $p,y._90I=new $p,y.setItems(v||[]),a.handleGroupSelectedChanged=function(W){if(W.isSelected()){var s=W.getGroupId();null!=s&&y._items.forEach(function(G){var K=G.element;K&&K!==W&&K.setSelected&&K.getGroupId&&K.getGroupId()===s&&K.setSelected(!1)})}},new Qg(y)},Lm("Toolbar",C,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Mj,Bl,rr,oj,bb,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:M.toolbarLabelColor,_labelSelectColor:M.toolbarLabelSelectColor,_labelFont:M.toolbarLabelFont,_selectBackground:M.toolbarSelectBackground,_itemGap:M.toolbarItemGap,_separatorColor:M.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(D){var c=this.getItemInfoAt(D);return c?c.item.toolTip:Z},getLabelColor:function(X){return X&&X.selected&&X.type!==Tl&&X.type!==nl?this._labelSelectColor:this._labelColor},onPropertyChanged:function(F){this.iv(),F.property===Mj&&this._items.forEach(function(v){Ng(v)})},redraw:function(){this.iv()},addItem:function(I,$){var G=this._items;$==Z?G.push(I):G.splice($,0,I),this.fp(Mj,Z,G)},removeItem:function(G){if(G)for(var u=this._items,w=0;w<u.length;w++)G===u[w]&&(u.splice(w,1),this.fp(Mj,Z,u))},removeItemById:function(n){if(n!=Z)for(var q=this._items,g=0;g<q.length;g++)if(n===q[g].id){var u=q.splice(g,1)[0];return this.fp(Mj,Z,q),u}},getItemById:function(s){if(s!=Z)for(var V=this._items,b=0;b<V.length;b++){var j=V[b];if(s===j.id)return j}},setItemVisible:function(i,K){var R=this.getItemById(i);R&&(R.visible=K)},getItemInfos:function(){return this._30o},getItemInfoAt:function(D){var S=this,s=0,L=S._30o,b=S.lp(D),p=b.x,F=b.y;if(F>=0&&F<=S.getHeight())for(;s<L.size();s++){var $=L.get(s);if($.startX<=p&&p<=$.endX)return $}return Z},drawItem:function(H,w,P,b,o){if(w.visible===!1)return 0;if(Ck(w.visible)&&!w.visible())return 0;var i=this,G=w.disabled;G&&(H.globalAlpha=Gn);var d=i.drawItemImpl(H,w,P,b,o),r=i._itemGap;return G&&(H.globalAlpha=1),this._currentItem!==w||"separator"===w||w.separator===!0||w.unfocusable||Il(H,i._separatorColor,P-r/2,0,d+r,b),d},drawItemImpl:function(t,k,i,d,g){var x=this,G=x._view,j=x._itemGap,X=d/2,W=k.type,O=k.element,Q=k.label;Gk(O)&&(Q=O,O=Z);var P,A=x.getLabelFont(k),J=x.getLabelColor(k),F=k.selected,e=Mk(k.icon),M=pr(e,k),r=0,C=M+(Q?Dn(A,Q).width:0);if("separator"===k||k.separator===!0)return dq(t,x._separatorColor,i,d/4,X),1;if(O){e&&gl(t,e,i+M/2,X,k,x),np(t,Q,A,J,i+M,0,0,d);var l=or(O);g||x._90I.add(l),l.parentNode!==G&&Xh(G,l),O.iv&&O.iv(),O.validate&&O.validate();var v=l.getBoundingClientRect(),R=v.width,s=l.style;return tl(l),s.left=x.tx()+i+C+rm,s.top=(d-v.height)/2+rm,C+R}return W===nl?P=Mk(F?Km:zl):W===Tl&&(P=Mk(F?Tl:wf)),P?(r=pr(P,k),gl(t,P,i+r/2,X,k,x),i+=r,C+=r):F&&Rf(t,i-j/2,0,C+j,d,x.getSelectBackground(k)),e&&gl(t,e,i+M/2,X,k,x),np(t,Q,A,J,i+M,0,0,d),C},validateImpl:function(){var j=this,N=j._canvas,b=j.getWidth(),Y=j.getHeight(),k=j._30o,a=j._items;Aq(N,b,Y);var o=Lf(N),I=j._itemGap,J=I/2;Nn(o,j.tx(),0,1),o.clearRect(0,0,b,Y);var D=j._90I;j._90I=new $p,k.clear(),a.forEach(function(T){var e=j.drawItem(o,T,J,Y);k.add({item:T,startX:J,endX:J+e,width:e}),e&&(J+=e+I)}),D.each(function(k){j._90I.contains(k)||Xq(k)});var t=j._64I;j._64I=E(0,J),o.restore(),j._stickToRight?(j._65O=0,o=Lf(N),J=b-j._64I+I,Nn(o,0,0,1),o.clearRect(0,0,b,Y),k.clear(),a.forEach(function($){var E=j.drawItem(o,$,J,Y,!0);k.add({item:$,startX:J,endX:J+E,width:E}),E&&(J+=E+I)}),o.restore()):j.tx(j.tx()),t!==j._64I&&j.onSumWidthChanged(t,j._64I)},onSumWidthChanged:function(){},handleClick:function(w,B){var j=this,f=w.type,v=w.action,u=w.groupId,S=w.selected;w.disabled||(u!=Z?S||(w.selected=!0,this._items.forEach(function(U){U.groupId===u&&w!==U&&(U.selected=!1)}),v&&w.action(w,j,B)):f===Tl||"toggle"===f?(w.selected=!S,v&&w.action(w,j,B)):v&&w.action(w,j,B)),sf(),j.iv()}});var Qg=function(r){this.tb=r,this.addListeners()};_p(Qg,C,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(Q){this.handleScroll(Q,10*(Q.wheelDelta/40))},handle_DOMMouseScroll:function(C){this.handleScroll(C,10*-C.detail)},handleScroll:function(m,q){xf(m);var g=this.tb;g.isScrollable()&&!g._stickToRight&&(g.tx(g.tx()+q),vf())},handle_mousemove:function(y){var d=this;Re||d.setItem(y)},handle_mouseout:function(v){var z=this;v.target===z.getView()?z.tb.setCurrentItem(Z):z.handle_mousemove(v)},handle_mousedown:function(u){this.handle_mousemove(u),this.handle_touchstart(u)},handle_touchstart:function(N){var Y=this,C=Y.tb,y=N.target;em(N)&&(y===Y.getView()||y===C._canvas)&&(xf(N),C.setFocus(N)&&(this.setItem(N,!0),(C.isScrollable()||Y.info&&!Y.info.item.disabled)&&(Y.x=bk(N).x,Y.tx=C.tx(),nf(Y,N))))},handleWindowMouseMove:function(v){this.handleWindowTouchMove(v)},handleWindowTouchMove:function(C){var u=this,L=u.tb;if(!L._stickToRight){var k=bk(C).x-u.x;!u._25o&&s(k)>2&&L.isScrollable()&&(u._25o=1),u._25o&&L.tx(u.tx+k)}},handleWindowMouseUp:function(q){this.handleWindowTouchEnd(q)},handleWindowTouchEnd:function(y){var d=this,g=d.tb,I=d.info,C=d.tb.getItemInfoAt(y);if(!d._25o&&I){var i=I.item;C&&C.item===i&&g.handleClick(i,y)}d._25o=d.x=d.tx=Z,d.setItem()},setItem:function(V,q){var d=this,H=d.tb,L=d.info=V?H.getItemInfoAt(V):Z,g=L?L.item:Z;H.setCurrentItem(g),q&&g&&Ck(g.onDown)&&g.onDown(V)}}),dn.BorderPane=function(){this._view=nn(1,this),this.iv()},Lm("BorderPane",C,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(c,u){this._12o("leftView",c),u!=Z&&this.setLeftWidth(u)},getRightView:function(){return this._rightView},setRightView:function(e,G){this._12o("rightView",e),G!=Z&&this.setRightWidth(G)},getTopView:function(){return this._topView},setTopView:function(A,l){this._12o("topView",A),l!=Z&&this.setTopHeight(l)},getBottomView:function(){return this._bottomView},setBottomView:function(L,w){this._12o("bottomView",L),w!=Z&&this.setBottomHeight(w)},getCenterView:function(){return this._centerView},setCenterView:function(l){this._12o("centerView",l)},_12o:function(Y,F){var o=this,H="_"+Y,K=o._view,_=o[H];_!==F&&(_&&(_.getView?Xq(_.getView()):Xq(_)),o[H]=F,F&&(F.getView?Xh(K,F.getView(),1):Xh(K,F,1)),o.fp(Y,_,F))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var O=this,J=O._topView,c=O._bottomView,q=O._leftView,B=O._rightView,y=O._centerView,Y=O.getWidth(),s=O.getHeight(),W=0,o=0,V=Y,m=s,n=0,d=0,D=0,x=0;J&&(n=O._topHeight==Z?lc(J):O._topHeight,o=n),c&&(d=O._bottomHeight==Z?lc(c):O._bottomHeight,m=s-d),q&&(D=O._leftWidth==Z?vr(q):O._leftWidth,W=D),B&&(x=O._rightWidth==Z?vr(B):O._rightWidth,V=Y-x);var h=E(0,V-W),P=E(0,m-o);J&&ef(J,0,0,Y,n),c&&ef(c,0,m,Y,d),q&&ef(q,0,o,D,P),B&&ef(B,V,o,x,P),y&&ef(y,W,o,h,P)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);